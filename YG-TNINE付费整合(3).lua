if game.PlaceId == 120217704230083 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

    Window:EditOpenButton({
        Title = "Paid user",
        Icon = "crown",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
        Draggable = true,
    })
    
    Window:Tag({
        Title = "付费版",
        Color = Color3.fromHex("#FFA500") 
    })
    
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)
    
    if not borderInitialized then
        spawn(function()
            wait(0.5)
            initializeRainbowBorder("糖果颜色", animationSpeed)
            wait(1)
            applyFontStyleToWindow(currentFontStyle)
        end)
    end

    local windowOpen = true

    local killLoop = false
    local knifeLoop = false
    local skillLoop = false
    local killInterval = 0.1
    local attackRange = 50
    local player = game.Players.LocalPlayer

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
    end)

    local originalOpenFunction = Window.Open
    Window.Open = function(...)
        windowOpen = true
        local result = originalOpenFunction(...)
        
        if borderInitialized and borderEnabled and not rainbowBorderAnimation then
            wait(0.1)
            startBorderAnimation(Window, animationSpeed)
        end
        
        return result
    end

    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})
    local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})
    infoSection:Divider()
    infoSection:Paragraph({
        Title = "您当前的服务器为",
        Desc = tostring(game.PlaceId) .. "\n欢迎使用YG/TNINE",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "持续更新 有bug请提出来",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "作者:怀 凌乱",
        ThumbnailSize = 190,
    })

    local LockSection = Window:Section({
        Title = "功能以及UI设置",
        Icon = "crown",
        Opened = true,
    })

    local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
    Settings:Paragraph({
        Title = "UI设置",
        Desc = "绝妙二改WindUI",
        Image = "settings",
        ImageSize = 20,
        Color = "White"
    })

    Settings:Toggle({
        Title = "启用边框",
        Value = borderEnabled,
        Callback = function(value)
            borderEnabled = value
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Enabled = value
                    if value and windowOpen and not rainbowBorderAnimation then
                        startBorderAnimation(Window, animationSpeed)
                    elseif not value and rainbowBorderAnimation then
                        rainbowBorderAnimation:Disconnect()
                        rainbowBorderAnimation = nil
                    end
                    
                    WindUI:Notify({
                        Title = "边框",
                        Content = value and "已启用" or "已禁用",
                        Duration = 2,
                        Icon = value and "eye" or "eye-off"
                    })
                end
            end
        end
    })

    Settings:Toggle({
        Title = "启用字体颜色",
        Value = fontColorEnabled,
        Callback = function(value)
            fontColorEnabled = value
            applyFontColorsToWindow(currentFontColorScheme)
            
            WindUI:Notify({
                Title = "字体颜色",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "type" or "type"
            })
        end
    })

    Settings:Toggle({
        Title = "启用音效",
        Value = soundEnabled,
        Callback = function(value)
            soundEnabled = value
            WindUI:Notify({
                Title = "音效",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "volume-2" or "volume-x"
            })
        end
    })

    Settings:Toggle({
        Title = "启用背景模糊",
        Value = blurEnabled,
        Callback = function(value)
            blurEnabled = value
            applyBlurEffect(value)
            WindUI:Notify({
                Title = "背景模糊",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "cloud-rain" or "cloud"
            })
        end
    })

    local colorSchemeNames = {}
    for name, _ in pairs(COLOR_SCHEMES) do
        table.insert(colorSchemeNames, name)
    end
    table.sort(colorSchemeNames)

    Settings:Dropdown({
        Title = "边框颜色方案",
        Desc = "选择喜欢的颜色组合",
        Values = colorSchemeNames,
        Value = "糖果颜色",
        Callback = function(value)
            currentBorderColorScheme = value
            local success = initializeRainbowBorder(value, animationSpeed)
            playSound()
        end
    })

    Settings:Dropdown({
        Title = "字体颜色方案",
        Desc = "选择文字颜色组合",
        Values = colorSchemeNames,
        Value = "彩虹颜色",
        Callback = function(value)
            currentFontColorScheme = value
            applyFontColorsToWindow(value)
            playSound()
        end
    })

    local fontOptions = {}
    for _, fontName in ipairs(FONT_STYLES) do
        local description = FONT_DESCRIPTIONS[fontName] or fontName
        table.insert(fontOptions, {text = description, value = fontName})
    end

    table.sort(fontOptions, function(a, b)
        return a.text < b.text
    end)

    local fontValues = {}
    local fontValueToName = {}
    for _, option in ipairs(fontOptions) do
        table.insert(fontValues, option.text)
        fontValueToName[option.text] = option.value
    end

    Settings:Dropdown({
        Title = "字体样式",
        Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
        Values = fontValues,
        Value = "标准粗体",
        Callback = function(value)
            local fontName = fontValueToName[value]
            if fontName then
                currentFontStyle = fontName
                local successCount, totalCount = applyFontStyleToWindow(fontName)
                playSound()
            end
        end
    })

    Settings:Slider({
        Title = "边框转动速度",
        Desc = "调整边框旋转的快慢",
        Value = { 
            Min = 1,
            Max = 10,
            Default = 5,
        },
        Callback = function(value)
            animationSpeed = value
            if rainbowBorderAnimation then
                rainbowBorderAnimation:Disconnect()
                rainbowBorderAnimation = nil
            end
            if borderEnabled then
                startBorderAnimation(Window, animationSpeed)
            end
            
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Slider({
        Title = "UI整体缩放",
        Desc = "调整UI大小比例",
        Value = { 
            Min = 0.5,
            Max = 1.5,
            Default = 1,
        },
        Step = 0.1,
        Callback = function(value)
            uiScale = value
            applyUIScale(value)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Slider({
        Title = "UI透明度",
        Desc = "调整整个UI的透明度",
        Value = { 
            Min = 0,
            Max = 1,
            Default = 0.2,
        },
        Step = 0.1,
        Callback = function(value)
            Window:ToggleTransparency(tonumber(value) > 0)
            WindUI.TransparencyValue = tonumber(value)
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI宽度",
        Desc = "调整窗口的宽度",
        Value = { 
            Min = 500,
            Max = 800,
            Default = 600,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI高度",
        Desc = "调整窗口的高度",
        Value = { 
            Min = 300,
            Max = 600,
            Default = 400,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                local currentWidth = Window.UIElements.Main.Size.X.Offset
                Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "边框粗细",
        Desc = "调整边框的粗细",
        Value = { 
            Min = 1,
            Max = 5,
            Default = 1.5,
        },
        Step = 0.5,
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Thickness = value
                end
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "圆角大小",
        Desc = "调整UI圆角的大小",
        Value = { 
            Min = 0,
            Max = 20,
            Default = 16,
        },
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local corner = mainFrame:FindFirstChildOfClass("UICorner")
                if not corner then
                    corner = Instance.new("UICorner")
                    corner.Parent = mainFrame
                end
                corner.CornerRadius = UDim.new(0, value)
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "恢复UI到原位",
        Icon = "rotate-ccw",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "重置UI大小",
        Icon = "maximize-2",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "随机字体",
        Icon = "shuffle",
        Callback = function()
            local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
            currentFontStyle = randomFont
            applyFontStyleToWindow(randomFont)
            playSound()
        end
    })

    Settings:Button({
        Title = "随机颜色",
        Icon = "palette",
        Callback = function()
            local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
            currentBorderColorScheme = randomColor
            initializeRainbowBorder(randomColor, animationSpeed)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Button({
        Title = "刷新字体颜色",
        Icon = "refresh-cw",
        Callback = function()
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Button({
        Title = "刷新字体样式",
        Icon = "refresh-cw",
        Callback = function()
            local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
            playSound()
        end
    })

    Settings:Button({
        Title = "测试所有字体",
        Icon = "check-circle",
        Callback = function()
            local workingFonts = {}
            local totalFonts = #FONT_STYLES
            
            for i, fontName in ipairs(FONT_STYLES) do
                local success = pcall(function()
                    local test = Enum.Font[fontName]
                end)
                
                if success then
                    table.insert(workingFonts, fontName)
                end
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "导出设置",
        Icon = "download",
        Callback = function()
            local settings = {
                font = currentFontStyle,
                borderColor = currentBorderColorScheme,
                fontSize = currentFontColorScheme,
                speed = animationSpeed,
                scale = uiScale
            }
            setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
            playSound()
        end
    })

    local Tab1 = Window:Tab({Title = "主要功能", Icon = "zap"})
    
    local MainSection1 = Tab1:Section({Title = "地牢猎人功能", Icon = "swords", Opened = true})
    
    MainSection1:Toggle({
        Title = "自动杀戮",
        Value = killLoop,
        Callback = function(Value)
            killLoop = Value
            if Value then
                spawn(function()
                    while killLoop do
                        local success, err = pcall(function()
                            local character = player.Character
                            if character and character:FindFirstChild("HumanoidRootPart") then
                                local humanoidRootPart = character.HumanoidRootPart
                                local currentPosition = humanoidRootPart.Position
                                
                                for i = 1, 10 do
                                    local angle = math.rad(i * 36)
                                    local offset = Vector3.new(math.cos(angle) * attackRange, 0, math.sin(angle) * attackRange)
                                    local targetPosition = currentPosition + offset
                                    
                                    local args = {
                                        [1] = "10016",
                                        [2] = "20",
                                        [3] = {},
                                        [4] = targetPosition
                                    }
                                    
                                    game:GetService("ReplicatedStorage").GameplayAbilitySystem.Remote.ClientApplyServerActivateGA:InvokeServer(unpack(args))
                                end
                            end
                        end)
                        
                        if not success then
                            killLoop = false
                            WindUI:Notify({
                                Title = "错误",
                                Content = "杀戮无法运行",
                                Duration = 3,
                                Icon = "4483362458"
                            })
                            break
                        end
                        
                        wait(killInterval)
                    end
                end)
                WindUI:Notify({
                    Title = "提示",
                    Content = "自动杀戮已开启",
                    Duration = 2,
                    Icon = "4483362458"
                })
            else
                WindUI:Notify({
                    Title = "提示",
                    Content = "自动杀戮已关闭",
                    Duration = 2,
                    Icon = "4483362458"
                })
            end
        end
    })

    MainSection1:Toggle({
        Title = "自动砍刀(概率)",
        Value = knifeLoop,
        Callback = function(Value)
            knifeLoop = Value
            if Value then
                spawn(function()
                    while knifeLoop do
                        local success, err = pcall(function()
                            local args = {
                                [1] = "10016",
                                [2] = "23",
                                [3] = {}
                            }
                            game:GetService("ReplicatedStorage").GameplayAbilitySystem.Remote.ClientApplyServerActivateGA:InvokeServer(unpack(args))
                        end)
                        
                        if not success then
                            knifeLoop = false
                            WindUI:Notify({
                                Title = "错误",
                                Content = "自动砍刀模块无法使用，已自动关闭",
                                Duration = 3,
                                Icon = "4483362458"
                            })
                            break
                        end
                        
                        wait(0.1)
                    end
                end)
                WindUI:Notify({
                    Title = "提示",
                    Content = "自动砍刀已开启",
                    Duration = 2,
                    Icon = "4483362458"
                })
            else
                WindUI:Notify({
                    Title = "提示",
                    Content = "自动砍刀已关闭",
                    Duration = 2,
                    Icon = "4483362458"
                })
            end
        end
    })

    MainSection1:Toggle({
        Title = "自动一技能",
        Value = skillLoop,
        Callback = function(Value)
            skillLoop = Value
            if Value then
                spawn(function()
                    while skillLoop do
                        local success, err = pcall(function()
                            local args = {
                                [1] = "10016",
                                [2] = "21",
                                [3] = {}
                            }
                            game:GetService("ReplicatedStorage").GameplayAbilitySystem.Remote.ClientApplyServerActivateGA:InvokeServer(unpack(args))
                        end)
                        
                        if not success then
                            skillLoop = false
                            WindUI:Notify({
                                Title = "错误",
                                Content = "自动一技能模块无法使用，已自动关闭",
                                Duration = 3,
                                Icon = "4483362458"
                            })
                            break
                        end
                        
                        wait(0.1)
                    end
                end)
                WindUI:Notify({
                    Title = "提示",
                    Content = "自动一技能已开启",
                    Duration = 2,
                    Icon = "4483362458"
                })
            else
                WindUI:Notify({
                    Title = "提示",
                    Content = "自动一技能已关闭",
                    Duration = 2,
                    Icon = "4483362458"
                })
            end
        end
    })

    local SkillControlSection = Tab1:Section({Title = "技能控制", Icon = "settings", Opened = true})
    
    SkillControlSection:Slider({
        Title = "杀戮攻击速度",
        Desc = "调整自动杀戮的攻击速度",
        Value = { 
            Min = 0.05,
            Max = 2,
            Default = 0.1,
        },
        Step = 0.05,
        Callback = function(Value)
            killInterval = Value
            WindUI:Notify({
                Title = "设置已更新",
                Content = "杀戮攻速: " .. Value .. "秒",
                Duration = 2,
                Icon = "4483362458"
            })
        end
    })

    SkillControlSection:Slider({
        Title = "攻击范围[50%无效]",
        Desc = "调整自动杀戮的攻击范围",
        Value = { 
            Min = 10,
            Max = 100,
            Default = 50,
        },
        Step = 5,
        Callback = function(Value)
            attackRange = Value
            WindUI:Notify({
                Title = "设置已更新",
                Content = "攻击距离: " .. Value .. "米",
                Duration = 2,
                Icon = "4483362458"
            })
        end
    })

    local allFunctionsEnabled = false
    
    SkillControlSection:Toggle({
        Title = "一键全开",
        Value = allFunctionsEnabled,
        Callback = function(Value)
            if Value then
                killLoop = true
                knifeLoop = true
                skillLoop = true
                allFunctionsEnabled = true
                
                spawn(function()
                    while killLoop do
                        local success1, err1 = pcall(function()
                            local character = player.Character
                            if character and character:FindFirstChild("HumanoidRootPart") then
                                local humanoidRootPart = character.HumanoidRootPart
                                local currentPosition = humanoidRootPart.Position
                                
                                for i = 1, 10 do
                                    local angle = math.rad(i * 36)
                                    local offset = Vector3.new(math.cos(angle) * attackRange, 0, math.sin(angle) * attackRange)
                                    local targetPosition = currentPosition + offset
                                    
                                    local killArgs = {
                                        [1] = "10016",
                                        [2] = "20",
                                        [3] = {},
                                        [4] = targetPosition
                                    }
                                    
                                    game:GetService("ReplicatedStorage").GameplayAbilitySystem.Remote.ClientApplyServerActivateGA:InvokeServer(unpack(killArgs))
                                end
                            end
                        end)
                        
                        if not success1 then
                            killLoop = false
                            WindUI:Notify({
                                Title = "错误",
                                Content = "自动杀戮模块无法运行",
                                Duration = 3,
                                Icon = "4483362458"
                            })
                            break
                        end
                        
                        wait(killInterval)
                    end
                end)
                
                spawn(function()
                    while knifeLoop do
                        local success2, err2 = pcall(function()
                            local knifeArgs = {[1] = "10016", [2] = "23", [3] = {}}
                            game:GetService("ReplicatedStorage").GameplayAbilitySystem.Remote.ClientApplyServerActivateGA:InvokeServer(unpack(knifeArgs))
                        end)
                        
                        if not success2 then
                            knifeLoop = false
                            WindUI:Notify({
                                Title = "错误",
                                Content = "自动砍刀模块无法使用，已自动关闭",
                                Duration = 3,
                                Icon = "4483362458"
                            })
                            break
                        end
                        
                        wait(0.1)
                    end
                end)
                
                spawn(function()
                    while skillLoop do
                        local success3, err3 = pcall(function()
                            local skillArgs = {[1] = "10016", [2] = "21", [3] = {}}
                            game:GetService("ReplicatedStorage").GameplayAbilitySystem.Remote.ClientApplyServerActivateGA:InvokeServer(unpack(skillArgs))
                        end)
                        
                        if not success3 then
                            skillLoop = false
                            WindUI:Notify({
                                Title = "错误",
                                Content = "自动一技能模块无法运行",
                                Duration = 3,
                                Icon = "4483362458"
                            })
                            break
                        end
                        
                        wait(0.1)
                    end
                end)
                
                WindUI:Notify({
                    Title = "提示",
                    Content = "所有功能已开启",
                    Duration = 3,
                    Icon = "4483362458"
                })
            else
                killLoop = false
                knifeLoop = false
                skillLoop = false
                allFunctionsEnabled = false
                
                WindUI:Notify({
                    Title = "提示",
                    Content = "所有功能已关闭",
                    Duration = 3,
                    Icon = "4483362458"
                })
            end
        end
    })

    SkillControlSection:Button({
        Title = "一键关闭所有",
        Icon = "power",
        Callback = function()
            killLoop = false
            knifeLoop = false
            skillLoop = false
            allFunctionsEnabled = false
            
            WindUI:Notify({
                Title = "666",
                Content = "已关闭所有功能",
                Duration = 3,
                Icon = "4483362458"
            })
        end
    })

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        applyBlurEffect(false)
    end)

    Window:OnDestroy(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        for _, animation in pairs(fontColorAnimations) do
            animation:Disconnect()
        end
        fontColorAnimations = {}
        applyBlurEffect(false)
    end)
end

elseif game.PlaceId == 12334109280 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

Window:EditOpenButton({
    Title = "Paid user",
    Icon = "crown",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 4,
    Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
    Draggable = true,
})
Window:Tag({
    Title = "付费版",
    Color = Color3.fromHex("#FFA500") 
})
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do  
            local color = Color3.fromHSV(hue, 0.8, 1)  
            Window:EditOpenButton({
                Color = ColorSequence.new(color)
            })
            wait(0.04)  
        end
    end
end)

if not borderInitialized then
    spawn(function()
        wait(0.5)
        initializeRainbowBorder("糖果颜色", animationSpeed)
        wait(1)
        applyFontStyleToWindow(currentFontStyle)
    end)
end

local windowOpen = true

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
end)

local originalOpenFunction = Window.Open
Window.Open = function(...)
    windowOpen = true
    local result = originalOpenFunction(...)
    
    if borderInitialized and borderEnabled and not rainbowBorderAnimation then
        wait(0.1)
        startBorderAnimation(Window, animationSpeed)
    end
    
    return result
end

local soundId = 115779793163732
local sound = Instance.new("Sound")
sound.SoundId = "rbxassetid://" .. soundId
sound.Parent = game:GetService("SoundService")
sound.Volume = 1
sound.Looped = false
sound:Play()
game:GetService("Debris"):AddItem(sound, sound.TimeLength + 1)

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local RunService = game:GetService("RunService")

local VirtualUser = game:GetService("VirtualUser")
game:GetService("Players").LocalPlayer.Idled:connect(function()
    VirtualUser:Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
    wait(1)
    VirtualUser:Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
end)

local AuraSettings = {
    silentaura = false,
    rotation = false,
    attackhead = false,
    barrel = false,
    attackRange = 19,
    pikeRange = 17,
    axeRange = 8,
    defaultRange = 10
}

local BayonetSettings = {
    silentaura = false,
    rotation = false,
    attackhead = false,
    barrel = false,
    attackRange = 15,
    thrustRange = 10
}

local function getCharacter()
    return player.Character
end

local function getHumanoid()
    local char = getCharacter()
    return char and char:FindFirstChildOfClass("Humanoid")
end

local function getRootPart()
    local char = getCharacter()
    return char and char:FindFirstChild("HumanoidRootPart")
end

local function distance(target)
    local root = getRootPart()
    if not root or not target or not target:FindFirstChild("HumanoidRootPart") then
        return math.huge
    end
    return (target.HumanoidRootPart.Position - root.Position).magnitude
end

local function IsAlive(model)
    if not (model and model.Parent) then return false end
    local humanoid = model:FindFirstChildOfClass("Humanoid")
    return humanoid and humanoid.Health > 0
end

local function GetCurrentWeapon()
    local char = getCharacter()
    if not char then return nil end
    for _, item in pairs(char:GetChildren()) do if item:GetAttribute("Melee") then return item end end
    for _, item in pairs(player.Backpack:GetChildren()) do if item:GetAttribute("Melee") then return item end end
    return nil
end

local function GetWeaponByType()
    local char = getCharacter()
    if char then
        for _, item in pairs(char:GetChildren()) do 
            if item:GetAttribute("Melee") and item.Name ~= "Pike" then 
                return item 
            end 
        end
    end
    for _, item in pairs(player.Backpack:GetChildren()) do 
        if item:GetAttribute("Melee") and item.Name ~= "Pike" then 
            return item 
        end 
    end
    if char then
        for _, item in pairs(char:GetChildren()) do 
            if item:GetAttribute("Melee") and item.Name == "Pike" then 
                return item 
            end 
        end
    end
    for _, item in pairs(player.Backpack:GetChildren()) do 
        if item:GetAttribute("Melee") and item.Name == "Pike" then 
            return item 
        end 
    end
    return nil
end

local function GetDistance(target)
    local char = getCharacter()
    if char and char:FindFirstChild("HumanoidRootPart") and target and target.PrimaryPart then
        return (char.HumanoidRootPart.Position - target.PrimaryPart.Position).Magnitude
    end
    return math.huge
end

local function GetMusket()
    local char = getCharacter()
    for _, i in pairs(char:GetChildren()) do 
        if i.Name == "Musket" or i.Name == "Rifle" then 
            return i 
        end 
    end
    for _, i in pairs(player.Backpack:GetChildren()) do 
        if i.Name == "Musket" or i.Name == "Rifle" then 
            return i 
        end 
    end
    return nil
end

local function GetMeleeWeapon()
    local char = getCharacter()
    if char then
        for _, child in pairs(char:GetChildren()) do
            if child:GetAttribute("Melee") then return child end
        end
    end
    for _, child in pairs(player.Backpack:GetChildren()) do
        if child:GetAttribute("Melee") then return child end
    end
    return nil
end

local function AttackTarget(weapon, forceEquip, aim, target, ignoreDist)
    if not weapon then return end
    local char = getCharacter()
    if not char then return end
    
    local targetRoot = target:FindFirstChild("HumanoidRootPart")
    if not targetRoot then return end
    
    if (char.HumanoidRootPart.Position - targetRoot.Position).Magnitude < 5 then
        local oldParent = weapon.Parent
        local didEquip = false
        
        if forceEquip and weapon.Parent ~= char then
            weapon.Parent = char
            didEquip = true
        end
        task.wait()
        
        if aim then
             char.HumanoidRootPart.CFrame = CFrame.lookAt(char.HumanoidRootPart.Position, Vector3.new(targetRoot.Position.X, char.HumanoidRootPart.Position.Y, targetRoot.Position.Z))
        end
        
        local remote = char:WaitForChild(weapon.Name).RemoteEvent
        remote:FireServer("Swing", "Side")
        remote:FireServer("HitZombie", target, target.Head.CFrame.Position, true)
        task.wait()
        
        if didEquip and ignoreDist then
            weapon.Parent = oldParent
        end
    end
end

local function PerformAttack(target)
    local char = getCharacter()
    if not char then return false end
    local tool = char:FindFirstChildOfClass("Tool")
    if not tool then
        tool = GetMeleeWeapon()
    end
    if not tool then return false end
    
    local remote = tool:FindFirstChild("RemoteEvent") or tool:FindFirstChild("RemoteFunction")
    if not remote then return false end
    
    local targetRoot = target:FindFirstChild("HumanoidRootPart") or target:FindFirstChild("Torso")
    if not targetRoot then return false end
    
    local myRoot = char.HumanoidRootPart
    local hitPos = targetRoot.Position
    local direction = (hitPos - myRoot.Position).Unit
    local force = direction * 25
    local knockback = -direction
    
    pcall(function()
        if remote:IsA("RemoteEvent") then
            remote:FireServer("PrepareSwing")
            task.wait(0)
            remote:FireServer("Swing", "Side")
            remote:FireServer("HitZombie", target, hitPos, false, force, "Torso", knockback)
        else
            remote:InvokeServer("Attack", target, hitPos)
        end
    end)
    
    local remotes = game:GetService("ReplicatedStorage"):FindFirstChild("Remotes")
    local gibRemote = remotes and remotes:FindFirstChild("Gib")
    if gibRemote then
        pcall(function() gibRemote:FireServer(target, "Torso", hitPos, knockback) end)
    end
    return true
end

local Tabs = {
    CombatTab = Window:Tab({ Title = gradient("杀戮类", Color3.fromHex("#FFFFFF"), Color3.fromHex("#FF0000")), Icon = "sword" }),
    SpeedTab = Window:Tab({ Title = gradient("移速控制", Color3.fromHex("#FFFFFF"), Color3.fromHex("#00FF00")), Icon = "gauge" }),
    AssistTab = Window:Tab({ Title = gradient("辅助功能", Color3.fromHex("#FFFFFF"), Color3.fromHex("#FFA500")), Icon = "settings" }),
}

local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})
local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})
infoSection:Divider()
infoSection:Paragraph({
    Title = "您当前的服务器为",
    Desc = tostring(game.PlaceId) .. "\n欢迎使用YG/TNINE",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "持续更新 有bug请提出来",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "作者:怀 凌乱",
    ThumbnailSize = 190,
})

local LockSection = Window:Section({
    Title = "功能以及UI设置",
    Icon = "crown",
    Opened = true,
})

Tabs.CombatTab:Paragraph({
    Title = "公告",
    Desc = "死亡后你开启了那些功能全关闭再打开 不搞的话没效果",
    Image = "rbxassetid://4483345998",
    ImageSize = 42,
    ThumbnailSize = 120
})

Tabs.CombatTab:Section({Title = "杀戮光环"})
Tabs.CombatTab:Toggle({
    Title = "开启/关闭杀戮光环",
    Icon = "sword",
    Value = false,
    Callback = function(Value)
        AuraSettings.silentaura = Value
        if Value then
            local function AttackZombie(target, weapon, headshot)
                local char = getCharacter()
                local hitPos = headshot and target.Head.Position or target.PrimaryPart.Position
                hitPos = hitPos + char.Head.CFrame.LookVector * 2.55
                
                if weapon.Parent ~= char then 
                    weapon.Parent = char 
                end
                
                weapon.RemoteEvent:FireServer("Swing", "Side")
                local args
                if target:GetAttribute("Type") ~= "barrel" then
                    args = {"HitZombie", target, hitPos, true}
                else
                    args = {"HitZombie", target, target.L.CFrame.Position + char.Head.CFrame.LookVector * 2.55, false}
                end
                weapon.RemoteEvent:FireServer(unpack(args))
            end

            if _G.AuraLoop then 
                _G.AuraLoop:Disconnect() 
                _G.AuraLoop = nil
            end
            
            _G.AuraLoop = RunService.Heartbeat:Connect(function()
                local char = getCharacter()
                if AuraSettings.silentaura and char and char:FindFirstChild("HumanoidRootPart") and char:FindFirstChild("Humanoid") then
                    pcall(function()
                        for _, zombie in pairs(workspace.Zombies:GetChildren()) do
                            if zombie and zombie.PrimaryPart and zombie:FindFirstChildOfClass("Humanoid") and zombie:FindFirstChild("State") and zombie.State.Value ~= "Spawn" and char.Humanoid.Health > 0 then
                                local dist = GetDistance(zombie)
                                if dist <= AuraSettings.attackRange then
                                    local isBarrel = zombie:GetAttribute("Type") == "Barrel"
                                    if AuraSettings.barrel or not isBarrel then
                                        local weapon = GetWeaponByType() or GetCurrentWeapon()
                                        if weapon then
                                            local range = weapon.Name == "Pike" and AuraSettings.pikeRange or (weapon.Name == "Axe" and AuraSettings.axeRange or AuraSettings.defaultRange)
                                            
                                            if AuraSettings.rotation then
                                                char.Humanoid.AutoRotate = false
                                                char.HumanoidRootPart.CFrame = CFrame.lookAt(char.HumanoidRootPart.Position, Vector3.new(zombie.PrimaryPart.Position.X, char.HumanoidRootPart.Position.Y, zombie.PrimaryPart.Position.Z))
                                                char.Humanoid.AutoRotate = true
                                            end
                                            
                                            if dist <= range then
                                                local headshot = AuraSettings.attackhead
                                                if headshot then headshot = not isBarrel end
                                                AttackZombie(zombie, weapon, headshot)
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end)
                end
            end)
        else
            if _G.AuraLoop then 
                _G.AuraLoop:Disconnect() 
                _G.AuraLoop = nil
            end
        end
    end
})

Tabs.CombatTab:Section({Title = "刺刀光环"})
Tabs.CombatTab:Toggle({
    Title = "开启/关闭刺刀光环",
    Icon = "sword",
    Value = false,
    Callback = function(Value)
        BayonetSettings.silentaura = Value
        if Value then
            if _G.BayonetLoop then 
                _G.BayonetLoop:Disconnect() 
                _G.BayonetLoop = nil
            end
            
            _G.BayonetLoop = RunService.Heartbeat:Connect(function()
                local char = getCharacter()
                if BayonetSettings.silentaura and char and char:FindFirstChild("HumanoidRootPart") and char:FindFirstChild("Humanoid") then
                    pcall(function()
                        local weapon = GetMusket()
                        if weapon then
                            for _, zombie in pairs(workspace.Zombies:GetChildren()) do
                                if zombie and zombie.PrimaryPart and zombie:FindFirstChildOfClass("Humanoid") and zombie:FindFirstChild("State") and zombie.State.Value ~= "Spawn" and char.Humanoid.Health > 0 then
                                    local dist = GetDistance(zombie)
                                    local isBarrel = zombie:GetAttribute("Type") == "Barrel"
                                    if (BayonetSettings.barrel or not isBarrel) and dist <= BayonetSettings.thrustRange then
                                        if dist > BayonetSettings.attackRange then
                                            weapon.RemoteEvent:FireServer("ThrustBayonet")
                                        else
                                            local hitPart = BayonetSettings.attackhead and "Head" or "Torso"
                                            local hitPos = BayonetSettings.attackhead and zombie.Head.Position or zombie.PrimaryPart.Position
                                            weapon.RemoteEvent:FireServer("Bayonet_HitZombie", zombie, hitPos, false, hitPart)
                                        end
                                        
                                        if BayonetSettings.rotation then
                                            char.Humanoid.AutoRotate = false
                                            char.HumanoidRootPart.CFrame = CFrame.lookAt(char.HumanoidRootPart.Position, Vector3.new(zombie.PrimaryPart.Position.X, char.HumanoidRootPart.Position.Y, zombie.PrimaryPart.Position.Z))
                                            char.Humanoid.AutoRotate = true
                                        end
                                    end
                                end
                            end
                        end
                    end)
                end
            end)
        else
            if _G.BayonetLoop then 
                _G.BayonetLoop:Disconnect() 
                _G.BayonetLoop = nil
            end
        end
    end
})

Tabs.CombatTab:Section({Title = "杀戮光环设置"})
Tabs.CombatTab:Toggle({
    Title = "攻击头部",
    Icon = "target",
    Value = false,
    Callback = function(Value) 
        AuraSettings.attackhead = Value 
    end
})
Tabs.CombatTab:Toggle({
    Title = "攻击炸药桶",
    Icon = "bomb",
    Value = false,
    Callback = function(Value) 
        AuraSettings.barrel = Value 
    end
})
Tabs.CombatTab:Toggle({
    Title = "自动转向",
    Icon = "rotate-cw",
    Value = false,
    Callback = function(Value) 
        AuraSettings.rotation = Value 
    end
})
Tabs.CombatTab:Slider({
    Title = "自动转向触发范围",
    Value = {Min = 5, Max = 50, Default = 19},
    Callback = function(value)
        AuraSettings.attackRange = value
    end
})
Tabs.CombatTab:Slider({
    Title = "长矛攻击范围",
    Value = {Min = 5, Max = 30, Default = 17},
    Callback = function(value)
        AuraSettings.pikeRange = value
    end
})
Tabs.CombatTab:Slider({
    Title = "斧头攻击范围",
    Value = {Min = 5, Max = 20, Default = 8},
    Callback = function(value)
        AuraSettings.axeRange = value
    end
})
Tabs.CombatTab:Slider({
    Title = "其他武器攻击范围",
    Value = {Min = 5, Max = 20, Default = 10},
    Callback = function(value)
        AuraSettings.defaultRange = value
    end
})

Tabs.CombatTab:Section({Title = "刺刀光环设置"})
Tabs.CombatTab:Toggle({
    Title = "攻击头部",
    Icon = "target",
    Value = false,
    Callback = function(Value) 
        BayonetSettings.attackhead = Value 
    end
})
Tabs.CombatTab:Toggle({
    Title = "攻击炸药桶",
    Icon = "bomb",
    Value = false,
    Callback = function(Value) 
        BayonetSettings.barrel = Value 
    end
})
Tabs.CombatTab:Toggle({
    Title = "自动转向",
    Icon = "rotate-cw",
    Value = false,
    Callback = function(Value) 
        BayonetSettings.rotation = Value 
    end
})
Tabs.CombatTab:Slider({
    Title = "自动转向触发范围",
    Value = {Min = 5, Max = 30, Default = 15},
    Callback = function(value)
        BayonetSettings.attackRange = value
    end
})
Tabs.CombatTab:Slider({
    Title = "刺刀攻击范围",
    Value = {Min = 5, Max = 20, Default = 10},
    Callback = function(value)
        BayonetSettings.thrustRange = value
    end
})

Tabs.CombatTab:Section({Title = "高级战斗功能"})
Tabs.CombatTab:Toggle({
    Title = "自动打怪自救",
    Icon = "shield",
    Value = false,
    Callback = function(Value)
        if Value then
            if _G.SelfRescueLoop then 
                _G.SelfRescueLoop:Disconnect() 
                _G.SelfRescueLoop = nil
            end
            
            _G.SelfRescueLoop = RunService.Heartbeat:Connect(function()
                local weapon = GetMeleeWeapon()
                if weapon then
                    for _, zombie in pairs(workspace.Zombies:GetChildren()) do
                        pcall(function()
                            if zombie:GetAttribute("Type") ~= "Barrel" and zombie:FindFirstChild("HumanoidRootPart") then
                                AttackTarget(weapon, true, true, zombie, true)
                                task.wait(0.1)
                            end
                        end)
                    end
                end
            end)
        else
            if _G.SelfRescueLoop then 
                _G.SelfRescueLoop:Disconnect() 
                _G.SelfRescueLoop = nil
            end
        end
    end
})
Tabs.CombatTab:Toggle({
    Title = "自动攻击",
    Icon = "target",
    Value = false,
    Callback = function(Value)
        if Value then
            if _G.AutoAttackConnection then 
                _G.AutoAttackConnection:Disconnect() 
                _G.AutoAttackConnection = nil
            end
            
            local lastAttack = 0
            local cooldown = 0.5
            _G.AutoAttackConnection = RunService.Heartbeat:Connect(function()
                if tick() - lastAttack >= cooldown then
                    local targets = {}
                    local char = getCharacter()
                    if char and char:FindFirstChild("HumanoidRootPart") then
                        local myPos = char.HumanoidRootPart.Position
                        local range = 105
                        
                        local enemies = workspace:FindFirstChild("Zombies") or workspace:FindFirstChild("Enemies")
                        if enemies then
                            for _, enemy in ipairs(enemies:GetChildren()) do
                                if enemy:IsA("Model") and IsAlive(enemy) then
                                    local root = enemy:FindFirstChild("HumanoidRootPart") or enemy:FindFirstChild("Torso")
                                    if root and (myPos - root.Position).Magnitude <= range then
                                        table.insert(targets, {model = enemy, dist = (myPos - root.Position).Magnitude})
                                    end
                                end
                            end
                        end
                        
                        for _, child in ipairs(workspace:GetChildren()) do
                            if child:IsA("Model") and IsAlive(child) then
                                local root = child:FindFirstChild("HumanoidRootPart") or child:FindFirstChild("Torso")
                                if root and (myPos - root.Position).Magnitude <= range then
                                    table.insert(targets, {model = child, dist = (myPos - root.Position).Magnitude})
                                end
                            end
                        end
                        
                        table.sort(targets, function(a, b) return a.dist < b.dist end)
                        
                        if #targets > 0 and PerformAttack(targets[1].model) then
                            lastAttack = tick()
                        end
                    end
                end
            end)
        else
            if _G.AutoAttackConnection then 
                _G.AutoAttackConnection:Disconnect() 
                _G.AutoAttackConnection = nil
            end
        end
    end
})

Tabs.SpeedTab:Section({Title = "移速设置"})
Tabs.SpeedTab:Paragraph({
    Title = "移速功能说明",
    Desc = "开启后保持设定速度 死亡后这个功能也一样 关闭重开。",
    Image = "rbxassetid://4483345998",
    ImageSize = 42,
    ThumbnailSize = 120
})

local currentSpeed = 16
local speedToggle = false

Tabs.SpeedTab:Toggle({
    Title = "移速开关",
    Icon = "gauge",
    Value = false,
    Callback = function(state)
        speedToggle = state
        if state then
            local humanoid = getHumanoid()
            if humanoid then
                humanoid.WalkSpeed = currentSpeed
            end
        else
            local humanoid = getHumanoid()
            if humanoid then
                humanoid.WalkSpeed = 16
            end
        end
    end
})
Tabs.SpeedTab:Slider({
    Title = "移速大小",
    Value = {Min = 1, Max = 100, Default = 16},
    Callback = function(value)
        currentSpeed = value
        if speedToggle then
            local humanoid = getHumanoid()
            if humanoid then
                humanoid.WalkSpeed = currentSpeed
            end
        end
    end
})
Tabs.SpeedTab:Toggle({
    Title = "无减速",
    Icon = "zap-off",
    Value = false,
    Callback = function(Value)
        if Value then
            local function EnforceSpeed()
                local char = getCharacter()
                if char then
                    local hum = char:FindFirstChildOfClass("Humanoid")
                    if hum then
                        hum:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
                            if hum.WalkSpeed < 16 then hum.WalkSpeed = 16 end
                        end)
                        if hum.WalkSpeed < 16 then hum.WalkSpeed = 16 end
                    end
                end
            end
            EnforceSpeed()
            player.CharacterAdded:Connect(function() 
                task.wait(1) 
                EnforceSpeed() 
            end)
        end
    end
})

Tabs.AssistTab:Section({Title = "建筑与修复"})
Tabs.AssistTab:Toggle({
    Title = "自动修复建筑",
    Icon = "hammer",
    Value = false,
    Callback = function(Value)
        if Value then
            if _G.AutoRepairLoop then return end
            _G.AutoRepairLoop = true
            
            task.spawn(function()
                while _G.AutoRepairLoop do
                    local cam = workspace.CurrentCamera
                    local char = getCharacter()
                    if char then
                        local buildings = workspace:FindFirstChild("Buildings")
                        if buildings then
                            local closestDist = math.huge
                            local targetHealth = nil
                            local center = Vector2.new(cam.ViewportSize.X/2, cam.ViewportSize.Y/2)
                            
                            local function CheckModel(model)
                                local health = model:FindFirstChild("BuildingHealth")
                                local hitbox = health and model:FindFirstChild("Hitbox")
                                if hitbox then
                                    local screenPos, onScreen = cam:WorldToScreenPoint(hitbox.CFrame.Position)
                                    if onScreen then
                                        local dist = (Vector2.new(screenPos.X, screenPos.Y) - center).Magnitude
                                        if dist < closestDist then
                                            closestDist = dist
                                            targetHealth = health
                                        end
                                    end
                                end
                            end
                            
                            for _, folder in ipairs(buildings:GetChildren()) do
                                if folder:IsA("Folder") then
                                    for _, model in ipairs(folder:GetChildren()) do
                                        if model:IsA("Model") then CheckModel(model) end
                                    end
                                end
                            end
                            
                            local caltrops = workspace:FindFirstChild("Caltrops")
                            if caltrops and caltrops:IsA("Model") then CheckModel(caltrops) end
                            local stakes = workspace:FindFirstChild("Stakes")
                            if stakes then CheckModel(stakes) end
                            
                            if targetHealth then
                                local hammer = char:FindFirstChild("Hammer")
                                local remote = hammer and hammer:FindFirstChild("RemoteEvent")
                                if remote then
                                    remote:FireServer("Repair", targetHealth)
                                end
                            end
                        end
                    end
                    task.wait(0.01)
                end
            end)
        else
            _G.AutoRepairLoop = false
        end
    end
})
Tabs.AssistTab:Toggle({
    Title = "自动挖雪",
    Icon = "shovel",
    Value = false,
    Callback = function(Value)
        local paths = {
            "Vardohus Fortress/Modes/Objective/DoorSnow/Diggable",
            "Vardohus Fortress/Modes/Objective/Diggable",
            "OLD Vardohus Fortress/Modes/Objective/DigSnow/Diggable"
        }
        
        local function GetShovel()
            local char = getCharacter()
            if not char then return nil end
            for _, child in pairs(char:GetChildren()) do
                if (child.Name == "Shovel" or child.Name == "Spade") and child:FindFirstChild("RemoteEvent") then return child end
            end
            for _, child in pairs(player.Backpack:GetChildren()) do
                if (child.Name == "Shovel" or child.Name == "Spade") and child:FindFirstChild("RemoteEvent") then return child end
            end
            return nil
        end
        
        local function GetSnowTarget()
            for _, path in ipairs(paths) do
                local parts = path:split("/")
                local current = workspace
                for _, name in ipairs(parts) do
                    current = current and current:FindFirstChild(name)
                end
                if current then return current end
            end
            return nil
        end
        
        if Value then
            if _G.AutoDigLoop then 
                _G.AutoDigLoop:Disconnect() 
                _G.AutoDigLoop = nil
            end
            
            _G.AutoDigLoop = RunService.Heartbeat:Connect(function()
                local target = GetSnowTarget()
                if target then
                    local shovel = GetShovel()
                    if shovel then
                        if shovel.Parent ~= player.Character then
                            shovel.Parent = player.Character
                            task.wait(0.2)
                        end
                        if shovel:FindFirstChild("RemoteEvent") then
                            shovel.RemoteEvent:FireServer("Dig", target, target.Position)
                        end
                    end
                end
            end)
        else
            if _G.AutoDigLoop then 
                _G.AutoDigLoop:Disconnect() 
                _G.AutoDigLoop = nil
            end
        end
    end
})
Tabs.AssistTab:Toggle({
    Title = "自动水桶灭火",
    Icon = "droplets",
    Value = false,
    Callback = function(Value)
        if Value then
            if _G.AutoBucketLoop then 
                _G.AutoBucketLoop:Disconnect() 
                _G.AutoBucketLoop = nil
            end
            
            _G.AutoBucketLoop = RunService.Heartbeat:Connect(function()
                local char = getCharacter()
                if not char then return end
                
                local bucket = char:FindFirstChild("Water Bucket") or player.Backpack:FindFirstChild("Water Bucket")
                
                if bucket then
                    if bucket.Parent ~= char then
                        bucket.Parent = char
                        task.wait(0.1)
                    end
                    if bucket:FindFirstChild("RemoteEvent") then
                        bucket.RemoteEvent:FireServer("Throw")
                        task.spawn(function()
                            task.wait(0.2)
                            if bucket and bucket.Parent == char then
                                bucket.Parent = player.Backpack
                            end
                        end)
                    end
                end
            end)
        else
            if _G.AutoBucketLoop then 
                _G.AutoBucketLoop:Disconnect() 
                _G.AutoBucketLoop = nil
            end
        end
    end
})
Tabs.AssistTab:Toggle({
    Title = "自动敲钟",
    Icon = "bell",
    Value = false,
    Callback = function(Value)
        if Value then
            if _G.AutoBellLoop then 
                _G.AutoBellLoop:Disconnect() 
                _G.AutoBellLoop = nil
            end
            
            _G.AutoBellLoop = RunService.Heartbeat:Connect(function()
                if workspace:FindFirstChild("Leipzig") and workspace.Leipzig:FindFirstChild("Modes") then
                    workspace.Leipzig.Modes.Objective.BellInteract.Interact:FireServer()
                end
            end)
        else
            if _G.AutoBellLoop then 
                _G.AutoBellLoop:Disconnect() 
                _G.AutoBellLoop = nil
            end
        end
    end
})

Tabs.AssistTab:Section({Title = "生存功能"})
Tabs.AssistTab:Toggle({
    Title = "自动移除摔落伤害",
    Icon = "shield",
    Value = false,
    Callback = function(Value)
        _G.AutoSelfDamage = Value
        if _G.AutoSelfDamage then
            task.spawn(function()
                while _G.AutoSelfDamage do
                    if getCharacter() and getCharacter():FindFirstChild("Health") then
                        getCharacter().Health.ForceSelfDamage:FireServer(0)
                    end
                    task.wait()
                end
            end)
        end
    end
})
Tabs.AssistTab:Toggle({
    Title = "保持物品栏",
    Icon = "package",
    Value = false,
    Callback = function(Value)
        if Value then
            if not player.PlayerGui:FindFirstChild("BackpackGui") then return end
            player.PlayerGui.BackpackGui.Enabled = true
            player.PlayerGui.BackpackGui:GetPropertyChangedSignal("Enabled"):Connect(function()
                player.PlayerGui.BackpackGui.Enabled = true
            end)
            player.CharacterAdded:Connect(function()
                task.wait(1)
                if player.PlayerGui:FindFirstChild("BackpackGui") then
                    player.PlayerGui.BackpackGui.Enabled = true
                end
            end)
        end
    end
})

Tabs.AssistTab:Section({Title = "成就功能"})
Tabs.AssistTab:Button({
    Title = "解锁复仇之刃成就",
    Icon = "trophy",
    Callback = function()
        local hidden = player:FindFirstChild("HiddenAchievements")
        if hidden then
            local ach = hidden:FindFirstChild("LeRevenant")
            if ach and ach:IsA("BoolValue") then
                ach.Value = true
                Window:Notify({
                    Title = "成就解锁成功",
                    Description = "复仇之刃成就已解锁！",
                    Duration = 5
                })
            else
                Window:Notify({
                    Title = "成就解锁失败",
                    Description = "未找到复仇之刃成就数据",
                    Duration = 5
                })
            end
        end
    end
})

player.CharacterAdded:Connect(function(character)
    if _G.AuraLoop then
        _G.AuraLoop:Disconnect()
        _G.AuraLoop = nil
    end
    
    if _G.BayonetLoop then
        _G.BayonetLoop:Disconnect()
        _G.BayonetLoop = nil
    end
    
    if _G.SelfRescueLoop then
        _G.SelfRescueLoop:Disconnect()
        _G.SelfRescueLoop = nil
    end
    
    if _G.AutoAttackConnection then
        _G.AutoAttackConnection:Disconnect()
        _G.AutoAttackConnection = nil
    end
    
    if _G.AutoBucketLoop then
        _G.AutoBucketLoop:Disconnect()
        _G.AutoBucketLoop = nil
    end
    
    if _G.AutoBellLoop then
        _G.AutoBellLoop:Disconnect()
        _G.AutoBellLoop = nil
    end
    
    if _G.AutoDigLoop then
        _G.AutoDigLoop:Disconnect()
        _G.AutoDigLoop = nil
    end
    
    AuraSettings.silentaura = false
    BayonetSettings.silentaura = false
    
    if not speedToggle then
        local humanoid = character:WaitForChild("Humanoid")
        humanoid.WalkSpeed = 16
    end

    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    local humanoid = character:WaitForChild("Humanoid")
    local originalPosition = humanoidRootPart.Position

    RunService.Stepped:Connect(function()
        if humanoidRootPart.AssemblyLinearVelocity.Magnitude > 100 then
            humanoidRootPart.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
            humanoidRootPart.AssemblyAngularVelocity = Vector3.new(0, 0, 0)
            humanoidRootPart.CFrame = CFrame.new(originalPosition) * humanoidRootPart.CFrame.Rotation
        else
            originalPosition = humanoidRootPart.Position
        end
    end)

    local raycastParams = RaycastParams.new()
    raycastParams.FilterDescendantsInstances = { 
        workspace:WaitForChild("Players"), 
        workspace:FindFirstChild("IgnoreParts"), 
        workspace:WaitForChild("Zombies") 
    }
    raycastParams.FilterType = Enum.RaycastFilterType.Exclude
    raycastParams.IgnoreWater = true

    local lastPlatformCFrame = nil

    RunService.Heartbeat:Connect(function()
        local raycastResult = workspace:Raycast(humanoidRootPart.Position, Vector3.new(0, -10, 0), raycastParams)
        
        if raycastResult and raycastResult.Instance.Parent and raycastResult.Instance.Parent:HasTag("MovingPlatform") then
            local platform = raycastResult.Instance.Parent
            
            if platform.PrimaryPart then
                local currentPlatformCFrame = platform.PrimaryPart.CFrame
                
                if lastPlatformCFrame == nil then
                    lastPlatformCFrame = currentPlatformCFrame
                end
                
                local platformMovement = currentPlatformCFrame * lastPlatformCFrame:Inverse()
                lastPlatformCFrame = currentPlatformCFrame
                
                if not character:HasTag("OnCannon") then
                    humanoidRootPart.CFrame = platformMovement * humanoidRootPart.CFrame
                end
            else
                lastPlatformCFrame = nil
                return
            end
        else
            lastPlatformCFrame = nil
            return
        end
    end)
    
    if player.PlayerGui:FindFirstChild("BackpackGui") then
        player.PlayerGui.BackpackGui.Enabled = true
    end
end)

local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
Settings:Paragraph({
    Title = "UI设置",
    Desc = "绝妙二改WindUI",
    Image = "settings",
    ImageSize = 20,
    Color = "White"
})

Settings:Toggle({
    Title = "启用边框",
    Value = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and windowOpen and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                
                WindUI:Notify({
                    Title = "边框",
                    Content = value and "已启用" or "已禁用",
                    Duration = 2,
                    Icon = value and "eye" or "eye-off"
                })
            end
        end
    end
})

Settings:Toggle({
    Title = "启用字体颜色",
    Value = fontColorEnabled,
    Callback = function(value)
        fontColorEnabled = value
        applyFontColorsToWindow(currentFontColorScheme)
        
        WindUI:Notify({
            Title = "字体颜色",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "type" or "type"
        })
    end
})

Settings:Toggle({
    Title = "启用音效",
    Value = soundEnabled,
    Callback = function(value)
        soundEnabled = value
        WindUI:Notify({
            Title = "音效",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "volume-2" or "volume-x"
        })
    end
})

Settings:Toggle({
    Title = "启用背景模糊",
    Value = blurEnabled,
    Callback = function(value)
        blurEnabled = value
        applyBlurEffect(value)
        WindUI:Notify({
            Title = "背景模糊",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "cloud-rain" or "cloud"
        })
    end
})

local colorSchemeNames = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames, name)
end
table.sort(colorSchemeNames)

Settings:Dropdown({
    Title = "边框颜色方案",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames,
    Value = "糖果颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})

Settings:Dropdown({
    Title = "字体颜色方案",
    Desc = "选择文字颜色组合",
    Values = colorSchemeNames,
    Value = "彩虹颜色",
    Callback = function(value)
        currentFontColorScheme = value
        applyFontColorsToWindow(value)
        playSound()
    end
})

local fontOptions = {}
for _, fontName in ipairs(FONT_STYLES) do
    local description = FONT_DESCRIPTIONS[fontName] or fontName
    table.insert(fontOptions, {text = description, value = fontName})
end

table.sort(fontOptions, function(a, b)
    return a.text < b.text
end)

local fontValues = {}
local fontValueToName = {}
for _, option in ipairs(fontOptions) do
    table.insert(fontValues, option.text)
    fontValueToName[option.text] = option.value
end

Settings:Dropdown({
    Title = "字体样式",
    Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
    Values = fontValues,
    Value = "标准粗体",
    Callback = function(value)
        local fontName = fontValueToName[value]
        if fontName then
            currentFontStyle = fontName
            local successCount, totalCount = applyFontStyleToWindow(fontName)
            playSound()
        end
    end
})

Settings:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = { 
        Min = 1,
        Max = 10,
        Default = 5,
    },
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Slider({
    Title = "UI整体缩放",
    Desc = "调整UI大小比例",
    Value = { 
        Min = 0.5,
        Max = 1.5,
        Default = 1,
    },
    Step = 0.1,
    Callback = function(value)
        uiScale = value
        applyUIScale(value)
        playSound()
    end
})

Settings:Divider()

Settings:Slider({
    Title = "UI透明度",
    Desc = "调整整个UI的透明度",
    Value = { 
        Min = 0,
        Max = 1,
        Default = 0.2,
    },
    Step = 0.1,
    Callback = function(value)
        Window:ToggleTransparency(tonumber(value) > 0)
        WindUI.TransparencyValue = tonumber(value)
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI宽度",
    Desc = "调整窗口的宽度",
    Value = { 
        Min = 500,
        Max = 800,
        Default = 600,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI高度",
    Desc = "调整窗口的高度",
    Value = { 
        Min = 300,
        Max = 600,
        Default = 400,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            local currentWidth = Window.UIElements.Main.Size.X.Offset
            Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = { 
        Min = 1,
        Max = 5,
        Default = 1.5,
    },
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})

Settings:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = { 
        Min = 0,
        Max = 20,
        Default = 16,
    },
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})

Settings:Button({
    Title = "恢复UI到原位",
    Icon = "rotate-ccw",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
            playSound()
        end
    end
})

Settings:Button({
    Title = "重置UI大小",
    Icon = "maximize-2",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
            playSound()
        end
    end
})

Settings:Button({
    Title = "随机字体",
    Icon = "shuffle",
    Callback = function()
        local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
        currentFontStyle = randomFont
        applyFontStyleToWindow(randomFont)
        playSound()
    end
})

Settings:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

Settings:Divider()

Settings:Button({
    Title = "刷新字体颜色",
    Icon = "refresh-cw",
    Callback = function()
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Button({
    Title = "刷新字体样式",
    Icon = "refresh-cw",
    Callback = function()
        local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
        playSound()
    end
})

Settings:Button({
    Title = "测试所有字体",
    Icon = "check-circle",
    Callback = function()
        local workingFonts = {}
        local totalFonts = #FONT_STYLES
        
        for i, fontName in ipairs(FONT_STYLES) do
            local success = pcall(function()
                local test = Enum.Font[fontName]
            end)
            
            if success then
                table.insert(workingFonts, fontName)
            end
        end
        playSound()
    end
})

Settings:Button({
    Title = "导出设置",
    Icon = "download",
    Callback = function()
        local settings = {
            font = currentFontStyle,
            borderColor = currentBorderColorScheme,
            fontSize = currentFontColorScheme,
            speed = animationSpeed,
            scale = uiScale
        }
        setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
        playSound()
    end
})

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    applyBlurEffect(false)
end)

Window:OnDestroy(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    for _, animation in pairs(fontColorAnimations) do
        animation:Disconnect()
    end
    fontColorAnimations = {}
    applyBlurEffect(false)
end)

task.spawn(function()
    wait(2)
    Window:Notify({
        Title = "TnineHub加载完成",
        Description = "tnine team",
        Duration = 5
    })
end)

end

elseif game.PlaceId == 14438406081 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

getgenv().bin = getgenv().bin or {}
getgenv().MovementConfig = getgenv().MovementConfig or { HitboxBrickColor = "Really red" }
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")

local RootPart = nil
local AutoShoot = false
local ShooterModule = nil
local OriginalShoot = nil

getgenv().TrailColors = {
    StartColor = Color3.fromRGB(0, 170, 255),
    EndColor = Color3.fromRGB(255, 0, 0),
    MiddleColor1 = Color3.fromRGB(255, 0, 255),
    MiddleColor2 = Color3.fromRGB(255, 255, 0)
}

local function InitRootPart()
    pcall(function()
        local char = LocalPlayer.Character
        if not char then
            char = LocalPlayer.CharacterAdded:Wait()
        end
        if char then
            RootPart = char:WaitForChild("HumanoidRootPart", 5)
        end
    end)
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})
function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

Window:EditOpenButton({
    Title = "Paid user",
    Icon = "crown",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 4,
    Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
    Draggable = true,
})
Window:Tag({
    Title = "YG(怀)/messy(凌乱)",
    Color = Color3.fromHex("#FFA500") 
})
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do  
            local color = Color3.fromHSV(hue, 0.8, 1)  
            Window:EditOpenButton({
                Color = ColorSequence.new(color)
            })
            wait(0.04)  
        end
    end
end)
if not borderInitialized then
    spawn(function()
        wait(0.5)
        initializeRainbowBorder("糖果颜色", animationSpeed)
        wait(1)
        applyFontStyleToWindow(currentFontStyle)
    end)
end

local windowOpen = true

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
end)

local originalOpenFunction = Window.Open
Window.Open = function(...)
    windowOpen = true
    local result = originalOpenFunction(...)
    
    if borderInitialized and borderEnabled and not rainbowBorderAnimation then
        wait(0.1)
        startBorderAnimation(Window, animationSpeed)
    end
    
    return result
end

local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

infoSection:Divider()

infoSection:Paragraph({
    Title = "您当前的服务器为",
    Desc = "通缉\n欢迎使用YG/TNINE",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "持续更新 有bug请提出来",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "作者:怀 凌乱",
    ThumbnailSize = 190,
})

local LockSection = Window:Section({
    Title = "功能以及UI设置",
    Icon = "crown",
    Opened = true,
})

local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
Settings:Paragraph({
    Title = "UI设置",
    Desc = "绝妙二改WindUI",
    Image = "settings",
    ImageSize = 20,
    Color = "White"
})

Settings:Toggle({
    Title = "启用边框",
    Value = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and windowOpen and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                
                WindUI:Notify({
                    Title = "边框",
                    Content = value and "已启用" or "已禁用",
                    Duration = 2,
                    Icon = value and "eye" or "eye-off"
                })
            end
        end
    end
})

Settings:Toggle({
    Title = "启用字体颜色",
    Value = fontColorEnabled,
    Callback = function(value)
        fontColorEnabled = value
        applyFontColorsToWindow(currentFontColorScheme)
        
        WindUI:Notify({
            Title = "字体颜色",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "type" or "type"
        })
    end
})

Settings:Toggle({
    Title = "启用音效",
    Value = soundEnabled,
    Callback = function(value)
        soundEnabled = value
        WindUI:Notify({
            Title = "音效",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "volume-2" or "volume-x"
        })
    end
})

Settings:Toggle({
    Title = "启用背景模糊",
    Value = blurEnabled,
    Callback = function(value)
        blurEnabled = value
        applyBlurEffect(value)
        WindUI:Notify({
            Title = "背景模糊",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "cloud-rain" or "cloud"
        })
    end
})

local colorSchemeNames = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames, name)
end
table.sort(colorSchemeNames)

Settings:Dropdown({
    Title = "边框颜色方案",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames,
    Value = "糖果颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})

Settings:Dropdown({
    Title = "字体颜色方案",
    Desc = "选择文字颜色组合",
    Values = colorSchemeNames,
    Value = "彩虹颜色",
    Callback = function(value)
        currentFontColorScheme = value
        applyFontColorsToWindow(value)
        playSound()
    end
})

local fontOptions = {}
for _, fontName in ipairs(FONT_STYLES) do
    local description = FONT_DESCRIPTIONS[fontName] or fontName
    table.insert(fontOptions, {text = description, value = fontName})
end

table.sort(fontOptions, function(a, b)
    return a.text < b.text
end)

local fontValues = {}
local fontValueToName = {}
for _, option in ipairs(fontOptions) do
    table.insert(fontValues, option.text)
    fontValueToName[option.text] = option.value
end

Settings:Dropdown({
    Title = "字体样式",
    Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
    Values = fontValues,
    Value = "标准粗体",
    Callback = function(value)
        local fontName = fontValueToName[value]
        if fontName then
            currentFontStyle = fontName
            local successCount, totalCount = applyFontStyleToWindow(fontName)
            playSound()
        end
    end
})

Settings:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = { 
        Min = 1,
        Max = 10,
        Default = 5,
    },
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Slider({
    Title = "UI整体缩放",
    Desc = "调整UI大小比例",
    Value = { 
        Min = 0.5,
        Max = 1.5,
        Default = 1,
    },
    Step = 0.1,
    Callback = function(value)
        uiScale = value
        applyUIScale(value)
        playSound()
    end
})

Settings:Divider()

Settings:Slider({
    Title = "UI透明度",
    Desc = "调整整个UI的透明度",
    Value = { 
        Min = 0,
        Max = 1,
        Default = 0.2,
    },
    Step = 0.1,
    Callback = function(value)
        Window:ToggleTransparency(tonumber(value) > 0)
        WindUI.TransparencyValue = tonumber(value)
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI宽度",
    Desc = "调整窗口的宽度",
    Value = { 
        Min = 500,
        Max = 800,
        Default = 600,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI高度",
    Desc = "调整窗口的高度",
    Value = { 
        Min = 300,
        Max = 600,
        Default = 400,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            local currentWidth = Window.UIElements.Main.Size.X.Offset
            Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = { 
        Min = 1,
        Max = 5,
        Default = 1.5,
    },
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})

Settings:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = { 
        Min = 0,
        Max = 20,
        Default = 16,
    },
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})

Settings:Button({
    Title = "恢复UI到原位",
    Icon = "rotate-ccw",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
            playSound()
        end
    end
})

Settings:Button({
    Title = "重置UI大小",
    Icon = "maximize-2",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
            playSound()
        end
    end
})

Settings:Button({
    Title = "随机字体",
    Icon = "shuffle",
    Callback = function()
        local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
        currentFontStyle = randomFont
        applyFontStyleToWindow(randomFont)
        playSound()
    end
})

Settings:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

Settings:Divider()

Settings:Button({
    Title = "刷新字体颜色",
    Icon = "refresh-cw",
    Callback = function()
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Button({
    Title = "刷新字体样式",
    Icon = "refresh-cw",
    Callback = function()
        local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
        playSound()
    end
})

Settings:Button({
    Title = "测试所有字体",
    Icon = "check-circle",
    Callback = function()
        local workingFonts = {}
        local totalFonts = #FONT_STYLES
        
        for i, fontName in ipairs(FONT_STYLES) do
            local success = pcall(function()
                local test = Enum.Font[fontName]
            end)
            
            if success then
                table.insert(workingFonts, fontName)
            end
        end
        playSound()
    end
})

Settings:Button({
    Title = "导出设置",
    Icon = "download",
    Callback = function()
        local settings = {
            font = currentFontStyle,
            borderColor = currentBorderColorScheme,
            fontSize = currentFontColorScheme,
            speed = animationSpeed,
            scale = uiScale
        }
        setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
        playSound()
    end
})

local MainTab = Window:Tab({
    Title = "愤怒机器人全枪",
    Desc = "hook",
    Icon = "swords",
    IconColor = Color3.fromHex("#EF4F1D"),
    IconShape = "Square",
    Border = true,
})

MainTab:Section({
    Title = "Toggle",
    TextSize = 16,
    FontWeight = Enum.FontWeight.SemiBold,
})

local AutoShootInput = MainTab:Input({
    Flag = "AutoShootInput",
    Title = "愤怒机器人(open开启close关闭)",
    Desc = "输入open启用close关闭自动射击",
    Value = "close",
    Placeholder = "输入open使用close关闭",
    Callback = function(v)
        AutoShoot = v:lower() == "open"
        if AutoShoot then
            task.spawn(function()
                local ReplicatedStorage = game:GetService("ReplicatedStorage")
                local clientTool = ReplicatedStorage:FindFirstChild("Client", true)
                    and ReplicatedStorage.Client:FindFirstChild("Wanted", true)
                    and ReplicatedStorage.Client.Wanted:FindFirstChild("Objects", true)
                    and ReplicatedStorage.Client.Wanted.Objects:FindFirstChild("ClientTool", true)
                    and ReplicatedStorage.Client.Wanted.Objects.ClientTool:FindFirstChild("Components", true)
                    and ReplicatedStorage.Client.Wanted.Objects.ClientTool.Components:FindFirstChild("Guns", true)
                    and ReplicatedStorage.Client.Wanted.Objects.ClientTool.Components.Guns:FindFirstChild("Shooter", true)
                
                if not clientTool then
                    WindUI:Notify({ Title = "错误", Content = "未找到枪械模块", Duration = 3, Color = "Red" })
                    AutoShoot = false
                    AutoShootInput:Set("close")
                    return
                end
                
                ShooterModule = require(clientTool)
                OriginalShoot = ShooterModule._shoot
                
                local function createBezierCurve(p0, p1, p2, t)
                    return (1 - t)^2 * p0 + 2 * (1 - t) * t * p1 + t^2 * p2
                end
                
                local function createBeautifulTrail(origin, targetPos)
                    local trailContainer = Instance.new("Folder")
                    trailContainer.Name = "MagicTrail"
                    trailContainer.Parent = Workspace
                    
                    local midPoint = (origin + targetPos) / 2
                    local direction = (targetPos - origin).Unit
                    local perpendicular = Vector3.new(-direction.Z, direction.Y, direction.X) * 3
                    local controlPoint = midPoint + perpendicular + Vector3.new(0, math.random(-3, 3), 0)
                    
                    local curvePoints = {}
                    local numSegments = 20
                    
                    for i = 0, numSegments do
                        local t = i / numSegments
                        local point = createBezierCurve(origin, controlPoint, targetPos, t)
                        table.insert(curvePoints, point)
                    end
                    
                    for i = 1, #curvePoints - 1 do
                        local startPoint = curvePoints[i]
                        local endPoint = curvePoints[i + 1]
                        local distance = (endPoint - startPoint).Magnitude
                        
                        local beamPart = Instance.new("Part")
                        beamPart.Size = Vector3.new(0.15, 0.15, distance)
                        beamPart.Anchored = true
                        beamPart.CanCollide = false
                        beamPart.Material = Enum.Material.Neon
                        beamPart.Transparency = 0.3
                        beamPart.CFrame = CFrame.new(startPoint, endPoint) * CFrame.new(0, 0, -distance / 2)
                        beamPart.Parent = trailContainer
                        
                        local t = i / (#curvePoints - 1)
                        local color
                        if t < 0.3 then
                            color = getgenv().TrailColors.StartColor or Color3.fromRGB(0, 170, 255)
                        elseif t < 0.6 then
                            color = getgenv().TrailColors.MiddleColor1 or Color3.fromRGB(255, 0, 255)
                        elseif t < 0.9 then
                            color = getgenv().TrailColors.MiddleColor2 or Color3.fromRGB(255, 255, 0)
                        else
                            color = getgenv().TrailColors.EndColor or Color3.fromRGB(255, 0, 0)
                        end
                        
                        beamPart.Color = color
                        
                        local pointLight = Instance.new("PointLight")
                        pointLight.Brightness = 5
                        pointLight.Range = 3
                        pointLight.Color = color
                            pointLight.Parent = beamPart
                        
                        local particles = Instance.new("ParticleEmitter")
                        particles.Size = NumberSequence.new(0.1, 0.3)
                        particles.Transparency = NumberSequence.new(0.3, 0.8)
                        particles.Lifetime = NumberRange.new(0.5, 1)
                        particles.Rate = 50
                        particles.Speed = NumberRange.new(1, 2)
                        particles.VelocitySpread = 180
                        particles.Color = ColorSequence.new(color)
                        particles.Parent = beamPart
                    end
                    
                    task.delay(1.5, function()
                        if trailContainer and trailContainer.Parent then
                            trailContainer:Destroy()
                        end
                    end)
                    
                    return trailContainer
                end
                
                local function hasLineOfSight(shooterPos, targetPos)
                    local raycastParams = RaycastParams.new()
                    raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
                    raycastParams.FilterDescendantsInstances = {LocalPlayer.Character}
                    raycastParams.IgnoreWater = true
                    
                    local direction = (targetPos - shooterPos).Unit
                    local distance = (targetPos - shooterPos).Magnitude
                    local raycastResult = Workspace:Raycast(shooterPos, direction * distance, raycastParams)
                    
                    if raycastResult then
                        local hitPart = raycastResult.Instance
                        if hitPart then
                            local hitCharacter = hitPart:FindFirstAncestorOfClass("Model")
                            if hitCharacter and hitCharacter:FindFirstChild("Humanoid") then
                                return true
                            else
                                return false
                            end
                        end
                    end
                    return true
                end
                
                ShooterModule._shoot = function(self)
                    if not self or not self.tool then
                        return OriginalShoot(self)
                    end
                    
                    local LocalCharacter = LocalPlayer.Character
                    if not LocalCharacter then
                        return OriginalShoot(self)
                    end
                    
                    local shooterPos = LocalCharacter.HumanoidRootPart and LocalCharacter.HumanoidRootPart.Position 
                        or LocalCharacter.PrimaryPart.Position
                    local nearestPlayer = nil
                    local nearestDistance = math.huge
                    
                    for _, player in ipairs(Players:GetPlayers()) do
                        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                            local targetPos = player.Character.HumanoidRootPart.Position
                            local distance = (shooterPos - targetPos).Magnitude
                            
                            if hasLineOfSight(shooterPos, targetPos) and distance < nearestDistance then
                                nearestDistance = distance
                                nearestPlayer = player
                            end
                        end
                    end
                    
                    if nearestPlayer and nearestPlayer.Character and nearestPlayer.Character:FindFirstChild("HumanoidRootPart") then
                        local targetPos = nearestPlayer.Character.HumanoidRootPart.Position
                        self.aimpoint = targetPos
                        self.aimpoint2 = targetPos
                        
                        if self.tool.model and self.tool.model.PrimaryPart then
                            local muzzlePos = self.tool.model.PrimaryPart.Position
                            createBeautifulTrail(muzzlePos, targetPos)
                        else
                            createBeautifulTrail(shooterPos, targetPos)
                        end
                        
                        if self.tool then
                            self.tool.shooting = true
                            self.tool.fireDebounce = 0
                            self.tool.fireMode = "auto"
                        end
                    else
                        if self.tool then
                            self.tool.shooting = false
                        end
                    end
                    
                    return OriginalShoot(self)
                end
                
                while AutoShoot do
                    if ShooterModule and ShooterModule._shoot then
                        local tool = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildWhichIsA("Tool")
                        if tool then
                            local shooter = tool:FindFirstChild("Shooter") or {tool = tool}
                            pcall(function()
                                ShooterModule._shoot(shooter)
                            end)
                        end
                    end
                    task.wait(0.2)
                end
                
                if OriginalShoot then
                    ShooterModule._shoot = OriginalShoot
                end
            end)
            WindUI:Notify({ Title = "成功", Content = "愤怒机器人已启用", Duration = 3 })
        else
            if ShooterModule and OriginalShoot then
                ShooterModule._shoot = OriginalShoot
            end
            WindUI:Notify({ Title = "提示", Content = "愤怒机器人已关闭", Duration = 3 })
        end
    end
})

MainTab:Space()

MainTab:Section({
    Title = "弹道颜色调整",
    TextSize = 16,
    FontWeight = Enum.FontWeight.SemiBold,
})

local TrailColorStartPicker = MainTab:Colorpicker({
    Flag = "TrailColorStart",
    Title = "弹道起始颜色",
    Desc = "设置弹道开始部分的颜色",
    Default = getgenv().TrailColors.StartColor,
    Transparency = 0,
    Callback = function(color)
        getgenv().TrailColors.StartColor = color
        WindUI:Notify({ 
            Title = "颜色已更新", 
            Content = "弹道起始颜色已设置为: " .. tostring(color),
            Duration = 2 
        })
    end
})

MainTab:Space({ Columns = 1 })

local TrailColorMiddle1Picker = MainTab:Colorpicker({
    Flag = "TrailColorMiddle1",
    Title = "弹道中间颜色1",
    Desc = "设置弹道中间部分的颜色",
    Default = getgenv().TrailColors.MiddleColor1,
    Transparency = 0,
    Callback = function(color)
        getgenv().TrailColors.MiddleColor1 = color
        WindUI:Notify({ 
            Title = "颜色已更新", 
            Content = "弹道中间颜色1已设置为: " .. tostring(color),
            Duration = 2 
        })
    end
})

MainTab:Space({ Columns = 1 })

local TrailColorMiddle2Picker = MainTab:Colorpicker({
    Flag = "TrailColorMiddle2",
    Title = "弹道中间颜色2",
    Desc = "设置弹道中间部分的颜色",
    Default = getgenv().TrailColors.MiddleColor2,
    Transparency = 0,
    Callback = function(color)
        getgenv().TrailColors.MiddleColor2 = color
        WindUI:Notify({ 
            Title = "颜色已更新", 
            Content = "弹道中间颜色2已设置为: " .. tostring(color),
            Duration = 2 
        })
    end
})

MainTab:Space({ Columns = 1 })

local TrailColorEndPicker = MainTab:Colorpicker({
    Flag = "TrailColorEnd",
    Title = "弹道结束颜色",
    Desc = "设置弹道结束部分的颜色",
    Default = getgenv().TrailColors.EndColor,
    Transparency = 0,
    Callback = function(color)
        getgenv().TrailColors.EndColor = color
        WindUI:Notify({ 
            Title = "颜色已更新", 
            Content = "弹道结束颜色已设置为: " .. tostring(color),
            Duration = 2 
        })
    end
})

MainTab:Space()

MainTab:Section({
    Title = "弹道预览",
    TextSize = 16,
    FontWeight = Enum.FontWeight.SemiBold,
})

MainTab:Button({
    Title = "测试弹道效果",
    Desc = "在当前位置生成测试弹道（预览颜色效果）",
    Justify = "Center",
    Icon = "zap",
    Callback = function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local startPos = LocalPlayer.Character.HumanoidRootPart.Position
            local endPos = startPos + Vector3.new(0, 0, -20)
            
            local trailContainer = Instance.new("Folder")
            trailContainer.Name = "TestTrail"
            trailContainer.Parent = Workspace
            
            local beam = Instance.new("Part")
            beam.Size = Vector3.new(0.2, 0.2, 20)
            beam.Anchored = true
            beam.CanCollide = false
            beam.Material = Enum.Material.Neon
            beam.Transparency = 0.3
            beam.CFrame = CFrame.new(startPos, endPos) * CFrame.new(0, 0, -10)
            beam.Color = getgenv().TrailColors.StartColor or Color3.fromRGB(0, 170, 255)
            beam.Parent = trailContainer
            
            local pointLight = Instance.new("PointLight")
            pointLight.Brightness = 5
            pointLight.Range = 5
            pointLight.Color = beam.Color
            pointLight.Parent = beam
            
            local particles = Instance.new("ParticleEmitter")
            particles.Size = NumberSequence.new(0.1, 0.3)
            particles.Transparency = NumberSequence.new(0.3, 0.8)
            particles.Lifetime = NumberRange.new(0.5, 1)
            particles.Rate = 50
            particles.Speed = NumberRange.new(1, 2)
            particles.VelocitySpread = 180
            particles.Color = ColorSequence.new(
                getgenv().TrailColors.StartColor or Color3.fromRGB(0, 170, 255),
                getgenv().TrailColors.MiddleColor1 or Color3.fromRGB(255, 0, 255),
                getgenv().TrailColors.MiddleColor2 or Color3.fromRGB(255, 255, 0),
                getgenv().TrailColors.EndColor or Color3.fromRGB(255, 0, 0)
            )
            particles.Parent = beam
            
            task.delay(3, function()
                if trailContainer and trailContainer.Parent then
                    trailContainer:Destroy()
                end
            end)
            
            WindUI:Notify({ 
                Title = "测试成功", 
                Content = "弹道颜色预览已生成",
                Duration = 3 
            })
        else
            WindUI:Notify({ 
                Title = "错误", 
                Content = "无法找到角色位置",
                Duration = 3,
                Color = "Red"
            })
        end
    end
})

MainTab:Space({ Columns = 1 })

MainTab:Button({
    Title = "重置颜色设置",
    Desc = "恢复所有颜色为默认值",
    Justify = "Center",
    Icon = "rotate-ccw",
    Color = Color3.fromHex("#ff4830"),
    Callback = function()
        getgenv().TrailColors = {
            StartColor = Color3.fromRGB(0, 170, 255),
            EndColor = Color3.fromRGB(255, 0, 0),
            MiddleColor1 = Color3.fromRGB(255, 0, 255),
            MiddleColor2 = Color3.fromRGB(255, 255, 0)
        }
        
        TrailColorStartPicker:Set(Color3.fromRGB(0, 170, 255))
        TrailColorMiddle1Picker:Set(Color3.fromRGB(255, 0, 255))
        TrailColorMiddle2Picker:Set(Color3.fromRGB(255, 255, 0))
        TrailColorEndPicker:Set(Color3.fromRGB(255, 0, 0))
        
        WindUI:Notify({ 
            Title = "重置完成", 
            Content = "所有颜色已恢复为默认值",
            Duration = 3 
        })
    end
})

MainTab:Space()

MainTab:Section({
    Title = "其他设置",
    TextSize = 16,
    FontWeight = Enum.FontWeight.SemiBold,
})

MainTab:Slider({
    Flag = "TrailTransparency",
    Title = "弹道透明度",
    Desc = "调整弹道的透明度",
    Icons = {
        From = "eye",
        To = "eye-off",
    },
    Step = 0.1,
    IsTooltip = true,
    Value = {
        Min = 0,
        Max = 1,
        Default = 0.3,
    },
    Callback = function(value)
        getgenv().TrailTransparency = value
        WindUI:Notify({ 
            Title = "透明度已调整", 
            Content = "弹道透明度设置为: " .. value,
            Duration = 2 
        })
    end
})

MainTab:Space({ Columns = 1 })

MainTab:Slider({
    Flag = "ShootInterval",
    Title = "射击间隔",
    Desc = "调整自动射击的时间间隔（秒）",
    Icons = {
        From = "clock",
        To = "zap",
    },
    Step = 0.1,
    IsTooltip = true,
    Value = {
        Min = 0.1,
        Max = 1.0,
        Default = 0.2,
    },
    Callback = function(value)
        getgenv().ShootInterval = value
        WindUI:Notify({ 
            Title = "间隔已调整", 
            Content = "射击间隔设置为: " .. value .. "秒",
            Duration = 2 
        })
    end
})

MainTab:Space()

local WeaponTab = Window:Tab({Title = "武器修改", Icon = "target"})
    
WeaponTab:Button({
    Title = "无限子弹",
    Callback = function()
        local Shooter = require(game:GetService("ReplicatedStorage").Client.Wanted.Objects.ClientTool.Components.Guns.Shooter)
        local originalShoot = Shooter._shoot
        Shooter._shoot = function(self)
            self.ammo = 9999
            self.totalAmmo = 9999
            return originalShoot(self)
        end
    end
})

WeaponTab:Button({
    Title = "无后坐力",
    Callback = function()
        local Shooter = require(game:GetService("ReplicatedStorage").Client.Wanted.Objects.ClientTool.Components.Guns.Shooter)
        local originalShoot = Shooter._shoot
        Shooter._shoot = function(self)
            self.recoil = {firstShotKick = 0, climb = 0, spread = 0}
            return originalShoot(self)
        end
    end
})

WeaponTab:Button({
    Title = "无扩散",
    Callback = function()
        local Shooter = require(game:GetService("ReplicatedStorage").Client.Wanted.Objects.ClientTool.Components.Guns.Shooter)
        local originalShoot = Shooter._shoot
        Shooter._shoot = function(self)
            self.aim = {spreadAngle = 0, zeroing = 1000}
            return originalShoot(self)
        end
    end
})

WeaponTab:Button({
    Title = "快速射击",
    Callback = function()
        local Shooter = require(game:GetService("ReplicatedStorage").Client.Wanted.Objects.ClientTool.Components.Guns.Shooter)
        local originalShoot = Shooter._shoot
        Shooter._shoot = function(self)
            self.tool.fireDebounce = 0
            self.tool.fireMode = "auto"
            return originalShoot(self)
        end
    end
})

WeaponTab:Button({
    Title = "无装弹",
    Callback = function()
        local Shooter = require(game:GetService("ReplicatedStorage").Client.Wanted.Objects.ClientTool.Components.Guns.Shooter)
        local originalShoot = Shooter._shoot
        Shooter._shoot = function(self)
            self.ammoData = {reloadTime = 0, magSize = 9999}
            return originalShoot(self)
        end
    end
})

local SoundService = game:GetService("SoundService")
local PlayStartSound = Instance.new("Sound")
PlayStartSound.SoundId = "rbxassetid://88457346646245"
PlayStartSound.Looped = false
PlayStartSound.Volume = 1
PlayStartSound.Parent = SoundService
PlayStartSound:Play()
PlayStartSound.Ended:Connect(function() PlayStartSound:Destroy() end)

local GizmoFolder = workspace:FindFirstChild("Local") and workspace.Local:FindFirstChild("Gizmos") and workspace.Local.Gizmos:FindFirstChild("White") or nil

local PatrolPoints = {
    Vector3.new(-1137, 78, -1953),
    Vector3.new(-44, 63, -2083),
    Vector3.new(194, 60, -2884),
    Vector3.new(-412, 106, -1301),
    Vector3.new(-377, 410, -741),
    Vector3.new(-985, 380, -1145),
    Vector3.new(-854, 406, -1505)
}

local IsAutoFarmRunning = false
local AutoFarmThread = nil

local function GetBasePart(instance)
    if not instance then return nil end
    if instance:IsA("BasePart") then return instance end
    for _, descendant in ipairs(instance:GetDescendants()) do
        if descendant:IsA("BasePart") then return descendant end
    end
    return nil
end

local function IsValidTarget(instance)
    local typeAttr = instance:GetAttribute("gizmoType")
    return typeAttr == "ATM" or typeAttr == "Register"
end

local function FindClosestTarget()
    if not GizmoFolder or not RootPart then return nil end
    local minDistance = math.huge
    local closestPart = nil
    for _, item in ipairs(GizmoFolder:GetChildren()) do
        if IsValidTarget(item) then
            local part = GetBasePart(item)
            if part then
                local dist = (RootPart.Position - part.Position).Magnitude
                if dist < minDistance then
                    closestPart = part
                    minDistance = dist
                end
            end
        end
    end
    return closestPart
end

local function TeleportToTarget(target)
    if not RootPart then return end
    if typeof(target) ~= "Instance" then
        if typeof(target) == "Vector3" then RootPart.CFrame = CFrame.new(target) end
    else
        RootPart.CFrame = target.CFrame * CFrame.new(0, 1, 0) 
    end
end

local function SpamInteract(duration)
    local start = tick()
    while tick() - start < duration do
        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
        task.wait(0.01)
    end
end

local function ProcessCollection(targetPart)
    SpamInteract(1.5) 
end

local function StartAutoFarm()
    if AutoFarmThread or not GizmoFolder or not RootPart then return end
    IsAutoFarmRunning = true
    AutoFarmThread = task.spawn(function()
        while IsAutoFarmRunning do
            pcall(function()
                local target = FindClosestTarget()
                if target then
                    TeleportToTarget(target)
                    ProcessCollection(target)
                else
                    TeleportToTarget(PatrolPoints[math.random(1, #PatrolPoints)])
                end
                task.wait(1.5) 
            end)
        end
    end)
end

local function StopAutoFarm()
    IsAutoFarmRunning = false
    if AutoFarmThread then task.cancel(AutoFarmThread) AutoFarmThread = nil end
end

LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    InitRootPart()
end)

local TeleportTab = Window:Tab({Locked = false,Title = "传送",Icon = "map-pin"})
local WeaponsTab = Window:Tab({Locked = false,Title = "武器",Icon = "swords"})
local MoneyTab = Window:Tab({Locked = false,Title = "金钱",Icon = "dollar-sign"})
local CombatTab = Window:Tab({Locked = false,Title = "战斗",Icon = "swords"})
local PlayerTab = Window:Tab({Locked = false,Title = "本地玩家",Icon = "user"})
local AboutTab = Window:Tab({Title = "关于", Desc = "脚本信息和帮助", Icon = "info", IconColor = Color3.fromHex("#83889E"), IconShape = "Square", Border = true})

local Section_Combat = CombatTab:Section({TextSize = 17,Title = "战斗功能",TextXAlignment = "Left"})
Section_Combat:Paragraph({
    Title = "注意",
    Desc = "范围固定 但是要记得演戏 小心被挂DC"
})

local HitboxHeadSize = 20
local HitboxDisabled = true
local HitboxTransparency = 0.7
local HitboxColor = Color3.fromRGB(255, 255, 255)
local HitboxRainbow = false
local HitboxTargetedUser = ""

local function GenerateRainbowColor()
    local HueValue = tick() % 5 / 5
    return Color3.fromHSV(HueValue, 1, 1)
end

local function IsTargetedUser(PlayerName)
    local TargetLower = HitboxTargetedUser:lower()
    return PlayerName:lower():find(TargetLower, 1, true) ~= nil
end

RunService.RenderStepped:Connect(function()
    pcall(function()
        if HitboxDisabled then
            for _, NextPlayer in pairs(Players:GetPlayers()) do
                if NextPlayer ~= LocalPlayer then
                    pcall(function()
                        local Character = NextPlayer.Character
                        local HRP = Character and Character:FindFirstChild("HumanoidRootPart")
                        if HRP then
                            HRP.Size = Vector3.new(2, 2, 1)
                            HRP.Transparency = 1
                            HRP.BrickColor = BrickColor.new("Medium stone grey")
                            HRP.Material = Enum.Material.Plastic
                            HRP.CanCollide = true
                        end
                    end)
                end
            end
        else
            for _, NextPlayer in pairs(Players:GetPlayers()) do
                if NextPlayer ~= LocalPlayer then
                    pcall(function()
                        local Character = NextPlayer.Character
                        local HRP = Character and Character:FindFirstChild("HumanoidRootPart")
                        if HRP then
                            if HitboxTargetedUser == "" or IsTargetedUser(NextPlayer.Name) then
                                HRP.Size = Vector3.new(HitboxHeadSize, HitboxHeadSize, HitboxHeadSize)
                                HRP.Transparency = HitboxTransparency
                                HRP.BrickColor = HitboxRainbow and BrickColor.new(GenerateRainbowColor()) or BrickColor.new(HitboxColor)
                                HRP.Material = Enum.Material.Neon
                                HRP.CanCollide = false
                            else
                                HRP.Size = Vector3.new(2, 2, 1)
                                HRP.Transparency = 1
                                HRP.BrickColor = BrickColor.new("Medium stone grey")
                                HRP.Material = Enum.Material.Plastic
                                HRP.CanCollide = true
                            end
                        end
                    end)
                end
            end
        end
    end)
end)

Section_Combat:Toggle({
    TextSize = 14,
    Title = "启用 Hitbox Extender",
    Callback = function(state)
        HitboxDisabled = not state
    end,
    Default = false
})

local InfiniteJumpEnabled = false
local DefaultJumpPower = 50 
local UserInputService = game:GetService("UserInputService")

local function InfiniteJumpLogic()
    UserInputService.JumpRequest:Connect(function()
        if not InfiniteJumpEnabled then return end
        pcall(function()
            local char = LocalPlayer.Character
            local humanoid = char and char:FindFirstChildOfClass("Humanoid")
            if humanoid and humanoid.Health > 0 then
                humanoid.JumpPower = DefaultJumpPower
                humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end)
    end)

    LocalPlayer.CharacterAdded:Connect(function()
        task.wait(0.5)
        local char = LocalPlayer.Character
        local humanoid = char and char:FindFirstChildOfClass("Humanoid")
        if humanoid and InfiniteJumpEnabled then
            humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping, true)
            humanoid.JumpPower = DefaultJumpPower
        end
    end)
end
task.spawn(InfiniteJumpLogic)

local speedMultiplier = 2
local isSpeedEnabled = false

local function updateSpeed()
    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if not humanoid then return end
    if isSpeedEnabled then
        humanoid.WalkSpeed = 16 * speedMultiplier 
    else
        humanoid.WalkSpeed = 16
    end
end

LocalPlayer.CharacterAdded:Connect(function(char)
    char:WaitForChildOfClass("Humanoid")
    updateSpeed()
end)

local Section_LocalPlayer = PlayerTab:Section({TextSize = 17, Title = "本地玩家", TextXAlignment = "Left"})
Section_LocalPlayer:Toggle({
    TextSize = 14,
    Title = "启用无限跳",
    Callback = function(state)
        InfiniteJumpEnabled = state
        if state then
            pcall(function()
                local char = LocalPlayer.Character
                local humanoid = char and char:FindFirstChildOfClass("Humanoid")
                if humanoid then 
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping, true)
                    humanoid.JumpPower = DefaultJumpPower
                end
            end)
        end
    end,
    Default = false
})

Section_LocalPlayer:Toggle({
    TextSize = 14,
    Title = "加速移动",
    Callback = function(state)
        isSpeedEnabled = state
        updateSpeed()
    end,
    Default = false
})

Section_LocalPlayer:Slider({
    TextSize = 14,
    Title = "速度倍数",
    Desc = "调整移动速度倍数",
    Icons = {
        From = "walk",
        To = "zap",
    },
    Step = 0.1,
    IsTooltip = true,
    Value = {
        Min = 1,
        Max = 5,
        Default = 2,
    },
    Callback = function(value)
        speedMultiplier = value
        if isSpeedEnabled then
            updateSpeed()
        end
    end
})

local Section_AutoFarm = MoneyTab:Section({TextSize = 17,Title = "金钱",TextXAlignment = "Left"})
Section_AutoFarm:Toggle({
    TextSize = 14,
    Title = "自动全图刷钱",
    Callback = function(state)
        if state then StartAutoFarm() else StopAutoFarm() end
    end,
    Default = false
})

local Section_Places = TeleportTab:Section({TextSize = 16,Title = "地点传送",TextXAlignment = "Left"})
local function TeleportTo(x, y, z)
    pcall(function()
        local player = Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait(3)
        local hrp = character:WaitForChild("HumanoidRootPart", 3)
        hrp.CFrame = CFrame.new(x, y, z)
    end)
end

Section_Places:Button({TextSize = 14,Title = "枪店",Callback = function() TeleportTo(-180.77, 43.13, -2805.05) end})
Section_Places:Button({TextSize = 14,Title = "手机店",Callback = function() TeleportTo(-905.70, 42.98, -1563.35) end})
Section_Places:Button({TextSize = 14,Title = "黑市",Callback = function() TeleportTo(-2907.39, 37.58, 1652.25) end})

local Section_Crime = TeleportTab:Section({TextSize = 16,Title = "犯罪地点",TextXAlignment = "Left"})
Section_Crime:Button({TextSize = 14,Title = "犯罪窝点",Callback = function() TeleportTo(-7939.26, 21.74, 1073.52) end})
Section_Crime:Button({TextSize = 14,Title = "银行外",Callback = function() TeleportTo(-431.54, 40.09, -1400.08) end})
Section_Crime:Button({TextSize = 14,Title = "小银行",Callback = function() TeleportTo(-6852.36, 42.61, 965.86) end})
Section_Crime:Button({TextSize = 14,Title = "银行内部",Callback = function() TeleportTo(-399.28, 617.63, -1245.29) end})

local Section_Special = TeleportTab:Section({TextSize = 16,Title = "特殊地点",TextXAlignment = "Left"})
Section_Special:Button({TextSize = 14,Title = "警察局",Callback = function() TeleportTo(1583.31, 119.86, -716.63) end})
Section_Special:Button({TextSize = 14,Title = "烈焰要塞",Callback = function() TeleportTo(-1412.96, 181.18, 3054.46) end})

local Section_Weapons = WeaponsTab:Section({TextSize = 16,Title = "武器",TextXAlignment = "Left"})
Section_Weapons:Button({TextSize = 14,Title = "AWP狙击枪",Callback = function() TeleportTo(-822.97, 326.09, -506.58) end})
Section_Weapons:Button({TextSize = 14,Title = "UMP 45",Callback = function() TeleportTo(1665.20, 143.84, -644.01) end})
Section_Weapons:Button({TextSize = 14,Title = "贝内利 M1014",Callback = function() TeleportTo(1345.20, 141.52, -4809.11) end})
Section_Weapons:Button({TextSize = 14,Title = "M4",Callback = function() TeleportTo(-6342.43, 134.86, -4326.83) end})
Section_Weapons:Button({TextSize = 14,Title = "AK47",Callback = function() TeleportTo(-7835.20, 21.84, 1192.14) end})
Section_Weapons:Button({TextSize = 14,Title = "火箭筒",Callback = function() TeleportTo(-1392.87, 209.34, 3217.20) end})
Section_Weapons:Button({TextSize = 14,Title = "UZI",Callback = function() TeleportTo(-1348.55, 40.68, 2033.74) end})

AboutTab:Section({
    Title = "脚本信息",
    TextSize = 16,
    FontWeight = Enum.FontWeight.SemiBold,
})

AboutTab:Paragraph({
    Title = "TnineHub付费版",
    Desc = "主要功能：\n• 愤怒机器人(hook)\n• 武器修改\n• 自动刷钱\n• 传送功能\n• 通用功能\n\n注意：记得演戏"
})

AboutTab:Button({
    Title = "检查更新",
    Desc = "检查脚本是否有更新版本",
    Justify = "Center",
    Icon = "refresh-cw",
    Callback = function()
        WindUI:Notify({ 
            Title = "检查更新", 
            Content = "当前已是最新版本",
            Duration = 3 
        })
    end
})

AboutTab:Space({ Columns = 1 })

AboutTab:Button({
    Title = "反馈问题",
    Desc = "报告脚本使用中的问题",
    Justify = "Center",
    Icon = "alert-circle",
    Color = Color3.fromHex("#ff4830"),
    Callback = function()
        WindUI:Notify({ 
            Title = "反馈", 
            Content = "请联系开发者反馈问题",
            Duration = 3 
        })
    end
})

InitRootPart()

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    applyBlurEffect(false)
end)

Window:OnDestroy(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    for _, animation in pairs(fontColorAnimations) do
        animation:Disconnect()
    end
    fontColorAnimations = {}
    applyBlurEffect(false)
end)

WindUI:Notify({ 
    Title = "TnineHub付费版", 
    Content = "已全部加载",
    Duration = 5,
    Icon = "check-circle"
})

end

elseif game.PlaceId == 136801880565837 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local workspace = game:GetService("Workspace")
local players = game:GetService("Players")
local runService = game:GetService("RunService")
local userInputService = game:GetService("UserInputService")
local lighting = game:GetService("Lighting")
local tweenService = game:GetService("TweenService")
local localPlayer = players.LocalPlayer

local bulletAimbotEnabled = false
local bulletAimbotRange = 999
local bulletOriginalFireFunction
local bulletHandlerHooked = false

if not getgenv().BulletTrailColors then
    getgenv().BulletTrailColors = {
        StartColor = Color3.fromRGB(0, 170, 255),
        EndColor = Color3.fromRGB(255, 0, 0),
        MiddleColor1 = Color3.fromRGB(255, 0, 255),
        MiddleColor2 = Color3.fromRGB(255, 255, 0)
    }
end

if not getgenv().HitEffectConfig then
    getgenv().HitEffectConfig = {
        Enabled = true,
        Text = "XD",
        TextColor = Color3.fromRGB(255, 0, 0),
        TextSize = 50,
        EffectColor = Color3.fromRGB(255, 0, 0),
        EffectSize = 5,
        Duration = 3,
        ShowExplosion = true,
        ExplosionColor = Color3.fromRGB(255, 100, 0),
        ShowShockwave = true,
        ShockwaveColor = Color3.fromRGB(255, 200, 0)
    }
end

local bulletTrailTransparency = 0.3
local bulletTrailSize = 0.25
local currentBulletTrail = nil
local bulletTrailOverallColor = Color3.fromRGB(255, 255, 255)

local infiniteJumpEnabled = false
local jumpConnection = nil

local originalGravity = workspace.Gravity
local gravityLoop = nil

local speedEnabled = false
local speedValue = 1
local speedConnection = nil

local espEnabled = false
local espScreenGui = nil
local espFolder = nil
local espNameColor = Color3.fromRGB(0, 255, 127)
local espBodyColor = Color3.fromRGB(0, 255, 127)
local espNameSize = 14
local espRainbowEnabled = false
local espRainbowSpeed = 5
local currentESPHue = 0

local aimbotEnabled = false
local aimbotFOV = 100
local aimbotSmoothness = 10
local aimbotCrosshairDistance = 5
local aimbotFOVColor = Color3.fromRGB(0, 255, 0)
local aimbotFriendCheck = true
local aimbotWallCheck = true
local aimbotTargetPlayer = nil
local aimbotTargetAll = true
local aimbotFOVRainbowEnabled = true
local aimbotFOVRainbowSpeed = 8
local currentFOVHue = 0

local drawingObjects = {}
local aimbotConnection = nil
local fovCircle = nil

local function getRainbowColor(hue)
    hue = hue % 1
    local r, g, b
    local i = math.floor(hue * 6)
    local f = hue * 6 - i
    local p = 1
    local q = 1 - f
    local t = f
    if i % 6 == 0 then r, g, b = 1, t, p
    elseif i % 6 == 1 then r, g, b = q, 1, p
    elseif i % 6 == 2 then r, g, b = p, 1, t
    elseif i % 6 == 3 then r, g, b = p, q, 1
    elseif i % 6 == 4 then r, g, b = t, p, 1
    else r, g, b = 1, p, q end
    return Color3.new(r, g, b)
end

local function createBezierCurve(p0, p1, p2, t)
    return (1 - t)^2 * p0 + 2 * (1 - t) * t * p1 + t^2 * p2
end

local function cleanupPreviousBulletTrail()
    if currentBulletTrail and currentBulletTrail.Parent then
        currentBulletTrail:Destroy()
        currentBulletTrail = nil
    end
end

local function createHitEffect(hitPosition, hitCharacter)
    if not getgenv().HitEffectConfig.Enabled then
        return
    end
    pcall(function()
        local effectContainer = Instance.new("Folder")
        effectContainer.Name = "HitEffect_" .. tostring(tick())
        effectContainer.Parent = workspace
        if getgenv().HitEffectConfig.Text and getgenv().HitEffectConfig.Text ~= "" then
            local billboardGui = Instance.new("BillboardGui")
            billboardGui.Name = "HitText"
            billboardGui.Size = UDim2.new(0, 200, 0, 200)
            billboardGui.StudsOffset = Vector3.new(0, 3, 0)
            billboardGui.AlwaysOnTop = true
            billboardGui.Adornee = hitCharacter and hitCharacter:FindFirstChild("HumanoidRootPart") or nil
            billboardGui.Enabled = true
            billboardGui.Parent = effectContainer
            local textLabel = Instance.new("TextLabel")
            textLabel.Size = UDim2.new(1, 0, 1, 0)
            textLabel.BackgroundTransparency = 1
            textLabel.Text = getgenv().HitEffectConfig.Text
            textLabel.TextColor3 = getgenv().HitEffectConfig.TextColor
            textLabel.TextSize = getgenv().HitEffectConfig.TextSize
            textLabel.Font = Enum.Font.GothamBold
            textLabel.TextStrokeTransparency = 0.5
            textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
            textLabel.Parent = billboardGui
            local tweenInfo = TweenInfo.new(0.5,Enum.EasingStyle.Back,Enum.EasingDirection.Out)
            local scaleTween = tweenService:Create(textLabel, tweenInfo, {TextSize = getgenv().HitEffectConfig.TextSize * 1.5})
            scaleTween:Play()
            task.delay(getgenv().HitEffectConfig.Duration * 0.7, function()
                local fadeTween = tweenService:Create(textLabel, TweenInfo.new(0.5), {TextTransparency = 1,TextStrokeTransparency = 1})
                fadeTween:Play()
            end)
        end
        if getgenv().HitEffectConfig.ShowExplosion then
            local explosion = Instance.new("Part")
            explosion.Name = "ExplosionEffect"
            explosion.Size = Vector3.new(1, 1, 1)
            explosion.Shape = Enum.PartType.Ball
            explosion.Material = Enum.Material.Neon
            explosion.Color = getgenv().HitEffectConfig.ExplosionColor
            explosion.Transparency = 0.3
            explosion.Anchored = true
            explosion.CanCollide = false
            explosion.Position = hitPosition
            explosion.Parent = effectContainer
            local explosionLight = Instance.new("PointLight")
            explosionLight.Brightness = 15
            explosionLight.Range = getgenv().HitEffectConfig.EffectSize * 3
            explosionLight.Color = getgenv().HitEffectConfig.ExplosionColor
            explosionLight.Parent = explosion
            local scaleTween = tweenService:Create(explosion, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Size = Vector3.new(getgenv().HitEffectConfig.EffectSize,getgenv().HitEffectConfig.EffectSize,getgenv().HitEffectConfig.EffectSize)})
            scaleTween:Play()
            task.delay(0.5, function()
                local fadeTween = tweenService:Create(explosion, TweenInfo.new(0.5), {Transparency = 1})
                fadeTween:Play()
                local lightTween = tweenService:Create(explosionLight, TweenInfo.new(0.5), {Brightness = 0})
                lightTween:Play()
            end)
        end
        if getgenv().HitEffectConfig.ShowShockwave then
            local shockwave = Instance.new("Part")
            shockwave.Name = "ShockwaveEffect"
            shockwave.Size = Vector3.new(1, 0.1, 1)
            shockwave.Shape = Enum.PartType.Cylinder
            shockwave.Material = Enum.Material.Neon
            shockwave.Color = getgenv().HitEffectConfig.ShockwaveColor
            shockwave.Transparency = 0.5
            shockwave.Anchored = true
            shockwave.CanCollide = false
            shockwave.CFrame = CFrame.new(hitPosition) * CFrame.Angles(math.rad(90), 0, 0)
            shockwave.Parent = effectContainer
            local scaleTween = tweenService:Create(shockwave, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Size = Vector3.new(getgenv().HitEffectConfig.EffectSize * 4,0.1,getgenv().HitEffectConfig.EffectSize * 4),Transparency = 1})
            scaleTween:Play()
        end
        local particleEmitter = Instance.new("ParticleEmitter")
        particleEmitter.Parent = effectContainer
        particleEmitter.Size = NumberSequence.new({NumberSequenceKeypoint.new(0, 0.5),NumberSequenceKeypoint.new(0.5, 1),NumberSequenceKeypoint.new(1, 0)})
        particleEmitter.Transparency = NumberSequence.new({NumberSequenceKeypoint.new(0, 0),NumberSequenceKeypoint.new(1, 1)})
        particleEmitter.Color = ColorSequence.new(getgenv().HitEffectConfig.EffectColor)
        particleEmitter.Acceleration = Vector3.new(0, -10, 0)
        particleEmitter.Lifetime = NumberRange.new(1, 2)
        particleEmitter.Rate = 100
        particleEmitter.Speed = NumberRange.new(5, 10)
        particleEmitter.VelocitySpread = 360
        task.delay(getgenv().HitEffectConfig.Duration, function()
            if effectContainer and effectContainer.Parent then
                effectContainer:Destroy()
            end
        end)
        return effectContainer
    end)
end

local function createBulletTrail(origin, targetPos, targetCharacter)
    cleanupPreviousBulletTrail()
    local trailContainer = Instance.new("Folder")
    trailContainer.Name = "BulletTrail_" .. tostring(tick())
    trailContainer.Parent = workspace
    currentBulletTrail = trailContainer
    local midPoint = (origin + targetPos) / 2
    local direction = (targetPos - origin).Unit
    local perpendicular = Vector3.new(-direction.Z, direction.Y, direction.X) * 5
    local controlPoint = midPoint + perpendicular + Vector3.new(0, math.random(-5, 5), 0)
    local curvePoints = {}
    local numSegments = 25
    for i = 0, numSegments do
        local t = i / numSegments
        local point = createBezierCurve(origin, controlPoint, targetPos, t)
        table.insert(curvePoints, point)
    end
    for i = 1, #curvePoints - 1 do
        local startPoint = curvePoints[i]
        local endPoint = curvePoints[i + 1]
        local distance = (endPoint - startPoint).Magnitude
        local beamPart = Instance.new("Part")
        beamPart.Size = Vector3.new(bulletTrailSize, bulletTrailSize, distance)
        beamPart.Anchored = true
        beamPart.CanCollide = false
        beamPart.Material = Enum.Material.Neon
        beamPart.Transparency = bulletTrailTransparency
        beamPart.CFrame = CFrame.new(startPoint, endPoint) * CFrame.new(0, 0, -distance / 2)
        beamPart.Parent = trailContainer
        local t = i / (#curvePoints - 1)
        local color
        if bulletTrailOverallColor ~= Color3.fromRGB(255, 255, 255) then
            color = bulletTrailOverallColor
        else
            if t < 0.3 then
                color = getgenv().BulletTrailColors.StartColor or Color3.fromRGB(0, 170, 255)
            elseif t < 0.6 then
                color = getgenv().BulletTrailColors.MiddleColor1 or Color3.fromRGB(255, 0, 255)
            elseif t < 0.9 then
                color = getgenv().BulletTrailColors.MiddleColor2 or Color3.fromRGB(255, 255, 0)
            else
                color = getgenv().BulletTrailColors.EndColor or Color3.fromRGB(255, 0, 0)
            end
        end
        beamPart.Color = color
        local pointLight = Instance.new("PointLight")
        pointLight.Brightness = 8
        pointLight.Range = 5
        pointLight.Color = color
        pointLight.Parent = beamPart
        local particles = Instance.new("ParticleEmitter")
        particles.Size = NumberSequence.new({NumberSequenceKeypoint.new(0, 0.2),NumberSequenceKeypoint.new(0.5, 0.4),NumberSequenceKeypoint.new(1, 0.1)})
        particles.Transparency = NumberSequence.new({NumberSequenceKeypoint.new(0, 0.2),NumberSequenceKeypoint.new(1, 0.8)})
        particles.Lifetime = NumberRange.new(0.8, 1.5)
        particles.Rate = 80
        particles.Speed = NumberRange.new(2, 4)
        particles.VelocitySpread = 180
        particles.Color = ColorSequence.new(color)
        particles.Parent = beamPart
        local glow = Instance.new("SurfaceLight")
        glow.Brightness = 2
        glow.Range = 8
        glow.Color = color
        glow.Parent = beamPart
    end
    local startExplosion = Instance.new("Part")
    startExplosion.Size = Vector3.new(1, 1, 1)
    startExplosion.Anchored = true
    startExplosion.CanCollide = false
    startExplosion.Material = Enum.Material.Neon
    startExplosion.Transparency = 0.5
    startExplosion.Shape = Enum.PartType.Ball
    startExplosion.CFrame = CFrame.new(origin)
    startExplosion.Color = bulletTrailOverallColor ~= Color3.fromRGB(255, 255, 255) and bulletTrailOverallColor or getgenv().BulletTrailColors.StartColor
    startExplosion.Parent = trailContainer
    local startLight = Instance.new("PointLight")
    startLight.Brightness = 10
    startLight.Range = 10
    startLight.Color = startExplosion.Color
    startLight.Parent = startExplosion
    spawn(function()
        task.wait(0.1)
        if targetCharacter and getgenv().HitEffectConfig.Enabled then
            createHitEffect(targetPos, targetCharacter)
        end
        local endExplosion = Instance.new("Part")
        endExplosion.Size = Vector3.new(1.5, 1.5, 1.5)
        endExplosion.Anchored = true
        endExplosion.CanCollide = false
        endExplosion.Material = Enum.Material.Neon
        endExplosion.Transparency = 0.3
        endExplosion.Shape = Enum.PartType.Ball
        endExplosion.CFrame = CFrame.new(targetPos)
        endExplosion.Color = bulletTrailOverallColor ~= Color3.fromRGB(255, 255, 255) and bulletTrailOverallColor or getgenv().BulletTrailColors.EndColor
        endExplosion.Parent = trailContainer
        local endLight = Instance.new("PointLight")
        endLight.Brightness = 15
        endLight.Range = 12
        endLight.Color = endExplosion.Color
        endLight.Parent = endExplosion
    end)
    task.delay(1.5, function()
        if trailContainer and trailContainer.Parent then
            for _, child in ipairs(trailContainer:GetChildren()) do
                if child:IsA("Part") then
                    local tween = tweenService:Create(child, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Transparency = 1})
                    tween:Play()
                end
            end
            task.delay(0.5, function()
                if trailContainer and trailContainer.Parent then
                    trailContainer:Destroy()
                end
            end)
        end
    end)
    return trailContainer
end

local function get_closest_target(range)
    local closest_part, closest_distance, closest_character = nil, range, nil
    local camera = workspace.CurrentCamera
    for _, player in players:GetPlayers() do
        if player == localPlayer then
            continue
        end
        local character = player.Character
        if not character then
            continue
        end
        local humanoid = character:FindFirstChild("Humanoid")
        local head = character:FindFirstChild("Head")
        if not head or not humanoid or humanoid.Health == 0 then
            continue
        end
        local screen_position, on_screen = camera:WorldToViewportPoint(head.Position)
        if not on_screen then
            continue
        end
        local distance = (Vector2.new(screen_position.X, screen_position.Y) - camera.ViewportSize / 2).Magnitude
        if distance < closest_distance then
            closest_part = head
            closest_distance = distance
            closest_character = character
        end
    end
    return closest_part, closest_character
end

local function setupBulletAimbot()
    if bulletHandlerHooked then
        return true
    end
    local success, bullet_handler = pcall(function()
        return require(game:GetService("ReplicatedStorage").ModuleScripts.GunModules.BulletHandler)
    end)
    if not success or not bullet_handler then
        WindUI:Notify({Title = "错误",Content = "无法找到BulletHandler模块",Duration = 3,Icon = "x"})
        return false
    end
    bulletOriginalFireFunction = bullet_handler.Fire
    bullet_handler.Fire = function(data)
        if bulletAimbotEnabled then
            local closest, character = get_closest_target(bulletAimbotRange)
            if closest then
                data.Force = data.Force * 1000
                data.Direction = (closest.Position - data.Origin).Unit
                spawn(function()
                    createBulletTrail(data.Origin, closest.Position, character)
                end)
            end
        end
        return bulletOriginalFireFunction(data)
    end
    bulletHandlerHooked = true
    return true
end

local function toggleBulletAimbot(state)
    bulletAimbotEnabled = state
    if state then
        local success = setupBulletAimbot()
        if success then
            WindUI:Notify({Title = "美国子弹",Content = "功能已启用 (距离: " .. bulletAimbotRange .. ")",Duration = 2,Icon = "crosshair"})
        else
            bulletAimbotEnabled = false
            WindUI:Notify({Title = "美国子弹",Content = "启用失败",Duration = 2,Icon = "x"})
        end
    else
        cleanupPreviousBulletTrail()
        WindUI:Notify({Title = "美国子弹",Content = "功能已关闭",Duration = 2,Icon = "circle"})
    end
end

local function toggleInfiniteJump(state)
    infiniteJumpEnabled = state
    if state then
        if jumpConnection then
            jumpConnection:Disconnect()
        end
        jumpConnection = userInputService.JumpRequest:Connect(function()
            local char = localPlayer.Character
            if char and char:FindFirstChild("Humanoid") then
                char.Humanoid:ChangeState("Jumping")
            end
        end)
        WindUI:Notify({Title = "无限跳跃",Content = "已开启无限跳跃",Icon = "jump-rope"})
    else
        if jumpConnection then
            jumpConnection:Disconnect()
            jumpConnection = nil
        end
        WindUI:Notify({Title = "无限跳跃",Content = "已关闭无限跳跃",Icon = "jump-rope"})
    end
end

local function setGravity(value)
    local numValue = tonumber(value)
    if numValue then
        if gravityLoop then
            gravityLoop:Disconnect()
            gravityLoop = nil
        end
        workspace.Gravity = numValue
        WindUI:Notify({Title = "重力设置",Content = "重力已设置为: " .. tostring(numValue),Icon = "weight"})
    else
        WindUI:Notify({Title = "错误",Content = "请输入数字",Icon = "alert-circle"})
    end
end

local function setSpeed(value)
    local numValue = tonumber(value)
    if numValue then
        speedValue = numValue
        WindUI:Notify({Title = "速度设置",Content = "速度已设置为: " .. tostring(numValue),Icon = "zap"})
    else
        WindUI:Notify({Title = "错误",Content = "请输入有效数字",Icon = "alert-circle"})
    end
end

local function toggleSpeed(state)
    speedEnabled = state
    if state then
        if speedConnection then
            speedConnection:Disconnect()
        end
        speedConnection = runService.Heartbeat:Connect(function()
            local char = localPlayer.Character
            if char and char:FindFirstChild("Humanoid") then
                local humanoid = char.Humanoid
                if humanoid.MoveDirection.Magnitude > 0 then
                    char:TranslateBy(humanoid.MoveDirection * speedValue / 2)
                end
            end
        end)
    else
        if speedConnection then
            speedConnection:Disconnect()
            speedConnection = nil
        end
    end
end

local function initESP()
    espScreenGui = Instance.new("ScreenGui")
    espScreenGui.Name = "PlayerESP_System"
    espScreenGui.ResetOnSpawn = false
    espScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    espScreenGui.Parent = localPlayer:WaitForChild("PlayerGui")
    espFolder = Instance.new("Folder")
    espFolder.Name = "PlayerESPFolder"
    espFolder.Parent = espScreenGui
end

local function updateESPColors()
    if not espEnabled or not espFolder then return end
    for _, child in ipairs(espFolder:GetChildren()) do
        if child:IsA("BillboardGui") then
            local nameLabel = child:FindFirstChild("NameLabel")
            if nameLabel then
                nameLabel.TextColor3 = espRainbowEnabled and getRainbowColor(currentESPHue) or espNameColor
                nameLabel.TextSize = espNameSize
            end
        elseif child:IsA("Highlight") then
            child.FillColor = espRainbowEnabled and getRainbowColor(currentESPHue) or espBodyColor
            child.OutlineColor = espRainbowEnabled and getRainbowColor(currentESPHue) or espBodyColor
        end
    end
end

local function updateESPNameSize()
    if not espEnabled or not espFolder then return end
    for _, child in ipairs(espFolder:GetChildren()) do
        if child:IsA("BillboardGui") then
            local nameLabel = child:FindFirstChild("NameLabel")
            if nameLabel then
                nameLabel.TextSize = espNameSize
            end
        end
    end
end

local function createPlayerESP(player)
    if player == localPlayer or not espEnabled then return end
    local character = player.Character
    if not character then return end
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    local existingESP = espFolder:FindFirstChild(player.Name)
    if existingESP then existingESP:Destroy() end
    local ESPGui = Instance.new("BillboardGui")
    ESPGui.Name = player.Name
    ESPGui.Adornee = humanoidRootPart
    ESPGui.Size = UDim2.new(0, 100, 0, 40)
    ESPGui.StudsOffset = Vector3.new(0, 3, 0)
    ESPGui.AlwaysOnTop = true
    ESPGui.MaxDistance = 500
    ESPGui.Enabled = true
    ESPGui.Parent = espFolder
    local NameLabel = Instance.new("TextLabel")
    NameLabel.Size = UDim2.new(1, 0, 0.5, 0)
    NameLabel.BackgroundTransparency = 1
    NameLabel.Font = Enum.Font.GothamBold
    NameLabel.TextSize = espNameSize
    NameLabel.TextColor3 = espRainbowEnabled and getRainbowColor(currentESPHue) or espNameColor
    NameLabel.TextStrokeTransparency = 0.5
    NameLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
    NameLabel.Text = player.Name
    NameLabel.Parent = ESPGui
    local DistanceLabel = Instance.new("TextLabel")
    DistanceLabel.Size = UDim2.new(1, 0, 0.5, 0)
    DistanceLabel.Position = UDim2.new(0, 0, 0.5, 0)
    DistanceLabel.BackgroundTransparency = 1
    DistanceLabel.Font = Enum.Font.Gotham
    DistanceLabel.TextSize = 12
    DistanceLabel.TextColor3 = Color3.fromRGB(240, 255, 245)
    DistanceLabel.TextStrokeTransparency = 0.5
    DistanceLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
    DistanceLabel.Name = "DistanceLabel"
    DistanceLabel.Parent = ESPGui
    local Highlight = Instance.new("Highlight")
    Highlight.Name = player.Name .. "_Highlight"
    Highlight.Adornee = character
    Highlight.FillColor = espRainbowEnabled and getRainbowColor(currentESPHue) or espBodyColor
    Highlight.FillTransparency = 0.7
    Highlight.OutlineColor = espRainbowEnabled and getRainbowColor(currentESPHue) or espBodyColor
    Highlight.OutlineTransparency = 0
    Highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    Highlight.Enabled = true
    Highlight.Parent = espFolder
end

local function updateESP()
    if not espEnabled then return end
    pcall(function()
        local myCharacter = localPlayer.Character
        local myHRP = myCharacter and myCharacter:FindFirstChild("HumanoidRootPart")
        if not myHRP then return end
        for _, player in ipairs(players:GetPlayers()) do
            if player ~= localPlayer then
                local character = player.Character
                if character then
                    local hrp = character:FindFirstChild("HumanoidRootPart")
                    if hrp then
                        local espGui = espFolder:FindFirstChild(player.Name)
                        if not espGui then
                            createPlayerESP(player)
                            espGui = espFolder:FindFirstChild(player.Name)
                        end
                        local distance = (myHRP.Position - hrp.Position).Magnitude
                        local distanceLabel = espGui:FindFirstChild("DistanceLabel")
                        if distanceLabel then
                            distanceLabel.Text = string.format("%.0f studs", distance)
                        end
                        if distance > 500 then
                            espGui.Enabled = false
                            local highlight = espFolder:FindFirstChild(player.Name .. "_Highlight")
                            if highlight then highlight.Enabled = false end
                        else
                            espGui.Enabled = true
                            local highlight = espFolder:FindFirstChild(player.Name .. "_Highlight")
                            if highlight then highlight.Enabled = true end
                        end
                    else
                        local espGui = espFolder:FindFirstChild(player.Name)
                        if espGui then espGui:Destroy() end
                        local highlight = espFolder:FindFirstChild(player.Name .. "_Highlight")
                        if highlight then highlight:Destroy() end
                    end
                else
                    local esp = espFolder:FindFirstChild(player.Name)
                    if esp then esp:Destroy() end
                    local highlight = espFolder:FindFirstChild(player.Name .. "_Highlight")
                    if highlight then highlight:Destroy() end
                end
            end
        end
    end)
end

local function toggleESP(state)
    espEnabled = state
    if state then
        if not espScreenGui then initESP() end
        for _, player in ipairs(players:GetPlayers()) do
            if player ~= localPlayer and player.Character then
                createPlayerESP(player)
            end
        end
        WindUI:Notify({Title = "透视",Content = "玩家透视已开启",Icon = "eye"})
    else
        if espFolder then
            for _, esp in ipairs(espFolder:GetChildren()) do
                esp:Destroy()
            end
        end
        WindUI:Notify({Title = "透视",Content = "玩家透视已关闭",Icon = "eye"})
    end
end

local function initializeAimDrawings()
    if not fovCircle then
        fovCircle = Drawing.new("Circle")
        fovCircle.Visible = aimbotEnabled
        fovCircle.Thickness = 2
        fovCircle.Filled = false
        fovCircle.Radius = aimbotFOV
        fovCircle.Position = workspace.CurrentCamera.ViewportSize / 2
        table.insert(drawingObjects, fovCircle)
    end
end

local function updateFOVCircle()
    if fovCircle then
        fovCircle.Visible = aimbotEnabled
        fovCircle.Radius = aimbotFOV
        fovCircle.Color = aimbotFOVRainbowEnabled and getRainbowColor(currentFOVHue) or aimbotFOVColor
        fovCircle.Position = workspace.CurrentCamera.ViewportSize / 2
    end
end

local function cleanupDrawings()
    for _, drawing in ipairs(drawingObjects) do
        if drawing then
            drawing:Remove()
        end
    end
    drawingObjects = {}
    fovCircle = nil
end

local function isFriend(player)
    if not aimbotFriendCheck then
        return false
    end
    local success, result = pcall(function()
        if localPlayer:IsFriendsWith(player.UserId) then
            return true
        end
        return false
    end)
    return success and result
end

local function wallCheck(targetPosition, targetCharacter)
    if not aimbotWallCheck then
        return true
    end
    local camera = workspace.CurrentCamera
    local origin = camera.CFrame.Position
    local direction = (targetPosition - origin).Unit
    local distance = (targetPosition - origin).Magnitude
    local raycastParams = RaycastParams.new()
    raycastParams.FilterDescendantsInstances = {localPlayer.Character, targetCharacter}
    raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
    raycastParams.IgnoreWater = true
    raycastParams.CollisionGroup = "Default"
    local raycastResult = workspace:Raycast(origin, direction * distance, raycastParams)
    if raycastResult then
        local hitPart = raycastResult.Instance
        if hitPart then
            local size = hitPart.Size
            local isLargeWall = size.X > 10 or size.Y > 10 or size.Z > 10
            local nameLower = string.lower(hitPart.Name)
            local isWallName = string.find(nameLower, "wall") or string.find(nameLower, "floor") or string.find(nameLower, "ceiling") or string.find(nameLower, "base")
            if isLargeWall or isWallName then
                return false
            end
        end
    end
    return true
end

local function getClosestPlayer()
    local camera = workspace.CurrentCamera
    local mousePos = camera.ViewportSize / 2
    local nearestPlayer = nil
    local shortestDistance = aimbotFOV
    if aimbotTargetPlayer and not aimbotTargetAll then
        local target = players:FindFirstChild(aimbotTargetPlayer)
        if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local targetPos = target.Character.HumanoidRootPart.Position
            local screenPos, onScreen = camera:WorldToViewportPoint(targetPos)
            if onScreen then
                local distance = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
                if distance <= aimbotFOV then
                    return target
                end
            end
        end
        return nil
    end
    for _, player in ipairs(players:GetPlayers()) do
        if player ~= localPlayer and player.Character then
            if isFriend(player) then
                continue
            end
            local humanoidRootPart = player.Character:FindFirstChild("HumanoidRootPart")
            local humanoid = player.Character:FindFirstChild("Humanoid")
            if humanoidRootPart and humanoid and humanoid.Health > 0 then
                if not wallCheck(humanoidRootPart.Position, player.Character) then
                    continue
                end
                local screenPos, onScreen = camera:WorldToViewportPoint(humanoidRootPart.Position)
                if onScreen then
                    local distance = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
                    if distance < shortestDistance then
                        shortestDistance = distance
                        nearestPlayer = player
                    end
                end
            end
        end
    end
    return nearestPlayer
end

local function aimBot()
    if not aimbotEnabled then
        return
    end
    local camera = workspace.CurrentCamera
    local target = getClosestPlayer()
    if target and target.Character then
        local humanoidRootPart = target.Character:FindFirstChild("HumanoidRootPart")
        local head = target.Character:FindFirstChild("Head")
        if humanoidRootPart and head then
            local targetVelocity = humanoidRootPart.Velocity
            local targetPosition = head.Position
            if aimbotCrosshairDistance > 0 then
                local distance = (targetPosition - camera.CFrame.Position).Magnitude
                local timeToTarget = distance / 1000
                targetPosition = targetPosition + (targetVelocity * timeToTarget * aimbotCrosshairDistance)
            end
            local currentCFrame = camera.CFrame
            local targetCFrame = CFrame.new(currentCFrame.Position, targetPosition)
            local smoothedCFrame = currentCFrame:Lerp(targetCFrame, 1 / aimbotSmoothness)
            camera.CFrame = smoothedCFrame
        end
    end
end

local function toggleAimbot(state)
    aimbotEnabled = state
    if state then
        initializeAimDrawings()
        updateFOVCircle()
        if aimbotConnection then
            aimbotConnection:Disconnect()
        end
        aimbotConnection = runService.RenderStepped:Connect(function(deltaTime)
            if aimbotFOVRainbowEnabled then
                currentFOVHue = currentFOVHue + deltaTime * aimbotFOVRainbowSpeed / 10
            end
            updateFOVCircle()
            aimBot()
        end)
        WindUI:Notify({Title = "自瞄",Content = "自瞄功能已开启",Icon = "crosshair"})
    else
        if aimbotConnection then
            aimbotConnection:Disconnect()
            aimbotConnection = nil
        end
        cleanupDrawings()
        WindUI:Notify({Title = "自瞄",Content = "自瞄功能已关闭",Icon = "crosshair"})
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})
function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

Window:EditOpenButton({
    Title = "Paid user",
    Icon = "crown",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 4,
    Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
    Draggable = true,
})
Window:Tag({
    Title = "YG(怀)/messy(凌乱)",
    Color = Color3.fromHex("#FFA500") 
})
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do  
            local color = Color3.fromHSV(hue, 0.8, 1)  
            Window:EditOpenButton({
                Color = ColorSequence.new(color)
            })
            wait(0.04)  
        end
    end
end)
if not borderInitialized then
    spawn(function()
        wait(0.5)
        initializeRainbowBorder("糖果颜色", animationSpeed)
        wait(1)
        applyFontStyleToWindow(currentFontStyle)
    end)
end

local windowOpen = true

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
end)

local originalOpenFunction = Window.Open
Window.Open = function(...)
    windowOpen = true
    local result = originalOpenFunction(...)
    
    if borderInitialized and borderEnabled and not rainbowBorderAnimation then
        wait(0.1)
        startBorderAnimation(Window, animationSpeed)
    end
    
    return result
end

local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

infoSection:Divider()

infoSection:Paragraph({
    Title = "您当前的服务器为",
    Desc = "服务器名\n欢迎使用YG/TNINE",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "持续更新 有bug请提出来",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "作者:怀 凌乱",
    ThumbnailSize = 190,
})

local LockSection = Window:Section({
    Title = "功能以及UI设置",
    Icon = "crown",
    Opened = true,
})

local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
Settings:Paragraph({
    Title = "UI设置",
    Desc = "绝妙二改WindUI",
    Image = "settings",
    ImageSize = 20,
    Color = "White"
})

Settings:Toggle({
    Title = "启用边框",
    Value = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and windowOpen and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                
                WindUI:Notify({
                    Title = "边框",
                    Content = value and "已启用" or "已禁用",
                    Duration = 2,
                    Icon = value and "eye" or "eye-off"
                })
            end
        end
    end
})

Settings:Toggle({
    Title = "启用字体颜色",
    Value = fontColorEnabled,
    Callback = function(value)
        fontColorEnabled = value
        applyFontColorsToWindow(currentFontColorScheme)
        
        WindUI:Notify({
            Title = "字体颜色",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "type" or "type"
        })
    end
})

Settings:Toggle({
    Title = "启用音效",
    Value = soundEnabled,
    Callback = function(value)
        soundEnabled = value
        WindUI:Notify({
            Title = "音效",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "volume-2" or "volume-x"
        })
    end
})

Settings:Toggle({
    Title = "启用背景模糊",
    Value = blurEnabled,
    Callback = function(value)
        blurEnabled = value
        applyBlurEffect(value)
        WindUI:Notify({
            Title = "背景模糊",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "cloud-rain" or "cloud"
        })
    end
})

local colorSchemeNames = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames, name)
end
table.sort(colorSchemeNames)

Settings:Dropdown({
    Title = "边框颜色方案",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames,
    Value = "糖果颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})

Settings:Dropdown({
    Title = "字体颜色方案",
    Desc = "选择文字颜色组合",
    Values = colorSchemeNames,
    Value = "彩虹颜色",
    Callback = function(value)
        currentFontColorScheme = value
        applyFontColorsToWindow(value)
        playSound()
    end
})

local fontOptions = {}
for _, fontName in ipairs(FONT_STYLES) do
    local description = FONT_DESCRIPTIONS[fontName] or fontName
    table.insert(fontOptions, {text = description, value = fontName})
end

table.sort(fontOptions, function(a, b)
    return a.text < b.text
end)

local fontValues = {}
local fontValueToName = {}
for _, option in ipairs(fontOptions) do
    table.insert(fontValues, option.text)
    fontValueToName[option.text] = option.value
end

Settings:Dropdown({
    Title = "字体样式",
    Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
    Values = fontValues,
    Value = "标准粗体",
    Callback = function(value)
        local fontName = fontValueToName[value]
        if fontName then
            currentFontStyle = fontName
            local successCount, totalCount = applyFontStyleToWindow(fontName)
            playSound()
        end
    end
})

Settings:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = { 
        Min = 1,
        Max = 10,
        Default = 5,
    },
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Slider({
    Title = "UI整体缩放",
    Desc = "调整UI大小比例",
    Value = { 
        Min = 0.5,
        Max = 1.5,
        Default = 1,
    },
    Step = 0.1,
    Callback = function(value)
        uiScale = value
        applyUIScale(value)
        playSound()
    end
})

Settings:Divider()

Settings:Slider({
    Title = "UI透明度",
    Desc = "调整整个UI的透明度",
    Value = { 
        Min = 0,
        Max = 1,
        Default = 0.2,
    },
    Step = 0.1,
    Callback = function(value)
        Window:ToggleTransparency(tonumber(value) > 0)
        WindUI.TransparencyValue = tonumber(value)
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI宽度",
    Desc = "调整窗口的宽度",
    Value = { 
        Min = 500,
        Max = 800,
        Default = 600,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI高度",
    Desc = "调整窗口的高度",
    Value = { 
        Min = 300,
        Max = 600,
        Default = 400,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            local currentWidth = Window.UIElements.Main.Size.X.Offset
            Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = { 
        Min = 1,
        Max = 5,
        Default = 1.5,
    },
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})

Settings:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = { 
        Min = 0,
        Max = 20,
        Default = 16,
    },
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})

Settings:Button({
    Title = "恢复UI到原位",
    Icon = "rotate-ccw",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
            playSound()
        end
    end
})

Settings:Button({
    Title = "重置UI大小",
    Icon = "maximize-2",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
            playSound()
        end
    end
})

Settings:Button({
    Title = "随机字体",
    Icon = "shuffle",
    Callback = function()
        local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
        currentFontStyle = randomFont
        applyFontStyleToWindow(randomFont)
        playSound()
    end
})

Settings:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

Settings:Divider()

Settings:Button({
    Title = "刷新字体颜色",
    Icon = "refresh-cw",
    Callback = function()
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Button({
    Title = "刷新字体样式",
    Icon = "refresh-cw",
    Callback = function()
        local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
        playSound()
    end
})

Settings:Button({
    Title = "测试所有字体",
    Icon = "check-circle",
    Callback = function()
        local workingFonts = {}
        local totalFonts = #FONT_STYLES
        for i, fontName in ipairs(FONT_STYLES) do
            local success = pcall(function()
                local test = Enum.Font[fontName]
            end)
            if success then
                table.insert(workingFonts, fontName)
            end
        end
        playSound()
    end
})

Settings:Button({
    Title = "导出设置",
    Icon = "download",
    Callback = function()
        local settings = {
            font = currentFontStyle,
            borderColor = currentBorderColorScheme,
            fontSize = currentFontColorScheme,
            speed = animationSpeed,
            scale = uiScale
        }
        setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
        playSound()
    end
})

local FlashMainTab = Window:Tab({Title = "主功能", Icon = "settings", Locked = false})
FlashMainTab:Toggle({
    Title = "美国子弹",
    Desc = "开启/关闭美国子弹功能",
    Default = bulletAimbotEnabled,
    Callback = function(value)
        toggleBulletAimbot(value)
        playSound()
    end
})
FlashMainTab:Slider({
    Title = "子弹范围",
    Desc = "设置美国子弹的瞄准范围",
    Value = {Min = 50,Max = 2000,Default = bulletAimbotRange},
    Callback = function(value)
        bulletAimbotRange = value
        if bulletAimbotEnabled then
            WindUI:Notify({Title = "美国子弹",Content = "范围已更新: " .. value,Duration = 2,Icon = "maximize-2"})
        end
        playSound()
    end
})
FlashMainTab:Button({
    Title = "测试子弹",
    Desc = "测试美国子弹功能",
    Callback = function()
        if bulletAimbotEnabled then
            WindUI:Notify({Title = "美国子弹",Content = "功能已启用，范围: " .. bulletAimbotRange,Duration = 3,Icon = "check"})
        else
            WindUI:Notify({Title = "美国子弹",Content = "请先开启美国子弹功能",Duration = 3,Icon = "x"})
        end
        playSound()
    end
})
FlashMainTab:Toggle({
    Title = "无限跳跃",
    Desc = "启用后可以无限跳跃",
    Default = infiniteJumpEnabled,
    Callback = function(value)
        toggleInfiniteJump(value)
        playSound()
    end
})
FlashMainTab:Input({
    Title = "设置重力",
    Desc = "输入重力值 (默认: " .. tostring(originalGravity) .. ")",
    Placeholder = "输入重力值",
    Callback = function(value)
        setGravity(value)
        playSound()
    end
})
FlashMainTab:Input({
    Title = "设置快速跑步速度",
    Desc = "输入速度 (默认: 1)",
    Placeholder = "输入速度",
    Callback = function(value)
        setSpeed(value)
        playSound()
    end
})
FlashMainTab:Toggle({
    Title = "开启快速跑步",
    Desc = "启用快速跑步功能",
    Default = speedEnabled,
    Callback = function(value)
        toggleSpeed(value)
        playSound()
    end
})

FlashMainTab:Section({Title = "美国子弹弹道设置",TextSize = 16,FontWeight = Enum.FontWeight.SemiBold})
local BulletTrailOverallColorPicker = FlashMainTab:Colorpicker({
    Flag = "BulletTrailOverallColor",
    Title = "整体弹道颜色",
    Desc = "设置弹道整体颜色（启用后会覆盖渐变颜色）",
    Default = bulletTrailOverallColor,
    Transparency = 0,
    Callback = function(color)
        bulletTrailOverallColor = color
        if color == Color3.fromRGB(255, 255, 255) then
            WindUI:Notify({Title = "颜色已更新",Content = "已启用渐变颜色模式",Duration = 2})
        else
            WindUI:Notify({Title = "颜色已更新",Content = "美国子弹弹道整体颜色已设置为: " .. tostring(color),Duration = 2})
        end
    end
})
FlashMainTab:Button({
    Title = "启用渐变颜色模式",
    Desc = "禁用整体颜色，使用下面的渐变颜色设置",
    Justify = "Center",
    Icon = "palette",
    Callback = function()
        bulletTrailOverallColor = Color3.fromRGB(255, 255, 255)
        BulletTrailOverallColorPicker:Set(Color3.fromRGB(255, 255, 255))
        WindUI:Notify({Title = "模式已切换",Content = "已启用渐变颜色模式",Duration = 2})
        playSound()
    end
})
FlashMainTab:Space({ Columns = 1 })
local BulletTrailColorStartPicker = FlashMainTab:Colorpicker({
    Flag = "BulletTrailColorStart",
    Title = "弹道起始颜色",
    Desc = "设置弹道开始部分的颜色（渐变模式生效）",
    Default = getgenv().BulletTrailColors.StartColor,
    Transparency = 0,
    Callback = function(color)
        getgenv().BulletTrailColors.StartColor = color
        WindUI:Notify({Title = "颜色已更新",Content = "美国子弹弹道起始颜色已设置为: " .. tostring(color),Duration = 2})
    end
})
FlashMainTab:Space({ Columns = 1 })
local BulletTrailColorMiddle1Picker = FlashMainTab:Colorpicker({
    Flag = "BulletTrailColorMiddle1",
    Title = "弹道中间颜色1",
    Desc = "设置弹道中间部分的颜色（渐变模式生效）",
    Default = getgenv().BulletTrailColors.MiddleColor1,
    Transparency = 0,
    Callback = function(color)
        getgenv().BulletTrailColors.MiddleColor1 = color
        WindUI:Notify({Title = "颜色已更新",Content = "美国子弹弹道中间颜色1已设置为: " .. tostring(color),Duration = 2})
    end
})
FlashMainTab:Space({ Columns = 1 })
local BulletTrailColorMiddle2Picker = FlashMainTab:Colorpicker({
    Flag = "BulletTrailColorMiddle2",
    Title = "弹道中间颜色2",
    Desc = "设置弹道中间部分的颜色（渐变模式生效）",
    Default = getgenv().BulletTrailColors.MiddleColor2,
    Transparency = 0,
    Callback = function(color)
        getgenv().BulletTrailColors.MiddleColor2 = color
        WindUI:Notify({Title = "颜色已更新",Content = "美国子弹弹道中间颜色2已设置为: " .. tostring(color),Duration = 2})
    end
})
FlashMainTab:Space({ Columns = 1 })
local BulletTrailColorEndPicker = FlashMainTab:Colorpicker({
    Flag = "BulletTrailColorEnd",
    Title = "弹道结束颜色",
    Desc = "设置弹道结束部分的颜色（渐变模式生效）",
    Default = getgenv().BulletTrailColors.EndColor,
    Transparency = 0,
    Callback = function(color)
        getgenv().BulletTrailColors.EndColor = color
        WindUI:Notify({Title = "颜色已更新",Content = "美国子弹弹道结束颜色已设置为: " .. tostring(color),Duration = 2})
    end
})
FlashMainTab:Space()
FlashMainTab:Section({Title = "弹道效果调整",TextSize = 16,FontWeight = Enum.FontWeight.SemiBold})
FlashMainTab:Slider({
    Flag = "BulletTrailSize",
    Title = "弹道尺寸",
    Desc = "调整美国子弹弹道的粗细",
    Icons = {From = "minimize",To = "maximize"},
    Step = 0.05,
    IsTooltip = true,
    Value = {Min = 0.1,Max = 0.5,Default = bulletTrailSize},
    Callback = function(value)
        bulletTrailSize = value
        WindUI:Notify({Title = "尺寸已调整",Content = "美国子弹弹道尺寸设置为: " .. string.format("%.2f", value),Duration = 2})
        playSound()
    end
})
FlashMainTab:Slider({
    Flag = "BulletTrailTransparency",
    Title = "弹道透明度",
    Desc = "调整美国子弹弹道的透明度",
    Icons = {From = "eye",To = "eye-off"},
    Step = 0.1,
    IsTooltip = true,
    Value = {Min = 0,Max = 1,Default = bulletTrailTransparency},
    Callback = function(value)
        bulletTrailTransparency = value
        WindUI:Notify({Title = "透明度已调整",Content = "美国子弹弹道透明度设置为: " .. value,Duration = 2})
        playSound()
    end
})

FlashMainTab:Section({Title = "美国子弹命中特效设置",TextSize = 16,FontWeight = Enum.FontWeight.SemiBold})
FlashMainTab:Toggle({
    Title = "启用命中特效",
    Desc = "开启/关闭子弹命中时的特效",
    Default = getgenv().HitEffectConfig.Enabled,
    Callback = function(value)
        getgenv().HitEffectConfig.Enabled = value
        WindUI:Notify({Title = "命中特效",Content = value and "已启用" or "已禁用",Duration = 2})
        playSound()
    end
})
FlashMainTab:Input({
    Title = "命中文字",
    Desc = "设置命中时显示的文字",
    Placeholder = "输入文字(空格没有文字特效)",
    Default = getgenv().HitEffectConfig.Text,
    Callback = function(value)
        getgenv().HitEffectConfig.Text = value
        WindUI:Notify({Title = "命中文字",Content = "已设置为: " .. value,Duration = 2})
        playSound()
    end
})
local HitEffectTextColorPicker = FlashMainTab:Colorpicker({
    Flag = "HitEffectTextColor",
    Title = "命中文字颜色",
    Desc = "设置命中文字的颜色",
    Default = getgenv().HitEffectConfig.TextColor,
    Transparency = 0,
    Callback = function(color)
        getgenv().HitEffectConfig.TextColor = color
        WindUI:Notify({Title = "颜色已更新",Content = "命中文字颜色已设置",Duration = 2})
    end
})
FlashMainTab:Slider({
    Flag = "HitEffectTextSize",
    Title = "命中文字大小",
    Desc = "调整命中文字的大小",
    Icons = {From = "minimize",To = "maximize"},
    Step = 1,
    IsTooltip = true,
    Value = {Min = 20,Max = 100,Default = getgenv().HitEffectConfig.TextSize},
    Callback = function(value)
        getgenv().HitEffectConfig.TextSize = value
        WindUI:Notify({Title = "文字大小已调整",Content = "命中文字大小设置为: " .. value,Duration = 2})
        playSound()
    end
})
local HitEffectColorPicker = FlashMainTab:Colorpicker({
    Flag = "HitEffectColor",
    Title = "命中特效颜色",
    Desc = "设置命中特效的主要颜色",
    Default = getgenv().HitEffectConfig.EffectColor,
    Transparency = 0,
    Callback = function(color)
        getgenv().HitEffectConfig.EffectColor = color
        WindUI:Notify({Title = "颜色已更新",Content = "命中特效颜色已设置",Duration = 2})
    end
})
FlashMainTab:Slider({
    Flag = "HitEffectSize",
    Title = "命中特效大小",
    Desc = "调整命中特效的整体大小",
    Icons = {From = "minimize",To = "maximize"},
    Step = 0.5,
    IsTooltip = true,
    Value = {Min = 1,Max = 10,Default = getgenv().HitEffectConfig.EffectSize},
    Callback = function(value)
        getgenv().HitEffectConfig.EffectSize = value
        WindUI:Notify({Title = "特效大小已调整",Content = "命中特效大小设置为: " .. value,Duration = 2})
        playSound()
    end
})
FlashMainTab:Slider({
    Flag = "HitEffectDuration",
    Title = "命中特效持续时间",
    Desc = "调整命中特效的显示时间",
    Icons = {From = "fast-forward",To = "clock"},
    Step = 0.5,
    IsTooltip = true,
    Value = {Min = 1,Max = 5,Default = getgenv().HitEffectConfig.Duration},
    Callback = function(value)
        getgenv().HitEffectConfig.Duration = value
        WindUI:Notify({Title = "持续时间已调整",Content = "命中特效持续时间设置为: " .. value .. "秒",Duration = 2})
        playSound()
    end
})
FlashMainTab:Toggle({
    Title = "显示爆炸效果",
    Desc = "开启/关闭命中时的爆炸效果",
    Default = getgenv().HitEffectConfig.ShowExplosion,
    Callback = function(value)
        getgenv().HitEffectConfig.ShowExplosion = value
        WindUI:Notify({Title = "爆炸效果",Content = value and "已启用" or "已禁用",Duration = 2})
        playSound()
    end
})
local ExplosionColorPicker = FlashMainTab:Colorpicker({
    Flag = "ExplosionColor",
    Title = "爆炸效果颜色",
    Desc = "设置爆炸效果的颜色",
    Default = getgenv().HitEffectConfig.ExplosionColor,
    Transparency = 0,
    Callback = function(color)
        getgenv().HitEffectConfig.ExplosionColor = color
        WindUI:Notify({Title = "颜色已更新",Content = "爆炸效果颜色已设置",Duration = 2})
    end
})
FlashMainTab:Toggle({
    Title = "显示冲击波",
    Desc = "开启/关闭命中时的冲击波效果",
    Default = getgenv().HitEffectConfig.ShowShockwave,
    Callback = function(value)
        getgenv().HitEffectConfig.ShowShockwave = value
        WindUI:Notify({Title = "冲击波效果",Content = value and "已启用" or "已禁用",Duration = 2})
        playSound()
    end
})
local ShockwaveColorPicker = FlashMainTab:Colorpicker({
    Flag = "ShockwaveColor",
    Title = "冲击波颜色",
    Desc = "设置冲击波效果的颜色",
    Default = getgenv().HitEffectConfig.ShockwaveColor,
    Transparency = 0,
    Callback = function(color)
        getgenv().HitEffectConfig.ShockwaveColor = color
        WindUI:Notify({Title = "颜色已更新",Content = "冲击波颜色已设置",Duration = 2})
    end
})
FlashMainTab:Space()
FlashMainTab:Section({Title = "命中特效预览",TextSize = 16,FontWeight = Enum.FontWeight.SemiBold})
FlashMainTab:Button({
    Title = "测试命中特效",
    Desc = "在当前位置生成测试命中特效",
    Justify = "Center",
    Icon = "zap",
    Callback = function()
        if localPlayer.Character and localPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local hitPosition = localPlayer.Character.HumanoidRootPart.Position
            local oldEffect = workspace:FindFirstChild("HitEffect_Test")
            if oldEffect then
                oldEffect:Destroy()
            end
            spawn(function()
                createHitEffect(hitPosition, localPlayer.Character)
            end)
            WindUI:Notify({Title = "测试成功",Content = "命中特效预览已生成",Duration = 3})
        else
            WindUI:Notify({Title = "错误",Content = "无法找到角色位置",Duration = 3,Color = "Red"})
        end
        playSound()
    end
})
FlashMainTab:Space({ Columns = 1 })
FlashMainTab:Button({
    Title = "清理所有特效",
    Desc = "清理屏幕上所有弹道和特效",
    Justify = "Center",
    Icon = "trash-2",
    Color = Color3.fromHex("#ff4830"),
    Callback = function()
        cleanupPreviousBulletTrail()
        local testTrail = workspace:FindFirstChild("BulletTestTrail")
        if testTrail then
            testTrail:Destroy()
        end
        local testEffect = workspace:FindFirstChild("HitEffect_Test")
        if testEffect then
            testEffect:Destroy()
        end
        for _, obj in ipairs(workspace:GetChildren()) do
            if obj.Name:find("BulletTrail") or obj.Name:find("HitEffect") then
                obj:Destroy()
            end
        end
        WindUI:Notify({Title = "清理完成",Content = "所有弹道和特效已清理",Duration = 3})
        playSound()
    end
})
FlashMainTab:Space({ Columns = 1 })
FlashMainTab:Button({
    Title = "重置所有设置",
    Desc = "恢复所有颜色和效果为默认值",
    Justify = "Center",
    Icon = "rotate-ccw",
    Color = Color3.fromHex("#ff4830"),
    Callback = function()
        getgenv().BulletTrailColors = {
            StartColor = Color3.fromRGB(0, 170, 255),
            EndColor = Color3.fromRGB(255, 0, 0),
            MiddleColor1 = Color3.fromRGB(255, 0, 255),
            MiddleColor2 = Color3.fromRGB(255, 255, 0)
        }
        getgenv().HitEffectConfig = {
            Enabled = true,
            Text = "XD",
            TextColor = Color3.fromRGB(255, 0, 0),
            TextSize = 50,
            EffectColor = Color3.fromRGB(255, 0, 0),
            EffectSize = 5,
            Duration = 3,
            ShowExplosion = true,
            ExplosionColor = Color3.fromRGB(255, 100, 0),
            ShowShockwave = true,
            ShockwaveColor = Color3.fromRGB(255, 200, 0)
        }
        bulletTrailOverallColor = Color3.fromRGB(255, 255, 255)
        bulletTrailSize = 0.25
        bulletTrailTransparency = 0.3
        BulletTrailOverallColorPicker:Set(Color3.fromRGB(255, 255, 255))
        BulletTrailColorStartPicker:Set(Color3.fromRGB(0, 170, 255))
        BulletTrailColorMiddle1Picker:Set(Color3.fromRGB(255, 0, 255))
        BulletTrailColorMiddle2Picker:Set(Color3.fromRGB(255, 255, 0))
        BulletTrailColorEndPicker:Set(Color3.fromRGB(255, 0, 0))
        HitEffectTextColorPicker:Set(Color3.fromRGB(255, 0, 0))
        HitEffectColorPicker:Set(Color3.fromRGB(255, 0, 0))
        ExplosionColorPicker:Set(Color3.fromRGB(255, 100, 0))
        ShockwaveColorPicker:Set(Color3.fromRGB(255, 200, 0))
        WindUI:Notify({Title = "重置完成",Content = "所有颜色和效果已恢复为默认值",Duration = 3})
        playSound()
    end
})

local ESPTab = Window:Tab({Title = "透视功能", Icon = "eye", Locked = false})
ESPTab:Toggle({
    Title = "玩家透视 (ESP)",
    Desc = "显示玩家描边和距离",
    Default = espEnabled,
    Callback = function(value)
        toggleESP(value)
        playSound()
    end
})
ESPTab:Colorpicker({
    Title = "ESP玩家名字颜色",
    Desc = "设置玩家名字显示颜色",
    Default = espNameColor,
    Callback = function(color)
        espNameColor = color
        if espEnabled and not espRainbowEnabled then
            updateESPColors()
        end
        playSound()
    end
})
ESPTab:Colorpicker({
    Title = "ESP身体绘制颜色",
    Desc = "设置玩家身体颜色",
    Default = espBodyColor,
    Callback = function(color)
        espBodyColor = color
        if espEnabled and not espRainbowEnabled then
            updateESPColors()
        end
        playSound()
    end
})
ESPTab:Slider({
    Title = "ESP玩家名字大小",
    Desc = "设置玩家名字的文本大小",
    Value = {Min = 8,Max = 24,Default = espNameSize},
    Callback = function(value)
        espNameSize = value
        if espEnabled then
            updateESPNameSize()
        end
        playSound()
    end
})
ESPTab:Toggle({
    Title = "ESP彩虹渐变",
    Desc = "开启透视彩虹效果",
    Default = espRainbowEnabled,
    Callback = function(value)
        espRainbowEnabled = value
        if espEnabled then
            updateESPColors()
        end
        playSound()
    end
})
ESPTab:Slider({
    Title = "ESP彩虹速度",
    Desc = "调整彩虹的速度",
    Value = {Min = 1,Max = 10,Default = espRainbowSpeed},
    Callback = function(value)
        espRainbowSpeed = value
        playSound()
    end
})

local AimbotTab = Window:Tab({Title = "自瞄功能", Icon = "crosshair", Locked = false})
AimbotTab:Toggle({
    Title = "启用自瞄",
    Desc = "开启/关闭自瞄功能",
    Default = aimbotEnabled,
    Callback = function(value)
        toggleAimbot(value)
        playSound()
    end
})
AimbotTab:Toggle({
    Title = "FOV彩虹效果",
    Desc = "开启FOV圆圈彩虹效果",
    Value = aimbotFOVRainbowEnabled,
    Callback = function(value)
        aimbotFOVRainbowEnabled = value
        updateFOVCircle()
        playSound()
    end
})
AimbotTab:Slider({
    Title = "FOV彩虹速度",
    Desc = "调整彩虹流动的速度",
    Value = {Min = 1,Max = 20,Default = aimbotFOVRainbowSpeed},
    Callback = function(value)
        aimbotFOVRainbowSpeed = value
        playSound()
    end
})
AimbotTab:Slider({
    Title = "自瞄范围 (FOV)",
    Desc = "设置自瞄FOV大小",
    Value = {Min = 50,Max = 500,Default = aimbotFOV},
    Callback = function(value)
        aimbotFOV = value
        updateFOVCircle()
        playSound()
    end
})
AimbotTab:Slider({
    Title = "自瞄平滑度",
    Desc = "数值越小越强锁",
    Value = {Min = 1,Max = 50,Default = aimbotSmoothness},
    Callback = function(value)
        aimbotSmoothness = value
        playSound()
    end
})
AimbotTab:Slider({
    Title = "预判距离",
    Desc = "设置预判距离(需要强锁直接调到0-3)",
    Value = {Min = 0,Max = 20,Default = aimbotCrosshairDistance},
    Callback = function(value)
        aimbotCrosshairDistance = value
        playSound()
    end
})
AimbotTab:Colorpicker({
    Title = "FOV圆圈颜色",
    Desc = "彩虹模式关闭时生效",
    Default = aimbotFOVColor,
    Callback = function(color)
        aimbotFOVColor = color
        updateFOVCircle()
        playSound()
    end
})
AimbotTab:Toggle({
    Title = "好友检测",
    Desc = "不秒好友",
    Value = aimbotFriendCheck,
    Callback = function(value)
        aimbotFriendCheck = value
        playSound()
    end
})
AimbotTab:Toggle({
    Title = "墙壁检测",
    Desc = "开启墙壁检测 避免自瞄乱飞",
    Value = aimbotWallCheck,
    Callback = function(value)
        aimbotWallCheck = value
        playSound()
    end
})
local playerList = {}
for _, player in ipairs(players:GetPlayers()) do
    if player ~= localPlayer then
        table.insert(playerList, player.Name)
    end
end
AimbotTab:Toggle({
    Title = "目标自瞄模式",
    Desc = "开启后可以选择目标进行制裁",
    Value = false,
    Callback = function(value)
        aimbotTargetAll = not value
        playSound()
    end
})
local targetDropdown = AimbotTab:Dropdown({
    Title = "选择目标玩家",
    Desc = "选择要自瞄的玩家",
    Values = playerList,
    Value = nil,
    AllowNone = true,
    Callback = function(selected)
        aimbotTargetPlayer = selected
        playSound()
    end
})
players.PlayerAdded:Connect(function(player)
    table.insert(playerList, player.Name)
    if targetDropdown and targetDropdown.Refresh then
        targetDropdown:Refresh(playerList)
    end
end)
players.PlayerRemoving:Connect(function(player)
    for i, name in ipairs(playerList) do
        if name == player.Name then
            table.remove(playerList, i)
            break
        end
    end
    if targetDropdown and targetDropdown.Refresh then
        targetDropdown:Refresh(playerList)
    end
end)
local QuickSettings = AimbotTab:Group({})
QuickSettings:Button({
    Title = "快速设置: 近距离(强锁)",
    Desc = "FOV: 80 平滑: 1 预判0",
    Justify = "Center",
    Callback = function()
        aimbotFOV = 80
        aimbotSmoothness = 1
        aimbotCrosshairDistance = 0
        updateFOVCircle()
        WindUI:Notify({Title = "快速设置",Content = "已使用近距离设置",Icon = "settings"})
        playSound()
    end
})
QuickSettings:Button({
    Title = "快速设置: 中距离(小强锁)",
    Desc = "FOV: 120, 平滑: 4 预判2",
    Justify = "Center",
    Callback = function()
        aimbotFOV = 120
        aimbotSmoothness = 4
        aimbotCrosshairDistance = 2
        updateFOVCircle()
        WindUI:Notify({Title = "快速设置",Content = "已使用中距离设置",Icon = "settings"})
        playSound()
    end
})
QuickSettings:Button({
    Title = "快速设置: 远距离",
    Desc = "FOV: 130 平滑: 5 预判3",
    Justify = "Center",
    Callback = function()
        aimbotFOV = 130
        aimbotSmoothness = 5
        aimbotCrosshairDistance = 3
        updateFOVCircle()
        WindUI:Notify({Title = "快速设置",Content = "已使用远距离设置",Icon = "settings"})
        playSound()
    end
})

local FlashBorderTab = Window:Tab({Title = "边框设置", Icon = "palette", Locked = false})
FlashBorderTab:Toggle({
    Title = "启用边框",
    Desc = "开关霓虹灯边框效果",
    Default = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                WindUI:Notify({Title = "边框",Content = value and "已启用" or "已禁用",Duration = 2,Icon = value and "eye" or "eye-off"})
            end
        end
    end
})
local colorSchemeNames2 = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames2, name)
end
table.sort(colorSchemeNames2)
FlashBorderTab:Dropdown({
    Title = "边框颜色",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames2,
    Value = "彩虹颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})
FlashBorderTab:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = {Min = 1,Max = 10,Default = 5},
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        playSound()
    end
})
FlashBorderTab:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = {Min = 1,Max = 5,Default = 1.5},
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})
FlashBorderTab:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = {Min = 0,Max = 20,Default = 16},
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})
FlashBorderTab:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames2[math.random(1, #colorSchemeNames2)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

localPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    if espEnabled then
        if espFolder then
            for _, esp in ipairs(espFolder:GetChildren()) do
                esp:Destroy()
            end
        end
        for _, player in ipairs(players:GetPlayers()) do
            if player ~= localPlayer and player.Character then
                createPlayerESP(player)
            end
        end
    end
end)
players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        if espEnabled then
            task.wait(1)
            createPlayerESP(player)
        end
    end)
end)
players.PlayerRemoving:Connect(function(player)
    if espFolder then
        local espGui = espFolder:FindFirstChild(player.Name)
        if espGui then espGui:Destroy() end
        local highlight = espFolder:FindFirstChild(player.Name .. "_Highlight")
        if highlight then highlight:Destroy() end
    end
end)

runService.Heartbeat:Connect(function(deltaTime)
    updateESP()
    if espRainbowEnabled then
        currentESPHue = currentESPHue + deltaTime * espRainbowSpeed / 10
        updateESPColors()
    end
end)

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    applyBlurEffect(false)
end)

Window:OnDestroy(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    for _, animation in pairs(fontColorAnimations) do
        animation:Disconnect()
    end
    fontColorAnimations = {}
    applyBlurEffect(false)
end)

WindUI:Notify({Title = "TnineHub闪光付费",Content = "欢迎付费用户使用此脚本",Duration = 3,Icon = "check"})
end

elseif game.PlaceId == 17164617414 then
local function copyToClipboard()
    if setclipboard then
        setclipboard("作者QQ:2979764086")
    end
end

copyToClipboard()

local function SafeCall(func)
    local success, result = pcall(func)
    return success and result
end

local function SetupHooks()
    if hookfunction and is_synapse_function then
        local oldNamecall
        oldNamecall = hookfunction(getrawmetatable(game).__namecall, function(self, ...)
            local method = getnamecallmethod()
            if method == "Kick" or method == "Destroy" then
                return nil
            end
            return oldNamecall(self, ...)
        end)
    end
end

local function CleanEnvironment()
    for _, v in pairs(getconnections or {}) do
        if v.Disable then v:Disable() end
    end
    
    if setfflag then
        setfflag("DebuggerBreak", "True")
        setfflag("DebuggerLuaFix", "True")
    end
end

SafeCall(CleanEnvironment)
SafeCall(SetupHooks)

wait(2.5)

if game.PlaceId == 17164617414 then
    game:GetService('StarterGui'):SetCore('SendNotification', {
        Title = 'FPE脚本',
        Text = '[Fpe:s] 游戏支持！',
        Icon = 'rbxassetid://7734053426',
    })
    
    if cloneref(game:GetService('Workspace')):FindFirstChild('SafeZone') then
        cloneref(game:GetService('StarterGui')):SetCore('SendNotification', {
            Title = 'FPE漏洞系统',
            Text = '你已经执行过脚本',
            Icon = 'rbxassetid://7743878857',
        })
        return
    end

    local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
    WindUI.TransparencyValue = 0.2
    WindUI:SetTheme("Dark")

    local username = game:GetService("Players").LocalPlayer.Name
    local coloredUsername = ""
    local gradientColors = {"#4169E1", "#6A5ACD", "#9370DB", "#8A2BE2", "#4B0082"}
    local goldColor = "#FFD700"
    for i = 1, #username do
        local char = username:sub(i, i)
        if char:match("[A-Za-z0-9]") then
            local colorIndex = (i - 1) % #gradientColors + 1
            coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
        else
            coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
        end
    end

    local Confirmed = false
    WindUI:Popup({
        Title = 'FPE脚本',
        IconThemed = true,
        Icon = "crown",
        Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用FPE脚本\n加入我们QQ1015718032",
        Buttons = {
            {
                Title = "取消",
                Callback = function() end,
                Variant = "Secondary",
            },
            {
                Title = "执行",
                Icon = "arrow-right",
                Callback = function() 
                    Confirmed = true
                end,
                Variant = "Primary",
            }
        }
    })

    if not Confirmed then return end

    local Window = WindUI:CreateWindow({
        Title = 'FPE脚本',
        Icon = "crown",
        IconThemed = true,
        Author = "多喝水",
        Folder = "FPE",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "FPE脚本",
                    Content = "作者：多喝水", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索功能...",
            Callback = function(searchText)
            end
        }
    })

    Window:EditOpenButton({
        Title = "FPE用户",
        Icon = "crown",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
        Draggable = true,
    })
    Window:Tag({
        Title = "VIP版",
        Color = Color3.fromHex("#FFA500") 
    })
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)

    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})
    local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})
    infoSection:Divider()
    infoSection:Paragraph({
        Title = "您当前的服务器为",
        Desc = tostring(game.PlaceId) .. "\n欢迎使用FPE脚本",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "持续更新 有bug请提出",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "作者:多喝水",
        ThumbnailSize = 190,
    })

    local _LocalPlayerTab = Window:Tab({Title = "本地玩家功能", Icon = "user"})
    local playerSection = _LocalPlayerTab:Section({Title = "玩家功能", Icon = "user", Opened = true})

    playerSection:Label("<font color='rgb(255, 0, 0)'>警告：非FE</font>")

    playerSection:Toggle({
        Title = "获取 <font color='rgb(252, 240, 3)'>VIP</font> (客户端)",
        Value = false,
        Callback = function(p3)
            local _LocalPlayer = game:GetService('Players').LocalPlayer
            if not _LocalPlayer.Character then
                _LocalPlayer.CharacterAdded:Wait()
            end
            if _LocalPlayer:GetAttribute('HasVIP') ~= nil then
                _LocalPlayer:SetAttribute('HasVIP', p3)
            end
        end,
    })

    playerSection:Divider()
    playerSection:Label("视觉增强")

    local _Lighting = game:GetService('Lighting')
    local u6 = {
        Brightness = _Lighting.Brightness,
        ClockTime = _Lighting.ClockTime,
        FogEnd = _Lighting.FogEnd,
        FogStart = _Lighting.FogStart,
        FogColor = _Lighting.FogColor,
        Ambient = _Lighting.Ambient,
        OutdoorAmbient = _Lighting.OutdoorAmbient,
        GlobalShadows = _Lighting.GlobalShadows,
    }

    local function u7()
        _Lighting.Brightness = 25
        _Lighting.ClockTime = 12
        _Lighting.FogEnd = 1000000
        _Lighting.FogStart = 0
        _Lighting.FogColor = Color3.new(1, 1, 1)
        _Lighting.Ambient = Color3.new(1, 1, 1)
        _Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
        _Lighting.GlobalShadows = false
    end

    local function u12()
        for v10, v11 in pairs(u6) do
            _Lighting[v10] = v11
        end
    end

    playerSection:Toggle({
        Title = '全亮模式',
        Value = false,
        Callback = function(p13)
            if p13 then
                u7()
            else
                u12()
            end
        end,
    })

    playerSection:Divider()
    playerSection:Label("传送工具")
    playerSection:Button({
        Title = '生成传送工具',
        Callback = function()
            local mouse = game.Players.LocalPlayer:GetMouse()
            local tool = Instance.new('Tool')
            tool.RequiresHandle = false
            tool.Name = '传送工具(装备后点击传送)'
            tool.Activated:Connect(function()
                local v14 = mouse.Hit + Vector3.new(0, 2.5, 0)
                local v15 = CFrame.new(v14.X, v14.Y, v14.Z)
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v15
            end)
            tool.Parent = game.Players.LocalPlayer.Backpack
            WindUI:Notify({Title = "传送工具", Content = "已添加到背包", Duration = 3})
        end,
    })

    playerSection:Divider()
    playerSection:Label("无限体力")
    playerSection:Button({
        Title = '无限体力',
        Callback = function()
            WindUI:Notify({Title = "FPE脚本", Content = "创作者:多喝水", Duration = 3})
            
            local _LocalPlayer = game:GetService('Players').LocalPlayer
            local v2 = _LocalPlayer.Character or _LocalPlayer.CharacterAdded:Wait()
            
            if v2:GetAttribute('MaxStamina') == nil then
                if _LocalPlayer:GetAttribute('MaxStamina') == nil then
                    local objects = {v2, _LocalPlayer, v2:FindFirstChildOfClass('Humanoid')}
                    for _, obj in ipairs(objects) do
                        if obj and obj:GetAttributes() then
                            for attrName, _ in pairs(obj:GetAttributes()) do
                                if string.lower(attrName):find('stamina') then
                                    obj:SetAttribute(attrName, math.huge)
                                end
                            end
                        end
                    end
                else
                    _LocalPlayer:SetAttribute('MaxStamina', math.huge)
                end
            else
                v2:SetAttribute('MaxStamina', math.huge)
            end
            
            task.wait(1)
            
            local _LocalPlayer2 = game:GetService('Players').LocalPlayer
            local v12 = _LocalPlayer2.Character or _LocalPlayer2.CharacterAdded:Wait()
            
            if v12:GetAttribute('Stamina') == nil then
                if _LocalPlayer2:GetAttribute('Stamina') == nil then
                    local objects = {v12, _LocalPlayer2, v12:FindFirstChildOfClass('Humanoid')}
                    for _, obj in ipairs(objects) do
                        if obj and obj:GetAttributes() then
                            for attrName, _ in pairs(obj:GetAttributes()) do
                                if string.lower(attrName):find('stamina') then
                                    obj:SetAttribute(attrName, math.huge)
                                end
                            end
                        end
                    end
                else
                    _LocalPlayer2:SetAttribute('Stamina', math.huge)
                end
            else
                v12:SetAttribute('Stamina', math.huge)
            end
            WindUI:Notify({Title = "无限体力", Content = "体力已设置为无限", Duration = 3})
        end,
    })

    local CombatTab = Window:Tab({Title = "战斗系统", Icon = "shield"})
    local combatSection = CombatTab:Section({Title = "自动格挡", Icon = "shield", Opened = true})

    combatSection:Label("自动格挡(音频)")
    local autoBlockEnabled = false
    local blockDetectionRange = 25
    local lastBlockTime = 0
    local BLOCK_COOLDOWN = 1.3
    local blockConnection = nil
    
    local function pressBlockKey()
        local currentTime = tick()
        if currentTime - lastBlockTime < BLOCK_COOLDOWN then return end
        local virtualInputManager = game:GetService("VirtualInputManager")
        virtualInputManager:SendKeyEvent(true, Enum.KeyCode.Q, false, game)
        virtualInputManager:SendKeyEvent(false, Enum.KeyCode.Q, false, game)
        lastBlockTime = currentTime
    end
    
    local function checkSoundPlaying(sound)
        if not sound then return false end
        if sound:IsA("Sound") then
            if sound.IsLoaded and sound.TimeLength > 0 then
                return sound.TimePosition > 0 and sound.TimePosition < sound.TimeLength
            end
            return sound.Playing
        end
        return false
    end
    
    local function checkForAttack()
        local character = game.Players.LocalPlayer.Character
        if not character or not character:FindFirstChild("HumanoidRootPart") then return end
        local myPosition = character.HumanoidRootPart.Position
        local teachersFolder = workspace:FindFirstChild("Teachers")
        if not teachersFolder then return end
        for _, teacher in pairs(teachersFolder:GetChildren()) do
            if teacher:IsA("Model") then
                local teacherRoot = teacher:FindFirstChild("HumanoidRootPart")
                if teacherRoot then
                    local distance = (teacherRoot.Position - myPosition).Magnitude
                    if distance > blockDetectionRange then continue end
                    for _, sound in pairs(teacher:GetDescendants()) do
                        if sound.Name == "SwingSFX" and checkSoundPlaying(sound) then
                            pressBlockKey()
                            return
                        end
                    end
                end
            end
        end
    end
    
    local function startBlockLoop()
        if blockConnection then blockConnection:Disconnect() end
        blockConnection = game:GetService("RunService").Heartbeat:Connect(function()
            if autoBlockEnabled then checkForAttack() end
        end)
    end
    
    combatSection:Toggle({
        Title = '启用自动格挡',
        Value = false,
        Callback = function(enabled)
            autoBlockEnabled = enabled
            if enabled then
                startBlockLoop()
                WindUI:Notify({Title = "自动格挡", Content = "已启用自动格挡功能", Duration = 3})
            else
                if blockConnection then
                    blockConnection:Disconnect()
                    blockConnection = nil
                end
            end
        end,
    })
    
    combatSection:Slider({
        Title = '格挡检测范围',
        Desc = "设置格挡检测距离",
        Value = {Min = 10, Max = 50, Default = 25},
        Callback = function(value)
            blockDetectionRange = value
            WindUI:Notify({Title = "自动格挡", Content = "检测范围已设置为: " .. value, Duration = 3})
        end,
    })

    combatSection:Divider()
    combatSection:Label("自动格挡(动画)")
    local autoBlockEnabled2 = false
    local blockConnection2 = nil
    local blockDetectionRange2 = 25
    local teacherAttackAnimIDs = {17492938294, 17492940267, 17605409993, 17605403503, 18593007074, 18592978117, 81704410466143, 140314441187252}

    local function isTeacherAttacking(teacher)
        local humanoid = teacher:FindFirstChildOfClass("Humanoid")
        if not humanoid then return false end
        for _, track in pairs(humanoid:GetPlayingAnimationTracks()) do
            if track.Animation then
                local animId = track.Animation.AnimationId
                local idMatch = animId:match("%d+")
                if idMatch then
                    for _, attackId in ipairs(teacherAttackAnimIDs) do
                        if tonumber(idMatch) == attackId then return true end
                    end
                end
            end
        end
        return false
    end

    local function checkForAttack2()
        local character = game.Players.LocalPlayer.Character
        if not character or not character:FindFirstChild("HumanoidRootPart") then return end
        local teachersFolder = workspace:FindFirstChild("Teachers")
        if not teachersFolder then return end
        local myPosition = character.HumanoidRootPart.Position
        for _, teacher in pairs(teachersFolder:GetChildren()) do
            if teacher:IsA("Model") then
                local teacherRoot = teacher:FindFirstChild("HumanoidRootPart")
                if teacherRoot then
                    local distance = (teacherRoot.Position - myPosition).Magnitude
                    if distance > blockDetectionRange2 then continue end
                    if isTeacherAttacking(teacher) then
                        local virtualInputManager = game:GetService("VirtualInputManager")
                        virtualInputManager:SendKeyEvent(true, Enum.KeyCode.Q, false, game)
                        task.wait(0.1)
                        virtualInputManager:SendKeyEvent(false, Enum.KeyCode.Q, false, game)
                        break
                    end
                end
            end
        end
    end

    local function startAnimationBlock()
        if blockConnection2 then blockConnection2:Disconnect() end
        blockConnection2 = game:GetService("RunService").Heartbeat:Connect(function()
            if autoBlockEnabled2 then checkForAttack2() end
        end)
    end

    combatSection:Toggle({
        Title = '动画ID格挡',
        Value = false,
        Callback = function(enabled)
            autoBlockEnabled2 = enabled
            if enabled then
                startAnimationBlock()
                WindUI:Notify({Title = "动画ID格挡", Content = "已启用动画ID格挡功能", Duration = 3})
            else
                if blockConnection2 then
                    blockConnection2:Disconnect()
                    blockConnection2 = nil
                end
            end
        end,
    })

    combatSection:Slider({
        Title = '格挡检测范围',
        Desc = "设置动画格挡检测距离",
        Value = {Min = 10, Max = 50, Default = 25},
        Callback = function(value)
            blockDetectionRange2 = value
            WindUI:Notify({Title = "动画格挡", Content = "检测范围已设置为: " .. value, Duration = 3})
        end,
    })

    combatSection:Input({
        Title = '添加攻击动画ID',
        Placeholder = table.concat(teacherAttackAnimIDs, ","),
        Callback = function(input)
            local newIDs = {}
            for idStr in input:gmatch("[^,]+") do
                local id = tonumber(idStr:trim())
                if id then table.insert(newIDs, id) end
            end
            if #newIDs > 0 then
                teacherAttackAnimIDs = newIDs
                WindUI:Notify({Title = "动画ID", Content = "已更新动画ID列表", Duration = 3})
            end
        end,
    })

    local VisualTab = Window:Tab({Title = "视觉增强", Icon = "eye"})
    local visualSection = VisualTab:Section({Title = "队伍透视", Icon = "eye", Opened = true})

    local _Players = game:GetService('Players')
    local _LocalPlayer2 = _Players.LocalPlayer
    local u18 = true
    local u19 = true
    local u20 = {}
    local u21 = {}

    local function u27(p22)
        local v23 = u21[p22]
        if v23 and v23:FindFirstChild('ESPText') then
            local _ESPText = v23.ESPText
            local _Name = p22.Name
            local _Character = p22.Character
            if _Character then
                _Character = p22.Character:FindFirstChildOfClass('Humanoid')
            end
            if _Character and u18 then
                _Name = _Name .. ' | 血量: ' .. math.floor(_Character.Health)
            end
            if u19 and p22.Team then
                _Name = _Name .. ' | ' .. p22.Team.Name
            end
            _ESPText.Text = _Name
        end
    end

    local function u33(p28)
        if p28.Character then
            local _Head = p28.Character:FindFirstChild('Head')
            if _Head and not _Head:FindFirstChild('TeamESP') then
                local _BillboardGui = Instance.new('BillboardGui')
                _BillboardGui.Name = 'TeamESP'
                _BillboardGui.Adornee = _Head
                _BillboardGui.Size = UDim2.new(0, 120, 0, 50)
                _BillboardGui.AlwaysOnTop = true
                _BillboardGui.LightInfluence = 0
                _BillboardGui.ResetOnSpawn = false
                local _TextLabel = Instance.new('TextLabel')
                _TextLabel.Size = UDim2.new(1, 0, 1, 0)
                _TextLabel.BackgroundTransparency = 1
                _TextLabel.TextStrokeTransparency = 0.5
                _TextLabel.TextScaled = true
                _TextLabel.Font = Enum.Font.SourceSansBold
                _TextLabel.TextColor3 = p28.TeamColor.Color
                _TextLabel.Name = 'ESPText'
                _TextLabel.Text = ''
                _TextLabel.Parent = _BillboardGui
                _BillboardGui.Parent = _Head
                u21[p28] = _BillboardGui
                local _Humanoid = p28.Character:FindFirstChildOfClass('Humanoid')
                if _Humanoid then
                    table.insert(u20, _Humanoid:GetPropertyChangedSignal('Health'):Connect(function()
                        u27(p28)
                    end))
                end
                u27(p28)
            end
        end
    end

    local function u40()
        for _, player in ipairs(_Players:GetPlayers()) do
            if player ~= _LocalPlayer2 then
                u33(player)
                table.insert(u20, player.CharacterAdded:Connect(function()
                    wait(1)
                    u33(player)
                end))
            end
        end
        table.insert(u20, _Players.PlayerAdded:Connect(function(p39)
            p39.CharacterAdded:Connect(function()
                wait(1)
                u33(p39)
            end)
        end))
    end

    local function u49()
        for _, v44 in pairs(u21) do
            if v44 and v44.Parent then v44:Destroy() end
        end
        u21 = {}
        for _, v48 in ipairs(u20) do
            if typeof(v48) == 'RBXScriptConnection' then v48:Disconnect() end
        end
        u20 = {}
    end

    visualSection:Toggle({
        Title = '启用透视',
        Value = false,
        Callback = function(p50)
            if p50 then
                u40()
                WindUI:Notify({Title = "透视系统", Content = "已启用玩家透视", Duration = 3})
            else
                u49()
            end
        end,
    })

    visualSection:Toggle({
        Title = '显示血量',
        Value = true,
        Callback = function(p51)
            u18 = p51
            for player, _ in pairs(u21) do u27(player) end
        end,
    })

    visualSection:Toggle({
        Title = '显示队伍名称',
        Value = true,
        Callback = function(p55)
            u19 = p55
            for player, _ in pairs(u21) do u27(player) end
        end,
    })

    local _SafeZoneTab = Window:Tab({Title = "安全区系统", Icon = "shield"})
    local safeSection = _SafeZoneTab:Section({Title = "安全区传送", Icon = "shield", Opened = true})

    local _LocalPlayer3 = game:GetService('Players').LocalPlayer

    local function v62()
        local _Part = Instance.new('Part')
        _Part.Name = 'SafeZone'
        _Part.Size = Vector3.new(500, 1, 500)
        _Part.Position = Vector3.new(0, 10, 0)
        _Part.Anchored = true
        _Part.CanCollide = true
        _Part.BrickColor = BrickColor.new('Gray')
        _Part.Material = Enum.Material.Plastic
        _Part.Transparency = 0.6
        _Part.TopSurface = Enum.SurfaceType.Smooth
        _Part.BottomSurface = Enum.SurfaceType.Smooth
        _Part.Parent = workspace
        return _Part
    end

    local u63 = workspace:FindFirstChild('SafeZone') or v62()
    local u64 = false
    local u65 = 25
    local u66 = false

    local antiPullback = {
        enabled = true,
        safePositions = {},
        maxSafePositions = 5,
        detectionRange = 50,
        teleportCooldown = 1,
        lastTeleportTime = 0
    }

    local function recordSafePosition(position)
        table.insert(antiPullback.safePositions, 1, position)
        if #antiPullback.safePositions > antiPullback.maxSafePositions then
            table.remove(antiPullback.safePositions)
        end
    end

    local function checkPullback(currentPos, targetPos)
        if not antiPullback.enabled then return false end
        local distance = (currentPos - targetPos).Magnitude
        if distance > antiPullback.detectionRange then return true end
        return false
    end

    local function safeTeleport(targetCFrame)
        local currentTime = tick()
        if currentTime - antiPullback.lastTeleportTime < antiPullback.teleportCooldown then return false end
        local character = _LocalPlayer3.Character
        if not character then return false end
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        if not humanoidRootPart then return false end
        recordSafePosition(humanoidRootPart.Position)
        humanoidRootPart.CFrame = targetCFrame
        antiPullback.lastTeleportTime = currentTime
        task.delay(0.5, function()
            if character and humanoidRootPart and humanoidRootPart.Parent then
                local newPos = humanoidRootPart.Position
                if checkPullback(newPos, targetCFrame.Position) then
                    if #antiPullback.safePositions > 0 then
                        local safePos = antiPullback.safePositions[1]
                        humanoidRootPart.CFrame = CFrame.new(safePos)
                        recordSafePosition(safePos)
                    end
                else
                    recordSafePosition(newPos)
                end
            end
        end)
        return true
    end

    local function u68()
        local character = _LocalPlayer3.Character
        if not character then return end
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        if humanoidRootPart then
            local targetCFrame = u63.CFrame + Vector3.new(0, 3, 0)
            safeTeleport(targetCFrame)
        end
    end

    local function u71()
        local character = _LocalPlayer3.Character
        if not character then return end
        local _Humanoid2 = character:WaitForChild('Humanoid', 5)
        if _Humanoid2 then
            u66 = false
            _Humanoid2.HealthChanged:Connect(function(p70)
                if u64 and (p70 <= u65 and not u66) then
                    u66 = true
                    u68()
                end
            end)
        end
    end

    _LocalPlayer3.CharacterAdded:Connect(function(character)
        antiPullback.safePositions = {}
        if character then
            local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
            if humanoidRootPart then recordSafePosition(humanoidRootPart.Position) end
        end
        if u64 then u71() end
    end)

    if _LocalPlayer3.Character then
        local humanoidRootPart = _LocalPlayer3.Character:FindFirstChild("HumanoidRootPart")
        if humanoidRootPart then recordSafePosition(humanoidRootPart.Position) end
        u71()
    end

    safeSection:Toggle({
        Title = '启用自动安全区',
        Value = false,
        Callback = function(p72)
            u64 = p72
            if p72 then
                u71()
                WindUI:Notify({Title = "安全区", Content = "自动安全区已启用", Duration = 3})
            end
        end,
    })

    safeSection:Input({
        Title = '触发血量阈值',
        Placeholder = '25',
        Callback = function(p73)
            local v74 = tonumber(p73)
            if v74 then u65 = v74 end
        end,
    })

    safeSection:Divider()
    safeSection:Label("手动传送")
    local _LocalPlayer4 = game:GetService('Players').LocalPlayer
    local u76 = nil

    local function u77()
        return (_LocalPlayer4.Character or _LocalPlayer4.CharacterAdded:Wait()):WaitForChild('HumanoidRootPart', 5)
    end

    local u78 = workspace:FindFirstChild('SafeZone') or v62()

    safeSection:Toggle({
        Title = '传送到安全区',
        Value = false,
        Callback = function(p79)
            local v80 = u77()
            if v80 then
                if p79 then
                    if not u76 then u76 = v80.CFrame end
                    safeTeleport(u78.CFrame + Vector3.new(0, 3, 0))
                    WindUI:Notify({Title = "安全区", Content = "已传送到安全区", Duration = 3})
                elseif u76 then
                    safeTeleport(u76)
                    u76 = nil
                    WindUI:Notify({Title = "安全区", Content = "已返回原位置", Duration = 3})
                end
            end
        end,
    })

    safeSection:Divider()
    safeSection:Label("防拉回设置")
    safeSection:Toggle({
        Title = '启用防拉回系统',
        Value = true,
        Callback = function(enabled)
            antiPullback.enabled = enabled
        end,
    })

    safeSection:Input({
        Title = '拉回检测距离',
        Placeholder = '50',
        Callback = function(value)
            local distance = tonumber(value)
            if distance and distance > 0 then antiPullback.detectionRange = distance end
        end,
    })

    safeSection:Input({
        Title = '传送冷却时间(秒)',
        Placeholder = '1',
        Callback = function(value)
            local cooldown = tonumber(value)
            if cooldown and cooldown > 0 then antiPullback.teleportCooldown = cooldown end
        end,
    })

    safeSection:Button({
        Title = '重置安全位置记录',
        Callback = function()
            antiPullback.safePositions = {}
            local character = _LocalPlayer3.Character
            if character then
                local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                if humanoidRootPart then recordSafePosition(humanoidRootPart.Position) end
            end
            WindUI:Notify({Title = "安全区", Content = "已重置安全位置", Duration = 3})
        end,
    })

    local _CreditTab = Window:Tab({Title = "关于作者", Icon = "user"})
    local creditSection = _CreditTab:Section({Title = "作者信息", Icon = "user", Opened = true})
    
    creditSection:Paragraph({
        Title = "所有者: 多喝水 (唯一所有者)",
        Desc = "脚本永久免费"
    })
    creditSection:Paragraph({
        Title = "B站搜索ROBLOX多喝水",
        Desc = "禁止倒卖"
    })
    creditSection:Paragraph({
        Title = "QQ: 2979764086",
        Desc = "感谢使用"
    })

    Window:OnClose(function()
        applyBlurEffect(false)
    end)

    Window:OnDestroy(function()
        applyBlurEffect(false)
    end)

    local function applyBlurEffect(enabled)
        if enabled then
            pcall(function()
                local blur = Instance.new("BlurEffect")
                blur.Size = 8
                blur.Name = "FPEBlur"
                blur.Parent = game:GetService("Lighting")
            end)
        else
            pcall(function()
                local existingBlur = game:GetService("Lighting"):FindFirstChild("FPEBlur")
                if existingBlur then existingBlur:Destroy() end
            end)
        end
    end
end

elseif game.PlaceId == 3623096087 then--力量传奇
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

local function setupAntiAFK()
    game:GetService("Players").LocalPlayer.Idled:Connect(function()
        game:GetService("VirtualUser"):Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
        wait(1)
        game:GetService("VirtualUser"):Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
    end)
end

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer

_G.airStrike = false
_G.switchServers = false
_G.positionLock = false
local startTime = tick()

local targetPosition = Vector3.new(-8775.1904296875, 256.52142333984, -5853.5532226562)
local positionLockConnection

local autoKillConnection
local autoPunchConnection

local function startPositionLock()
    if positionLockConnection then
        positionLockConnection:Disconnect()
    end
    
    positionLockConnection = RunService.Heartbeat:Connect(function()
        if _G.positionLock then
            local character = LocalPlayer.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = CFrame.new(targetPosition)
                
                local platform = workspace:FindFirstChild("TeleportPlatform")
                if not platform then
                    platform = Instance.new("Part")
                    platform.Name = "TeleportPlatform"
                    platform.Parent = workspace
                    platform.CFrame = CFrame.new(-8775.1904296875, 251.52142333984, -5853.5532226562)
                    platform.Size = Vector3.new(10, 0, 10)
                    platform.Anchored = true
                end
            end
        end
    end)
end

local function autoKill()
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local targetHead = player.Character:FindFirstChild("Head")
            local myCharacter = LocalPlayer.Character
            
            if targetHead and myCharacter then
                local myLeftHand = myCharacter:FindFirstChild("LeftHand")
                
                if myLeftHand then
                    pcall(function()
                        firetouchinterest(targetHead, myLeftHand, 0)
                        task.wait(0.01)
                        firetouchinterest(targetHead, myLeftHand, 1)
                    end)
                end
            end
        end
    end
end

local function autoPunch()
    pcall(function()
        LocalPlayer.muscleEvent:FireServer("punch", "leftHand")
        
        local character = LocalPlayer.Character
        local backpack = LocalPlayer.Backpack
        
        if character and backpack then
            local punchTool = backpack:FindFirstChild("Punch")
            if punchTool then
                local humanoid = character:FindFirstChild("Humanoid")
                if humanoid then
                    humanoid:EquipTool(punchTool)
                end
            end
        end
    end)
end

local function serverHop()
    local success, errorMsg = pcall(function()
        local baseUrl = "https://games.roblox.com/v1/games/"
        local placeId = game.PlaceId
        local url = baseUrl .. placeId .. "/servers/Public?sortOrder=Desc&limit=100"
        
        local function findServer(cursor)
            local fullUrl = cursor and (url .. "&cursor=" .. cursor) or url
            local response = game:HttpGet(fullUrl)
            
            if not response then return nil end
            
            local data = game:GetService("HttpService"):JSONDecode(response)
            if not data then return nil end
            
            for _, server in ipairs(data.data) do
                if server.playing >= 14 and server.playing < server.maxPlayers then
                    return server.id
                end
            end
            
            if data.nextPageCursor then
                return findServer(data.nextPageCursor)
            end
            
            return nil
        end
        
        local serverId = findServer()
        
        if serverId then
            TeleportService:TeleportToPlaceInstance(placeId, serverId, LocalPlayer)
        else
            TeleportService:Teleport(placeId, LocalPlayer)
        end
    end)
    
    if not success then
        warn("服务器跳转失败:", errorMsg)
    end
end

local function resetAllFeatures()
    _G.airStrike = false
    _G.switchServers = false
    _G.positionLock = false
    
    if getgenv() then
        getgenv().fly = false
        getgenv().AutoWeight = false
        getgenv().AutoPushups = false
        getgenv().AutoSitups = false
        getgenv().AutoHandstands = false
        getgenv().AutoAllTrain = false
        getgenv().AutoTrainTriple = false
        getgenv().AutoPushup = false
        getgenv().AutoSitup = false
        getgenv().AutoHandstand = false
    end
    
    if autoKillConnection then
        autoKillConnection:Disconnect()
        autoKillConnection = nil
    end
    
    if autoPunchConnection then
        autoPunchConnection:Disconnect()
        autoPunchConnection = nil
    end
    
    if positionLockConnection then
        positionLockConnection:Disconnect()
        positionLockConnection = nil
    end
    
    if getgenv() and getgenv().FlyLoop then
        getgenv().FlyLoop:Disconnect()
        getgenv().FlyLoop = nil
    end
    
    if getgenv() and getgenv().noclipConnection then
        getgenv().noclipConnection:Disconnect()
        getgenv().noclipConnection = nil
    end
    
    local character = game.Players.LocalPlayer.Character
    if character then
        local hrp = character:FindFirstChild("HumanoidRootPart")
        if hrp then
            if hrp:FindFirstChild("VelocityHandler") then hrp.VelocityHandler:Destroy() end
            if hrp:FindFirstChild("GyroHandler") then hrp.GyroHandler:Destroy() end
            character.Humanoid.PlatformStand = false
        end
        
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end
    
    WindUI:Notify({
        Title = "功能重置",
        Content = "玩家死亡，所有功能已重置",
        Duration = 3,
    })
end

local function setupDeathListener()
    LocalPlayer.CharacterAdded:Connect(function(character)
        local humanoid = character:WaitForChild("Humanoid")
        humanoid.Died:Connect(function()
            resetAllFeatures()
        end)
    end)
    
    if LocalPlayer.Character then
        local humanoid = LocalPlayer.Character:WaitForChild("Humanoid")
        humanoid.Died:Connect(function()
            resetAllFeatures()
        end)
    end
end

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "Version Beat",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

    Window:EditOpenButton({
        Title = "Paid user",
        Icon = "crown",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
        Draggable = true,
    })
    Window:Tag({
        Title = "YG(怀)/messy(凌乱)",
        Color = Color3.fromHex("#FFA500") 
    })
    
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)
    
    if not borderInitialized then
        spawn(function()
            wait(0.5)
            initializeRainbowBorder("糖果颜色", animationSpeed)
            wait(1)
            applyFontStyleToWindow(currentFontStyle)
        end)
    end

    local windowOpen = true

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
    end)

    local originalOpenFunction = Window.Open
    Window.Open = function(...)
        windowOpen = true
        local result = originalOpenFunction(...)
        
        if borderInitialized and borderEnabled and not rainbowBorderAnimation then
            wait(0.1)
            startBorderAnimation(Window, animationSpeed)
        end
        
        return result
    end

    setupAntiAFK()
    setupDeathListener()

    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

    local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

    infoSection:Divider()

    infoSection:Paragraph({
        Title = "您当前的服务器为",
        Desc = "力量传奇\n欢迎使用YG/TNINE",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "持续更新 有bug请提出来",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "作者:怀 凌乱",
        ThumbnailSize = 190,
    })

    local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
    Settings:Paragraph({
        Title = "UI设置",
        Desc = "绝妙二改WindUI",
        Image = "settings",
        ImageSize = 20,
        Color = "White"
    })

    Settings:Toggle({
        Title = "启用边框",
        Value = borderEnabled,
        Callback = function(value)
            borderEnabled = value
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Enabled = value
                    if value and windowOpen and not rainbowBorderAnimation then
                        startBorderAnimation(Window, animationSpeed)
                    elseif not value and rainbowBorderAnimation then
                        rainbowBorderAnimation:Disconnect()
                        rainbowBorderAnimation = nil
                    end
                    
                    WindUI:Notify({
                        Title = "边框",
                        Content = value and "已启用" or "已禁用",
                        Duration = 2,
                        Icon = value and "eye" or "eye-off"
                    })
                end
            end
        end
    })

    Settings:Toggle({
        Title = "启用字体颜色",
        Value = fontColorEnabled,
        Callback = function(value)
            fontColorEnabled = value
            applyFontColorsToWindow(currentFontColorScheme)
            
            WindUI:Notify({
                Title = "字体颜色",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "type" or "type"
            })
        end
    })

    Settings:Toggle({
        Title = "启用音效",
        Value = soundEnabled,
        Callback = function(value)
            soundEnabled = value
            WindUI:Notify({
                Title = "音效",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "volume-2" or "volume-x"
            })
        end
    })

    Settings:Toggle({
        Title = "启用背景模糊",
        Value = blurEnabled,
        Callback = function(value)
            blurEnabled = value
            applyBlurEffect(value)
            WindUI:Notify({
                Title = "背景模糊",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "cloud-rain" or "cloud"
            })
        end
    })

    local colorSchemeNames = {}
    for name, _ in pairs(COLOR_SCHEMES) do
        table.insert(colorSchemeNames, name)
    end
    table.sort(colorSchemeNames)

    Settings:Dropdown({
        Title = "边框颜色方案",
        Desc = "选择喜欢的颜色组合",
        Values = colorSchemeNames,
        Value = "糖果颜色",
        Callback = function(value)
            currentBorderColorScheme = value
            local success = initializeRainbowBorder(value, animationSpeed)
            playSound()
        end
    })

    Settings:Dropdown({
        Title = "字体颜色方案",
        Desc = "选择文字颜色组合",
        Values = colorSchemeNames,
        Value = "彩虹颜色",
        Callback = function(value)
            currentFontColorScheme = value
            applyFontColorsToWindow(value)
            playSound()
        end
    })

    local fontOptions = {}
    for _, fontName in ipairs(FONT_STYLES) do
        local description = FONT_DESCRIPTIONS[fontName] or fontName
        table.insert(fontOptions, {text = description, value = fontName})
    end

    table.sort(fontOptions, function(a, b)
        return a.text < b.text
    end)

    local fontValues = {}
    local fontValueToName = {}
    for _, option in ipairs(fontOptions) do
        table.insert(fontValues, option.text)
        fontValueToName[option.text] = option.value
    end

    Settings:Dropdown({
        Title = "字体样式",
        Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
        Values = fontValues,
        Value = "标准粗体",
        Callback = function(value)
            local fontName = fontValueToName[value]
            if fontName then
                currentFontStyle = fontName
                local successCount, totalCount = applyFontStyleToWindow(fontName)
                playSound()
            end
        end
    })

    Settings:Slider({
        Title = "边框转动速度",
        Desc = "调整边框旋转的快慢",
        Value = { 
            Min = 1,
            Max = 10,
            Default = 5,
        },
        Callback = function(value)
            animationSpeed = value
            if rainbowBorderAnimation then
                rainbowBorderAnimation:Disconnect()
                rainbowBorderAnimation = nil
            end
            if borderEnabled then
                startBorderAnimation(Window, animationSpeed)
            end
            
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Slider({
        Title = "UI整体缩放",
        Desc = "调整UI大小比例",
        Value = { 
            Min = 0.5,
            Max = 1.5,
            Default = 1,
        },
        Step = 0.1,
        Callback = function(value)
            uiScale = value
            applyUIScale(value)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Slider({
        Title = "UI透明度",
        Desc = "调整整个UI的透明度",
        Value = { 
            Min = 0,
            Max = 1,
            Default = 0.2,
        },
        Step = 0.1,
        Callback = function(value)
            Window:ToggleTransparency(tonumber(value) > 0)
            WindUI.TransparencyValue = tonumber(value)
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI宽度",
        Desc = "调整窗口的宽度",
        Value = { 
            Min = 500,
            Max = 800,
            Default = 600,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI高度",
        Desc = "调整窗口的高度",
        Value = { 
            Min = 300,
            Max = 600,
            Default = 400,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                local currentWidth = Window.UIElements.Main.Size.X.Offset
                Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "边框粗细",
        Desc = "调整边框的粗细",
        Value = { 
            Min = 1,
            Max = 5,
            Default = 1.5,
        },
        Step = 0.5,
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Thickness = value
                end
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "圆角大小",
        Desc = "调整UI圆角的大小",
        Value = { 
            Min = 0,
            Max = 20,
            Default = 16,
        },
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local corner = mainFrame:FindFirstChildOfClass("UICorner")
                if not corner then
                    corner = Instance.new("UICorner")
                    corner.Parent = mainFrame
                end
                corner.CornerRadius = UDim.new(0, value)
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "恢复UI到原位",
        Icon = "rotate-ccw",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "重置UI大小",
        Icon = "maximize-2",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "随机字体",
        Icon = "shuffle",
        Callback = function()
            local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
            currentFontStyle = randomFont
            applyFontStyleToWindow(randomFont)
            playSound()
        end
    })

    Settings:Button({
        Title = "随机颜色",
        Icon = "palette",
        Callback = function()
            local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
            currentBorderColorScheme = randomColor
            initializeRainbowBorder(randomColor, animationSpeed)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Button({
        Title = "刷新字体颜色",
        Icon = "refresh-cw",
        Callback = function()
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Button({
        Title = "刷新字体样式",
        Icon = "refresh-cw",
        Callback = function()
            local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
            playSound()
        end
    })

    Settings:Button({
        Title = "测试所有字体",
        Icon = "check-circle",
        Callback = function()
            local workingFonts = {}
            local totalFonts = #FONT_STYLES
            
            for i, fontName in ipairs(FONT_STYLES) do
                local success = pcall(function()
                    local test = Enum.Font[fontName]
                end)
                
                if success then
                    table.insert(workingFonts, fontName)
                end
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "导出设置",
        Icon = "download",
        Callback = function()
            local settings = {
                font = currentFontStyle,
                borderColor = currentBorderColorScheme,
                fontSize = currentFontColorScheme,
                speed = animationSpeed,
                scale = uiScale
            }
            setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
            playSound()
        end
    })

    local MainTab = Window:Tab({Title = "杀戮类", Icon = "target"})
    local PlayerTab = Window:Tab({Title = "修改类", Icon = "edit"})
    local AutoTab = Window:Tab({Title = "自动类", Icon = "zap"})
    local NoAutoTab = Window:Tab({Title = "自动锻炼类", Icon = "dumbbell"})
    local LOLTab = Window:Tab({Title = "通用类", Icon = "settings"})
    local InfoTab = Window:Tab({Title = "信息类", Icon = "info"})

    local MainSection = MainTab:Section({Title = "杀戮功能", Icon = "target", Opened = true})
    local PlayerSection = PlayerTab:Section({Title = "修改功能", Icon = "edit", Opened = true})
    local AutoSection = AutoTab:Section({Title = "自动功能", Icon = "zap", Opened = true})
    local NoAutoSection = NoAutoTab:Section({Title = "自动锻炼功能", Icon = "dumbbell", Opened = true})
    local LOLSection = LOLTab:Section({Title = "通用功能", Icon = "settings", Opened = true})
    local InfoSection = InfoTab:Section({Title = "信息", Icon = "info", Opened = true})

    MainSection:Toggle({
        Title = "自动击杀",
        Value = false,
        Callback = function(value)
            _G.airStrike = value
            
            if value then
                if autoKillConnection then
                    autoKillConnection:Disconnect()
                end
                autoKillConnection = RunService.Heartbeat:Connect(function()
                    if _G.airStrike then
                        autoKill()
                    end
                end)
            else
                if autoKillConnection then
                    autoKillConnection:Disconnect()
                    autoKillConnection = nil
                end
            end
        end
    })

    MainSection:Toggle({
        Title = "自动挥拳",
        Value = false,
        Callback = function(value)
            if value then
                if autoPunchConnection then
                    autoPunchConnection:Disconnect()
                end
                autoPunchConnection = RunService.Heartbeat:Connect(function()
                    autoPunch()
                end)
            else
                if autoPunchConnection then
                    autoPunchConnection:Disconnect()
                    autoPunchConnection = nil
                end
            end
        end
    })

    MainSection:Toggle({
        Title = "锁定坐标(位置)",
        Value = false,
        Callback = function(value)
            _G.positionLock = value
            
            if value then
                startPositionLock()
            else
                if positionLockConnection then
                    positionLockConnection:Disconnect()
                    positionLockConnection = nil
                end
            end
        end
    })

    MainSection:Toggle({
        Title = "自动换服",
        Value = false,
        Callback = function(value)
            _G.switchServers = value
            
            if value then
                LocalPlayer.CharacterAdded:Connect(function(character)
                    local humanoid = character:WaitForChild("Humanoid")
                    humanoid.Died:Connect(function()
                        if _G.switchServers then
                            WindUI:Notify({
                                Title = "自动换服",
                                Content = "玩家死亡，正在执行换服...",
                                Duration = 3,
                            })
                            serverHop()
                        end
                    end)
                end)
                
                RunService.Heartbeat:Connect(function()
                    if _G.switchServers then
                        if tick() - startTime >= 180 then
                            WindUI:Notify({
                                Title = "自动换服",
                                Content = "180秒时间到，正在执行换服...",
                                Duration = 3,
                            })
                            serverHop()
                        end
                    end
                end)
            end
        end
    })

    PlayerSection:Input({
        Title = "修改力量",
        Placeholder = "请输入数值",
        Callback = function(value)
            game:GetService("Players").LocalPlayer.leaderstats.Strength.Value = value
        end
    })

    PlayerSection:Input({
        Title = "修改重生数",
        Placeholder = "请输入数值",
        Callback = function(value)
            game:GetService("Players").LocalPlayer.leaderstats.Rebirths.Value = value
        end
    })

    PlayerSection:Input({
        Title = "修改击杀数",
        Placeholder = "请输入数值",
        Callback = function(value)
            game:GetService("Players").LocalPlayer.leaderstats.Kills.Value = value
        end
    })

    PlayerSection:Input({
        Title = "修改获胜数",
        Placeholder = "请输入数值",
        Callback = function(value)
            game:GetService("Players").LocalPlayer.leaderstats.Brawls.Value = value
        end
    })

    AutoSection:Toggle({
        Title = "自动重生",
        Value = false,
        Callback = function(value)
            if value then
                spawn(function()
                    while value do
                        game:GetService("ReplicatedStorage").rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                        wait()
                    end
                end)
            end
        end
    })

    AutoSection:Button({
        Title = "调整体积为2",
        Callback = function()
            game:GetService("ReplicatedStorage").rEvents.changeSpeedSizeRemote:InvokeServer("changeSize",2)
        end
    })

    AutoSection:Toggle({
        Title = "自动传送肌肉大王",
        Value = false,
        Callback = function(value)
            if value then
                spawn(function()
                    while value do
                        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-8625.9296875, 13.566278457641602, -5730.4736328125)
                        wait()
                    end
                end)
            end
        end
    })

    AutoSection:Paragraph({
        Title = "以下为自动锻炼功能",
        Content = "不可以边锻炼边走 但是别人不会对LocalPlayer(本地玩家)造成伤害"
    })

    AutoSection:Toggle({
        Title = "自动执行所有锻炼",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoTrainTriple = value
            end
            local oldPos = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
            local part = Instance.new('Part', workspace)
            part.Size = Vector3.new(500, 20, 530.1)
            part.Position = Vector3.new(0, 100000, 133.15)
            part.CanCollide = true
            part.Anchored = true
            
            spawn(function()
                while value do
                    wait()
                    local char = game.Players.LocalPlayer.Character
                    if not char then wait(1) continue end
                    char.HumanoidRootPart.CFrame = part.CFrame + Vector3.new(0, 50, 0)
                    for i, v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                        if v.ClassName == "Tool" and (v.Name == "Handstands" or v.Name == "Situps" or v.Name == "Pushups" or v.Name == "Weight") then
                            if v:FindFirstChildOfClass("NumberValue") then
                                v:FindFirstChildOfClass("NumberValue").Value = 0
                            end
                            repeat wait() until game.Players.LocalPlayer.Backpack:FindFirstChildOfClass("Tool")
                            char:WaitForChild("Humanoid"):EquipTool(v)
                            game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                        end
                    end
                end
                part:Destroy()
                local char = game.Players.LocalPlayer.Character
                if char then
                    char.HumanoidRootPart.CFrame = oldPos
                    char:WaitForChild("Humanoid"):UnequipTools()
                end
            end)
        end
    })

    AutoSection:Toggle({
        Title = "自动举哑铃",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoWeight = value
            end
            local oldPos = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
            local part = Instance.new('Part', workspace)
            part.Size = Vector3.new(500, 20, 530.1)
            part.Position = Vector3.new(0, 100000, 133.15)
            part.CanCollide = true
            part.Anchored = true
            
            spawn(function()
                while value do
                    wait()
                    local char = game.Players.LocalPlayer.Character
                    if not char then wait(1) continue end
                    char.HumanoidRootPart.CFrame = part.CFrame + Vector3.new(0, 50, 0)
                    for i,v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                        if v.ClassName == "Tool" and v.Name == "Weight" then
                            v.Parent = char
                        end
                    end
                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                end
                part:Destroy()
                local char = game.Players.LocalPlayer.Character
                if char then
                    char.HumanoidRootPart.CFrame = oldPos
                    char:WaitForChild("Humanoid"):UnequipTools()
                end
            end)
        end
    })

    AutoSection:Toggle({
        Title = "自动俯卧撑",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoPushup = value
            end
            local oldPos = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
            local part = Instance.new('Part', workspace)
            part.Size = Vector3.new(500, 20, 530.1)
            part.Position = Vector3.new(0, 100000, 133.15)
            part.CanCollide = true
            part.Anchored = true
            
            spawn(function()
                while value do
                    wait()
                    local char = game.Players.LocalPlayer.Character
                    if not char then wait(1) continue end
                    char.HumanoidRootPart.CFrame = part.CFrame + Vector3.new(0, 50, 0)
                    for i,v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                        if v.ClassName == "Tool" and v.Name == "Pushups" then
                            v.Parent = char
                        end
                    end
                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                end
                part:Destroy()
                local char = game.Players.LocalPlayer.Character
                if char then
                    char.HumanoidRootPart.CFrame = oldPos
                    char:WaitForChild("Humanoid"):UnequipTools()
                end
            end)
        end
    })

    AutoSection:Toggle({
        Title = "自动仰卧起坐",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoSitup = value
            end
            local oldPos = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
            local part = Instance.new('Part', workspace)
            part.Size = Vector3.new(500, 20, 530.1)
            part.Position = Vector3.new(0, 100000, 133.15)
            part.CanCollide = true
            part.Anchored = true
            
            spawn(function()
                while value do
                    wait()
                    local char = game.Players.LocalPlayer.Character
                    if not char then wait(1) continue end
                    char.HumanoidRootPart.CFrame = part.CFrame + Vector3.new(0, 50, 0)
                    for i,v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                        if v.ClassName == "Tool" and v.Name == "Situps" then
                            v.Parent = char
                        end
                    end
                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                end
                part:Destroy()
                local char = game.Players.LocalPlayer.Character
                if char then
                    char.HumanoidRootPart.CFrame = oldPos
                    char:WaitForChild("Humanoid"):UnequipTools()
                end
            end)
        end
    })

    AutoSection:Toggle({
        Title = "自动倒立",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoHandstand = value
            end
            local oldPos = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
            local part = Instance.new('Part', workspace)
            part.Size = Vector3.new(500, 20, 530.1)
            part.Position = Vector3.new(0, 100000, 133.15)
            part.CanCollide = true
            part.Anchored = true
            
            spawn(function()
                while value do
                    wait()
                    local char = game.Players.LocalPlayer.Character
                    if not char then wait(1) continue end
                    char.HumanoidRootPart.CFrame = part.CFrame + Vector3.new(0, 50, 0)
                    for i,v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                        if v.ClassName == "Tool" and v.Name == "Handstands" then
                            v.Parent = char
                        end
                    end
                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                end
                part:Destroy()
                local char = game.Players.LocalPlayer.Character
                if char then
                    char.HumanoidRootPart.CFrame = oldPos
                    char:WaitForChild("Humanoid"):UnequipTools()
                end
            end)
        end
    })

    NoAutoSection:Paragraph({
        Title = "以下为自动锻炼功能",
        Content = "可以边锻炼边走 但是别人会对LocalPlayer(本地玩家)造成伤害"
    })

    NoAutoSection:Toggle({
        Title = "自动举哑铃",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoWeight = value
            end
            spawn(function()
                while value do
                    pcall(function()
                        local char = game.Players.LocalPlayer.Character
                        if not char then 
                            wait(2)
                        else
                            for i, v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                                if v.ClassName == "Tool" and v.Name == "Weight" then
                                    v.Parent = char
                                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                                    wait(0.03)
                                    v.Parent = game.Players.LocalPlayer.Backpack
                                    wait(0.2)
                                end
                            end
                        end
                    end)
                    wait()
                end
                if not value then
                    for i, v in pairs(game.Players.LocalPlayer.Character:GetChildren()) do
                        if v:IsA("Tool") and v.Name == "Weight" then
                            v.Parent = game.Players.LocalPlayer.Backpack
                        end
                    end
                end
            end)
        end
    })

    NoAutoSection:Toggle({
        Title = "自动俯卧撑",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoPushups = value
            end
            spawn(function()
                while value do
                    pcall(function()
                        local char = game.Players.LocalPlayer.Character
                        if not char then 
                            wait(2)
                        else
                            for i, v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                                if v.ClassName == "Tool" and v.Name == "Pushups" then
                                    v.Parent = char
                                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                                    wait(0.03)
                                    v.Parent = game.Players.LocalPlayer.Backpack
                                    wait(0.2)
                                end
                            end
                        end
                    end)
                    wait()
                end
                if not value then
                    for i, v in pairs(game.Players.LocalPlayer.Character:GetChildren()) do
                        if v:IsA("Tool") and v.Name == "Pushups" then
                            v.Parent = game.Players.LocalPlayer.Backpack
                        end
                    end
                end
            end)
        end
    })

    NoAutoSection:Toggle({
        Title = "自动仰卧起坐",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoSitups = value
            end
            spawn(function()
                while value do
                    pcall(function()
                        local char = game.Players.LocalPlayer.Character
                        if not char then 
                            wait(2)
                        else
                            for i, v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                                if v.ClassName == "Tool" and v.Name == "Situps" then
                                    v.Parent = char
                                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                                    wait(0.03)
                                    v.Parent = game.Players.LocalPlayer.Backpack
                                    wait(0.2)
                                end
                            end
                        end
                    end)
                    wait()
                end
                if not value then
                    for i, v in pairs(game.Players.LocalPlayer.Character:GetChildren()) do
                        if v:IsA("Tool") and v.Name == "Situps" then
                            v.Parent = game.Players.LocalPlayer.Backpack
                        end
                    end
                end
            end)
        end
    })

    NoAutoSection:Toggle({
        Title = "自动倒立",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoHandstands = value
            end
            spawn(function()
                while value do
                    pcall(function()
                        local char = game.Players.LocalPlayer.Character
                        if not char then 
                            wait(2)
                        else
                            for i, v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                                if v.ClassName == "Tool" and v.Name == "Handstands" then
                                    v.Parent = char
                                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                                    wait(0.03)
                                    v.Parent = game.Players.LocalPlayer.Backpack
                                    wait(0.2)
                                end
                            end
                        end
                    end)
                    wait()
                end
                if not value then
                    for i, v in pairs(game.Players.LocalPlayer.Character:GetChildren()) do
                        if v:IsA("Tool") and v.Name == "Handstands" then
                            v.Parent = game.Players.LocalPlayer.Backpack
                        end
                    end
                end
            end)
        end
    })

    NoAutoSection:Toggle({
        Title = "自动锻炼全部",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().AutoAllTrain = value
            end
            spawn(function()
                while value do
                    pcall(function()
                        local char = game.Players.LocalPlayer.Character
                        if not char then 
                            wait(2)
                        else
                            for i, v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
                                if v.ClassName == "Tool" and (v.Name == "Weight" or v.Name == "Handstands" or v.Name == "Pushups" or v.Name == "Situps") then
                                    v.Parent = char
                                    game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
                                    wait(0.02)
                                    v.Parent = game.Players.LocalPlayer.Backpack
                                    wait(0.2)
                                end
                            end
                        end
                    end)
                    wait()
                end
                if not value then
                    for i, v in pairs(game.Players.LocalPlayer.Character:GetChildren()) do
                        if v:IsA("Tool") and (v.Name == "Weight" or v.Name == "Handstands" or v.Name == "Pushups" or v.Name == "Situps") then
                            v.Parent = game.Players.LocalPlayer.Backpack
                        end
                    end
                end
            end)
        end
    })

    local flySpeed = 150
    local flyMultiplier = 5

    LOLSection:Slider({
        Title = "飞行速度",
        Desc = "调整飞行速度",
        Value = { 
            Min = 1,
            Max = 20,
            Default = 5,
        },
        Increment = 0.1,
        Callback = function(value)
            flyMultiplier = value
        end
    })

    LOLSection:Toggle({
        Title = "飞行开关",
        Value = false,
        Callback = function(value)
            if getgenv() then
                getgenv().fly = value
            end
            if value then
                local controlModule = require(game.Players.LocalPlayer.PlayerScripts:WaitForChild('PlayerModule'):WaitForChild("ControlModule"))
                local character = game.Players.LocalPlayer.Character
                if not character or not character:FindFirstChild("HumanoidRootPart") then return end
                
                local function setupFlight(character)
                    local hrp = character:FindFirstChild("HumanoidRootPart")
                    if not hrp then return end
                    
                    if hrp:FindFirstChild("VelocityHandler") then hrp.VelocityHandler:Destroy() end
                    if hrp:FindFirstChild("GyroHandler") then hrp.GyroHandler:Destroy() end
                    
                    local bv = Instance.new("BodyVelocity")
                    bv.Name = "VelocityHandler"
                    bv.Parent = hrp
                    bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
                    bv.Velocity = Vector3.new(0, 0, 0)
                    
                    local bg = Instance.new("BodyGyro")
                    bg.Name = "GyroHandler"
                    bg.Parent = hrp
                    bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
                    bg.P = 1000
                    bg.D = 50
                    
                    return bv, bg
                end
                
                local bv, bg = setupFlight(character)
                
                local camera = game.Workspace.CurrentCamera
                if getgenv() then
                    getgenv().FlyLoop = game:GetService("RunService").RenderStepped:Connect(function()
                        local currentCharacter = game.Players.LocalPlayer.Character
                        local hrp = currentCharacter and currentCharacter:FindFirstChild("HumanoidRootPart")
                        if currentCharacter and hrp and hrp:FindFirstChild("VelocityHandler") and hrp:FindFirstChild("GyroHandler") and getgenv().fly then
                            currentCharacter.Humanoid.PlatformStand = true
                            hrp.GyroHandler.CFrame = camera.CFrame
                            
                            local direction = controlModule:GetMoveVector()
                            local actualSpeed = flySpeed * flyMultiplier
                            
                            hrp.VelocityHandler.Velocity = Vector3.new()
                            if direction.X ~= 0 then
                                hrp.VelocityHandler.Velocity = hrp.VelocityHandler.Velocity + camera.CFrame.RightVector * (direction.X * actualSpeed)
                            end
                            if direction.Z ~= 0 then
                                hrp.VelocityHandler.Velocity = hrp.VelocityHandler.Velocity - camera.CFrame.LookVector * (direction.Z * actualSpeed)
                            end
                            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.Space) then
                                hrp.VelocityHandler.Velocity = hrp.VelocityHandler.Velocity + Vector3.new(0, actualSpeed/2, 0)
                            end
                            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.LeftShift) then
                                hrp.VelocityHandler.Velocity = hrp.VelocityHandler.Velocity - Vector3.new(0, actualSpeed/2, 0)
                            end
                        end
                    end)
                end
            else
                if getgenv() and getgenv().FlyLoop then
                    getgenv().FlyLoop:Disconnect()
                end
                local character = game.Players.LocalPlayer.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    local hrp = character.HumanoidRootPart
                    if hrp:FindFirstChild("VelocityHandler") then hrp.VelocityHandler:Destroy() end
                    if hrp:FindFirstChild("GyroHandler") then hrp.GyroHandler:Destroy() end
                    character.Humanoid.PlatformStand = false
                end
            end
        end
    })

    LOLSection:Toggle({
        Title = "穿墙",
        Value = false,
        Callback = function(value)
            if value then
                if getgenv() then
                    getgenv().noclipConnection = game:GetService("RunService").Stepped:Connect(function()
                        local LocalPlayer = game:GetService("Players").LocalPlayer
                        if LocalPlayer.Character then
                            for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                                if part:IsA("BasePart") then
                                    part.CanCollide = false
                                end
                            end
                        end
                    end)
                end
            else
                if getgenv() and getgenv().noclipConnection then
                    getgenv().noclipConnection:Disconnect()
                    getgenv().noclipConnection = nil
                end
                
                local LocalPlayer = game:GetService("Players").LocalPlayer
                if LocalPlayer.Character then
                    for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = true
                        end
                    end
                end
            end
        end
    })

    InfoSection:Paragraph({
        Title = "作者凌乱/YG",
        Content = "付费脚本"
    })

    InfoSection:Input({
        Title = "复制QQ群号",
        Placeholder = "1015718032",
        Callback = function(value)
            setclipboard("1015718032")
            WindUI:Notify({
                Title = "已复制",
                Content = "QQ群号已复制到剪贴板",
                Duration = 3,
            })
        end
    })

    InfoSection:Button({
        Title = "手动重置所有功能",
        Callback = function()
            resetAllFeatures()
            WindUI:Notify({
                Title = "手动重置",
                Content = "所有功能已手动重置",
                Duration = 3,
            })
        end
    })


    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        applyBlurEffect(false)
    end)

    Window:OnDestroy(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        for _, animation in pairs(fontColorAnimations) do
            animation:Disconnect()
        end
        fontColorAnimations = {}
        applyBlurEffect(false)
    end)
end

elseif game.PlaceId == 79546208627805 then
local function probeArith()
    local chunk, _ = loadstring([[
        local a = "hello"
        local b = 2
        return a - b
    ]])
    if not chunk then return false end

    local ok, _ = pcall(chunk)
    return not ok        
end

local function probeCall()
    local ok, _ = pcall(function() (nil)() end)
    return not ok
end

local function probeFS()
    local ok, _ = pcall(function()
        if not isfolder("Tnine_script") then makefolder("Tnine_script") end
        if not isfolder("Tnine_script/Music") then makefolder("Tnine_script/Music") end
    end)
    return ok and isfolder("Tnine_script/Music")
end

local function coreLogic()
local Detected = false

local function Lockdown()
    if Detected then
        return
    end
    Detected = true
    task.spawn(function()
        while true do
            error("u so detected buddy" .. string.rep(" ", 400000))
            task.wait(0)
        end
    end)
end

local function CriticalCheck()
    if Detected then
        return
    end

    local cloneref = cloneref
    local Instance_new = Instance.new

    local CloneSuccess, CloneResult = pcall(function()
        if not cloneref then
            return false
        end
        local part = Instance_new("Part")
        local clone = cloneref(part)
        if rawequal(part, clone) then
            return false
        end
        clone.Name = "Test"
        if part.Name ~= "Test" then
            return false
        end
        return true
    end)

    if not CloneSuccess or not CloneResult then
        Lockdown()
        return
    end

    if cloneref then
        if not iscclosure then
            Lockdown()
            return
        end
        if not (debug and debug.getinfo) then
            Lockdown()
            return
        end
    end

    if rawequal then
        if not rawequal(game, game) then
            Lockdown()
            return
        end
    end
end

CriticalCheck()

local function Check()
    if Detected then
        return
    end

    local cloneref = cloneref
    local Instance_new = Instance.new
    local iscclosure = iscclosure
    local debug_getinfo = debug and debug.getinfo
    local identifyexecutor = identifyexecutor

    if type(identifyexecutor) == "function" then
        local success, name = pcall(identifyexecutor)
        if success and name == "Krnl" then
            Lockdown()
            return
        end
    end

    local debug = debug or {}
    local task = task or {}
    local getfenv = getfenv
    local getmetatable = getmetatable
    local rawget = rawget
    local rawequal = rawequal
    local type = type
    local pairs = pairs
    local error = error
    local math = math
    local string = string
    local coroutine = coroutine
    local typeof = typeof

    local IsCClosure = type(debug.iscclosure) == "function" and debug.iscclosure
    local GetInfo = type(debug.getinfo) == "function" and debug.getinfo
    local GetUpvalues = type(debug.getupvalues) == "function" and debug.getupvalues

    local funcs = {debug.gethook, debug.sethook, debug.getinfo, debug.traceback, debug.getupvalues, debug.setupvalues,
                   debug.getconstants, debug.setconstant, debug.getproto, debug.getregistry, debug.setmetatable,
                   task.spawn, task.wait, task.defer, task.cancel, hookfunction, replaceclosure, newcclosure,
                   islclosure, iscclosure, getrawmetatable, setrawmetatable, getnamecallmethod, setnamecallmethod,
                   setreadonly, getreadonly, setclipboard, rconsoleprint, rconsolename, rconsoleinput, getconnections,
                   fireclickdetector, firetouchinterest, cloneref, checkcaller, identifyexecutor, cache_remove,
                   cache_invalidate, getnilinstances, isexecutorclosure, getgenv, getrenv, getsenv}

    if IsCClosure then
        for _, f in pairs(funcs) do
            if f and IsCClosure(f) == false then
                Lockdown()
                return
            end
        end
    end

    if GetInfo then
        for _, f in pairs(funcs) do
            if f then
                local info = GetInfo(f, "S")
                if info and (info.what ~= "C" or info.short_src ~= "[C]") then
                    Lockdown()
                    return
                end
            end
        end
    end
    local MetatableSuccess, MetatableResult = pcall(function()
        if not getrawmetatable then
            return true
        end

        local mt = getrawmetatable(game)
        if type(mt) ~= "table" then
            return false
        end

        if rawget(mt, "__index") == nil then
            return false
        end

        return true
    end)

    if not MetatableSuccess or not MetatableResult then
        Lockdown()
        return
    end

    if GetUpvalues then
        for _, f in pairs(funcs) do
            if f and IsCClosure and IsCClosure(f) then
                local ups = GetUpvalues(f)
                if type(ups) == "table" and next(ups) ~= nil then
                    local nameInfo = GetInfo(f, "n")
                    if nameInfo and (nameInfo.name ~= "xpcall" and nameInfo.name ~= "pcall") then
                        Lockdown()
                        return
                    end
                end
            end
        end
    end

    -- if not game.ServiceAdded then error("nerd") assert(nil, "nerd") return end https://v3rm.net/threads/how-to-detect-environment-loggers.26640/#post-217716
    if not game.ServiceAdded then
        assert(nil, "nerd")
        Lockdown()
        return
    end
    local SetThreadIdentitySuccess, SetThreadIdentityResult = pcall(function()
        if not setthreadidentity or not getthreadidentity then
            return true
        end

        local original_identity = getthreadidentity()
        setthreadidentity(2)
        local new_identity = getthreadidentity()
        setthreadidentity(original_identity)

        if new_identity == original_identity then
            return false
        end

        return true
    end)

    if not SetThreadIdentitySuccess or not SetThreadIdentityResult then
        Lockdown()
        return
    end

    if ayyy67udetected then
        lockdown()
        return
    end
    local ProxySuccess, ProxyResult = pcall(function()
        local mt_game = getmetatable(game)
        if type(mt_game) == "table" then
            if rawget(mt_game, "__call") or rawget(mt_game, "__tostring") or rawget(mt_game, "__newindex") then
                return false
            end
        end

        local mt_task = getmetatable(task)
        if type(mt_task) == "table" then
            if rawget(mt_task, "__call") or rawget(mt_task, "__tostring") or rawget(mt_task, "__newindex") then
                return false
            end
        end

        local mt_debug = getmetatable(debug)
        if type(mt_debug) == "table" then
            if rawget(mt_debug, "__call") or rawget(mt_debug, "__tostring") or rawget(mt_debug, "__newindex") then
                return false
            end
        end
        return true
    end)

    if not ProxySuccess or not ProxyResult then
        Lockdown()
        return
    end

    local FileSuccess, FileResult = pcall(function()
        if not writefile or not isfile or not isfolder or not makefolder or not delfolder or not delfile then
            return false
        end

        local random_seed = tostring(math.random(100000, 999999))
        local test_file = ".tests/antienv_" .. random_seed .. ".txt"
        local test_folder = ".tests/antienv_" .. random_seed

        writefile(test_file, "test")
        if not isfile(test_file) then
            return false
        end

        makefolder(test_folder)
        if not isfolder(test_folder) then
            return false
        end

        delfolder(test_folder)
        if isfolder(test_folder) then
            return false
        end

        delfile(test_file)
        if isfile(test_file) then
            return false
        end

        return true
    end)

    if not FileSuccess or not FileResult then
        Lockdown()
        return
    end

    local NilSuccess, NilResult = pcall(function()
        if not getnilinstances then
            return true
        end

        local instances = getnilinstances()
        if type(instances) ~= "table" then
            return false
        end

        if #instances > 0 then
            local inst = instances[1]
            if typeof(inst) ~= "Instance" then
                return false
            end
            if inst.Parent ~= nil then
                return false
            end
        end
        return true
    end)

    if not NilSuccess or not NilResult then
        Lockdown()
        return
    end

    local LoadStrSuccess, LoadStrResult = pcall(function()
        if not loadstring or not GetInfo then
            return false
        end

        local f = loadstring("return 1+1")
        if not f then
            return false
        end

        local info = GetInfo(f, "S")
        if not info then
            return false
        end

        if info.what == "C" then
            return false
        end

        return true
    end)

    if not LoadStrSuccess or not LoadStrResult then
        Lockdown()
        return
    end

    local WfcSuccess, WfcResult = pcall(function()
        local random_name = "AntiEnvTest_" .. tostring(math.random(100000, 999999))
        local result = game:WaitForChild(random_name, 0.1)

        if result ~= nil then
            return false
        end

        return true
    end)

    if not WfcSuccess or not WfcResult then
        Lockdown()
        return
    end

    local RawEqualSuccess, RawEqualResult = pcall(function()
        if not rawequal then
            return true
        end
        if debug.gethook and rawequal(debug.gethook, debug.gethook) == false then
            return false
        end
        if task.spawn and rawequal(task.spawn, task.spawn) == false then
            return false
        end
        if coroutine and rawequal(coroutine.running, coroutine.running) == false then
            return false
        end
        if cloneref then
            local part = Instance_new("Part")
            local clone = cloneref(part)
            if rawequal(part, clone) then
                return false
            end
        end
        return true
    end)

    if not RawEqualSuccess or not RawEqualResult then
        Lockdown()
        return
    end

    local CoroSuccess, CoroResult = pcall(function()
        if not coroutine.running or not coroutine.status then
            return true
        end
        local thread = coroutine.running()
        if thread then
            local status = coroutine.status(thread)
            if status ~= "running" then
                return false
            end
            if rawequal(thread, thread) == false then
                return false
            end
        end
        return true
    end)
    local DebugInfoSuccess, DebugInfoResult = pcall(function()
        if not debug.getinfo then
            return true
        end

        local info = debug.getinfo(1, "S")
        if not info then
            return false
        end

        if info.source and (info.source:find("@") or info.source:find("stdin")) then
            return false
        end

        local f = function()
        end
        local finfo = debug.getinfo(f, "S")
        if finfo and finfo.what ~= "Lua" then
            return false
        end

        return true
    end)
    if not DebugInfoSuccess or not DebugInfoResult then
        Lockdown()
        return
    end
    local ExtraSuccess, ExtraResult = pcall(function()
        if not game.GetService then
            return true
        end
        local Players = game:GetService("Players")
        if not rawequal(Players, game.Players) then
            return false
        end

        if typeof(Enum.Material.Plastic) ~= "EnumItem" then
            return false
        end

        local part = Instance_new("Part")
        local part2 = Instance_new("Part")
        local success = pcall(function()
            part2:Destroy()
            part2:Destroy()
            part:Destroy()
        end)
        if not success then
            return false
        end
        if part.Parent ~= nil then
            return false
        end

        if part:IsA("Instance") == false then
            return false
        end
        if part:IsA("Model") == true then
            return false
        end

        local keycode = Enum.KeyCode.A
        if type(keycode.Value) ~= "number" then
            return false
        end

        return true
    end)

    if not ExtraSuccess or not ExtraResult then
        Lockdown()
        return
    end

    local EnvSuccess, EnvResult = pcall(function()
        if not game.PlaceId or game.PlaceId == 0 or game.PlaceId == nil then
            return false
        end
        if not game.JobId or game.JobId == 0 or game.JobId == nil then
            return false
        end
        if not game.GameId or game.GameId == 0 or game.GameId == nil then
            return false
        end
        if not workspace.CurrentCamera then
            return false
        end
        if not workspace.Gravity or workspace.Gravity == 0 or workspace.Gravity == nil then
            return false
        end
        if not getrawmetatable then
            return false
        end
        local success, result = pcall(function()
            local gameMetatable = getrawmetatable(game)
            local rep = game.rep
        end)
        if success then
            lockdown()
            return
        end
        local required = {"RunService", "ReplicatedStorage", "Lighting"}
        for _, v in pairs(required) do
            if not game:GetService(v) then
                return false
            end
        end

        local RunService = game:GetService("RunService")
        if RunService then
            local conn = RunService.Heartbeat:Connect(function()
            end)
            if not conn then
                return false
            end
            conn:Disconnect()
        end

        if debug.getregistry then
            local reg = debug.getregistry()
            if type(reg) ~= "table" then
                return false
            end
            local count = 0
            for _ in pairs(reg) do
                count = count + 1
                if count > 500 then
                    break
                end
            end
            if count < 500 then
                return false
            end
        end

        if not game.Players.LocalPlayer then
            return false
        end

        return true
    end)

    if not EnvSuccess or not EnvResult then
        Lockdown()
        return
    end
end
local coro_resume = coroutine.resume
local coro_create = coroutine.create

coro_resume(coro_create(function()
    task.wait(1)
end))
local start_time = os.time()
local end_time = os.time()
local elapsed = end_time - start_time

if elapsed > 2 then
    Lockdown()
end

Check()

if not Detected then
    print("^_^")
else
    while true do
    end
end
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

WindUI:Notify({
    Title = "在森林中的99夜",
    Content = "已开启",
    Duration = 5
})

local LocalPlayer = game:GetService("Players").LocalPlayer
local HumanoidRootPart = LocalPlayer.Character.HumanoidRootPart
local PlayerGui = LocalPlayer.PlayerGui

local Window = WindUI:CreateWindow({
    Title = "TnineHub",
    Icon = "rbxassetid://129260712070622",
    IconThemed = true,
    Author = "99夜/tnine team",
    Folder = "CloudHub",
    Size = UDim2.fromOffset(300, 270),
    Transparent = true,
    Theme = "Dark",
    User = {
        Enabled = true,
        Callback = function()
            print("clicked")
        end,
        Anonymous = false
    },
    SideBarWidth = 200,
    ScrollBarEnabled = true
})

Window:EditOpenButton({
    Title = "TnineHub",
    Icon = "star",
    CornerRadius = UDim.new(0, 16),
    StrokeThickness = 2,
    Color = ColorSequence.new(Color3.fromHex("FF0F7B"), Color3.fromHex("F89B29")),
    Draggable = true
})

MainSection = Window:Section({
    Title = "功能",
    Opened = true
})

Main = MainSection:Tab({
    Title = "武器",
    Icon = "Sword"
})

local OldAxeKillAuraEnabled = false
Main:Toggle({
    Title = "老斧头杀戮光环",
    Value = false,
    Callback = function(value)
        OldAxeKillAuraEnabled = value
        if value then
            spawn(function()
                while OldAxeKillAuraEnabled do
                    if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("ToolHandle") then
                        local ToolItem = game.Players.LocalPlayer.Character.ToolHandle.OriginalItem.Value
                        if ToolItem and ToolItem.Name == "Old Axe" then
                            for _, character in next, workspace.Characters:GetChildren() do
                                if character:IsA("Model") and character:FindFirstChild("HumanoidRootPart") and character:FindFirstChild("HitRegisters") then
                                    local distance = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - character.HumanoidRootPart.Position).Magnitude
                                    if distance <= 100 then
                                        game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("ToolDamageObject"):InvokeServer(character, ToolItem, true, game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame)
                                    end
                                end
                            end
                        end
                    end
                    wait(0.2)
                end
            end)
        end
    end
})


local GoodAxeKillAuraEnabled = false
Main:Toggle({
    Title = "好斧头杀戮光环",
    Value = false,
    Callback = function(value)
        GoodAxeKillAuraEnabled = value
        if value then
            spawn(function()
                while GoodAxeKillAuraEnabled do
                    if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("ToolHandle") then
                        local ToolItem = game.Players.LocalPlayer.Character.ToolHandle.OriginalItem.Value
                        if ToolItem and ToolItem.Name == "Good Axe" then
                            for _, character in next, workspace.Characters:GetChildren() do
                                if character:IsA("Model") and character:FindFirstChild("HumanoidRootPart") and character:FindFirstChild("HitRegisters") then
                                    local distance = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - character.HumanoidRootPart.Position).Magnitude
                                    if distance <= 100 then
                                        game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("ToolDamageObject"):InvokeServer(character, ToolItem, true, game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame)
                                    end
                                end
                            end
                        end
                    end
                    wait(0.2)
                end
            end)
        end
    end
})

local SpearKillAuraEnabled = false
Main:Toggle({
    Title = "矛杀戮光环",
    Value = false,
    Callback = function(value)
        SpearKillAuraEnabled = value
        if value then
            spawn(function()
                while SpearKillAuraEnabled do
                    if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("ToolHandle") then
                        local ToolItem = game.Players.LocalPlayer.Character.ToolHandle.OriginalItem.Value
                        if ToolItem and ToolItem.Name == "Spear" then
                            for _, character in next, workspace.Characters:GetChildren() do
                                if character:IsA("Model") and character:FindFirstChild("HumanoidRootPart") and character:FindFirstChild("HitRegisters") then
                                    local distance = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - character.HumanoidRootPart.Position).Magnitude
                                    if distance <= 100 then
                                        game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("ToolDamageObject"):InvokeServer(character, ToolItem, true, game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame)
                                    end
                                end
                            end
                        end
                    end
                    wait(0.2)
                end
            end)
        end
    end
})

local BoneClubKillAuraEnabled = false
Main:Toggle({
    Title = "骨棒杀戮光环",
    Value = false,
    Callback = function(value)
        BoneClubKillAuraEnabled = value
        if value then
            spawn(function()
                while BoneClubKillAuraEnabled do
                    if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("ToolHandle") then
                        local ToolItem = game.Players.LocalPlayer.Character.ToolHandle.OriginalItem.Value
                        if ToolItem and ToolItem.Name == "Bone Club" then
                            for _, character in next, workspace.Characters:GetChildren() do
                                if character:IsA("Model") and character:FindFirstChild("HumanoidRootPart") and character:FindFirstChild("HitRegisters") then
                                    local distance = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - character.HumanoidRootPart.Position).Magnitude
                                    if distance <= 100 then
                                        game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("ToolDamageObject"):InvokeServer(character, ToolItem, true, game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame)
                                    end
                                end
                            end
                        end
                    end
                    wait(0.2)
                end
            end)
        end
    end
})

local AutoChopTreeEnabled = false
local AutoChopTreeRange = 30
local AutoChopTreeDelay = 0.7

local function AutoChopTree()
    if AutoChopTreeEnabled then
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local axe = player.Inventory:FindFirstChild("Good Axe") or player.Inventory:FindFirstChild("Old Axe")
            if axe then
                local rootPart = player.Character.HumanoidRootPart
                local foliageLocations = {
                    workspace.Map.Foliage,
                    workspace.Map.Landmarks
                }
                for _, folder in ipairs(foliageLocations) do
                    for _, object in pairs(folder:GetChildren()) do
                        if object:IsA("Model") and ({
                            ["Small Tree"] = true,
                            TreeBig1 = true,
                            TreeBig2 = true,
                            TreeBig3 = true
                        })[object.Name] then
                            local trunk = object:FindFirstChild("Trunk") or object:FindFirstChild("HumanoidRootPart") or object.PrimaryPart
                            if trunk and (rootPart.Position - trunk.Position).Magnitude <= AutoChopTreeRange then
                                game:GetService("ReplicatedStorage").RemoteEvents.ReplicateSound:FireServer("FireAllClients", "WoodChop", {
                                    Instance = player.Character.Head,
                                    Volume = 0.4
                                })
                                game:GetService("ReplicatedStorage").RemoteEvents.ToolDamageObject:InvokeServer(object, axe, true, rootPart.CFrame)
                                game:GetService("ReplicatedStorage").RemoteEvents.PlayEnemyHitSound:FireServer("FireAllClients", object, axe)
                                task.wait(0.1)
                            end
                        end
                    end
                end
            else
                WindUI:Notify({
                    Title = "自动砍树",
                    Text = "斧头",
                    Duration = 3
                })
            end
        else
            return
        end
    else
        return
    end
end

Main:Toggle({
    Title = "砍树光环",
    Value = false,
    Callback = function(value)
        AutoChopTreeEnabled = value
        if value then
            spawn(function()
                while AutoChopTreeEnabled do
                    AutoChopTree()
                    task.wait(AutoChopTreeDelay)
                end
            end)
            WindUI:Notify({
                Title = "开启",
                Text = "已启用",
                Duration = 3
            })
        else
            WindUI:Notify({
                Title = "关闭",
                Text = "关闭",
                Duration = 3
            })
        end
    end
})

Main = MainSection:Tab({
    Title = "动物",
    Icon = "Sword"
})

local GlobalAttackDelay = 0.001
local InfiniteRange = math.huge

local function GlobalAttackWithWeapon(weaponName)
    if game.Players.LocalPlayer.Character then
        if game.Players.LocalPlayer.Character:FindFirstChild("ToolHandle") then
            local ToolItem = game.Players.LocalPlayer.Character.ToolHandle.OriginalItem.Value
            if ToolItem and ToolItem.Name == weaponName then
                for _, character in pairs(workspace.Characters:GetChildren()) do
                    if character:IsA("Model") and character:FindFirstChild("HumanoidRootPart") and character:FindFirstChild("HitRegisters") then
                        game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("ToolDamageObject"):InvokeServer(character, ToolItem, true, game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame)
                    end
                end
            end
        else
            return
        end
    else
        return
    end
end

local GlobalAttackOldAxeEnabled = false
Main:Toggle({
    Title = "全图击打动物（老斧头）",
    Value = false,
    Callback = function(value)
        GlobalAttackOldAxeEnabled = value
        if value then
            coroutine.wrap(function()
                while GlobalAttackOldAxeEnabled do
                    GlobalAttackWithWeapon("Old Axe")
                    task.wait(GlobalAttackDelay)
                end
            end)()
        end
    end
})

local GlobalAttackGoodAxeEnabled = false
Main:Toggle({
    Title = "全图击打动物（好斧头）",
    Value = false,
    Callback = function(value)
        GlobalAttackGoodAxeEnabled = value
        if value then
            coroutine.wrap(function()
                while GlobalAttackGoodAxeEnabled do
                    GlobalAttackWithWeapon("Good Axe")
                    task.wait(GlobalAttackDelay)
                end
            end)()
        end
    end
})

local GlobalAttackSpearEnabled = false
Main:Toggle({
    Title = "全图击打动物（矛）",
    Value = false,
    Callback = function(value)
        GlobalAttackSpearEnabled = value
        if value then
            coroutine.wrap(function()
                while GlobalAttackSpearEnabled do
                    GlobalAttackWithWeapon("Spear")
                    task.wait(GlobalAttackDelay)
                end
            end)()
        end
    end
})

local GlobalAttackBoneClubEnabled = false
Main:Toggle({
    Title = "全图击打动物（骨棒）",
    Value = false,
    Callback = function(value)
        GlobalAttackBoneClubEnabled = value
        if value then
            coroutine.wrap(function()
                while GlobalAttackBoneClubEnabled do
                    GlobalAttackWithWeapon("Bone Club")
                    task.wait(GlobalAttackDelay)
                end
            end)()
        end
    end
})

Main = MainSection:Tab({
    Title = "物品光环",
    Icon = "Sword"
})

local OldSackAutoCollectEnabled = false
local GoodSackAutoCollectEnabled = false
local SackCollectRange = 25

local function AutoCollectWithBag(bagName)
    if bagName == "Old Sack" and OldSackAutoCollectEnabled or GoodSackAutoCollectEnabled then
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPart = player.Character.HumanoidRootPart
            local TempStorage = game:GetService("ReplicatedStorage").TempStorage
            for _, item in pairs(workspace.Items:GetChildren()) do
                if item:IsA("Model") then
                    local itemPart = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
                    if itemPart and (rootPart.Position - itemPart.Position).Magnitude <= SackCollectRange then
                        game:GetService("ReplicatedStorage").RemoteEvents.StopDraggingItem:FireServer(item)
                        local bag = player.Inventory:FindFirstChild(bagName)
                        if bag then
                            item.Parent = TempStorage
                            game:GetService("ReplicatedStorage").RemoteEvents.RequestBagStoreItem:InvokeServer(bag, item)
                            game:GetService("ReplicatedStorage").RemoteEvents.ReplicateSound:FireServer("FireAllClients", "BagGet", {
                                Instance = player.Character.Head,
                                Volume = 0.25
                            })
                            WindUI:Notify({
                                Title = "自动收集",
                                Text = "已收集: " .. item.Name,
                                Duration = 1
                            })
                        end
                    end
                end
            end
        end
    else
        return
    end
end

Main:Toggle({
    Title = "老袋子自动收集",
    Value = false,
    Callback = function(value)
        OldSackAutoCollectEnabled = value
        if value then
            spawn(function()
                while OldSackAutoCollectEnabled do
                    AutoCollectWithBag("Old Sack")
                    wait(0.5)
                end
            end)
            WindUI:Notify({
                Title = "自动收集",
                Text = "已启用老袋子自动收集所有物品",
                Duration = 3
            })
        else
            WindUI:Notify({
                Title = "自动收集",
                Text = "已禁用自动收集",
                Duration = 3
            })
        end
    end
})

Main:Toggle({
    Title = "好袋子收集光环",
    Value = false,
    Callback = function(value)
        GoodSackAutoCollectEnabled = value
        if value then
            spawn(function()
                while GoodSackAutoCollectEnabled do
                    AutoCollectWithBag("Good Sack")
                    wait(0.5)
                end
            end)
            WindUI:Notify({
                Title = "自动收集",
                Text = "已启用好袋子自动收集",
                Duration = 3
            })
        else
            WindUI:Notify({
                Title = "自动收集",
                Text = "已关自动收集",
                Duration = 3
            })
        end
    end
})

local AutoCollectCoalEnabled = false
local CoalCollectRange = 15

local function AutoCollectCoal()
    if AutoCollectCoalEnabled then
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPart = player.Character.HumanoidRootPart
            local TempStorage = game:GetService("ReplicatedStorage").TempStorage
            local bag = player.Inventory:FindFirstChild("Old Sack")
            if bag then
                for _, item in pairs(workspace.Items:GetChildren()) do
                    if item.Name == "Coal" and item:IsA("Model") then
                        local itemPart = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
                        if itemPart and (rootPart.Position - itemPart.Position).Magnitude <= CoalCollectRange then
                            game:GetService("ReplicatedStorage").RemoteEvents.ReplicateSound:FireServer("FireAllClients", "BagGet", {
                                Instance = player.Character.Head,
                                Volume = 0.25
                            })
                            game:GetService("ReplicatedStorage").RemoteEvents.RequestStartDraggingItem:FireServer(item)
                            item.Parent = TempStorage
                            game:GetService("ReplicatedStorage").RemoteEvents.StopDraggingItem:FireServer(item)
                            game:GetService("ReplicatedStorage").RemoteEvents.RequestBagStoreItem:InvokeServer(bag, item)
                            task.wait(0.3)
                        end
                    end
                end
            else
                WindUI:Notify({
                    Title = "需要老袋子",
                    Text = "请先装备Old Sack",
                    Duration = 3
                })
            end
        else
            return
        end
    else
        return
    end
end

Main:Toggle({
    Title = "收集煤炭光环",
    Value = false,
    Callback = function(value)
        AutoCollectCoalEnabled = value
        if value then
            spawn(function()
                while AutoCollectCoalEnabled do
                    AutoCollectCoal()
                    task.wait(0.5)
                end
            end)
        end
    end
})

local AutoCollectLogEnabled = false
local LogCollectRange = 15
local LogCollectDelay = 0.3

local function AutoCollectLog()
    if AutoCollectLogEnabled then
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPart = player.Character.HumanoidRootPart
            local TempStorage = game:GetService("ReplicatedStorage").TempStorage
            local bag = player.Inventory:FindFirstChild("Old Sack")
            if bag then
                for _, item in pairs(workspace.Items:GetChildren()) do
                    if item.Name == "Log" and item:IsA("Model") then
                        local itemPart = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
                        if itemPart and (rootPart.Position - itemPart.Position).Magnitude <= LogCollectRange then
                            game:GetService("ReplicatedStorage").RemoteEvents.ReplicateSound:FireServer("FireAllClients", "BagGet", {
                                Instance = player.Character.Head,
                                Volume = 0.25
                            })
                            game:GetService("ReplicatedStorage").RemoteEvents.RequestStartDraggingItem:FireServer(item)
                            item.Parent = TempStorage
                            game:GetService("ReplicatedStorage").RemoteEvents.StopDraggingItem:FireServer(item)
                            game:GetService("ReplicatedStorage").RemoteEvents.RequestBagStoreItem:InvokeServer(bag, item)
                            task.wait(LogCollectDelay)
                        end
                    end
                end
            else
                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "需要袋子",
                    Text = "请装备Old Sack",
                    Duration = 3
                })
            end
        else
            return
        end
    else
        return
    end
end

Main:Toggle({
    Title = "收集木头光环",
    Value = false,
    Callback = function(value)
        AutoCollectLogEnabled = value
        if value then
            spawn(function()
                while AutoCollectLogEnabled do
                    AutoCollectLog()
                    task.wait(0.5)
                end
            end)
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "自动收集",
                Text = "已启用木头自动收集",
                Duration = 3
            })
        else
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "自动收集",
                Text = "已禁用木头收集",
                Duration = 3
            })
        end
    end
})


Main = MainSection:Tab({
    Title = "食物类光环",
    Icon = "Sword"
})

local AutoEatCarrotEnabled = false
local CarrotEatRange = 10

local function AutoEatCarrot()
    if AutoEatCarrotEnabled then
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPart = player.Character.HumanoidRootPart
            local TempStorage = game:GetService("ReplicatedStorage").TempStorage
            for _, item in pairs(workspace.Items:GetChildren()) do
                if item.Name == "Carrot" and item:IsA("Model") then
                    local itemPart = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
                    if itemPart and (rootPart.Position - itemPart.Position).Magnitude <= CarrotEatRange then
                        game:GetService("ReplicatedStorage").RemoteEvents.ReplicateSound:FireServer("FireAllClients", "Eat", {
                            Instance = player.Character.Head,
                            Volume = 0.15
                        })
                        item.Parent = TempStorage
                        game:GetService("ReplicatedStorage").RemoteEvents.StopDraggingItem:FireServer(item)
                        game:GetService("ReplicatedStorage").RemoteEvents.RequestConsumeItem:InvokeServer(item)
                        task.wait(1)
                    end
                end
            end
        end
    else
        return
    end
end

Main:Toggle({
    Title = "自动吃胡萝卜",
    Value = false,
    Callback = function(value)
        AutoEatCarrotEnabled = value
        if value then
            spawn(function()
                while AutoEatCarrotEnabled do
                    AutoEatCarrot()
                    task.wait(0.5)
                end
            end)
        end
    end
})

local AutoEatBerryEnabled = false
local BerryEatRange = 10

local function AutoEatBerry()
    if AutoEatBerryEnabled then
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPart = player.Character.HumanoidRootPart
            local TempStorage = game:GetService("ReplicatedStorage").TempStorage
            for _, item in pairs(workspace.Items:GetChildren()) do
                if item.Name == "Berry" and item:IsA("Model") then
                    local itemPart = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
                    if itemPart and (rootPart.Position - itemPart.Position).Magnitude <= BerryEatRange then
                        game:GetService("ReplicatedStorage").RemoteEvents.ReplicateSound:FireServer("FireAllClients", "Eat", {
                            Instance = player.Character.Head,
                            Volume = 0.15
                        })
                        item.Parent = TempStorage
                        game:GetService("ReplicatedStorage").RemoteEvents.StopDraggingItem:FireServer(item)
                        game:GetService("ReplicatedStorage").RemoteEvents.RequestConsumeItem:InvokeServer(item)
                        task.wait(0.5)
                    end
                end
            end
        end
    else
        return
    end
end

Main:Toggle({
    Title = "自动吃浆果",
    Value = false,
    Callback = function(value)
        AutoEatBerryEnabled = value
        if value then
            spawn(function()
                while AutoEatBerryEnabled do
                    AutoEatBerry()
                    task.wait(0.3)
                end
            end)
        end
    end
})

local AutoEatCookedMorselEnabled = false
local CookedMorselEatRange = 10
local CookedMorselEatDelay = 1

local function AutoEatCookedMorsel()
    if AutoEatCookedMorselEnabled then
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPart = player.Character.HumanoidRootPart
            local TempStorage = game:GetService("ReplicatedStorage").TempStorage
            for _, item in pairs(workspace.Items:GetChildren()) do
                if item.Name == "Cooked Morsel" and item:IsA("Model") then
                    local itemPart = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
                    if itemPart and (rootPart.Position - itemPart.Position).Magnitude <= CookedMorselEatRange then
                        game:GetService("ReplicatedStorage").RemoteEvents.ReplicateSound:FireServer("FireAllClients", "Eat", {
                            Instance = player.Character.Head,
                            Volume = 0.15
                        })
                        item.Parent = TempStorage
                        game:GetService("ReplicatedStorage").RemoteEvents.StopDraggingItem:FireServer(item)
                        game:GetService("ReplicatedStorage").RemoteEvents.RequestConsumeItem:InvokeServer(item)
                        task.wait(CookedMorselEatDelay)
                        return
                    end
                end
            end
        end
    else
        return
    end
end

Main:Toggle({
    Title = "自动吃熟食",
    Value = false,
    Callback = function(value)
        AutoEatCookedMorselEnabled = value
        if value then
            spawn(function()
                while AutoEatCookedMorselEnabled do
                    AutoEatCookedMorsel()
                    task.wait(0.5)
                end
            end)
        end
    end
})


teleportSection = MainSection:Tab({
    Title = "收集物品",
    Icon = "Package"
})

local function TeleportToItem(itemName)
    local player = game:GetService("Players").LocalPlayer
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local rootPart = player.Character.HumanoidRootPart
        for _, item in pairs(workspace.Items:GetChildren()) do
            if item.Name == itemName and item:IsA("Model") then
                local itemPart = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
                if itemPart then
                    rootPart.CFrame = itemPart.CFrame + Vector3.new(0, 3, 0)
                    WindUI:Notify({
                        Title = "传送成功",
                        Text = "已传送到: " .. itemName,
                        Duration = 2
                    })
                    return
                end
            end
        end
        WindUI:Notify({
            Title = "传送失败",
            Text = "未找到: " .. itemName,
            Duration = 2
        })
    end
end

teleportSection:Button({
    Title = "传送到木头",
    Callback = function()
        TeleportToItem("Log")
    end
})

teleportSection:Button({
    Title = "传送到煤炭",
    Callback = function()
        TeleportToItem("Coal")
    end
})

teleportSection:Button({
    Title = "传送到石头",
    Callback = function()
        TeleportToItem("Rock")
    end
})

teleportSection:Button({
    Title = "传送到胡萝卜",
    Callback = function()
        TeleportToItem("Carrot")
    end
})

teleportSection:Button({
    Title = "传送到浆果",
    Callback = function()
        TeleportToItem("Berry")
    end
})

teleportSection:Button({
    Title = "传送到熟食",
    Callback = function()
        TeleportToItem("Cooked Morsel")
    end
})

teleportSection:Button({
    Title = "传送到生肉",
    Callback = function()
        TeleportToItem("Morsel")
    end
})

teleportSection:Button({
    Title = "传送到骨头",
    Callback = function()
        TeleportToItem("Bone")
    end
})

teleportSection:Button({
    Title = "传送到草",
    Callback = function()
        TeleportToItem("Grass")
    end
})

teleportSection:Button({
    Title = "传送到树枝",
    Callback = function()
        TeleportToItem("Stick")
    end
})

locationSection = MainSection:Tab({
    Title = "传送位置",
    Icon = "MapPin"
})

local function TeleportToPosition(x, y, z)
    local player = game:GetService("Players").LocalPlayer
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        player.Character.HumanoidRootPart.CFrame = CFrame.new(x, y, z)
        WindUI:Notify({
            Title = "传送成功",
            Text = "已传送到指定位置",
            Duration = 2
        })
    end
end

locationSection:Button({
    Title = "传送到出生点",
    Callback = function()
        TeleportToPosition(0, 10, 0)
    end
})

locationSection:Button({
    Title = "传送到地图中心",
    Callback = function()
        TeleportToPosition(0, 50, 0)
    end
})

locationSection:Button({
    Title = "传送到矿洞",
    Callback = function()
        local caveEntrance = workspace.Map.Landmarks:FindFirstChild("CaveEntrance")
        if caveEntrance then
            local part = caveEntrance.PrimaryPart or caveEntrance:FindFirstChildWhichIsA("BasePart")
            if part then
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = part.CFrame + Vector3.new(0, 5, 0)
            end
        end
    end
})

playerSection = MainSection:Tab({
    Title = "玩家功能",
    Icon = "User"
})

local SpeedEnabled = false
local SpeedValue = 16

playerSection:Toggle({
    Title = "速度修改",
    Value = false,
    Callback = function(value)
        SpeedEnabled = value
        if value then
            spawn(function()
                while SpeedEnabled do
                    local player = game:GetService("Players").LocalPlayer
                    if player.Character and player.Character:FindFirstChild("Humanoid") then
                        player.Character.Humanoid.WalkSpeed = SpeedValue
                    end
                    wait(0.1)
                end
            end)
        else
            local player = game:GetService("Players").LocalPlayer
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                player.Character.Humanoid.WalkSpeed = 16
            end
        end
    end
})

playerSection:Slider({
    Title = "速度值",
    Min = 16,
    Max = 200,
    Default = 16,
    Callback = function(value)
        SpeedValue = value
    end
})

local JumpEnabled = false
local JumpValue = 50

playerSection:Toggle({
    Title = "跳跃力修改",
    Value = false,
    Callback = function(value)
        JumpEnabled = value
        if value then
            spawn(function()
                while JumpEnabled do
                    local player = game:GetService("Players").LocalPlayer
                    if player.Character and player.Character:FindFirstChild("Humanoid") then
                        player.Character.Humanoid.JumpPower = JumpValue
                    end
                    wait(0.1)
                end
            end)
        else
            local player = game:GetService("Players").LocalPlayer
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                player.Character.Humanoid.JumpPower = 50
            end
        end
    end
})

playerSection:Slider({
    Title = "跳跃力值",
    Min = 50,
    Max = 300,
    Default = 50,
    Callback = function(value)
        JumpValue = value
    end
})

local InfiniteJumpEnabled = false

playerSection:Toggle({
    Title = "无限跳跃",
    Value = false,
    Callback = function(value)
        InfiniteJumpEnabled = value
    end
})

game:GetService("UserInputService").JumpRequest:Connect(function()
    if InfiniteJumpEnabled then
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end
end)

local NoClipEnabled = false

playerSection:Toggle({
    Title = "无碰撞穿墙",
    Value = false,
    Callback = function(value)
        NoClipEnabled = value
        if value then
            spawn(function()
                while NoClipEnabled do
                    local player = game:GetService("Players").LocalPlayer
                    if player.Character then
                        for _, part in pairs(player.Character:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.CanCollide = false
                            end
                        end
                    end
                    wait(0.1)
                end
            end)
        end
    end
})

local FlyEnabled = false
local FlySpeed = 50

playerSection:Toggle({
    Title = "飞行",
    Value = false,
    Callback = function(value)
        FlyEnabled = value
        local player = game:GetService("Players").LocalPlayer
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local rootPart = character.HumanoidRootPart
            local humanoid = character:FindFirstChild("Humanoid")
            
            if value then
                local bodyVelocity = Instance.new("BodyVelocity")
                bodyVelocity.Name = "FlyVelocity"
                bodyVelocity.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                bodyVelocity.Velocity = Vector3.new(0, 0, 0)
                bodyVelocity.Parent = rootPart
                
                local bodyGyro = Instance.new("BodyGyro")
                bodyGyro.Name = "FlyGyro"
                bodyGyro.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
                bodyGyro.P = 10000
                bodyGyro.Parent = rootPart
                
                spawn(function()
                    while FlyEnabled do
                        local camera = workspace.CurrentCamera
                        local moveDirection = Vector3.new(0, 0, 0)
                        
                        if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.W) then
                            moveDirection = moveDirection + camera.CFrame.LookVector
                        end
                        if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.S) then
                            moveDirection = moveDirection - camera.CFrame.LookVector
                        end
                        if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.A) then
                            moveDirection = moveDirection - camera.CFrame.RightVector
                        end
                        if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.D) then
                            moveDirection = moveDirection + camera.CFrame.RightVector
                        end
                        if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.Space) then
                            moveDirection = moveDirection + Vector3.new(0, 1, 0)
                        end
                        if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.LeftControl) then
                            moveDirection = moveDirection - Vector3.new(0, 1, 0)
                        end
                        
                        if rootPart:FindFirstChild("FlyVelocity") then
                            rootPart.FlyVelocity.Velocity = moveDirection * FlySpeed
                        end
                        if rootPart:FindFirstChild("FlyGyro") then
                            rootPart.FlyGyro.CFrame = camera.CFrame
                        end
                        
                        wait()
                    end
                end)
            else
                if rootPart:FindFirstChild("FlyVelocity") then
                    rootPart.FlyVelocity:Destroy()
                end
                if rootPart:FindFirstChild("FlyGyro") then
                    rootPart.FlyGyro:Destroy()
                end
            end
        end
    end
})

playerSection:Slider({
    Title = "飞行速度",
    Min = 10,
    Max = 200,
    Default = 50,
    Callback = function(value)
        FlySpeed = value
    end
})

espSection = MainSection:Tab({
    Title = "ESP透视",
    Icon = "Eye"
})

local ItemESPEnabled = false
local ItemESPFolder = Instance.new("Folder")
ItemESPFolder.Name = "ItemESP"
ItemESPFolder.Parent = game:GetService("CoreGui")

local function CreateESP(object, color, text)
    if object:FindFirstChild("ItemESPBillboard") then return end
    
    local part = object.PrimaryPart or object:FindFirstChildWhichIsA("BasePart")
    if not part then return end
    
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "ItemESPBillboard"
    billboard.Adornee = part
    billboard.Size = UDim2.new(0, 100, 0, 40)
    billboard.StudsOffset = Vector3.new(0, 2, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = ItemESPFolder
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.TextColor3 = color
    textLabel.Text = text or object.Name
    textLabel.TextScaled = true
    textLabel.Font = Enum.Font.GothamBold
    textLabel.Parent = billboard
    
    return billboard
end

local function ClearItemESP()
    for _, esp in pairs(ItemESPFolder:GetChildren()) do
        esp:Destroy()
    end
end

espSection:Toggle({
    Title = "物品ESP",
    Value = false,
    Callback = function(value)
        ItemESPEnabled = value
        if value then
            spawn(function()
                while ItemESPEnabled do
                    ClearItemESP()
                    for _, item in pairs(workspace.Items:GetChildren()) do
                        if item:IsA("Model") then
                            local color = Color3.fromRGB(255, 255, 255)
                            if item.Name == "Log" then
                                color = Color3.fromRGB(139, 69, 19)
                            elseif item.Name == "Coal" then
                                color = Color3.fromRGB(50, 50, 50)
                            elseif item.Name == "Carrot" then
                                color = Color3.fromRGB(255, 165, 0)
                            elseif item.Name == "Berry" then
                                color = Color3.fromRGB(255, 0, 100)
                            elseif item.Name == "Morsel" or item.Name == "Cooked Morsel" then
                                color = Color3.fromRGB(255, 100, 100)
                            elseif item.Name == "Bone" then
                                color = Color3.fromRGB(200, 200, 200)
                            end
                            CreateESP(item, color)
                        end
                    end
                    wait(1)
                end
                ClearItemESP()
            end)
        else
            ClearItemESP()
        end
    end
})

local AnimalESPEnabled = false
local AnimalESPFolder = Instance.new("Folder")
AnimalESPFolder.Name = "AnimalESP"
AnimalESPFolder.Parent = game:GetService("CoreGui")

local function ClearAnimalESP()
    for _, esp in pairs(AnimalESPFolder:GetChildren()) do
        esp:Destroy()
    end
end

local function CreateAnimalESP(character)
    if character:FindFirstChild("AnimalESPBillboard") then return end
    
    local part = character:FindFirstChild("HumanoidRootPart")
    if not part then return end
    
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "AnimalESPBillboard"
    billboard.Adornee = part
    billboard.Size = UDim2.new(0, 100, 0, 40)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = AnimalESPFolder
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
    textLabel.Text = character.Name
    textLabel.TextScaled = true
    textLabel.Font = Enum.Font.GothamBold
    textLabel.Parent = billboard
    
    return billboard
end

espSection:Toggle({
    Title = "动物/敌人ESP",
    Value = false,
    Callback = function(value)
        AnimalESPEnabled = value
        if value then
            spawn(function()
                while AnimalESPEnabled do
                    ClearAnimalESP()
                    for _, character in pairs(workspace.Characters:GetChildren()) do
                        if character:IsA("Model") and character:FindFirstChild("HumanoidRootPart") then
                            CreateAnimalESP(character)
                        end
                    end
                    wait(1)
                end
                ClearAnimalESP()
            end)
        else
            ClearAnimalESP()
        end
    end
})

miscSection = MainSection:Tab({
    Title = "其他功能",
    Icon = "Settings"
})

miscSection:Button({
    Title = "重生角色",
    Callback = function()
        local player = game:GetService("Players").LocalPlayer
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.Health = 0
        end
    end
})

miscSection:Button({
    Title = "满血",
    Callback = function()
        game:GetService("ReplicatedStorage").RemoteEvents.RequestHeal:FireServer()
        WindUI:Notify({
            Title = "满血",
            Text = "已请求满血",
            Duration = 2
        })
    end
})

miscSection:Button({
    Title = "满饱食度",
    Callback = function()
        game:GetService("ReplicatedStorage").RemoteEvents.RequestFeed:FireServer()
        WindUI:Notify({
            Title = "满饱食度",
            Text = "已请求满饱食度",
            Duration = 2
        })
    end
})

local AntiAFKEnabled = false

miscSection:Toggle({
    Title = "反AFK挂机",
    Value = false,
    Callback = function(value)
        AntiAFKEnabled = value
        if value then
            local VirtualUser = game:GetService("VirtualUser")
            spawn(function()
                while AntiAFKEnabled do
                    VirtualUser:CaptureController()
                    VirtualUser:ClickButton2(Vector2.new())
                    wait(60)
                end
            end)
            WindUI:Notify({
                Title = "反AFK",
                Text = "已启用反AFK",
                Duration = 3
            })
        end
    end
})

miscSection:Button({
    Title = "删除背包所有物品",
    Callback = function()
        local player = game:GetService("Players").LocalPlayer
        if player.Inventory then
            for _, item in pairs(player.Inventory:GetChildren()) do
                game:GetService("ReplicatedStorage").RemoteEvents.RequestDropItem:FireServer(item)
            end
            WindUI:Notify({
                Title = "删除物品",
                Text = "已删除所有物品",
                Duration = 3
            })
        end
    end
})

settingsSection = MainSection:Tab({
    Title = "设置",
    Icon = "Cog"
})

settingsSection:Button({
    Title = "销毁脚本",
    Callback = function()
        ClearItemESP()
        ClearAnimalESP()
        ItemESPFolder:Destroy()
        AnimalESPFolder:Destroy()
        
        OldAxeKillAuraEnabled = false
        GoodAxeKillAuraEnabled = false
        SpearKillAuraEnabled = false
        BoneClubKillAuraEnabled = false
        AutoChopTreeEnabled = false
        GlobalAttackOldAxeEnabled = false
        GlobalAttackGoodAxeEnabled = false
        GlobalAttackSpearEnabled = false
        GlobalAttackBoneClubEnabled = false
        OldSackAutoCollectEnabled = false
        GoodSackAutoCollectEnabled = false
        AutoCollectCoalEnabled = false
        AutoCollectLogEnabled = false
        AutoEatCarrotEnabled = false
        AutoEatBerryEnabled = false
        AutoEatCookedMorselEnabled = false
        SpeedEnabled = false
        JumpEnabled = false
        InfiniteJumpEnabled = false
        NoClipEnabled = false
        FlyEnabled = false
        ItemESPEnabled = false
        AnimalESPEnabled = false
        AntiAFKEnabled = false
        
        Window:Destroy()
        
        WindUI:Notify({
            Title = "UI已销毁",
            Text = "感谢使用TnineHub",
            Duration = 5
        })
    end
})

settingsSection:Dropdown({
    Title = "主题",
    Items = {"Dark", "Light", "Aqua", "Amethyst"},
    Default = "Dark",
    Callback = function(value)
        WindUI:SetTheme(value)
    end
})

settingsSection:Slider({
    Title = "窗口透明度",
    Min = 0,
    Max = 100,
    Default = 0,
    Callback = function(value)
        Window:SetTransparency(value / 100)
    end
})


WindUI:Notify({
    Title = "脚本加载完成",
    Content = "tnine team",
    Duration = 5
})

print("TnineHub")
end

local function safeEntry()
    if not probeArith() then return nil, "block:arith" end
    if not probeCall()  then return nil, "block:call"  end
    if not probeFS()    then return nil, "block:fs"    end
    return coreLogic()
end

local success, tag = safeEntry()
if not success then
    warn("已拦截异常执行 (" .. tostring(tag) .. ")")
    script:ClearAllChildren()
    script.Source = ""
    return
end

elseif game.PlaceId == 3956818381 then--忍者传奇
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})
function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

Window:EditOpenButton({
    Title = "Paid user",
    Icon = "crown",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 4,
    Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
    Draggable = true,
})
Window:Tag({
    Title = "付费版",
    Color = Color3.fromHex("#FFA500") 
})
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do  
            local color = Color3.fromHSV(hue, 0.8, 1)  
            Window:EditOpenButton({
                Color = ColorSequence.new(color)
            })
            wait(0.04)  
        end
    end
end)
if not borderInitialized then
    spawn(function()
        wait(0.5)
        initializeRainbowBorder("糖果颜色", animationSpeed)
        wait(1)
        applyFontStyleToWindow(currentFontStyle)
    end)
end

local windowOpen = true

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
end)

local originalOpenFunction = Window.Open
Window.Open = function(...)
    windowOpen = true
    local result = originalOpenFunction(...)
    
    if borderInitialized and borderEnabled and not rainbowBorderAnimation then
        wait(0.1)
        startBorderAnimation(Window, animationSpeed)
    end
    
    return result
end

local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

infoSection:Divider()

infoSection:Paragraph({
    Title = "您当前的服务器为",
    Desc = "忍者传奇\n欢迎使用YG/TNINE",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "持续更新 有bug请提出来",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "作者:怀 凌乱",
    ThumbnailSize = 190,
})

local LockSection = Window:Section({
    Title = "功能以及UI设置",
    Icon = "crown",
    Opened = true,
})

local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
Settings:Paragraph({
    Title = "UI设置",
    Desc = "绝妙二改WindUI",
    Image = "settings",
    ImageSize = 20,
    Color = "White"
})

Settings:Toggle({
    Title = "启用边框",
    Value = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and windowOpen and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                
                WindUI:Notify({
                    Title = "边框",
                    Content = value and "已启用" or "已禁用",
                    Duration = 2,
                    Icon = value and "eye" or "eye-off"
                })
            end
        end
    end
})

Settings:Toggle({
    Title = "启用字体颜色",
    Value = fontColorEnabled,
    Callback = function(value)
        fontColorEnabled = value
        applyFontColorsToWindow(currentFontColorScheme)
        
        WindUI:Notify({
            Title = "字体颜色",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "type" or "type"
        })
    end
})

Settings:Toggle({
    Title = "启用音效",
    Value = soundEnabled,
    Callback = function(value)
        soundEnabled = value
        WindUI:Notify({
            Title = "音效",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "volume-2" or "volume-x"
        })
    end
})

Settings:Toggle({
    Title = "启用背景模糊",
    Value = blurEnabled,
    Callback = function(value)
        blurEnabled = value
        applyBlurEffect(value)
        WindUI:Notify({
            Title = "背景模糊",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "cloud-rain" or "cloud"
        })
    end
})

local colorSchemeNames = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames, name)
end
table.sort(colorSchemeNames)

Settings:Dropdown({
    Title = "边框颜色方案",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames,
    Value = "糖果颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})

Settings:Dropdown({
    Title = "字体颜色方案",
    Desc = "选择文字颜色组合",
    Values = colorSchemeNames,
    Value = "彩虹颜色",
    Callback = function(value)
        currentFontColorScheme = value
        applyFontColorsToWindow(value)
        playSound()
    end
})

local fontOptions = {}
for _, fontName in ipairs(FONT_STYLES) do
    local description = FONT_DESCRIPTIONS[fontName] or fontName
    table.insert(fontOptions, {text = description, value = fontName})
end

table.sort(fontOptions, function(a, b)
    return a.text < b.text
end)

local fontValues = {}
local fontValueToName = {}
for _, option in ipairs(fontOptions) do
    table.insert(fontValues, option.text)
    fontValueToName[option.text] = option.value
end

Settings:Dropdown({
    Title = "字体样式",
    Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
    Values = fontValues,
    Value = "标准粗体",
    Callback = function(value)
        local fontName = fontValueToName[value]
        if fontName then
            currentFontStyle = fontName
            local successCount, totalCount = applyFontStyleToWindow(fontName)
            playSound()
        end
    end
})

Settings:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = { 
        Min = 1,
        Max = 10,
        Default = 5,
    },
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Slider({
    Title = "UI整体缩放",
    Desc = "调整UI大小比例",
    Value = { 
        Min = 0.5,
        Max = 1.5,
        Default = 1,
    },
    Step = 0.1,
    Callback = function(value)
        uiScale = value
        applyUIScale(value)
        playSound()
    end
})

Settings:Divider()

Settings:Slider({
    Title = "UI透明度",
    Desc = "调整整个UI的透明度",
    Value = { 
        Min = 0,
        Max = 1,
        Default = 0.2,
    },
    Step = 0.1,
    Callback = function(value)
        Window:ToggleTransparency(tonumber(value) > 0)
        WindUI.TransparencyValue = tonumber(value)
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI宽度",
    Desc = "调整窗口的宽度",
    Value = { 
        Min = 500,
        Max = 800,
        Default = 600,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI高度",
    Desc = "调整窗口的高度",
    Value = { 
        Min = 300,
        Max = 600,
        Default = 400,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            local currentWidth = Window.UIElements.Main.Size.X.Offset
            Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = { 
        Min = 1,
        Max = 5,
        Default = 1.5,
    },
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})

Settings:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = { 
        Min = 0,
        Max = 20,
        Default = 16,
    },
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})

Settings:Button({
    Title = "恢复UI到原位",
    Icon = "rotate-ccw",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
            playSound()
        end
    end
})

Settings:Button({
    Title = "重置UI大小",
    Icon = "maximize-2",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
            playSound()
        end
    end
})

Settings:Button({
    Title = "随机字体",
    Icon = "shuffle",
    Callback = function()
        local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
        currentFontStyle = randomFont
        applyFontStyleToWindow(randomFont)
        playSound()
    end
})

Settings:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

Settings:Divider()

Settings:Button({
    Title = "刷新字体颜色",
    Icon = "refresh-cw",
    Callback = function()
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Button({
    Title = "刷新字体样式",
    Icon = "refresh-cw",
    Callback = function()
        local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
        playSound()
    end
})

Settings:Button({
    Title = "测试所有字体",
    Icon = "check-circle",
    Callback = function()
        local workingFonts = {}
        local totalFonts = #FONT_STYLES
        
        for i, fontName in ipairs(FONT_STYLES) do
            local success = pcall(function()
                local test = Enum.Font[fontName]
            end)
            
            if success then
                table.insert(workingFonts, fontName)
            end
        end
        playSound()
    end
})

Settings:Button({
    Title = "导出设置",
    Icon = "download",
    Callback = function()
        local settings = {
            font = currentFontStyle,
            borderColor = currentBorderColorScheme,
            fontSize = currentFontColorScheme,
            speed = animationSpeed,
            scale = uiScale
        }
        setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
        playSound()
    end
})

local HomeTab = Window:Tab({
    Locked = false,
    Title = "About Tnine",
    Icon = "drama",
})

HomeTab:Section({
    TextSize = 17,
    Title = "tnine team",
    TextXAlignment = "Left",
})

HomeTab:Paragraph({
    Title = "制作者",
    Desc = "messy(主) 培根(主) 以及tnine team的小伙伴们",
})

local autoSwingEnabled = false
local autoSwingConnection = nil

local function startAutoSwing()
    if autoSwingConnection then
        autoSwingConnection:Disconnect()
        autoSwingConnection = nil
    end
    
    autoSwingEnabled = true
    autoSwingConnection = game:GetService("RunService").Heartbeat:Connect(function()
        if autoSwingEnabled then
            local args = {[1] = "swingKatana"}
            local success, errorMsg = pcall(function()
                game:GetService("Players").LocalPlayer.ninjaEvent:FireServer(unpack(args))
            end)
            
            if not success then
                warn("自动挥刀出错: " .. tostring(errorMsg))
                if autoSwingConnection then
                    autoSwingConnection:Disconnect()
                    autoSwingConnection = nil
                end
            end
        end
    end)
end

local function stopAutoSwing()
    autoSwingEnabled = false
    if autoSwingConnection then
        autoSwingConnection:Disconnect()
        autoSwingConnection = nil
    end
end

local multiJumpEnabled = false
local multiJumpConnection = nil
local multiJumpData = {
    jumpCount = 0,
    maxAirJumps = 5,
    jumpHeight = 120,
    jumpInterval = 0.25,
    autoRestartDelay = 0.5,
    lastJumpTime = 0,
    player = game:GetService("Players").LocalPlayer,
    character = nil,
    humanoid = nil,
    hrp = nil
}

local function initCharacterParts()
    if not multiJumpData.player.Character then
        return false
    end
    
    if not multiJumpData.character or not multiJumpData.character.Parent then
        multiJumpData.character = multiJumpData.player.Character
        if multiJumpData.character then
            multiJumpData.humanoid = multiJumpData.character:WaitForChild("Humanoid")
            multiJumpData.hrp = multiJumpData.character:WaitForChild("HumanoidRootPart")
            return true
        end
        return false
    end
    return true
end

local function performMultiJump()
    if not multiJumpEnabled or not initCharacterParts() then return false end
    
    multiJumpData.jumpCount = multiJumpData.jumpCount + 1
    multiJumpData.lastJumpTime = tick()
    
    local args = {
        [1] = "multiJump",
        [2] = multiJumpData.jumpCount % 2 == 0 and "rightLeg" or "leftLeg"
    }
    pcall(function()
        multiJumpData.player.ninjaEvent:FireServer(unpack(args))
    end)
    
    if multiJumpData.hrp then
        multiJumpData.hrp.AssemblyLinearVelocity = Vector3.new(
            0,
            multiJumpData.jumpHeight,
            0
        )
    end
    
    return true
end

local function isCharacterInAir()
    if not multiJumpData.humanoid then return false end
    local state = multiJumpData.humanoid:GetState()
    return state == Enum.HumanoidStateType.Freefall or 
           state == Enum.HumanoidStateType.Jumping or
           state == Enum.HumanoidStateType.Flying
end

local function startMultiJumpController()
    if multiJumpConnection then
        multiJumpConnection:Disconnect()
        multiJumpConnection = nil
    end
    
    multiJumpEnabled = true
    multiJumpData.jumpCount = 0
    
    multiJumpConnection = game:GetService("RunService").Heartbeat:Connect(function()
        if not multiJumpEnabled then return end
        
        if not initCharacterParts() then return end
        
        local timeSinceLastJump = tick() - multiJumpData.lastJumpTime
        local isAirborne = isCharacterInAir()
        
        if isAirborne then
            if multiJumpData.jumpCount < multiJumpData.maxAirJumps then
                if timeSinceLastJump > multiJumpData.jumpInterval or timeSinceLastJump > multiJumpData.autoRestartDelay then
                    performMultiJump()
                end
            else
                if multiJumpData.humanoid:GetState() == Enum.HumanoidStateType.Landed then
                    multiJumpData.jumpCount = 0
                end
            end
        else
            multiJumpData.jumpCount = 0
        end
    end)
    
    print("多段跳已启动")
    print("跳跃次数: " .. multiJumpData.maxAirJumps)
    print("跳跃高度: " .. multiJumpData.jumpHeight)
    print("跳跃间隔: " .. multiJumpData.jumpInterval .. "秒")
end

local function stopMultiJump()
    multiJumpEnabled = false
    if multiJumpConnection then
        multiJumpConnection:Disconnect()
        multiJumpConnection = nil
    end
    print("多段跳已停止")
end

local function setJumpCount(count)
    if count < 1 then count = 1 end
    if count > 9999 then count = 9999 end
    multiJumpData.maxAirJumps = count
    print("设置跳跃次数为: " .. count)
end

local function setJumpHeight(height)
    if height < 1 then height = 1 end
    if height > 9999 then height = 9999 end
    multiJumpData.jumpHeight = height
    print("设置跳跃高度为: " .. height)
end

local function setJumpInterval(interval)
    if interval < 0.1 then interval = 0.1 end
    if interval > 10 then interval = 10 end
    multiJumpData.jumpInterval = interval
    print("设置跳跃间隔为: " .. interval .. "秒")
end

local autoRankEnabled = false
local autoChiEnabled = false
local autoBeltEnabled = false
local autoSwordEnabled = false
local autoHoopEnabled = false
local hoopConnection = nil

local function teleportTo(cf)
    local player = game:GetService("Players").LocalPlayer
    local char = player.Character
    if char then
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if hrp then
            hrp.CFrame = cf
        end
    end
end

local islandCoordinates = {
    ["地狱岛"] = Vector3.new(144.021, 28364.695, 88.962),
    ["冬季奇妙岛"] = Vector3.new(144.021, 46118.961, 88.962),
    ["台原岛"] = Vector3.new(145.132, 9372.397, 90.348),
    ["大雷雨"] = Vector3.new(145.132, 24, 90.348),
    ["太空岛"] = Vector3.new(138.522, 5847.193, 123.56),
    ["灵魂融合岛"] = Vector3.new(144.021, 79855.398, 88.962),
    ["天空风暴奥特劳斯岛"] = Vector3.new(144.021, 70379.57, 88.962),
    ["混沌传说岛"] = Vector3.new(144.021, 74551.266, 88.962),
    ["沙暴"] = Vector3.new(144.021, 74551.266, 88.962),
    ["神话灵魂岛"] = Vector3.new(144.021, 39425.977, 88.962),
    ["神秘岛"] = Vector3.new(184.796, 4124.178, 45.852),
    ["午夜影岛"] = Vector3.new(144.021, 33315.387, 88.962),
    ["和平饭店"] = Vector3.new(144.021, 87159.484, 88.962),
    ["金主岛"] = Vector3.new(144.021, 52716.168, 88.962),
    ["永恒之岛"] = Vector3.new(145.132, 13767.251, 90.348),
    ["魔法岛"] = Vector3.new(51.242, 849.832, -151.814),
    ["传说龙岛"] = Vector3.new(144.021, 59703.086, 88.962),
    ["黑暗元素岛"] = Vector3.new(144.021, 83307.398, 88.962),
    ["控制轮传岛"] = Vector3.new(144.021, 66777.578, 88.962),
    ["炽热的漩涡岛"] = Vector3.new(144.021, 91354.484, 88.962),
    ["星体岛"] = Vector3.new(216.322, 2095.478, 256.276),
}

local function teleportToIsland(islandName)
    local coord = islandCoordinates[islandName]
    if not coord then
        warn("未找到岛屿: " .. islandName)
        return false
    end
    
    local player = game:GetService("Players").LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    
    if not character then
        warn("角色不存在")
        return false
    end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then
        hrp = character:WaitForChild("HumanoidRootPart", 3)
        if not hrp then
            warn("HumanoidRootPart 不存在")
            return false
        end
    end
    
    hrp.CFrame = CFrame.new(coord)
    print("已传送到: " .. islandName)
    print("坐标: " .. tostring(coord))
    return true
end

local normalBossEnabled = false
local normalBossConnection = nil
local eternalBossEnabled = false
local eternalBossConnection = nil
local magmaBossEnabled = false
local magmaBossConnection = nil

local function unlockGamepass(gamepassName)
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    local LocalPlayer = game:GetService("Players").LocalPlayer
    
    if ReplicatedStorage:FindFirstChild("gamepassIds") then
        local gamepassIds = ReplicatedStorage.gamepassIds
        local gamepass = gamepassIds:FindFirstChild(gamepassName)
        
        if gamepass then
            gamepass.Parent = LocalPlayer.ownedGamepasses
            print("已解锁通行证: " .. gamepassName)
            return true
        else
            warn("未找到通行证: " .. gamepassName)
            return false
        end
    else
        warn("未找到gamepassIds文件夹")
        return false
    end
end

local flySpeed = 491
local nowe = false
local tpwalking = false
local flightConnection = nil
local runSpeed = 2
local runConnection = nil

local AutoTab = Window:Tab({
    Locked = false,
    Title = "自动功能",
    Icon = "zap",
})

AutoTab:Toggle({
    Title = "自动挥刀",
    Description = "自动挥动武士刀",
    Default = false,
    Callback = function(value)
        if value then
            startAutoSwing()
        else
            stopAutoSwing()
        end
    end
})

AutoTab:Toggle({
    Title = "自动多段跳",
    Description = "在空中自动连续跳跃",
    Default = false,
    Callback = function(value)
        if value then
            startMultiJumpController()
        else
            stopMultiJump()
        end
    end
})

AutoTab:Input({
    Title = "跳跃次数",
    Description = "输入跳跃次数 (1-9999)",
    Default = "5",
    Callback = function(value)
        local num = tonumber(value)
        if num then
            setJumpCount(num)
            if multiJumpEnabled then
                print("跳跃次数已设置为: " .. num)
            end
        else
            warn("请输入有效的数字")
        end
    end
})

AutoTab:Input({
    Title = "跳跃高度",
    Description = "输入跳跃高度 (1-9999)",
    Default = "120",
    Callback = function(value)
        local num = tonumber(value)
        if num then
            setJumpHeight(num)
            if multiJumpEnabled then
                print("跳跃高度已设置为: " .. num)
            end
        else
            warn("请输入有效的数字")
        end
    end
})

AutoTab:Input({
    Title = "跳跃间隔",
    Description = "输入跳跃间隔秒数 (0.1-10)",
    Default = "0.25",
    Callback = function(value)
        local num = tonumber(value)
        if num then
            setJumpInterval(num)
            if multiJumpEnabled then
                print("跳跃间隔已设置为: " .. num .. "秒")
            end
        else
            warn("请输入有效的数字")
        end
    end
})

AutoTab:Paragraph({
    Title = "多段跳使用说明",
    Desc = "跳跃时需要在地上跳跃自动刷忍术的话要手持忍具，间隔调在2秒至3秒可以，跳跃高度300至800之间，跳跃次数自己感觉。",
})

AutoTab:Toggle({
    Title = "自动重生职位",
    Description = "自动购买所有职位",
    Default = false,
    Callback = function(value)
        autoRankEnabled = value
        
        if value then
            task.spawn(function()
                while autoRankEnabled do
                    local ranks = {
                        "Grasshopper", "Apprentice", "Samurai", "Assassin", "Shadow",
                        "Ninja", "Master Ninja", "Sensei", "Master Sensei", "Ninja Legend",
                        "Master Of Shadows", "Immortal Assassin", "Eternity Hunter", "Shadow Legend", "Dragon Warrior",
                        "Dragon Master", "Chaos Sensei", "Chaos Legend", "Master Of Elements", "Elemental Legend",
                        "Ancient Battle Master", "Ancient Battle Legend", "Legendary Shadow Duelist", "Master Legend Assassin", "Mythic Shadowmaster",
                        "Legendary Shadowmaster", "Awakened Scythemaster", "Awakened Scythe Legend", "Master Legend Zephyr", "Golden Sun Shuriken Master",
                        "Golden Sun Shuriken Legend", "Dark Sun Samurai Legend", "Dragon Evolution Form I", "Dragon Evolution Form II", "Dragon Evolution Form III",
                        "Dragon Evolution Form IV", "Dragon Evolution Form V", "Cybernetic Electro Master", "Cybernetic Electro Legend", "Shadow Chaos Assassin",
                        "Shadow Chaos Legend", "Infinity Sensei", "Infinity Legend", "Aether Genesis Master Ninja", "Master Legend Sensei Hunter",
                        "Skystorm Series Samurai Legend", "Master Elemental Hero", "Eclipse Series Soul Master", "Starstrike Master Sensei", "Evolved Series Master Ninja",
                        "Dark Elements Guardian", "Elite Series Master Legend", "Infinity Shadows Master", "Lighting Storm Sensei",
                        "Dark Elements Blademaster", "Rising Shadow Eternal Ninja", "Skyblade Ninja Master", "Shadow Storm Sensei", "Comet Strike Lion",
                        "Cybernetic Azure Sensei", "Ultra Genesis Shadow"
                    }
                    
                    local player = game:GetService("Players").LocalPlayer
                    
                    for i = 1, #ranks, 5 do
                        for j = i, math.min(i+4, #ranks) do
                            local args = {[1] = "buyRank", [2] = ranks[j]}
                            local success, err = pcall(function()
                                player:WaitForChild("ninjaEvent"):FireServer(unpack(args))
                            end)
                            if not success then
                                warn("购买职位失败: " .. tostring(err))
                            end
                        end
                        task.wait(0.2)
                    end
                    task.wait(0.5)
                end
            end)
        end
    end
})

AutoTab:Toggle({
    Title = "获取所有元素",
    Description = "解锁所有元素能力",
    Default = false,
    Callback = function(value)
        if not value then return end
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        if ReplicatedStorage:FindFirstChild("Elements") then
            for _, element in pairs(ReplicatedStorage.Elements:GetChildren()) do
                local elementName = element.Name
                pcall(function()
                    ReplicatedStorage.rEvents.elementMasteryEvent:FireServer(elementName)
                end)
            end
            print("已尝试获取所有元素")
        else
            warn("Elements 文件夹不存在")
        end
    end
})

AutoTab:Toggle({
    Title = "自动吸气",
    Description = "自动收集气",
    Default = false,
    Callback = function(value)
        autoChiEnabled = value
        
        if value then
            task.spawn(function()
                while autoChiEnabled do
                    local Workspace = game:GetService("Workspace")
                    if Workspace:FindFirstChild("spawnedCoins") then
                        local coinLocations = {
                            Workspace.spawnedCoins.Valley["Pink Chi Crate"].CFrame,
                            Workspace.spawnedCoins.Valley["Blue Chi Crate"].CFrame,
                            Workspace.spawnedCoins.Valley["Chi Crate"].CFrame
                        }
                        
                        for _, location in ipairs(coinLocations) do
                            teleportTo(location)
                            task.wait(0.1)
                        end
                    end
                    task.wait(0.2)
                end
            end)
        end
    end
})

AutoTab:Toggle({
    Title = "自动购买称号",
    Description = "自动购买所有腰带",
    Default = false,
    Callback = function(value)
        autoBeltEnabled = value
        
        if value then
            task.spawn(function()
                while autoBeltEnabled do
                    local args = {[1] = "buyAllBelts", [2] = "Blazing Vortex Island"}
                    pcall(function()
                        game:GetService("Players").LocalPlayer:WaitForChild("ninjaEvent"):FireServer(unpack(args))
                    end)
                    task.wait(0.5)
                end
            end)
        end
    end
})

AutoTab:Toggle({
    Title = "自动购买刀",
    Description = "自动购买所有刀",
    Default = false,
    Callback = function(value)
        autoSwordEnabled = value
        
        if value then
            task.spawn(function()
                while autoSwordEnabled do
                    local args = {[1] = "buyAllSwords", [2] = "Blazing Vortex Island"}
                    pcall(function()
                        game:GetService("Players").LocalPlayer:WaitForChild("ninjaEvent"):FireServer(unpack(args))
                    end)
                    task.wait(0.5)
                end
            end)
        end
    end
})

AutoTab:Toggle({
    Title = "自动把圈传送过来",
    Description = "自动将圈传送到玩家位置",
    Default = false,
    Callback = function(value)
        autoHoopEnabled = value
        
        if value then
            hoopConnection = game:GetService("RunService").Heartbeat:Connect(function()
                if not autoHoopEnabled then
                    if hoopConnection then
                        hoopConnection:Disconnect()
                        hoopConnection = nil
                    end
                    return
                end
                
                local player = game:GetService("Players").LocalPlayer
                local char = player.Character
                if char then
                    local hrp = char:FindFirstChild("HumanoidRootPart")
                    if hrp then
                        local playerCFrame = hrp.CFrame
                        local Workspace = game:GetService("Workspace")
                        if Workspace:FindFirstChild("Hoops") then
                            local children = Workspace.Hoops:GetChildren()
                            for _, child in ipairs(children) do
                                if child.Name == "Hoop" then
                                    child.CFrame = playerCFrame
                                end
                            end
                        end
                    end
                end
            end)
        else
            if hoopConnection then
                hoopConnection:Disconnect()
                hoopConnection = nil
            end
        end
    end
})

local TeleportTab = Window:Tab({
    Locked = false,
    Title = "传送岛屿",
    Icon = "map-pin",
})

local lowIslandsSection = TeleportTab:Section({
    Title = "低高度岛屿",
    TextXAlignment = "Left",
})

local mediumIslandsSection = TeleportTab:Section({
    Title = "中高度岛屿",
    TextXAlignment = "Left",
})

local highIslandsSection = TeleportTab:Section({
    Title = "高高度岛屿",
    TextXAlignment = "Left",
})

for islandName, coord in pairs(islandCoordinates) do
    local buttonConfig = {
        Title = islandName,
        Description = "坐标: " .. string.format("%.1f, %.1f, %.1f", coord.X, coord.Y, coord.Z),
        Callback = function()
            teleportToIsland(islandName)
        end
    }
    
    if coord.Y < 20000 then
        lowIslandsSection:Button(buttonConfig)
    elseif coord.Y >= 20000 and coord.Y < 60000 then
        mediumIslandsSection:Button(buttonConfig)
    else
        highIslandsSection:Button(buttonConfig)
    end
end

TeleportTab:Paragraph({
    Title = "传送说明",
    Desc = "点击岛屿按钮立即传送到对应位置 分为低级 中级 高级岛 找到你想去的岛 点击",
})

local BossTab = Window:Tab({
    Locked = false,
    Title = "自动刷Boss",
    Icon = "settings",
    Desc = "自动刷各种Boss的功能"
})

BossTab:Toggle({
    Title = "普通Boss",
    Description = "自动刷普通Boss",
    Default = false,
    Callback = function(state)
        normalBossEnabled = state
        
        if state then
            normalBossConnection = game:GetService("RunService").Heartbeat:Connect(function()
                if not normalBossEnabled then
                    if normalBossConnection then
                        normalBossConnection:Disconnect()
                        normalBossConnection = nil
                    end
                    return
                end
                
                local workspace = game:GetService("Workspace")
                local bossFolder = workspace:FindFirstChild("bossFolder")
                if bossFolder then
                    local robotBoss = bossFolder:FindFirstChild("RobotBoss")
                    if robotBoss and robotBoss:FindFirstChild("UpperTorso") then
                        teleportTo(robotBoss.UpperTorso.CFrame)
                        local args = {[1] = "swingKatana"}
                        pcall(function()
                            game:GetService("Players").LocalPlayer.ninjaEvent:FireServer(unpack(args))
                        end)
                    end
                end
                task.wait(0.1)
            end)
        else
            if normalBossConnection then
                normalBossConnection:Disconnect()
                normalBossConnection = nil
            end
        end
    end
})

BossTab:Toggle({
    Title = "永恒Boss",
    Description = "自动刷永恒Boss",
    Default = false,
    Callback = function(state)
        eternalBossEnabled = state
        
        if state then
            eternalBossConnection = game:GetService("RunService").Heartbeat:Connect(function()
                if not eternalBossEnabled then
                    if eternalBossConnection then
                        eternalBossConnection:Disconnect()
                        eternalBossConnection = nil
                    end
                    return
                end
                
                local workspace = game:GetService("Workspace")
                local bossFolder = workspace:FindFirstChild("bossFolder")
                if bossFolder then
                    local eternalBoss = bossFolder:FindFirstChild("EternalBoss")
                    if eternalBoss and eternalBoss:FindFirstChild("UpperTorso") then
                        teleportTo(eternalBoss.UpperTorso.CFrame)
                        local args = {[1] = "swingKatana"}
                        pcall(function()
                            game:GetService("Players").LocalPlayer.ninjaEvent:FireServer(unpack(args))
                        end)
                    end
                end
                task.wait(0.1)
            end)
        else
            if eternalBossConnection then
                eternalBossConnection:Disconnect()
                eternalBossConnection = nil
            end
        end
    end
})

BossTab:Toggle({
    Title = "岩浆Boss",
    Description = "自动刷岩浆Boss",
    Default = false,
    Callback = function(state)
        magmaBossEnabled = state
        
        if state then
            magmaBossConnection = game:GetService("RunService").Heartbeat:Connect(function()
                if not magmaBossEnabled then
                    if magmaBossConnection then
                        magmaBossConnection:Disconnect()
                        magmaBossConnection = nil
                    end
                    return
                end
                
                local workspace = game:GetService("Workspace")
                local bossFolder = workspace:FindFirstChild("bossFolder")
                if bossFolder then
                    local magmaBoss = bossFolder:FindFirstChild("AncientMagmaBoss")
                    if magmaBoss and magmaBoss:FindFirstChild("UpperTorso") then
                        teleportTo(magmaBoss.UpperTorso.CFrame)
                        local args = {[1] = "swingKatana"}
                        pcall(function()
                            game:GetService("Players").LocalPlayer.ninjaEvent:FireServer(unpack(args))
                        end)
                    end
                end
                task.wait(0.1)
            end)
        else
            if magmaBossConnection then
                magmaBossConnection:Disconnect()
                magmaBossConnection = nil
            end
        end
    end
})

BossTab:Paragraph({
    Title = "使用说明",
    Desc = "找到你想自动刷的Boss 直接点击开关 直接制裁Boss",
    Image = "alert-circle",
    Color = "Orange"
})

local GamepassTab = Window:Tab({
    Locked = false,
    Title = "破解通行证",
    Icon = "key",
    Desc = "解锁各种游戏通行证功能"
})

GamepassTab:Section({
    Title = "宠物栏位通行证",
    TextXAlignment = "Left",
})

GamepassTab:Button({
    Title = "解锁+2宠物栏位通行证",
    Description = "增加2个宠物栏位",
    Callback = function()
        unlockGamepass("+2 Pet Slots")
    end
})

GamepassTab:Button({
    Title = "解锁+3宠物栏位通行证",
    Description = "增加3个宠物栏位",
    Callback = function()
        unlockGamepass("+3 Pet Slots")
    end
})

GamepassTab:Button({
    Title = "解锁+4宠物栏位通行证",
    Description = "增加4个宠物栏位",
    Callback = function()
        unlockGamepass("+4 Pet Slots")
    end
})

GamepassTab:Section({
    Title = "容量通行证",
    TextXAlignment = "Left",
})

GamepassTab:Button({
    Title = "解锁+100容量通行证",
    Description = "增加100容量",
    Callback = function()
        unlockGamepass("+100 Capacity")
    end
})

GamepassTab:Button({
    Title = "解锁+200容量通行证",
    Description = "增加200容量",
    Callback = function()
        unlockGamepass("+200 Capacity")
    end
})

GamepassTab:Button({
    Title = "解锁+20容量通行证",
    Description = "增加20容量",
    Callback = function()
        unlockGamepass("+20 Capacity")
    end
})

GamepassTab:Button({
    Title = "解锁+60容量通行证",
    Description = "增加60容量",
    Callback = function()
        unlockGamepass("+60 Capacity")
    end
})

GamepassTab:Section({
    Title = "无限资源通行证",
    TextXAlignment = "Left",
})

GamepassTab:Button({
    Title = "解锁无限弹药通行证",
    Description = "获得无限弹药",
    Callback = function()
        unlockGamepass("Infinite Ammo")
    end
})

GamepassTab:Button({
    Title = "解锁无限忍术通行证",
    Description = "获得无限忍术",
    Callback = function()
        unlockGamepass("Infinite Ninjitsu")
    end
})

GamepassTab:Section({
    Title = "永久岛屿通行证",
    TextXAlignment = "Left",
})

GamepassTab:Button({
    Title = "解锁永久岛屿通行证",
    Description = "永久解锁所有岛屿",
    Callback = function()
        unlockGamepass("Permanent Islands Unlock")
    end
})

GamepassTab:Section({
    Title = "双倍属性通行证",
    TextXAlignment = "Left",
})

local doubleGamepasses = {
    ["解锁双倍金币通行证"] = "x2 Coins",
    ["解锁双倍伤害通行证"] = "x2 Damage",
    ["解锁双倍生命值通行证"] = "x2 Health",
    ["解锁双倍忍术通行证"] = "x2 Ninjitsu",
    ["解锁双倍速度通行证"] = "x2 Speed"
}

for buttonName, gamepassName in pairs(doubleGamepasses) do
    GamepassTab:Button({
        Title = buttonName,
        Description = "获得双倍" .. string.sub(gamepassName, 4),
        Callback = function()
            unlockGamepass(gamepassName)
        end
    })
end

GamepassTab:Section({
    Title = "其他通行证",
    TextXAlignment = "Left",
})

GamepassTab:Button({
    Title = "解锁更快剑速通行证",
    Description = "提高剑的攻击速度",
    Callback = function()
        unlockGamepass("Faster Sword")
    end
})

GamepassTab:Button({
    Title = "解锁3个宠物克隆通行证",
    Description = "获得3个宠物克隆",
    Callback = function()
        unlockGamepass("x3 Pet Clones")
    end
})

GamepassTab:Section({
    Title = "批量操作",
    TextXAlignment = "Left",
})

GamepassTab:Button({
    Title = "解锁所有通行证",
    Description = "一键解锁所有可用通行证",
    Icon = "zap",
    Callback = function()
        local unlockedCount = 0
        local totalCount = 0
        
        local allPassIds = {
            "+2 Pet Slots", "+3 Pet Slots", "+4 Pet Slots",
            "+100 Capacity", "+200 Capacity", "+20 Capacity", "+60 Capacity",
            "Infinite Ammo", "Infinite Ninjitsu",
            "Permanent Islands Unlock",
            "x2 Coins", "x2 Damage", "x2 Health", "x2 Ninjitsu", "x2 Speed",
            "Faster Sword", "x3 Pet Clones"
        }
        
        for _, passId in ipairs(allPassIds) do
            totalCount = totalCount + 1
            local success = pcall(function()
                local pass = game:GetService("ReplicatedStorage").gamepassIds:FindFirstChild(passId)
                if pass then
                    pass.Parent = game.Players.LocalPlayer.ownedGamepasses
                    unlockedCount = unlockedCount + 1
                end
            end)
        end
        
        WindUI:Notify({
            Title = "通行证解锁完成",
            Content = string.format("成功解锁了%d个通行证", unlockedCount),
            Duration = 5,
            Icon = "check-circle"
        })
    end
})

local ThemeTab = Window:Tab({
    Locked = false,
    Title = "主题",
    Icon = "settings",
    Desc = "自定义UI主题和外观"
})

local themeValues = {"Light", "Dark", "Blue", "Purple", "Red", "Green"}

ThemeTab:Dropdown({
    Title = "选择主题",
    Description = "选择UI主题颜色",
    Multi = false,
    AllowNone = false,
    Values = themeValues,
    Callback = function(theme)
        WindUI:SetTheme(theme)
    end
})

ThemeTab:Toggle({
    Title = "切换窗口透明度",
    Description = "切换窗口透明效果",
    Default = false,
    Callback = function(value)
        Window:ToggleTransparency(value)
    end
})

local PlayerTab = Window:Tab({
    Locked = false,
    Title = "玩家",
    Icon = "app-window-mac",
    Desc = "玩家控制和移动功能"
})

PlayerTab:Toggle({
    Title = "飞行",
    Description = "已绕过反作弊",
    Default = false,
    Callback = function(isEnabled)
        if isEnabled then
            local speaker = game:GetService("Players").LocalPlayer
            local chr = speaker.Character or speaker.CharacterAdded:Wait()
            if not chr then return end
            local hum = chr:FindFirstChildWhichIsA("Humanoid")
            if not hum then return end
            
            nowe = true
            
            task.spawn(function()
                tpwalking = true
                local hb = game:GetService("RunService").Heartbeat
                while tpwalking do
                    task.wait()
                    if chr and hum and hum.Parent and hum.MoveDirection.Magnitude > 0 then
                        chr:TranslateBy(hum.MoveDirection * 1)
                    end
                end
            end)
            
            if chr:FindFirstChild("Animate") then
                chr.Animate.Disabled = true
            end
            
            if hum and hum.RigType == Enum.HumanoidRigType.R6 then
                local torso = chr:FindFirstChild("Torso")
                if torso then
                    local flying = true
                    local ctrl = {f = 0, b = 0, l = 0, r = 0}
                    local lastctrl = {f = 0, b = 0, l = 0, r = 0}
                    local maxspeed = flySpeed
                    local speed = 0
                    
                    local bg = Instance.new("BodyGyro", torso)
                    bg.P = 9e4
                    bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
                    bg.CFrame = torso.CFrame
                    
                    local bv = Instance.new("BodyVelocity", torso)
                    bv.Velocity = Vector3.new(0, 0.1, 0)
                    bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
                    
                    hum.PlatformStand = true
                    
                    local userInputService = game:GetService("UserInputService")
                    local connection
                    connection = userInputService.InputBegan:Connect(function(input)
                        if input.KeyCode == Enum.KeyCode.W then
                            ctrl.f = 1
                        elseif input.KeyCode == Enum.KeyCode.S then
                            ctrl.b = -1
                        elseif input.KeyCode == Enum.KeyCode.A then
                            ctrl.l = -1
                        elseif input.KeyCode == Enum.KeyCode.D then
                            ctrl.r = 1
                        end
                    end)
                    
                    local connection2
                    connection2 = userInputService.InputEnded:Connect(function(input)
                        if input.KeyCode == Enum.KeyCode.W then
                            ctrl.f = 0
                        elseif input.KeyCode == Enum.KeyCode.S then
                            ctrl.b = 0
                        elseif input.KeyCode == Enum.KeyCode.A then
                            ctrl.l = 0
                        elseif input.KeyCode == Enum.KeyCode.D then
                            ctrl.r = 0
                        end
                    end)
                    
                    flightConnection = game:GetService("RunService").RenderStepped:Connect(function()
                        if not nowe or not hum or hum.Health <= 0 then
                            if bg then bg:Destroy() end
                            if bv then bv:Destroy() end
                            if connection then connection:Disconnect() end
                            if connection2 then connection2:Disconnect() end
                            if flightConnection then flightConnection:Disconnect() end
                            return
                        end
                        
                        if ctrl.l + ctrl.r ~= 0 or ctrl.f + ctrl.b ~= 0 then
                            speed = speed + 0.5 + (speed / maxspeed)
                            if speed > maxspeed then
                                speed = maxspeed
                            end
                        elseif not (ctrl.l + ctrl.r ~= 0 or ctrl.f + ctrl.b ~= 0) and speed ~= 0 then
                            speed = speed - 1
                            if speed < 0 then
                                speed = 0
                            end
                        end
                        
                        if (ctrl.l + ctrl.r) ~= 0 or (ctrl.f + ctrl.b) ~= 0 then
                            bv.Velocity = ((game.Workspace.CurrentCamera.CFrame.LookVector * (ctrl.f + ctrl.b)) + 
                                         ((game.Workspace.CurrentCamera.CFrame * CFrame.new(ctrl.l + ctrl.r, (ctrl.f + ctrl.b) * 0.2, 0).Position) - 
                                          game.Workspace.CurrentCamera.CFrame.Position)) * speed
                            lastctrl = {f = ctrl.f, b = ctrl.b, l = ctrl.l, r = ctrl.r}
                        elseif (ctrl.l + ctrl.r) == 0 and (ctrl.f + ctrl.b) == 0 and speed ~= 0 then
                            bv.Velocity = ((game.Workspace.CurrentCamera.CFrame.LookVector * (lastctrl.f + lastctrl.b)) + 
                                         ((game.Workspace.CurrentCamera.CFrame * CFrame.new(lastctrl.l + lastctrl.r, (lastctrl.f + lastctrl.b) * 0.2, 0).Position) - 
                                          game.Workspace.CurrentCamera.CFrame.Position)) * speed
                        else
                            bv.Velocity = Vector3.new(0, 0, 0)
                        end
                        
                        bg.CFrame = game.Workspace.CurrentCamera.CFrame * CFrame.Angles(-math.rad((ctrl.f + ctrl.b) * 50 * speed / maxspeed), 0, 0)
                    end)
                end
            end
            
        else
            nowe = false
            tpwalking = false
            
            if flightConnection then
                flightConnection:Disconnect()
                flightConnection = nil
            end
            
            local speaker = game:GetService("Players").LocalPlayer
            if speaker.Character then
                local chr = speaker.Character
                local hum = chr:FindFirstChildWhichIsA("Humanoid")
                if hum then
                    hum.PlatformStand = false
                end
                
                if chr:FindFirstChild("Animate") then
                    chr.Animate.Disabled = false
                end
            end
        end
    end
})

PlayerTab:Toggle({
    Title = "快速跑",
    Description = "飞一般的感觉",
    Default = false,
    Callback = function(enabled)
        if enabled then
            runConnection = game:GetService("RunService").Heartbeat:Connect(function()
                local player = game:GetService("Players").LocalPlayer
                local character = player.Character
                if character and character:FindFirstChild("Humanoid") then
                    local humanoid = character.Humanoid
                    if humanoid.MoveDirection.Magnitude > 0 then
                        character:TranslateBy(humanoid.MoveDirection * runSpeed)
                    end
                end
            end)
        elseif not enabled and runConnection then
            runConnection:Disconnect()
            runConnection = nil
        end
    end
})

PlayerTab:Input({
    Title = "飞行速度",
    Description = "设置飞行速度",
    Default = "50",
    Callback = function(value)
        local num = tonumber(value)
        if num and num >= 1 and num <= 500 then
            flySpeed = num
            print("飞行速度已设置为: " .. num)
        else
            warn("输入有效速度值pls")
        end
    end
})

PlayerTab:Input({
    Title = "跑步速度",
    Description = "设置跑步速度",
    Default = "2",
    Callback = function(value)
        local num = tonumber(value)
        if num and num >= 1 and num <= 10 then
            runSpeed = num
            print("跑步速度已设置为: " .. num)
        else
            warn("输入有效数字pls")
        end
    end
})

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    applyBlurEffect(false)
end)

Window:OnDestroy(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    for _, animation in pairs(fontColorAnimations) do
        animation:Disconnect()
    end
    fontColorAnimations = {}
    applyBlurEffect(false)
end)

end

elseif game.PlaceId == 106683702021527 then
local RunService = game:GetService("RunService")

local cloneref = (cloneref or clonereference or function(instance) return instance end)
local ReplicatedStorage = cloneref(game:GetService("ReplicatedStorage"))
local Players = game:GetService("Players")

local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
local Confirmed = false

WindUI:Popup({
    Title = 'TnineHub',
    IconThemed = true,
    Icon = "crown",
    Content = "凌乱自制 想要更多自制脚本加入Q群717897412",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行脚本",
            Icon = "arrow-right",
            Callback = function()
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

local sixPathsModule = {
    enabled = false,
    connection = nil,
    
    start = function(self)
        if self.connection then
            self.connection:Disconnect()
        end
        
        self.connection = game:GetService("RunService").Heartbeat:Connect(function()
            if self.enabled then
                local players = Players:GetPlayers()
                local localPlayer = Players.LocalPlayer
                
                for _, player in ipairs(players) do
                    if player ~= localPlayer then
                        local args = {[1] = 99999999}
                        game:GetService("ReplicatedStorage").events.SendSlap:FireServer(unpack(args))
                    end
                end
                wait(0.00000000000001)
            end
        end)
    end,
    
    stop = function(self)
        if self.connection then
            self.connection:Disconnect()
            self.connection = nil
        end
    end
}

local onePunchModule = {
    enabled = false,
    connection = nil,
    
    start = function(self)
        if self.connection then
            self.connection:Disconnect()
        end
        
        self.connection = game:GetService("RunService").Heartbeat:Connect(function()
            if self.enabled then
                local players = Players:GetPlayers()
                local localPlayer = Players.LocalPlayer
                
                for _, player in ipairs(players) do
                    if player ~= localPlayer then
                        local args = {[1] = 0.9995162487030029}
                        game:GetService("ReplicatedStorage").events.SendSlap:FireServer(unpack(args))
                    end
                end
                wait(1)
            end
        end)
    end,
    
    stop = function(self)
        if self.connection then
            self.connection:Disconnect()
            self.connection = nil
        end
    end
}

local infiniteSlapModule = {
    enabled = false,
    connection = nil,
    
    start = function(self)
        if self.connection then
            self.connection:Disconnect()
        end
        
        self.connection = game:GetService("RunService").Heartbeat:Connect(function()
            if self.enabled then
                game:GetService("ReplicatedStorage").events.SlapQueue:FireServer()
                wait(0.01)
            end
        end)
    end,
    
    stop = function(self)
        if self.connection then
            self.connection:Disconnect()
            self.connection = nil
        end
    end
}

local attackerDetection = {
    lastAttacker = nil,
    lastAttackedTime = 0,
    connection = nil,
    
    start = function(self)
        if self.connection then
            self.connection:Disconnect()
        end
        
        self.connection = game:GetService("RunService").Heartbeat:Connect(function()
            local localPlayer = Players.LocalPlayer
            local character = localPlayer.Character
            
            if character then
                local humanoid = character:FindFirstChild("Humanoid")
                if humanoid then
                    local currentHealth = humanoid.Health
                    local maxHealth = humanoid.MaxHealth
                    
                    if currentHealth < maxHealth then
                        local players = Players:GetPlayers()
                        local closestPlayer = nil
                        local closestDistance = math.huge
                        local localPos = character:GetPivot().Position
                        
                        for _, player in ipairs(players) do
                            if player ~= localPlayer then
                                local targetChar = player.Character
                                if targetChar then
                                    local targetPos = targetChar:GetPivot().Position
                                    local distance = (localPos - targetPos).Magnitude
                                    
                                    if distance < 50 and distance < closestDistance then
                                        closestDistance = distance
                                        closestPlayer = player
                                    end
                                end
                            end
                        end
                        
                        if closestPlayer then
                            self.lastAttacker = closestPlayer
                            self.lastAttackedTime = tick()
                        end
                    end
                end
            end
        end)
    end,
    
    stop = function(self)
        if self.connection then
            self.connection:Disconnect()
            self.connection = nil
        end
    end,
    
    getLastAttacker = function(self)
        if self.lastAttacker and tick() - self.lastAttackedTime < 5 then
            return self.lastAttacker
        end
        return nil
    end
}

local undergroundModule = {
    enabled = false,
    connection = nil,
    undergroundPosition = Vector3.new(0, -100, 0), 
    originalPosition = nil, 
    undergroundTimer = nil, 
    isUnderground = false, 
    
    start = function(self)
        if self.connection then
            self.connection:Disconnect()
        end
        
        self.connection = game:GetService("RunService").Heartbeat:Connect(function()
            if self.enabled then
                local localPlayer = Players.LocalPlayer
                local character = localPlayer.Character
                
                if character then
                    local humanoid = character:FindFirstChild("Humanoid")
                    if humanoid then
                        local currentHealth = humanoid.Health
                        local maxHealth = humanoid.MaxHealth
                        
                        if currentHealth < maxHealth and not self.isUnderground then
                            local rootPart = character:FindFirstChild("HumanoidRootPart")
                            if rootPart then
                                self.originalPosition = rootPart.CFrame
                                rootPart.CFrame = CFrame.new(self.undergroundPosition)
                                self.isUnderground = true
                                
                                if self.undergroundTimer then
                                    self.undergroundTimer:Disconnect()
                                end
                                
                                self.undergroundTimer = game:GetService("RunService").Heartbeat:Connect(function()
                                    wait(10) 
                                    if self.enabled and self.isUnderground and character and rootPart then
                                        if self.originalPosition then
                                            rootPart.CFrame = self.originalPosition
                                        else
                                            rootPart.CFrame = CFrame.new(0, 5, 0)
                                        end
                                        self.isUnderground = false
                                        self.originalPosition = nil
                                    end
                                    self.undergroundTimer:Disconnect()
                                    self.undergroundTimer = nil
                                end)
                            end
                        end
                    end
                end
            end
        end)
    end,
    
    stop = function(self)
        if self.connection then
            self.connection:Disconnect()
            self.connection = nil
        end
        if self.undergroundTimer then
            self.undergroundTimer:Disconnect()
            self.undergroundTimer = nil
        end
        
        if self.isUnderground then
            local localPlayer = Players.LocalPlayer
            local character = localPlayer.Character
            if character then
                local rootPart = character:FindFirstChild("HumanoidRootPart")
                if rootPart then
                    if self.originalPosition then
                        rootPart.CFrame = self.originalPosition
                    else
                        rootPart.CFrame = CFrame.new(0, 5, 0)
                    end
                end
            end
            self.isUnderground = false
            self.originalPosition = nil
        end
    end
}

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'TnineHub-猜猜小偷',
        Icon = "https://raw.githubusercontent.com/tnine-n9/tnine_Hub/refs/heads/main/retouch_2026012321291407.png",
        IconThemed = true,
        Author = "by凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(500, 390),
        Transparent = true,
        Theme = "Dark",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/tnine_Hub/refs/heads/main/IMG_20260129_204606.jpg",
        BackgroundImageTransparency = 0.5,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己的头像",
                    Content = "没什么",
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索功能",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button",
                    Text = "",
                    Style = "Subtle",
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })
    
    Window:EditOpenButton({
        Title = "tnine user",
        Icon = "https://raw.githubusercontent.com/tnine-n9/tnine_Hub/refs/heads/main/retouch_2026012321291407.png",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 1.25,
        Color = ColorSequence.new(Color3.fromHex("00FFFF")),
        Draggable = true,
    })
    
    Window:Tag({
        Title = "tnine team",
        Color = Color3.fromHex("#00FFFF")
    })
    
    Window:Tag({
        Title = "雄狮",
        Color = Color3.fromHex("#00FFFF")
    })

    local SixPathsTab = Window:Tab({
        Title = "超快速连抽",
        Desc = "直接抽死",
        Icon = "crown",
        IconColor = Color3.fromHex("#FF0000"),
        IconShape = "Square",
        Border = true,
    })

    SixPathsTab:Section({
        Title = "超快速连抽",
    })

    SixPathsTab:Toggle({
        Title = "开关",
        Description = "开启/关闭快速连抽",
        Default = false,
        Callback = function(enabled)
            sixPathsModule.enabled = enabled
            if enabled then
                sixPathsModule:start()
            else
                sixPathsModule:stop()
            end
        end
    })

    local OnePunchTab = Window:Tab({
        Title = "一拳超人",
        Desc = "一拳超人循环攻击",
        Icon = "crown",
        IconColor = Color3.fromHex("#00FF00"),
        IconShape = "Square",
        Border = true,
    })

    OnePunchTab:Section({
        Title = "一拳超人",
    })

    OnePunchTab:Toggle({
        Title = "开关",
        Description = "开启/关闭一拳超人攻击",
        Default = false,
        Callback = function(enabled)
            onePunchModule.enabled = enabled
            if enabled then
                onePunchModule:start()
            else
                onePunchModule:stop()
            end
        end
    })

    local GuessTab = Window:Tab({
        Title = "猜玩家",
        Desc = "自动猜服务器中的玩家",
        Icon = "crown",
        IconColor = Color3.fromHex("#00AAFF"),
        IconShape = "Square",
        Border = true,
    })

    GuessTab:Section({
        Title = "猜玩家功能",
    })

    local attackerInfo = GuessTab:Section({
        Title = "攻击者：无",
        TextSize = 14,
        FontWeight = Enum.FontWeight.Medium,
    })

    local autoGuessEnabled = false
    local autoGuessConnection = nil

    local function getSortedPlayersByDistance()
        local players = Players:GetPlayers()
        local localPlayer = Players.LocalPlayer
        local localChar = localPlayer.Character
        local sortedPlayers = {}
        
        if not localChar then return players end
        
        local localPos = localChar:GetPivot().Position
        
        for _, player in ipairs(players) do
            if player ~= localPlayer then
                local targetChar = player.Character
                if targetChar then
                    local targetPos = targetChar:GetPivot().Position
                    local distance = (localPos - targetPos).Magnitude
                    table.insert(sortedPlayers, {
                        player = player,
                        distance = distance
                    })
                else
                    table.insert(sortedPlayers, {
                        player = player,
                        distance = math.huge
                    })
                end
            end
        end
        
        table.sort(sortedPlayers, function(a, b)
            return a.distance < b.distance
        end)
        
        return sortedPlayers
    end

    local function updateAttackerInfo()
        local attacker = attackerDetection:getLastAttacker()
        if attacker then
            attackerInfo:SetTitle("攻击玩家：" .. attacker.Name)
        else
            attackerInfo:SetTitle("攻击玩家：无")
        end
    end

    local function guessAttackerFirst()
        local attacker = attackerDetection:getLastAttacker()
        if attacker then
            local args = {[1] = attacker.Name}
            game:GetService("ReplicatedStorage").events.Guess:FireServer(unpack(args))
            return true
        end
        return false
    end

    GuessTab:Toggle({
        Title = "自动猜人开关",
        Description = "开启后按距离优先自动猜人",
        Default = false,
        Callback = function(enabled)
            autoGuessEnabled = enabled
            
            if enabled then
                attackerDetection:start()
                
                autoGuessConnection = game:GetService("RunService").Heartbeat:Connect(function()
                    if not autoGuessEnabled then return end
                    
                    local guessed = guessAttackerFirst()
                    
                    if not guessed then
                        local sortedPlayers = getSortedPlayersByDistance()
                        
                        for _, data in ipairs(sortedPlayers) do
                            if data.player and data.distance < 100 then
                                local args = {[1] = data.player.Name}
                                game:GetService("ReplicatedStorage").events.Guess:FireServer(unpack(args))
                                wait(0.2)
                                break
                            end
                        end
                    end
                    
                    updateAttackerInfo()
                end)
            else
                if autoGuessConnection then
                    autoGuessConnection:Disconnect()
                    autoGuessConnection = nil
                end
                attackerDetection:stop()
                attackerInfo:SetTitle("攻击者：无")
            end
        end
    })

    GuessTab:Button({
        Title = "猜最近玩家",
        Description = "只猜距离最近的玩家",
        Callback = function()
            local sortedPlayers = getSortedPlayersByDistance()
            
            if #sortedPlayers > 0 then
                local nearestPlayer = sortedPlayers[1].player
                local args = {[1] = nearestPlayer.Name}
                game:GetService("ReplicatedStorage").events.Guess:FireServer(unpack(args))
            end
        end
    })

    GuessTab:Toggle({
        Title = "自动传送地下(10秒返回)",
        Description = "10秒后回到地面",
        Default = false,
        Callback = function(enabled)
            undergroundModule.enabled = enabled
            if enabled then
                undergroundModule:start()
            else
                undergroundModule:stop()
            end
        end
    })

    local InfiniteSlapTab = Window:Tab({
        Title = "无限抢人头",
        Desc = "无限触发SlapQueue事件",
        Icon = "crown",
        IconColor = Color3.fromHex("#FF00FF"),
        IconShape = "Square",
        Border = true,
    })

    InfiniteSlapTab:Section({
        Title = "无限抢人头",
    })

    InfiniteSlapTab:Toggle({
        Title = "无限抢人头开关",
        Description = "开启后自动快速触发SlapQueue事件",
        Default = false,
        Callback = function(enabled)
            infiniteSlapModule.enabled = enabled
            if enabled then
                infiniteSlapModule:start()
            else
                infiniteSlapModule:stop()
            end
        end
    })

    local AboutTab = Window:Tab({
        Title = "About 雄狮",
        Desc = "凌乱牛逼", 
        Icon = "solar:info-square-bold",
        IconColor = Color3.fromHex("#83889E"),
        IconShape = "Square",
        Border = true,
    })

    AboutTab:Section({
        Title = "About 雄狮",
    })

    AboutTab:Image({
        Image = "https://raw.githubusercontent.com/tnine-n9/tnine_Hub/refs/heads/main/Image_1769596721060_218.jpg",
        AspectRatio = "16:9",
        Radius = 9,
    })

    AboutTab:Space({ Columns = 3 })

    AboutTab:Section({
        Title = "什么是雄狮",
        TextSize = 24,
        FontWeight = Enum.FontWeight.SemiBold,
    })

    AboutTab:Space()

    AboutTab:Section({
        Title = "是由messy和龙王组成的一个强大团队",
        TextSize = 18,
        TextTransparency = .35,
        FontWeight = Enum.FontWeight.Medium,
    })

    AboutTab:Space({ Columns = 4 })

    AboutTab:Button({
        Title = "关闭所有功能并销毁UI",
        Color = Color3.fromHex("#ff4830"),
        Justify = "Center",
        Icon = "shredder",
        IconAlign = "Left",
        Callback = function()
            sixPathsModule:stop()
            onePunchModule:stop()
            infiniteSlapModule:stop()
            attackerDetection:stop()
            undergroundModule:stop()
            if autoGuessConnection then
                autoGuessConnection:Disconnect()
            end
            Window:Destroy()
        end
    })
end

elseif game.PlaceId == 7239319209 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
  
    if char:match("[A-Za-z0-9]") then
    
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
    
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n支持YG感谢您！\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})
function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "Version Beat",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(580, 440),
        Transparent = true,
        Theme = "Dark",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/dohyynd/666/5a74d5d651b6538ea73d10275e1e0dae718030dd/m.png",
        BackgroundImageTransparency = 0.5,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

Window:EditOpenButton({
    Title = "YG SCRIPT.",
    Icon = "crown",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 4,
    Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
    Draggable = true,
})
Window:Tag({
    Title = "俄亥俄州",
    Color = Color3.fromHex("#FFA500") 
})
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do  
            local color = Color3.fromHSV(hue, 0.8, 1)  
            Window:EditOpenButton({
                Color = ColorSequence.new(color)
            })
            wait(0.04)  
        end
    end
end)
if not borderInitialized then
    spawn(function()
        wait(0.5)
        initializeRainbowBorder("糖果颜色", animationSpeed)
        wait(1)
        applyFontStyleToWindow(currentFontStyle)
    end)
end

local windowOpen = true

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
end)

local originalOpenFunction = Window.Open
Window.Open = function(...)
    windowOpen = true
    local result = originalOpenFunction(...)
    
    if borderInitialized and borderEnabled and not rainbowBorderAnimation then
        wait(0.1)
        startBorderAnimation(Window, animationSpeed)
    end
    
    return result
end

local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

infoSection:Divider()

infoSection:Paragraph({
    Title = "您当前的服务器为",
    Desc = "俄亥俄州\n欢迎使用YG此脚本",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "持续更新，有bug请提出来",
    ThumbnailSize = 190,
})

local LockSection = Window:Section({
    Title = "功能区域",
    Icon = "crown",
    Opened = true,
})
local K = Window:Tab({Title = "战斗", Icon = "swords"})
K:Section({ Title = "愤怒机器人", Icon = "swords" })
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local localPlayer = Players.LocalPlayer

local autoKillSettings = {
    isEnabled = false,
    range = 100,
    showBeams = true
}

local activeBeams = {}
local lastShootTime = 0
local lastReloadTime = 0
local shootInterval = 0.05
local reloadInterval = 3 

local function hasShield(character)
    if not character then return false end
    local shield = character:FindFirstChild("Shield") or character:FindFirstChild("ForceField")
    return shield ~= nil
end

local function isPlayerAlive(character)
    if not character then return false end
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    return humanoid and humanoid.Health > 0
end

local function purchaseAmmo(weaponName)
    pcall(function()
        require(game:GetService("ReplicatedStorage").devv).load("Signal").InvokeServer("attemptPurchaseAmmo", weaponName)
    end)
end

local function createBeamEffect(startPos, endPos)
    if not autoKillSettings.showBeams then return end
    
    local beam = Instance.new("Part")
    beam.Name = "KillBeam"
    beam.Anchored = true
    beam.CanCollide = false
    beam.CastShadow = false
    beam.Transparency = 0.2
    beam.Material = Enum.Material.Neon
    beam.Color = Color3.fromRGB(255, 0, 0)
    
    local direction = (endPos - startPos)
    local distance = direction.Magnitude
    
    beam.Size = Vector3.new(0.3, 0.3, distance)
    beam.CFrame = CFrame.lookAt(startPos, endPos) * CFrame.new(0, 0, -distance/2)
    
    local startGlow = Instance.new("Part")
    startGlow.Name = "StartGlow"
    startGlow.Anchored = true
    startGlow.CanCollide = false
    startGlow.Shape = Enum.PartType.Ball
    startGlow.Size = Vector3.new(1.2, 1.2, 1.2)
    startGlow.Color = Color3.fromRGB(255, 50, 50)
    startGlow.Material = Enum.Material.Neon
    startGlow.Transparency = 0.1
    startGlow.Position = startPos
    startGlow.Parent = beam
    
    local endGlow = startGlow:Clone()
    endGlow.Name = "EndGlow"
    endGlow.Position = endPos
    endGlow.Parent = beam
    
    local innerBeam = Instance.new("Part")
    innerBeam.Name = "InnerBeam"
    innerBeam.Anchored = true
    innerBeam.CanCollide = false
    innerBeam.Transparency = 0.1
    innerBeam.Material = Enum.Material.Neon
    innerBeam.Color = Color3.fromRGB(255, 100, 100)
    innerBeam.Size = Vector3.new(0.2, 0.2, distance)
    innerBeam.CFrame = beam.CFrame
    innerBeam.Parent = beam
    
    local pointLight = Instance.new("PointLight")
    pointLight.Brightness = 6
    pointLight.Range = 12
    pointLight.Color = Color3.fromRGB(255, 0, 0)
    pointLight.Parent = startGlow
    
    local pointLight2 = pointLight:Clone()
    pointLight2.Parent = endGlow
    
    beam.Parent = Workspace
    
    local beamInfo = {
        beam = beam,
        startTime = tick(),
        endTime = tick() + 0.3
    }
    
    table.insert(activeBeams, beamInfo)
    
    delay(0.3, function()
        if beam and beam.Parent then
            local fadeTween = TweenService:Create(beam, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Transparency = 1})
            fadeTween:Play()
            fadeTween.Completed:Connect(function()
                if beam and beam.Parent then
                    beam:Destroy()
                end
            end)
        end
    end)
    
    return beam
end

local function updateBeams()
    local currentTime = tick()
    local beamsToRemove = {}
    
    for i, beamInfo in ipairs(activeBeams) do
        if currentTime >= beamInfo.endTime then
            table.insert(beamsToRemove, i)
        end
    end
    
    for i = #beamsToRemove, 1, -1 do
        local index = beamsToRemove[i]
        local beamInfo = activeBeams[index]
        if beamInfo.beam and beamInfo.beam.Parent then
            beamInfo.beam:Destroy()
        end
        table.remove(activeBeams, index)
    end
end

local function isInRange(position1, position2)
    return (position1 - position2).Magnitude <= autoKillSettings.range
end

local function getShootingInfo()
    local success, reloadFunc = pcall(function()
        return getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.reload), 2)
    end)
    
    if not success then return nil end
    
    local success2, t = pcall(function()
        return getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.shoot), 1)
    end)
    
    if success2 and t and t.item then
        return {
            reload = reloadFunc,
            ammo = t.item.ammoManager,
            gunid = t.item.guid,
            firemode = t.item.firemode,
            weaponName = t.item.name
        }
    end
    return nil
end

local function autoReload(shootingInfo, forceReload)
    if not shootingInfo then return end
    
    local currentTime = tick()
    
    if forceReload or (currentTime - lastReloadTime >= reloadInterval) then
        local reloadEvent = ReplicatedStorage.devv.remoteStorage:FindFirstChild("reload")
        if reloadEvent and shootingInfo.reload then
            purchaseAmmo(shootingInfo.weaponName)
            firesignal(reloadEvent.OnClientEvent, shootingInfo.gunid, 0, shootingInfo.ammo.ammoOut)
            shootingInfo.reload()
            lastReloadTime = currentTime
        end
    end
end

local function getAlivePlayersInRange()
    local localCharacter = localPlayer.Character
    local localRootPart = localCharacter and localCharacter:FindFirstChild("HumanoidRootPart")
    if not localRootPart then return {} end
    
    local targets = {}
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= localPlayer and player.Character then
            local character = player.Character
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
            
            if humanoid and humanoid.Health > 0 and humanoidRootPart and not hasShield(character) then
                if isInRange(localRootPart.Position, humanoidRootPart.Position) then
                    table.insert(targets, {
                        player = player,
                        character = character,
                        rootPart = humanoidRootPart
                    })
                end
            end
        end
    end
    
    return targets
end

local function shootAtPlayer(targetData, shootingInfo, rightArm)
    if not shootingInfo or not targetData or not rightArm then return false end
    
    if shootingInfo.ammo.ammo <= 0 then
        autoReload(shootingInfo, true)
        return false
    end
    
    local targetParts = {
        targetData.character:FindFirstChild("Head"),
        targetData.character:FindFirstChild("UpperTorso"),
        targetData.character:FindFirstChild("HumanoidRootPart")
    }
    
    local Event1 = ReplicatedStorage.devv.remoteStorage:FindFirstChild("replicateProjectiles")
    local Event2 = ReplicatedStorage.devv.remoteStorage:FindFirstChild("projectileHit")
    
    if not Event1 or not Event2 then return false end
    
    for _, targetPart in ipairs(targetParts) do
        if targetPart and shootingInfo.ammo.ammo > 0 and isPlayerAlive(targetData.character) then
            local startPos = rightArm.Position
            createBeamEffect(startPos, targetPart.Position)
            
            Event1:FireServer(shootingInfo.gunid, {{"TrackingBullet", targetPart.CFrame}}, shootingInfo.firemode)
            Event2:FireServer("TrackingBullet", "player", {
                hitPart = targetPart,
                hitPlayerId = targetData.player.UserId,
                hitSize = targetPart.Size,
                pos = targetPart.Position
            })
            shootingInfo.ammo.ammo = shootingInfo.ammo.ammo - 1
            return true
        end
    end
    
    return false
end

local function autoKillAll()
    if not autoKillSettings.isEnabled then return end
    
    local currentTime = tick()
    if currentTime - lastShootTime < shootInterval then return end
    
    local targets = getAlivePlayersInRange()
    if #targets == 0 then return end
    
    local shootingInfo = getShootingInfo()
    if not shootingInfo then
        autoReload(shootingInfo, true)
        return
    end
    
    local localCharacter = localPlayer.Character
    if not localCharacter then return end
    
    local rightArm = localCharacter:FindFirstChild("RightHand")
    if not rightArm then return end
    
    for _, targetData in ipairs(targets) do
        if isPlayerAlive(targetData.character) and not hasShield(targetData.character) then
            if shootingInfo.ammo.ammo <= 0 then
                autoReload(shootingInfo, true)
                shootingInfo = getShootingInfo()
                if not shootingInfo then break end
            end
            
            local shotFired = shootAtPlayer(targetData, shootingInfo, rightArm)
            if shotFired then
                lastShootTime = currentTime
            end
        end
    end
end

local autoKillConnection
local beamUpdateConnection

local function toggleAutoKill(isEnabled)
    autoKillSettings.isEnabled = isEnabled
    if isEnabled then
        if autoKillConnection then
            autoKillConnection:Disconnect()
        end
        autoKillConnection = RunService.Heartbeat:Connect(autoKillAll)
        
        if beamUpdateConnection then
            beamUpdateConnection:Disconnect()
        end
        beamUpdateConnection = RunService.Heartbeat:Connect(updateBeams)
        
        lastReloadTime = tick()
    else
        if autoKillConnection then
            autoKillConnection:Disconnect()
            autoKillConnection = nil
        end
        
        if beamUpdateConnection then
            beamUpdateConnection:Disconnect()
            beamUpdateConnection = nil
        end
        
        for _, beamInfo in ipairs(activeBeams) do
            if beamInfo.beam and beamInfo.beam.Parent then
                beamInfo.beam:Destroy()
            end
        end
        activeBeams = {}
    end
end

K:Toggle({
    Title = "愤怒机器人[全枪]",
    Value = false,
    Callback = toggleAutoKill
})

K:Slider({
    Title = "射击范围",
    Value = {
        Min = 1,
        Max = 600,
        Default = 100,
    },
    Callback = function(Value)
        autoKillSettings.range = Value
    end
})

K:Toggle({
    Title = "子弹轨迹",
    Default = true,
    Callback = function(v)
        autoKillSettings.showBeams = v
    end
})

K:Section({ Title = "杀戮类", Icon = "swords" })
local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer
local b1 = require(game:GetService('ReplicatedStorage').devv).load('v3item').inventory.items
local autokill = false
local autostomp = false
local grabplay = false
local autoFists = false

local function equipFists()
    for i, v in next, b1 do 
        if v.name == 'Fists' then 
            Signal.FireServer("equip", v.guid)
            break
        end
    end
end

local function killAura()
    local character = localPlayer.Character
    if not character then return end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= localPlayer and player.Character then
            local targetChar = player.Character
            local targetHRP = targetChar:FindFirstChild("HumanoidRootPart")
            if targetHRP then
                local distance = (rootPart.Position - targetHRP.Position).Magnitude
                if distance <= 35 then
                    local uid = player.UserId
                    Signal.FireServer("meleeAttackHit", "player", { 
                        meleeType = "meleemegapunch", 
                        hitPlayerId = uid 
                    })
                end
            end
        end
    end
end

-- 踩踏光环
local function stompAura()
    local character = localPlayer.Character
    if not character then return end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= localPlayer and player.Character then
            local targetChar = player.Character
            local targetHRP = targetChar:FindFirstChild("HumanoidRootPart")
            local targetHumanoid = targetChar:FindFirstChild("Humanoid")
            if targetHRP and targetHumanoid and targetHumanoid.Health < 20 then
                local distance = (rootPart.Position - targetHRP.Position).Magnitude
                if distance <= 40 then
                    Signal.FireServer("finish", player)
                end
            end
        end
    end
end

-- 抓取光环
local function grabAura()
    local character = localPlayer.Character
    if not character then return end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= localPlayer and player.Character then
            local targetChar = player.Character
            local targetHRP = targetChar:FindFirstChild("HumanoidRootPart")
            local targetHumanoid = targetChar:FindFirstChild("Humanoid")
            if targetHRP and targetHumanoid and targetHumanoid.Health < 20 then
                local distance = (rootPart.Position - targetHRP.Position).Magnitude
                if distance <= 40 then
                    Signal.FireServer("grabPlayer", player)
                end
            end
        end
    end
end

game:GetService("RunService").Heartbeat:Connect(function()
    if autokill then
        killAura()
    end
    
    if autostomp then
        stompAura()
    end
    
    if grabplay then
        grabAura()
    end
    
    if autoFists then
        equipFists()
    end
end)

K:Toggle({
    Title = "自动装备拳头",
    Value = false,
    Callback = function(state) 
        autoFists = state
    end
})

K:Toggle({
    Title = "杀戮光环[一拳]",
    Value = false,
    Callback = function(state) 
        autokill = state
    end
})

K:Toggle({
    Title = "踩踏光环",
    Value = false,
    Callback = function(state) 
        autostomp = state
    end
})

K:Toggle({
    Title = "抓取光环",
    Value = false,
    Callback = function(state) 
        grabplay = state
    end
})

K:Section({ Title = "防护", Icon = "swords" })
K:Toggle({
    Title = "自动穿甲",
    Default = false,
    Callback = function(Value)
        AutoArmor = Value
        if Value then
            local heartbeat = game:GetService("RunService").Heartbeat
            local connection
            connection = heartbeat:Connect(function()
                if not AutoArmor then
                    connection:Disconnect()
                    return
                end
                
                pcall(function()
                    local player = game:GetService('Players').LocalPlayer
                    local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
                    if humanoid and humanoid.Health > 35 then
                        local b1 = require(game:GetService('ReplicatedStorage').devv).load('v3item').inventory.items
                        local hasLightVest = false
                        
                        for i, v in next, b1 do
                            if v.name == "Light Vest" then
                                hasLightVest = true
                                light = v.guid
                                local armor = player:GetAttribute('armor')
                                if armor == nil or armor <= 0 then
                                    require(game:GetService("ReplicatedStorage").devv).load("Signal").FireServer("equip", light)
                                    require(game:GetService("ReplicatedStorage").devv).load("Signal").FireServer("useConsumable", light)
                                    require(game:GetService("ReplicatedStorage").devv).load("Signal").FireServer("removeItem", light)
                                end
                                break
                            end
                        end
                        
                        if not hasLightVest then
                            require(game:GetService("ReplicatedStorage").devv).load("Signal").InvokeServer("attemptPurchase", "Light Vest")
                        end
                    end
                end)
            end)
        end
    end
})
K:Toggle({
    Title = "自动面具",
    --Image = "bird",
    Value = false,
    Callback = function(state) 
    autokz = state
    if autokz then
    while autokz and wait(1) do
local player = game:GetService("Players").LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local Mask = character:FindFirstChild("Hockey Mask")
local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
local b1 = require(game:GetService('ReplicatedStorage').devv).load('v3item').inventory.items
if not Mask then
Signal.InvokeServer("attemptPurchase", "Hockey Mask")
for i, v in next, b1 do
if v.name == "Hockey Mask" then
sugid = v.guid
if not Mask then
Signal.FireServer("equip", sugid)
Signal.FireServer("wearMask", sugid)
end
break
end
end
end
end
end
    end
})
K:Toggle({
    Title = "自动回血",
    Default = false,
    Callback = function(Value)
        if healThread then
            healThread:Disconnect()
            healThread = nil
        end

        if Value then
            local heartbeat = game:GetService("RunService").Heartbeat
            healThread = heartbeat:Connect(function()
                Signal.InvokeServer("attemptPurchase", 'Bandage')
                for _, v in next, item.inventory.items do
                    if v.name == 'Bandage' then
                        local bande = v.guid
                        local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
                        local Humanoid = Character:WaitForChild('Humanoid')
                        if Humanoid.Health >= 5 and Humanoid.Health < Humanoid.MaxHealth then
                            Signal.FireServer("equip", bande)
                            Signal.FireServer("useConsumable", bande)
                            Signal.FireServer("removeItem", bande)
                        end
                        break
                    end
                end
            end)
        end
    end
})
local melee = require(game:GetService("ReplicatedStorage").devv).load("ClientReplicator")
local lp = game:GetService("Players").LocalPlayer
local AutoKnockReset = false
K:Toggle({
    Title = "防倒地",
    Default = false,
    Callback = function(Value)
        AutoKnockReset = Value
        if Value then
            task.spawn(function()
                while AutoKnockReset do
                    if lp.Character and lp.Character:FindFirstChild("Humanoid") then
                        melee.Set(lp, "knocked", false)
                        melee.Replicate("knocked")
                    end
                    wait()
                end
            end)
        end
    end
})

K:Toggle({
    Title = "防虚空",
    Default = false,
    Callback = function(Value)
        task.spawn(function()
            while Value and task.wait(0.1) do
                local character = game:GetService("Players").LocalPlayer.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    local humanoidRootPart = character.HumanoidRootPart
                    local position = humanoidRootPart.Position
                    if position.Y < -200 then
                        humanoidRootPart.CFrame = CFrame.new(1339.9090576171875, 6.044891357421875, -660.3264770507812)
                    end
                end
            end
        end)
    end
})
K:Toggle({
    Title = "防甩飞",
    Default = false,
    Callback = function(Value)
        task.spawn(function()
            while Value and task.wait(0.1) do
                local character = game:GetService("Players").LocalPlayer.Character
                if character then
                    for _, part in ipairs(character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = false
                        end
                    end
                end
            end
        end)
    end
})
K:Toggle({
    Title = "显示名字血量",
    Value = false,
    Callback = function(enableESP)
        if enableESP then
            local function ApplyESP(v)
                if v.Character and v.Character:FindFirstChildOfClass'Humanoid' then
                    v.Character.Humanoid.NameDisplayDistance = 9e9
                    v.Character.Humanoid.NameOcclusion = "NoOcclusion"
                    v.Character.Humanoid.HealthDisplayDistance = 9e9
                    v.Character.Humanoid.HealthDisplayType = "AlwaysOn"
                    v.Character.Humanoid.Health = v.Character.Humanoid.Health 
                end
            end
            
            local Players = game:GetService("Players")
            local RunService = game:GetService("RunService")
            
        
            for i, v in pairs(Players:GetPlayers()) do
                ApplyESP(v)
                v.CharacterAdded:Connect(function()
                    task.wait(0.33)
                    ApplyESP(v)
                end)
            end
            
          
            Players.PlayerAdded:Connect(function(v)
                ApplyESP(v)
                v.CharacterAdded:Connect(function()
                    task.wait(0.33)
                    ApplyESP(v)
                end)
            end)
            
          
            local espConnection = RunService.Heartbeat:Connect(function()
                for i, v in pairs(Players:GetPlayers()) do
                    if v.Character and v.Character:FindFirstChildOfClass'Humanoid' then
                        v.Character.Humanoid.NameDisplayDistance = 9e9
                        v.Character.Humanoid.NameOcclusion = "NoOcclusion"
                        v.Character.Humanoid.HealthDisplayDistance = 9e9
                        v.Character.Humanoid.HealthDisplayType = "AlwaysOn"
                    end
                end
            end)
            
        
            _G.ESPConnection = espConnection
        else
          
            if _G.ESPConnection then
                _G.ESPConnection:Disconnect()
                _G.ESPConnection = nil
            end
            
           
            local Players = game:GetService("Players")
            for i, v in pairs(Players:GetPlayers()) do
                if v.Character and v.Character:FindFirstChildOfClass'Humanoid' then
                    v.Character.Humanoid.NameDisplayDistance = 100
                    v.Character.Humanoid.NameOcclusion = "OccludeAll"
                    v.Character.Humanoid.HealthDisplayDistance = 100
                    v.Character.Humanoid.HealthDisplayType = "DisplayWhenDamaged"
                end
            end
        end
    end
})
K:Toggle({
    Title = "防僵直",
    Default = false,
    Callback = function(Value)
        task.spawn(function()
            while Value and task.wait(0.1) do
                local character = game:GetService("Players").LocalPlayer.Character
                if character and character:FindFirstChild("Humanoid") then
                    local humanoid = character.Humanoid
                    if humanoid:GetState() == Enum.HumanoidStateType.Frozen then
                        humanoid:ChangeState(Enum.HumanoidStateType.Running)
                    end
                end
            end
        end)
    end
})

K:Toggle({
    Title = "防坐下",
    Default = false,
    Callback = function(Value)
        task.spawn(function()
            while Value and task.wait(0.1) do
                local character = game:GetService("Players").LocalPlayer.Character
                if character and character:FindFirstChild("Humanoid") then
                    local humanoid = character.Humanoid
                    if humanoid:GetState() == Enum.HumanoidStateType.Seated then
                        humanoid.Sit = false
                        humanoid:ChangeState(Enum.HumanoidStateType.Running)
                    end
                end
            end
        end)
    end
})
local Main = Window:Tab({Title = "魔法", Icon = "settings"})
Main:Section({ Title = "全图类", Icon = "swords" })

local bombardmentEnabled={RPG=false,Flamethrower=false,AcidGun=false}
local bombardmentConnections={}
local lastBombardmentTime=0 
local lastAmmoPurchaseTime=0 
local ammoPurchaseInterval=2 
local ammoPurchaseAmount=2 
local BOMBARDMENT_DURATION=3.2 

local function fixRemoteNames()
    local signalModule=require(game:GetService("ReplicatedStorage").devv.client.Helpers.remotes.Signal)
    for i,v in next,getupvalue(signalModule.LinkSignal,1)do 
        v.Name=i 
        v:GetPropertyChangedSignal("Name"):Connect(function()v.Name=i end)
    end 
    for i,v in next,getupvalue(signalModule.InvokeServer,1)do 
        v.Name=i 
        v:GetPropertyChangedSignal("Name"):Connect(function()v.Name=i end)
    end 
    for i,v in next,getupvalue(signalModule.FireServer,1)do 
        v.Name=i 
        v:GetPropertyChangedSignal("Name"):Connect(function()v.Name=i end)
    end 
end 
fixRemoteNames()

local function hasShield(player)
    local character=player.Character 
    if not character then return false end 
    local shieldPart=character:FindFirstChild("Shield")or character:FindFirstChild("ForceField")
    if shieldPart then return true end 
    for _,child in ipairs(character:GetDescendants())do 
        if child:IsA("ParticleEmitter")and child.Name:lower():find("shield")then 
            return true 
        end 
    end 
    return false 
end 

local function getAccuracyOffset()
    return Vector3.new(math.random(-0.2,0.2),math.random(-0.2,0.2),math.random(-0.2,0.2))
end 

local function purchaseAmmo(weaponType)
    local ammoType 
    if weaponType=="RPG" then 
        ammoType="RPG" 
    elseif weaponType=="Flamethrower" then 
        ammoType="Flamethrower" 
    elseif weaponType=="AcidGun" then 
        ammoType="Ace Gun" 
    end 
    require(game:GetService("ReplicatedStorage").devv).load("Signal").InvokeServer("attemptPurchaseAmmo",ammoType)
end 

local function createVisualEffect(position)
    local explosion = Instance.new("Explosion")
    explosion.Position = position
    explosion.BlastPressure = 0
    explosion.BlastRadius = 10
    explosion.ExplosionType = Enum.ExplosionType.NoCraters
    explosion.DestroyJointRadiusPercent = 0
    explosion.Parent = workspace
    delay(1, function() explosion:Destroy() end)
end

local function performBombardment(weaponType)
    local ReplicatedStorage=game:GetService("ReplicatedStorage")
    local Players=game:GetService("Players")
    local localPlayer=Players.LocalPlayer 
    local reload=getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.reload),2)
    local t=getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.shoot),1)
    local reloadEvent=ReplicatedStorage.devv.remoteStorage:FindFirstChild("reload")
    local ammo=t.item.ammoManager 
    local gunid=t.item.guid 
    local firemode=t.item.firemode 
    
    firesignal(reloadEvent.OnClientEvent,gunid,0,ammo.ammoOut)
    reload()
    
    local targets={}
    for _,player in ipairs(Players:GetPlayers())do 
        if player==localPlayer then continue end 
        if hasShield(player)then continue end 
        local character=player.Character 
        if not character then continue end 
        local humanoid=character:FindFirstChildOfClass("Humanoid")
        if not humanoid or humanoid.Health<=0 then continue end 
        
    
        if humanoid.Health <= 18 then continue end
        
        local hitbox=character:FindFirstChild("Hitbox")
        if not hitbox then continue end 
        local headHitbox=hitbox:FindFirstChild("Head_Hitbox")
        if not headHitbox then continue end 
        local targetRootPart=character:FindFirstChild("HumanoidRootPart")or humanoid.RootPart 
        if not targetRootPart then continue end 
        
        table.insert(targets,{player=player,character=character,headHitbox=headHitbox,rootPart=targetRootPart,humanoid=humanoid})
    end 
    
    if #targets==0 then return end 
    
    for _,targetData in ipairs(targets)do 
        local targetHeadCFrame=targetData.headHitbox.CFrame 
        local targetHeadPosition=targetData.headHitbox.Position 
        local targetPlayerId=targetData.player.UserId 
        targetHeadCFrame=CFrame.new(targetHeadPosition)
        
        if weaponType=="RPG" then 
            local shots=5 
            for i=1,math.min(ammo.ammo,shots)do 
                local offset=getAccuracyOffset()
                local adjustedCFrame=targetHeadCFrame+offset 
                local Event1=ReplicatedStorage.devv.remoteStorage:FindFirstChild("replicateProjectiles")
                if Event1 then 
                    Event1:FireServer(gunid,{{"EZohio123",adjustedCFrame}},firemode)
                end 
                local Event2=ReplicatedStorage.devv.remoteStorage:FindFirstChild("projectileHit")
                if Event2 then 
                    Event2:FireServer("EZohio123","player",{hitPart=targetData.headHitbox,hitPlayerId=targetPlayerId,hitSize=targetData.headHitbox.Size,pos=targetHeadPosition+offset})
                end 
                
             
                createVisualEffect(targetHeadPosition + offset)
            end 
            
            local rocketHitEvent=ReplicatedStorage.devv.remoteStorage:FindFirstChild("rocketHit")
            if rocketHitEvent then 
                for i=1,5 do 
                    local offset=getAccuracyOffset()
                    rocketHitEvent:FireServer("EZohio123","EZohio123",targetHeadPosition+offset)
                 
                    createVisualEffect(targetHeadPosition + offset)
                end 
            end 
            
        elseif weaponType=="Flamethrower" then 
            local flameHitEvent=ReplicatedStorage.devv.remoteStorage:FindFirstChild("flameHit")
            if flameHitEvent then 
                for i=1,50 do 
                    local offset=getAccuracyOffset()
                    flameHitEvent:FireServer("EZohio123","EZohio123",targetHeadPosition+offset)
                end 
            end 
            
        elseif weaponType=="AcidGun" then 
            local acidHitEvent=ReplicatedStorage.devv.remoteStorage:FindFirstChild("acidHit")
            if acidHitEvent then 
                for i=1,6 do 
                    local offset=getAccuracyOffset()
                    acidHitEvent:FireServer("EZohio123","EZohio123",targetHeadPosition+offset)
                end 
            end 
        end 
        
    
        if targetData.humanoid.Health > 18 then
          
            if weaponType == "RPG" then
                for i = 1, 2 do
                    local offset = getAccuracyOffset()
                    local rocketHitEvent = ReplicatedStorage.devv.remoteStorage:FindFirstChild("rocketHit")
                    if rocketHitEvent then
                        rocketHitEvent:FireServer("EZohio123", "EZohio123", targetHeadPosition + offset)
                        createVisualEffect(targetHeadPosition + offset)
                    end
                end
            end
        end
    end 
    
    firesignal(reloadEvent.OnClientEvent,gunid,0,ammo.ammoOut)
    reload()
end

Main:Toggle({
    Title="全图RPG",
    Default=false,
    Callback=function(Value)
        bombardmentEnabled.RPG=Value 
        if bombardmentConnections.RPG then 
            bombardmentConnections.RPG:Disconnect()
            bombardmentConnections.RPG=nil 
        end 
        if Value then 
            local RunService=game:GetService("RunService")
            local Players=game:GetService("Players")
            local localPlayer=Players.LocalPlayer 
            local guid=require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
            local originalGUID=hookfunction(guid,function(...)return "EZohio123" end)
            
            bombardmentConnections.RPG=RunService.Heartbeat:Connect(function()
                local currentTime=tick()
                local ping=game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
                if ping>1850 then return end 
                
                if currentTime-lastAmmoPurchaseTime>=ammoPurchaseInterval then 
                    for i=1,ammoPurchaseAmount do 
                        pcall(purchaseAmmo,"RPG")
                    end 
                    lastAmmoPurchaseTime=currentTime 
                end 
                
                if currentTime-lastBombardmentTime>=0.15 then 
                    pcall(function()
                        performBombardment("RPG")
                    end)
                    lastBombardmentTime=currentTime 
                end 
            end)
            
            _G.RPGBombardment={
                connection=bombardmentConnections.RPG,
                originalGUID=originalGUID
            }
        else 
            if _G.RPGBombardment then 
                if _G.RPGBombardment.connection then 
                    _G.RPGBombardment.connection:Disconnect()
                end 
                if _G.RPGBombardment.originalGUID then 
                    local guid=require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
                    hookfunction(guid,_G.RPGBombardment.originalGUID)
                end 
                _G.RPGBombardment=nil 
            end 
        end 
    end
})

Main:Toggle({
    Title="全图火焰发射器",
    Default=false,
    Callback=function(Value)
        bombardmentEnabled.Flamethrower=Value 
        if bombardmentConnections.Flamethrower then 
            bombardmentConnections.Flamethrower:Disconnect()
            bombardmentConnections.Flamethrower=nil 
        end 
        if Value then 
            local RunService=game:GetService("RunService")
            local Players=game:GetService("Players")
            local localPlayer=Players.LocalPlayer 
            local guid=require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
            local originalGUID=hookfunction(guid,function(...)return "EZohio123" end)
            
            bombardmentConnections.Flamethrower=RunService.Heartbeat:Connect(function()
                local currentTime=tick()
                local ping=game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
                if ping>1850 then return end 
                
                if currentTime-lastAmmoPurchaseTime>=ammoPurchaseInterval then 
                    for i=1,ammoPurchaseAmount do 
                        pcall(purchaseAmmo,"Flamethrower")
                    end 
                    lastAmmoPurchaseTime=currentTime 
                end 
                
                if currentTime-lastBombardmentTime>=0.15 then 
                    pcall(function()
                        performBombardment("Flamethrower")
                    end)
                    lastBombardmentTime=currentTime 
                end 
            end)
            
            _G.FlamethrowerBombardment={
                connection=bombardmentConnections.Flamethrower,
                originalGUID=originalGUID
            }
        else 
            if _G.FlamethrowerBombardment then 
                if _G.FlamethrowerBombardment.connection then 
                    _G.FlamethrowerBombardment.connection:Disconnect()
                end 
                if _G.FlamethrowerBombardment.originalGUID then 
                    local guid=require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
                    hookfunction(guid,_G.FlamethrowerBombardment.originalGUID)
                end 
                _G.FlamethrowerBombardment=nil 
            end 
        end 
    end
})

Main:Toggle({
    Title="全图硫酸枪",
    Default=false,
    Callback=function(Value)
        bombardmentEnabled.AcidGun=Value 
        if bombardmentConnections.AcidGun then 
            bombardmentConnections.AcidGun:Disconnect()
            bombardmentConnections.AcidGun=nil 
        end 
        if Value then 
            local RunService=game:GetService("RunService")
            local Players=game:GetService("Players")
            local localPlayer=Players.LocalPlayer 
            local guid=require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
            local originalGUID=hookfunction(guid,function(...)return "EZohio123" end)
            
            bombardmentConnections.AcidGun=RunService.Heartbeat:Connect(function()
                local currentTime=tick()
                local ping=game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
                if ping>1850 then return end 
                
                if currentTime-lastAmmoPurchaseTime>=ammoPurchaseInterval then 
                    for i=1,ammoPurchaseAmount do 
                        pcall(purchaseAmmo,"AcidGun")
                    end 
                    lastAmmoPurchaseTime=currentTime 
                end 
                
                if currentTime-lastBombardmentTime>=0.15 then 
                    pcall(function()
                        performBombardment("AcidGun")
                    end)
                    lastBombardmentTime=currentTime 
                end 
            end)
            
            _G.AcidGunBombardment={
                connection=bombardmentConnections.AcidGun,
                originalGUID=originalGUID
            }
        else 
            if _G.AcidGunBombardment then 
                if _G.AcidGunBombardment.connection then 
                    _G.AcidGunBombardment.connection:Disconnect()
                end 
                if _G.AcidGunBombardment.originalGUID then 
                    local guid=require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
                    hookfunction(guid,_G.AcidGunBombardment.originalGUID)
                end 
                _G.AcidGunBombardment=nil 
            end 
        end 
    end
})
local bombardmentEnabled = {PepperSpray = false}
local bombardmentConnections = {}
local lastBombardmentTime = 0 
local lastAmmoPurchaseTime = 0 
local ammoPurchaseInterval = 2 
local ammoPurchaseAmount = 2 
local MAX_DISTANCE = 400  

local function fixRemoteNames()
    local signalModule = require(game:GetService("ReplicatedStorage").devv.client.Helpers.remotes.Signal)
    for i, v in next, getupvalue(signalModule.LinkSignal, 1) do 
        v.Name = i 
        v:GetPropertyChangedSignal("Name"):Connect(function() v.Name = i end)
    end 
    for i, v in next, getupvalue(signalModule.InvokeServer, 1) do 
        v.Name = i 
        v:GetPropertyChangedSignal("Name"):Connect(function() v.Name = i end)
    end 
    for i, v in next, getupvalue(signalModule.FireServer, 1) do 
        v.Name = i 
        v:GetPropertyChangedSignal("Name"):Connect(function() v.Name = i end)
    end 
end 
fixRemoteNames()

local function hasShield(player)
    local character = player.Character 
    if not character then return false end 
    local shieldPart = character:FindFirstChild("Shield") or character:FindFirstChild("ForceField")
    if shieldPart then return true end 
    for _, child in ipairs(character:GetDescendants()) do 
        if child:IsA("ParticleEmitter") and child.Name:lower():find("shield") then 
            return true 
        end 
    end 
    return false 
end 

local function getAccuracyOffset()
    return Vector3.new(math.random(-0.5, 0.5), math.random(-0.5, 0.5), math.random(-0.5, 0.5))
end 

local function purchaseAmmo(weaponType)
    local ammoType 
    if weaponType == "PepperSpray" then 
        ammoType = "Pepper Spray"
    end 
    require(game:GetService("ReplicatedStorage").devv).load("Signal").InvokeServer("attemptPurchaseAmmo", ammoType)
end 

local function performPepperSprayBombardment()
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer 
    local reload = getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.reload), 2)
    local t = getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.shoot), 1)
    local reloadEvent = ReplicatedStorage.devv.remoteStorage:FindFirstChild("reload")
    local ammo = t.item.ammoManager 
    local gunid = t.item.guid 
    local firemode = t.item.firemode 
    local itemName = t.item.name or "Pepper Spray"
    
    firesignal(reloadEvent.OnClientEvent, gunid, 0, ammo.ammoOut)
    reload()
    
    local targets = {}
    local localPosition
    
    local localCharacter = localPlayer.Character
    if localCharacter then
        local localRootPart = localCharacter:FindFirstChild("HumanoidRootPart")
        if localRootPart then
            localPosition = localRootPart.Position
        end
    end
    
    if not localPosition then return end
    
    for _, player in ipairs(Players:GetPlayers()) do 
        if player == localPlayer then continue end 
        if hasShield(player) then continue end 
        local character = player.Character 
        if not character then continue end 
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if not humanoid or humanoid.Health <= 0 then continue end 
        
        local hitbox = character:FindFirstChild("Hitbox")
        if not hitbox then continue end 
        
        local headHitbox = hitbox:FindFirstChild("Head_Hitbox")
        if not headHitbox then continue end 
        
        local targetRootPart = character:FindFirstChild("HumanoidRootPart") or humanoid.RootPart 
        if not targetRootPart then continue end 
        
        local distance = (targetRootPart.Position - localPosition).Magnitude
        if distance > MAX_DISTANCE then continue end
        
        table.insert(targets, {
            player = player, 
            character = character, 
            headHitbox = headHitbox, 
            rootPart = targetRootPart, 
            humanoid = humanoid,
            distance = distance
        })
    end 
    
    if #targets == 0 then return end 
    
    for _, targetData in ipairs(targets) do 
        local targetHeadPosition = targetData.headHitbox.Position 
        local targetPlayerId = targetData.player.UserId 
        
        local accuracyMultiplier = math.clamp(targetData.distance / 100, 0.5, 2.0)
        
        local projectileEvent = ReplicatedStorage.devv.remoteStorage:FindFirstChild("replicateProjectiles")
        if projectileEvent then 
            local shots = 3
            for i = 1, math.min(ammo.ammo, shots) do 
                local shotOffset = getAccuracyOffset() * accuracyMultiplier
                local shotCFrame = CFrame.new(targetHeadPosition) + shotOffset
                projectileEvent:FireServer(gunid, {{"PepperCloud123", shotCFrame}}, firemode)
                
                local pepperSprayHitEvent = ReplicatedStorage.devv.remoteStorage:FindFirstChild("pepperSprayHit")
                if pepperSprayHitEvent then 
                    pepperSprayHitEvent:FireServer("PepperCloud123", "player", {
                        hitPart = targetData.headHitbox,
                        hitPlayerId = targetPlayerId,
                        hitSize = targetData.headHitbox.Size,
                        pos = targetHeadPosition + shotOffset
                    })
                end
            end 
        end
        
        local cloudEffect = ReplicatedStorage.devv.remoteStorage:FindFirstChild("createPepperCloud")
        if cloudEffect then 
            for i = 1, 3 do
                local cloudOffset = getAccuracyOffset() * accuracyMultiplier
                cloudEffect:FireServer("PepperCloud123", targetHeadPosition + cloudOffset, itemName)
            end
        end
    end 
    
    firesignal(reloadEvent.OnClientEvent, gunid, 0, ammo.ammoOut)
    reload()
end

Main:Toggle({
    Title = "全图辣椒喷雾",
    Default = false,
    Callback = function(Value)
        bombardmentEnabled.PepperSpray = Value 
        if bombardmentConnections.PepperSpray then 
            bombardmentConnections.PepperSpray:Disconnect()
            bombardmentConnections.PepperSpray = nil 
        end 
        if Value then 
            local RunService = game:GetService("RunService")
            local Players = game:GetService("Players")
            local localPlayer = Players.LocalPlayer 
            local guid = require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
            local originalGUID = hookfunction(guid, function(...) return "PepperCloud123" end)
            
            bombardmentConnections.PepperSpray = RunService.Heartbeat:Connect(function()
                local currentTime = tick()
                local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
                if ping > 1850 then return end 
                
                if currentTime - lastAmmoPurchaseTime >= ammoPurchaseInterval then 
                    for i = 1, ammoPurchaseAmount do 
                        pcall(purchaseAmmo, "PepperSpray")
                    end 
                    lastAmmoPurchaseTime = currentTime 
                end 
                
                if currentTime - lastBombardmentTime >= 0.2 then
                    pcall(function()
                        performPepperSprayBombardment()
                    end)
                    lastBombardmentTime = currentTime 
                end 
            end)
            
            _G.PepperSprayBombardment = {
                connection = bombardmentConnections.PepperSpray,
                originalGUID = originalGUID
            }
        else 
            if _G.PepperSprayBombardment then 
                if _G.PepperSprayBombardment.connection then 
                    _G.PepperSprayBombardment.connection:Disconnect()
                end 
                if _G.PepperSprayBombardment.originalGUID then 
                    local guid = require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
                    hookfunction(guid, _G.PepperSprayBombardment.originalGUID)
                end 
                _G.PepperSprayBombardment = nil 
            end 
        end 
    end
})
local fireExtinguisherEnabled = false
local fireExtinguisherConnection
local lastAttackTime = 0
local attackInterval = 0.2
local MAX_DISTANCE = 400
local ammoPurchaseInterval = 2
local ammoPurchaseAmount = 2
local lastAmmoPurchaseTime = 0
local currentItemName = "Fire Extinguisher"

local function fixRemoteNames()
    local signalModule = require(game:GetService("ReplicatedStorage").devv.client.Helpers.remotes.Signal)
    for i, v in next, getupvalue(signalModule.LinkSignal, 1) do 
        v.Name = i 
        v:GetPropertyChangedSignal("Name"):Connect(function() v.Name = i end)
    end 
    for i, v in next, getupvalue(signalModule.InvokeServer, 1) do 
        v.Name = i 
        v:GetPropertyChangedSignal("Name"):Connect(function() v.Name = i end)
    end 
    for i, v in next, getupvalue(signalModule.FireServer, 1) do 
        v.Name = i 
        v:GetPropertyChangedSignal("Name"):Connect(function() v.Name = i end)
    end 
end 
fixRemoteNames()

local function hasShield(player)
    local character = player.Character 
    if not character then return false end 
    local shieldPart = character:FindFirstChild("Shield") or character:FindFirstChild("ForceField")
    if shieldPart then return true end 
    for _, child in ipairs(character:GetDescendants()) do 
        if child:IsA("ParticleEmitter") and child.Name:lower():find("shield") then 
            return true 
        end 
    end 
    return false 
end 

local function getAccuracyOffset()
    return Vector3.new(math.random(-0.5, 0.5), math.random(-0.5, 0.5), math.random(-0.5, 0.5))
end 

local function purchaseAmmo()
    require(game:GetService("ReplicatedStorage").devv).load("Signal").InvokeServer("attemptPurchaseAmmo", "Fire Extinguisher")
end

local function getEquippedItemName()
    local t = getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.shoot), 1)
    if t and t.item then
        local name = t.item.name
        if name and (name:find("Fire") or name:find("Extinguisher")) then
            currentItemName = name
            return name
        end
    end
    return currentItemName
end

local function performFireExtinguisherAttack()
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer 
    local reload = getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.reload), 2)
    local t = getupvalue(require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item.bin.Gun.modules.controller.modules.shoot), 1)
    local reloadEvent = ReplicatedStorage.devv.remoteStorage:FindFirstChild("reload")
    local ammo = t.item.ammoManager 
    local gunid = t.item.guid 
    local firemode = t.item.firemode 
    local itemName = getEquippedItemName()
    
    firesignal(reloadEvent.OnClientEvent, gunid, 0, ammo.ammoOut)
    reload()
    
    local targets = {}
    local localPosition
    
    local localCharacter = localPlayer.Character
    if localCharacter then
        local localRootPart = localCharacter:FindFirstChild("HumanoidRootPart")
        if localRootPart then
            localPosition = localRootPart.Position
        end
    end
    
    if not localPosition then return end
    
    for _, player in ipairs(Players:GetPlayers()) do 
        if player == localPlayer then continue end 
        if hasShield(player) then continue end 
        local character = player.Character 
        if not character then continue end 
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if not humanoid or humanoid.Health <= 0 then continue end 
        
        local hitbox = character:FindFirstChild("Hitbox")
        if not hitbox then continue end 
        
        local headHitbox = hitbox:FindFirstChild("Head_Hitbox")
        if not headHitbox then continue end 
        
        local targetRootPart = character:FindFirstChild("HumanoidRootPart") or humanoid.RootPart 
        if not targetRootPart then continue end 
        
        local distance = (targetRootPart.Position - localPosition).Magnitude
        if distance > MAX_DISTANCE then continue end
        
        table.insert(targets, {
            player = player, 
            character = character, 
            headHitbox = headHitbox, 
            rootPart = targetRootPart, 
            humanoid = humanoid,
            distance = distance
        })
    end 
    
    if #targets == 0 then return end 
    
    for _, targetData in ipairs(targets) do 
        local targetHeadPosition = targetData.headHitbox.Position 
        local targetPlayerId = targetData.player.UserId 
        
        local accuracyMultiplier = math.clamp(targetData.distance / 100, 0.5, 2.0)
        
        local projectileEvent = ReplicatedStorage.devv.remoteStorage:FindFirstChild("replicateProjectiles")
        if projectileEvent then 
            local shots = 3
            for i = 1, math.min(ammo.ammo, shots) do 
                local shotOffset = getAccuracyOffset() * accuracyMultiplier
                local shotCFrame = CFrame.new(targetHeadPosition) + shotOffset
                projectileEvent:FireServer(gunid, {{"FireExt123", shotCFrame}}, firemode)
                
                local pepperSprayHitEvent = ReplicatedStorage.devv.remoteStorage:FindFirstChild("pepperSprayHit")
                if pepperSprayHitEvent then 
                    pepperSprayHitEvent:FireServer("FireExt123", "player", {
                        hitPart = targetData.headHitbox,
                        hitPlayerId = targetPlayerId,
                        hitSize = targetData.headHitbox.Size,
                        pos = targetHeadPosition + shotOffset
                    })
                end
            end 
        end
        
        local cloudEffect = ReplicatedStorage.devv.remoteStorage:FindFirstChild("createPepperCloud")
        if cloudEffect then 
            for i = 1, 2 do
                local cloudOffset = getAccuracyOffset() * accuracyMultiplier
                cloudEffect:FireServer("FireExt123", targetHeadPosition + cloudOffset, itemName)
            end
        end
    end 
    
    firesignal(reloadEvent.OnClientEvent, gunid, 0, ammo.ammoOut)
    reload()
end

Main:Toggle({
    Title = "全图灭火器",
    Default = false,
    Callback = function(Value)
        fireExtinguisherEnabled = Value 
        if fireExtinguisherConnection then 
            fireExtinguisherConnection:Disconnect()
            fireExtinguisherConnection = nil 
        end 
        if Value then 
            local RunService = game:GetService("RunService")
            local Players = game:GetService("Players")
            local localPlayer = Players.LocalPlayer 
            local guid = require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
            local originalGUID = hookfunction(guid, function(...) return "FireExt123" end)
            
            fireExtinguisherConnection = RunService.Heartbeat:Connect(function()
                local currentTime = tick()
                local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
                if ping > 1850 then return end 
                
                if currentTime - lastAmmoPurchaseTime >= ammoPurchaseInterval then 
                    for i = 1, ammoPurchaseAmount do 
                        pcall(purchaseAmmo)
                    end 
                    lastAmmoPurchaseTime = currentTime 
                end 
                
                if currentTime - lastAttackTime >= attackInterval then
                    pcall(function()
                        performFireExtinguisherAttack()
                    end)
                    lastAttackTime = currentTime 
                end 
            end)
            
            _G.FireExtinguisherAttack = {
                connection = fireExtinguisherConnection,
                originalGUID = originalGUID
            }
        else 
            if _G.FireExtinguisherAttack then 
                if _G.FireExtinguisherAttack.connection then 
                    _G.FireExtinguisherAttack.connection:Disconnect()
                end 
                if _G.FireExtinguisherAttack.originalGUID then 
                    local guid = require(game:GetService("ReplicatedStorage").devv.shared.Helpers.string.GUID)
                    hookfunction(guid, _G.FireExtinguisherAttack.originalGUID)
                end 
                _G.FireExtinguisherAttack = nil 
            end 
        end 
    end
})

local Main = Window:Tab({Title = "圣诞节活动", Icon = "gift"})
Main:Section({ Title = "刷糖果", Icon = "gift" })
local christmasMobThread = nil
local christmasMobEnabled = false

local function teleportToHideSpot()

end

local function checkAnyTargetExists()
   
    return true
end

local function collectGingerbread()
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer
    
    if localPlayer.Character then
        local rootPart = localPlayer.Character:FindFirstChild("HumanoidRootPart")
        if rootPart then
    
            if workspace:FindFirstChild("Game") and workspace.Game:FindFirstChild("Entities") then
                if workspace.Game.Entities:FindFirstChild("Gingerbread") then
                    for _, gingerbread in pairs(workspace.Game.Entities.Gingerbread:GetChildren()) do
                        if gingerbread:IsA("Model") then
                            for _, v in pairs(gingerbread:GetDescendants()) do
                                if v:IsA("ClickDetector") then
                                    local detectorPos = gingerbread:GetPivot().Position
                                    local distance = (rootPart.Position - detectorPos).Magnitude
                                    if distance <= 20 then
                                        fireclickdetector(v)
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
end

Main:Toggle({
    Title = "礼物盒农场",
    Default = false,
    Callback = function(Value)
        if christmasMobThread then
            task.cancel(christmasMobThread)
            christmasMobThread = nil
        end

        christmasMobEnabled = Value
        
        if Value then
            christmasMobThread = task.spawn(function()
                while christmasMobEnabled do
                    task.wait()
                    
                    if not checkAnyTargetExists() then
                        teleportToHideSpot()
                        task.wait(1)
                    else
                        pcall(function()
                            local plr = game:GetService("Players").LocalPlayer
                            local char = plr.Character
                            if char and char:FindFirstChild("HumanoidRootPart") then
                                local christmasMobs = workspace:FindFirstChild("Christmas")
                                
                                if christmasMobs and christmasMobs:FindFirstChild("Mobs") then
                                    local rootPart = char:FindFirstChild("HumanoidRootPart")
                                    if rootPart then
                                     
                                        collectGingerbread()
                                        
                                  
                                        for _, mob in ipairs(christmasMobs.Mobs:GetChildren()) do
                                            if mob:IsA("Model") then
                                          
                                                local health = mob:GetAttribute("health")
                                                if health and health > 0 then
                                             
                                                    rootPart.CFrame = mob:GetPivot() * CFrame.new(0, 0, -2)
                                                    task.wait(0.1)
                                                    
                                                
                                                    mob:SetAttribute("health", 0)
                                                    
                                               
                                                    task.wait(2)
                                                    
                                             
                                                    collectGingerbread()
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end)
                    end
                end
            end)
        end
    end
})
Main:Toggle({
    Title = "收集姜饼人光环",
    Default = false,
    Callback = function(Value)
        mngh = Value
        task.spawn(function()
            while mngh and task.wait() do
                if not checkAnyTargetExists() then
                    teleportToHideSpot()
                    task.wait(1)
                else
                    local Players = game:GetService("Players")
                    local localPlayer = Players.LocalPlayer
                    if localPlayer.Character then
                        local rootPart = localPlayer.Character:FindFirstChild("HumanoidRootPart")
                        if rootPart then
                            local player = game:GetService("Players").LocalPlayer
                            local character = player.Character or player.CharacterAdded:Wait()
                            local rootPart = character:WaitForChild("HumanoidRootPart")
                            for _, v in pairs(workspace.Game.Entities.CashBundle:GetDescendants()) do
                                if v:IsA("ClickDetector") then
                                    local detectorPos = v.Parent:GetPivot().Position
                                    local distance = (rootPart.Position - detectorPos).Magnitude
                                    if distance <= 50 then
                                        fireclickdetector(v)
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end)
    end
})
local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer

local autoElfEnabled = false
local autoElfThread = nil

local function findElves()
    local elves = {}
    local CollectionService = game:GetService("CollectionService")
    
    for _, elf in ipairs(CollectionService:GetTagged("PeterTheElf")) do
        if elf:IsA("Model") and elf.PrimaryPart then
            local alreadyCollected = false
            for _, part in ipairs(elf:GetChildren()) do
                if part:IsA("BasePart") and part.Name ~= "Hitbox" then
                    if part.Transparency >= 0.5 then
                        alreadyCollected = true
                        break
                    end
                end
            end
            
            if not alreadyCollected then
                table.insert(elves, elf)
            end
        end
    end
    
    return elves
end

local function collectElf(elf)
    if not elf or not elf.PrimaryPart then return false end
    
    local char = localPlayer.Character
    if not char then return false end
    
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return false end
    
    hrp.CFrame = elf.PrimaryPart.CFrame * CFrame.new(0, 0, -2)
    task.wait(0.5)
    
    local success, gingerbreadAmount = pcall(function()
        return Signal.InvokeServer("attemptCollectElf")
    end)
    
    if success then
        return true
    else
        return false
    end
end

Main:Toggle({
    Title = "自动圣诞精灵",
    Default = false,
    Callback = function(Value)
        if autoElfThread then
            task.cancel(autoElfThread)
            autoElfThread = nil
        end

        autoElfEnabled = Value
        
        if Value then
            autoElfThread = task.spawn(function()
                while autoElfEnabled do
                    task.wait()
                    
                    pcall(function()
                        local elves = findElves()
                        
                        if #elves > 0 then
                            for _, elf in ipairs(elves) do
                                if not autoElfEnabled then break end
                                
                                local collected = collectElf(elf)
                                
                                if collected then
                                    task.wait(3)
                                else
                                    task.wait(1)
                                end
                                
                                elves = findElves()
                                if #elves == 0 then break end
                            end
                        else
                            task.wait(5)
                        end
                    end)
                end
            end)
        end
    end
})

Main:Section({ Title = "任务", Icon = "gift" })

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local load = require(ReplicatedStorage.devv).load
local Signal = load("Signal")

local christmasQuests = load("ChristmasQuests")
local autoQuestThread = nil
local autoQuestEnabled = false

local function getQuestRewards()
    local quests = {}
    

    for questType, questData in pairs(christmasQuests) do
        if type(questData) == "table" then
            table.insert(quests, {
                type = questType,
                name = questData.title:match(">(.+)<") or questType,
                tiers = questData.tiers or {}
            })
        end
    end
    
    return quests
end

local function claimQuestReward(questType, tierIndex)
    local success, result = pcall(function()
        return Signal.InvokeServer("claimQuestReward", questType, tierIndex)
    end)
    
    return success
end

local function checkAndClaimAllQuests()
    local claimedCount = 0
    local failedCount = 0
    
    for questType, questData in pairs(christmasQuests) do
        if type(questData) == "table" and questData.tiers then
            for tierIndex = 1, #questData.tiers do
                local success = claimQuestReward(questType, tierIndex)
                if success then
                    claimedCount = claimedCount + 1
                    task.wait(0.2) -- 避免请求过快
                else
                    failedCount = failedCount + 1
                end
            end
        end
    end
    
    return claimedCount, failedCount
end

Main:Toggle({
    Title = "自动领取姜饼人奖励",
    Value = false,
    Callback = function(state)
        autoQuestEnabled = state
        
        if autoQuestThread then
            task.cancel(autoQuestThread)
            autoQuestThread = nil
        end
        
        if state then
            autoQuestThread = task.spawn(function()
                while autoQuestEnabled do
                    checkAndClaimAllQuests()
                    task.wait(5)
                end
            end)
            
        else
        end
    end
})

Main:Button({
    Title = "查看任务列表",
    Callback = function()
        local quests = getQuestRewards()
        local message = "圣诞任务列表：\n\n"
        
        for i, quest in ipairs(quests) do
            message = message .. string.format("%d. %s\n", i, quest.name)
            if quest.tiers and #quest.tiers > 0 then
                for j, tier in ipairs(quest.tiers) do
                    message = message .. string.format("   等级 %d: %d 姜饼人\n", j, tier.gingerbread or 0)
                end
            end
            message = message .. "\n"
        end
        
        WindUI:Notify({
            Title = "圣诞任务列表",
            Content = message,
            Duration = 8,
            Icon = "list"
        })
    end
})

local bs = Window:Tab({Title = "绕过", Icon = "user"})

bs:Button({
    Title = "绕过移动经销商[新版本]",
    Callback = function()
local pjyd pjyd=hookmetamethod(game,"__namecall",function(self,...)local args={...}local method=getnamecallmethod()if method=="InvokeServer" and args[2]==true then args[2]=false return pjyd(self,unpack(args))end return pjyd(self,...)end)--
game:GetService("Players").LocalPlayer:SetAttribute("mobileDealer",true)
local ReplicatedStorage=game:GetService("ReplicatedStorage")
local mobileDealer=require(ReplicatedStorage.devv.shared.Indicies.mobileDealer)

for category,items in pairs(mobileDealer)do 
    for _,item in ipairs(items)do 
        item.stock=999999 
    end 
end

table.insert(mobileDealer.Gun,{itemName="Acid Gun",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Candy Bucket",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Golden Rose",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Black Rose",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Dollar Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Bat Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Bunny Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Clover Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Ghost Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Gold Clover Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Heart Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Skull Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Snowflake Balloon",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Admin AK-47",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Admin Nuke Launcher",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Admin RPG",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Void Gem",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Pulse Rifle",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Unusual Money Printer",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Money Printer",stock=9999})
table.insert(mobileDealer.Gun,{itemName="Trident",stock=9999})
table.insert(mobileDealer.Gun,{itemName="NextBot Grenade",stock=9999})
table.insert(mobileDealer.Gun,{itemName="El Fuego",stock=9999})

    end
})
bs:Button({
    Title = "绕过高级表情包",
    Callback = function()
    for _, v in pairs(game:GetService("Players").LocalPlayer.PlayerGui.Emotes.Frame.ScrollingFrame:GetDescendants()) do
        if v.Name == "Locked" then
            v.Visible = false
        end
    end
    end
})

bs:Button({
    Title = "绕过飞行检测",
    Callback = function()
    if game:GetService("ReplicatedStorage"):FindFirstChild("devv"):FindFirstChild("remoteStorage"):FindFirstChild("makeExplosion") then
game:GetService("ReplicatedStorage"):FindFirstChild("devv"):FindFirstChild("remoteStorage"):FindFirstChild("makeExplosion"):Destroy()
end
    end
})
bs:Button({
    Title = "绕过物品栏封禁",
    Callback = function()
    if game:GetService("ReplicatedStorage"):FindFirstChild("devv"):FindFirstChild("remoteStorage"):FindFirstChild("makeExplosion") then
game:GetService("ReplicatedStorage"):FindFirstChild("devv"):FindFirstChild("remoteStorage"):FindFirstChild("makeExplosion"):Destroy()
end
    end
})

bs:Button({
    Title = "绕过战斗状态",
    Callback = function()
        for _, func in pairs(getgc(true)) do
    if type(func) == "function" then
        local info = debug.getinfo(func)
        if info.name == "isInCombat" or (info.source and info.source:find("combatIndicator")) then
            hookfunction(func, function() 
                return false 
            end)
        end
    end
end
    end
})
local Main = Window:Tab({Title = "本地", Icon = "box"})
Main:Section({ Title = "免费物品", Icon = "swords" })
local items = {
    "Golden Rose",
    "Black Rose", 
    "Dollar Balloon",
    "Bat Balloon",
    "Bunny Balloon", 
    "Clover Balloon",
    "Ghost Balloon",
    "Gold Clover Balloon",
    "Heart Balloon",
    "Skull Balloon",
    "Snowflake Balloon",
    "Admin AK-47",
    "Admin Nuke Launcher", 
    "Admin RPG",
    "Void Gem",
    "Pulse Rifle",
    "Unusual Money Printer",
    "Money Printer",
    "Trident",
    "NextBot Grenade",
    "El Fuego"
}

local itemDisplayNames = {
    ["Golden Rose"] = "金玫瑰",
    ["Black Rose"] = "黑玫瑰", 
    ["Dollar Balloon"] = "美元气球",
    ["Bat Balloon"] = "蝙蝠气球",
    ["Bunny Balloon"] = "兔子气球",
    ["Clover Balloon"] = "三叶草气球",
    ["Ghost Balloon"] = "幽灵气球",
    ["Gold Clover Balloon"] = "金三叶草气球",
    ["Heart Balloon"] = "爱心气球",
    ["Skull Balloon"] = "骷髅气球",
    ["Snowflake Balloon"] = "雪花气球",
    ["Admin AK-47"] = "管理员黄金AK-47",
    ["Admin Nuke Launcher"] = "管理员核弹发射器",
    ["Admin RPG"] = "管理员RPG",
    ["Void Gem"] = "虚空宝石", 
    ["Pulse Rifle"] = "脉冲步枪",
    ["Unusual Money Printer"] = "异常印钞机",
    ["Money Printer"] = "印钞机",
    ["Trident"] = "三叉戟",
    ["NextBot Grenade"] = "NextBot手榴弹",
    ["El Fuego"] = "烈焰喷射器"
}

local itemData = {
    ["Bat Balloon"] = {
        name = "Bat Balloon",
        cost = 0,
        unpurchasable = true,
        multiplier = 0.625,
        holdableType = "Balloon",
        canDrop = true,
        dropCooldown = 120,
        permanent = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0)},
        viewportOffsets = {
            hotbar = {dist = 5.5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, math.pi, 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Bunny Balloon"] = {
        name = "Bunny Balloon",
        cost = 0,
        unpurchasable = true,
        multiplier = 0.61,
        holdableType = "Balloon",
        canDrop = true,
        dropCooldown = 120,
        permanent = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0)},
        viewportOffsets = {
            hotbar = {dist = 4.75, offset = CFrame.new(0, -0.25, 0), rotoffset = CFrame.Angles(0, 4.71238898038469, 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Clover Balloon"] = {
        name = "Clover Balloon",
        cost = 200,
        unpurchasable = true,
        multiplier = 0.625,
        holdableType = "Balloon",
        canDrop = true,
        dropCooldown = 120,
        permanent = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0)},
        viewportOffsets = {
            hotbar = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Ghost Balloon"] = {
        name = "Ghost Balloon",
        cost = 0,
        unpurchasable = true,
        multiplier = 0.625,
        holdableType = "Balloon",
        canDrop = true,
        dropCooldown = 120,
        permanent = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0)},
        viewportOffsets = {
            hotbar = {dist = 3.5, offset = CFrame.new(0, 0.5, 0), rotoffset = CFrame.Angles(0, math.pi, 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Gold Clover Balloon"] = {
        name = "Gold Clover Balloon",
        cost = 250000,
        unpurchasable = true,
        multiplier = 0.6,
        holdableType = "Balloon",
        canDrop = true,
        dropCooldown = 120,
        permanent = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0)},
        viewportOffsets = {
            hotbar = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Heart Balloon"] = {
        name = "Heart Balloon",
        cost = 200,
        multiplier = 0.6,
        holdableType = "Balloon",
        unpurchasable = true,
        canDrop = true,
        dropCooldown = 120,
        permanent = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0)},
        viewportOffsets = {
            hotbar = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Skull Balloon"] = {
        name = "Skull Balloon",
        cost = 0,
        unpurchasable = true,
        multiplier = 0.625,
        holdableType = "Balloon",
        canDrop = true,
        dropCooldown = 120,
        permanent = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0)},
        viewportOffsets = {
            hotbar = {dist = 5.5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, -270, 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Snowflake Balloon"] = {
        name = "Snowflake Balloon",
        cost = 0,
        unpurchasable = true,
        multiplier = 0.625,
        holdableType = "Balloon",
        canDrop = true,
        dropCooldown = 120,
        permanent = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0)},
        viewportOffsets = {
            hotbar = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, (math.pi/2), 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Golden Rose"] = {
        name = "Golden Rose",
        guid = "golden_rose_"..tostring(tick()),
        permanent = true,
        canDrop = true,
        dropCooldown = 120,
        multiplier = 0.625,
        holdableType = "Balloon",
        movespeedAdd = 5,
        TPSOffsets = {hold = CFrame.new(0, 0.5, 0)},
        viewportOffsets = {
            hotbar = {dist = 3, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, (math.pi/2), 0)},
            ammoHUD = {dist = 2, offset = CFrame.new(-0.1, -0.2, 0), rotoffset = CFrame.Angles(0, -1.3744467859455345, 0)},
            slotButton = {dist = 1, offset = CFrame.new(-0.1, -0.2, 0), rotoffset = CFrame.Angles(0, (-math.pi/2), 0)}
        }
    },
    ["Black Rose"] = {
        name = "Black Rose",
        guid = "black_rose_"..tostring(tick()),
        permanent = true,
        canDrop = true,
        dropCooldown = 120,
        multiplier = 0.75,
        holdableType = "Balloon",
        movespeedAdd = 12,
        TPSOffsets = {hold = CFrame.new(0, 0.5, 0)},
        viewportOffsets = {
            hotbar = {dist = 3, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, (math.pi/2), 0)},
            ammoHUD = {dist = 2, offset = CFrame.new(-0.1, -0.2, 0), rotoffset = CFrame.Angles(0, -1.3744467859455345, 0)},
            slotButton = {dist = 1, offset = CFrame.new(-0.1, -0.2, 0), rotoffset = CFrame.Angles(0, (-math.pi/2), 0)}
        }
    },
    ["Dollar Balloon"] = {
        name = "Dollar Balloon",
        cost = 100000000000,
        unpurchasable = true,
        multiplier = 0.8,
        holdableType = "Balloon",
        movespeedAdd = 8,
        cannotDiscard = true,
        TPSOffsets = {hold = CFrame.new(0, 0, 0) * CFrame.Angles(0, math.pi, 0)},
        viewportOffsets = {
            hotbar = {dist = 4, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)},
            ammoHUD = {dist = 5, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, 0, 0)}
        }
    },
    ["Admin AK-47"] = {
        name = "Admin AK-47",
        modelName = "Gold AK-47",
        subtype = "AK-47",
        adminOnly = true,
        canDrop = false,
        unpurchasable = true,
        damage = 10,
        ammo = 999999999,
        startAmmo = -1,
        maxAmmo = -1,
        firemode = "auto",
        numProjectiles = 8,
        fireDebounce = 0.01
    },
    ["Admin Nuke Launcher"] = {
        name = "Admin Nuke Launcher",
        modelName = "Nuke Launcher",
        subtype = "Nuke Launcher",
        adminOnly = true,
        canDrop = false,
        unpurchasable = true,
        ammo = 99999999,
        startAmmo = -1,
        maxAmmo = -1,
        overrideProjectileProperties = {
            disableNukeFlash = true
        },
        reloadTime = 0,
        reloadType = "mag",
        firemode = "auto",
        numProjectiles = 1,
        fireDebounce = 0.2
    },
    ["Admin RPG"] = {
        canDrop = false,
        unpurchasable = true,
        name = "Admin RPG",
        modelName = "RPG",
        subtype = "RPG",
        adminOnly = true,
        ammo = 99999999,
        startAmmo = -1,
        maxAmmo = -1,
        reloadTime = 0,
        reloadType = "mag",
        firemode = "auto",
        numProjectiles = 1,
        fireDebounce = 0.02,
        recoilAdd = 0,
        maxRecoil = 0,
        recoilDiminishFactor = 0,
        recoilFastDiminishFactor = 0
    },
    ["Void Gem"] = {
        name = "Void Gem",
        subtype = "gem",
        maxAmmo = 3,
        adminLimit = 1,
        sellPrice = 25000,
        canDrop = true,
        dropCooldown = 300
    },
    ["Pulse Rifle"] = {
        name = "Pulse Rifle",
        subtype = "Raygun",
        unpurchasable = true,
        damage = 22,
        headshotMultiplier = 1.5,
        ammo = 50,
        startAmmo = -1,
        maxAmmo = -1,
        reloadTime = 3.5,
        reloadType = "mag",
        firemode = "auto",
        numProjectiles = 1,
        fireDebounce = 0.04,
        projectileLength = 20,
        projectileLifetime = 200,
        speedDropoff = 0.04,
        speedMax = 5,
        baseSpread = 3,
        baseAimSpread = 0.8,
        spread = 11,
        aimSpread = 2.4,
        recoilAdd = 0.05,
        maxRecoil = 0.4,
        recoilDiminishFactor = 0.95,
        recoilFastDiminishFactor = 0.85
    },
    ["Unusual Money Printer"] = {
        name = "Unusual Money Printer",
        cost = 500,
        ammo = 1,
        startAmmo = -1,
        maxAmmo = 1,
        hint = {
            computer = "Click to Place",
            console = "Click to Place"
        },
        canDrop = true,
        dropCooldown = 600,
        isConsumable = true,
        TPSOffsets = {
            hold = CFrame.new(-0.1, 0, -0.75) * CFrame.Angles(0, 0, 0)
        },
        viewportOffsets = {
            hotbar = {
                dist = 5,
                offset = CFrame.new(0, 0.15, 0),
                rotoffset = CFrame.Angles(0, (-math.pi/2), 0)
            },
            ammoHUD = {
                dist = 3.25,
                offset = CFrame.new(0, 1, 0),
                rotoffset = CFrame.Angles(0, (math.pi/2), 0)
            }
        }
    },
    ["Money Printer"] = {
        name = "Money Printer",
        ammo = 1,
        startAmmo = -1,
        maxAmmo = 1,
        adminLimit = 10,
        hint = {
            computer = "Click to Place",
            console = "Click to Place"
        },
        canDrop = true,
        dropCooldown = 600,
        isConsumable = true,
        permanent = true,
        TPSOffsets = {
            hold = CFrame.new(-0.1, 0, -0.75) * CFrame.Angles(0, 0, 0)
        },
        viewportOffsets = {
            hotbar = {
                dist = 5,
                offset = CFrame.new(0, 0.15, 0),
                rotoffset = CFrame.Angles(0, (-math.pi/2), 0)
            },
            ammoHUD = {
                dist = 3.25,
                offset = CFrame.new(0, 1, 0),
                rotoffset = CFrame.Angles(0, (-math.pi/2), 0)
            }
        }
    },
    ["Trident"] = {
        name = "Trident",
        subtype = "RPG",
        unpurchasable = true,
        ammo = 1,
        startAmmo = 12,
        maxAmmo = 12,
        firemode = "semi",
        numProjectiles = 3,
        fireDebounce = 0.5,
        projectileLength = 4,
        projectileLifetime = 1000,
        speedDropoff = 0.04,
        speedMax = 5,
        baseSpread = 5,
        baseAimSpread = 1,
        spread = 10,
        aimSpread = 6,
        recoilAdd = 1,
        maxRecoil = 1.25,
        recoilDiminishFactor = 0.9,
        recoilFastDiminishFactor = 0.66
    },
    ["NextBot Grenade"] = {
        name = "NextBot Grenade",
        isNade = true,
        bounceSFX = "nadeBounce",
        canDrop = true,
        dropCooldown = 600,
        thrownOffset = CFrame.Angles(0, (math.pi/2), 0),
        ammo = 1,
        startAmmo = -1,
        maxAmmo = 1,
        permanent = true,
        throwDist = 50,
        TPSOffsets = {
            hold = CFrame.new(-0.1, 0.25, -0.125)
        },
        viewportOffsets = {
            hotbar = {
                dist = 2.75,
                offset = CFrame.new(0, -0.125, 0),
                rotoffset = CFrame.Angles(0, 1.8849555921538759, 0)
            },
            ammoHUD = {
                dist = 2,
                offset = CFrame.new(0, 0.1, 0),
                rotoffset = CFrame.Angles(0, (math.pi/2), 0)
            }
        }
    },
    ["El Fuego"] = {
        name = "El Fuego",
        modelName = "El Fuego",
        subtype = "Flamethrower",
        unpurchasable = true,
        ammo = 600,
        startAmmo = 0,
        maxAmmo = 600,
        reloadTime = 6,
        reloadType = "mag",
        firemode = "auto",
        damage = 6,
        numProjectiles = 3,
        fireDebounce = 0.05,
        projectileLength = 4,
        projectileLifetime = 60,
        speedDropoff = 0.04,
        speedMax = 5,
        baseSpread = 4,
        baseAimSpread = 2,
        spread = 12,
        aimSpread = 6,
        recoilAdd = 0.1,
        maxRecoil = 1,
        recoilDiminishFactor = 0.95,
        recoilFastDiminishFactor = 0.8
    }
}

local function getItemList()
    local itemList = {}
    for _, itemName in ipairs(items) do
        local displayName = itemDisplayNames[itemName] or itemName
        table.insert(itemList, displayName)
    end
    return itemList
end

local selectedItem = ""

local itemDropdown = Main:Dropdown({
    Title = "选择物品",
    Desc = "从列表中选择要获得的物品",
    Values = getItemList(),
    Value = "",
    Callback = function(value)
        if value and value ~= "" then
            selectedItem = value
        else
            selectedItem = ""
        end
    end
})

local function getItemNameByDisplayName(displayName)
    for itemName, dispName in pairs(itemDisplayNames) do
        if dispName == displayName then
            return itemName
        end
    end
    return displayName
end

local function addItem(itemName)
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    
    pcall(function()
        local itemSystem = require(ReplicatedStorage.devv).load("v3item")
        local inventory = itemSystem.inventory
        
        if not itemData[itemName] then
            warn("物品数据不存在: " .. itemName)
            return
        end
        
        local itemConfig = itemData[itemName]
        local itemToAdd = {
            name = itemConfig.name,
            guid = itemName:lower():gsub(" ", "_").."_"..tostring(tick()),
            permanent = itemConfig.permanent or true,
            canDrop = itemConfig.canDrop or true,
            dropCooldown = itemConfig.dropCooldown or 120,
            multiplier = itemConfig.multiplier or 0.625,
            holdableType = itemConfig.holdableType or "Balloon",
            movespeedAdd = itemConfig.movespeedAdd or 0,
            cannotDiscard = itemConfig.cannotDiscard or false,
            TPSOffsets = itemConfig.TPSOffsets or {hold = CFrame.new(0, 0.5, 0)},
            viewportOffsets = itemConfig.viewportOffsets or {
                hotbar = {dist = 3, offset = CFrame.new(0, 0, 0), rotoffset = CFrame.Angles(0, (math.pi/2), 0)},
                ammoHUD = {dist = 2, offset = CFrame.new(-0.1, -0.2, 0), rotoffset = CFrame.Angles(0, -1.3744467859455345, 0)},
                slotButton = {dist = 1, offset = CFrame.new(-0.1, -0.2, 0), rotoffset = CFrame.Angles(0, (-math.pi/2), 0)}
            }
        }
        
        if itemConfig.subtype then itemToAdd.subtype = itemConfig.subtype end
        if itemConfig.modelName then itemToAdd.modelName = itemConfig.modelName end
        if itemConfig.adminOnly then itemToAdd.adminOnly = itemConfig.adminOnly end
        if itemConfig.damage then itemToAdd.damage = itemConfig.damage end
        if itemConfig.ammo then itemToAdd.ammo = itemConfig.ammo end
        if itemConfig.startAmmo then itemToAdd.startAmmo = itemConfig.startAmmo end
        if itemConfig.maxAmmo then itemToAdd.maxAmmo = itemConfig.maxAmmo end
        if itemConfig.reloadTime then itemToAdd.reloadTime = itemConfig.reloadTime end
        if itemConfig.reloadType then itemToAdd.reloadType = itemConfig.reloadType end
        if itemConfig.firemode then itemToAdd.firemode = itemConfig.firemode end
        if itemConfig.numProjectiles then itemToAdd.numProjectiles = itemConfig.numProjectiles end
        if itemConfig.fireDebounce then itemToAdd.fireDebounce = itemConfig.fireDebounce end
        if itemConfig.projectileLength then itemToAdd.projectileLength = itemConfig.projectileLength end
        if itemConfig.projectileLifetime then itemToAdd.projectileLifetime = itemConfig.projectileLifetime end
        if itemConfig.headshotMultiplier then itemToAdd.headshotMultiplier = itemConfig.headshotMultiplier end
        if itemConfig.hint then itemToAdd.hint = itemConfig.hint end
        if itemConfig.isConsumable then itemToAdd.isConsumable = itemConfig.isConsumable end
        if itemConfig.isNade then itemToAdd.isNade = itemConfig.isNade end
        if itemConfig.throwDist then itemToAdd.throwDist = itemConfig.throwDist end
        if itemConfig.sellPrice then itemToAdd.sellPrice = itemConfig.sellPrice end
        if itemConfig.adminLimit then itemToAdd.adminLimit = itemConfig.adminLimit end
        if itemConfig.overrideProjectileProperties then itemToAdd.overrideProjectileProperties = itemConfig.overrideProjectileProperties end
        if itemConfig.recoilAdd then itemToAdd.recoilAdd = itemConfig.recoilAdd end
        if itemConfig.maxRecoil then itemToAdd.maxRecoil = itemConfig.maxRecoil end
        if itemConfig.recoilDiminishFactor then itemToAdd.recoilDiminishFactor = itemConfig.recoilDiminishFactor end
        if itemConfig.recoilFastDiminishFactor then itemToAdd.recoilFastDiminishFactor = itemConfig.recoilFastDiminishFactor end
        
        if inventory.add then
            inventory.add(itemToAdd, false)
            if inventory.currentItemsData then
                table.insert(inventory.currentItemsData, itemToAdd)
            end
        end
        
        if inventory.rerender then
            inventory:rerender()
        end
    end)
end

Main:Button({
    Title = "免费获得选择的物品",
    Callback = function()
        if selectedItem and selectedItem ~= "" then
            local itemName = getItemNameByDisplayName(selectedItem)
            if itemName then
                addItem(itemName)
            end
        end
    end
})
Main:Section({ Title = "免费箱子", Icon = "swords" })
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local load = require(ReplicatedStorage.devv).load
local var4_result1_upvr_5 = load("skins")
local var4_result1_upvr_9 = load("state")
local var4_result1_upvr_10 = load("Signal")

local caseList = {}
local selectedCase = "Series3Heavy"

local function getAvailableCases()
    local cases = {}
    for caseName, caseData in pairs(var4_result1_upvr_5.cases) do
        table.insert(cases, caseName)
    end
    table.sort(cases)
    return cases
end

caseList = getAvailableCases()

Main:Dropdown({
    Title = "选择箱子类型",
    Values = caseList,
    Value = selectedCase,
    Callback = function(value)
        selectedCase = value
    end
})

Main:Button({
    Title = "获得999个选中箱子",
    Callback = function()
        if not var4_result1_upvr_9.data.ownedCases then
            var4_result1_upvr_9.data.ownedCases = {}
        end
        
        var4_result1_upvr_9.data.ownedCases[selectedCase] = 999
        
        if var4_result1_upvr_9.data.ownedCases[selectedCase] then
        else
        end
    end
})

Main:Button({
    Title = "获得所有箱子999个",
    Callback = function()
        if not var4_result1_upvr_9.data.ownedCases then
            var4_result1_upvr_9.data.ownedCases = {}
        end
        
        local count = 0
        for _, caseName in ipairs(caseList) do
            var4_result1_upvr_9.data.ownedCases[caseName] = 999
            count = count + 1
        end
    end
})

Main:Section({ Title = "皮肤类", Icon = "swords" })
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local load = require(ReplicatedStorage.devv).load
local var6_result1_upvr_5 = load("skins")
local var6_result1_upvr_4 = load("state")
local var6_result1_upvr_2 = load("Signal")

local skinList = {}
local selectedWeapon = "AK-47"
local selectedSkin = ""

local function getWeaponList()
    local weapons = {}
    for _, weapon in ipairs(var6_result1_upvr_5.compatabilities.Generic or {}) do
        table.insert(weapons, weapon)
    end
    table.sort(weapons)
    return weapons
end

local function getSkinListForWeapon(weapon)
    local skins = {}
    for skinName, skinData in pairs(var6_result1_upvr_5.skinData or {}) do
        local compatTable = var6_result1_upvr_5.GetCompatabilityTable(skinName, weapon)
        if compatTable and #compatTable > 0 then
            table.insert(skins, skinName)
        end
    end
    table.sort(skins)
    return skins
end

local weaponList = getWeaponList()

Main:Dropdown({
    Title = "选择类型",
    Values = weaponList,
    Value = selectedWeapon,
    Callback = function(value)
        selectedWeapon = value
        local weaponSkins = getSkinListForWeapon(value)
        skinList = weaponSkins
        if #weaponSkins > 0 then
            selectedSkin = weaponSkins[1]
        else
            selectedSkin = ""
        end
    end
})

Main:Dropdown({
    Title = "选择皮肤",
    Values = skinList,
    Value = selectedSkin,
    Callback = function(value)
        selectedSkin = value
    end
})

Main:Button({
    Title = "更换皮肤",
    Callback = function()
        if selectedWeapon == "" or selectedSkin == "" then
            WindUI:Notify({
                Title = "皮肤",
                Content = "请选择武器和皮肤",
                Duration = 3,
                Icon = "warning"
            })
            return
        end
        
        local compatTable = var6_result1_upvr_5.GetCompatabilityTable(selectedSkin, selectedWeapon)
        if not compatTable or #compatTable == 0 then
            WindUI:Notify({
                Title = "皮肤",
                Content = "该皮肤不适用于所选武器",
                Duration = 3,
                Icon = "warning"
            })
            return
        end
        
        local it = load("v3item").inventory
        it.skinUpdate(selectedWeapon, selectedSkin)
        
        WindUI:Notify({
            Title = "皮肤",
            Content = "已更换" .. selectedWeapon .. "的皮肤为" .. selectedSkin,
            Duration = 3,
            Icon = "check"
        })
    end
})

if #weaponList > 0 then
    local weaponSkins = getSkinListForWeapon(selectedWeapon)
    skinList = weaponSkins
    if #weaponSkins > 0 then
        selectedSkin = weaponSkins[1]
    end
end
local function setupCurrencyCheats()
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    local load = require(ReplicatedStorage.devv).load
    local Signal = load("Signal")
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    local moneyDisplay = load("moneyDisplay")
    local v3item = load("v3item")

    local gingerbreadAmount = 99999
    local moneyAmount = 999999999

    Main:Section({ Title = "姜饼人", Icon = "cookie" })

    Main:Input({
        Title = "姜饼人数量",
        Value = "99999",
        Placeholder = "输入姜饼人数量",
        Callback = function(value)
            local num = tonumber(value)
            if num and num > 0 then
                gingerbreadAmount = num
            end
        end
    })

    Main:Button({
        Title = "获得姜饼人",
        Icon = "cookie",
        Callback = function()
            pcall(function()
                LocalPlayer:SetAttribute("gingerbread", gingerbreadAmount)
            end)
            
            WindUI:Notify({
                Title = "姜饼人",
                Content = string.format("获得 %d 个姜饼人", gingerbreadAmount),
                Duration = 3,
                Icon = "check"
            })
        end
    })

    Main:Section({ Title = "金钱", Icon = "dollar-sign" })

    Main:Input({
        Title = "金钱数量",
        Value = "999999999",
        Placeholder = "输入金钱数量",
        Callback = function(value)
            local num = tonumber(value)
            if num and num > 0 then
                moneyAmount = num
            end
        end
    })

    Main:Button({
        Title = "获得金钱",
        Icon = "dollar-sign",
        Callback = function()
            pcall(function()
                local moneydata = tostring(moneyAmount)
                moneyDisplay.current = moneydata
                moneyDisplay.tweenTo = moneydata
                moneyDisplay.caChing()
            end)
            
            WindUI:Notify({
                Title = "金钱",
                Content = string.format("获得 $%s", tostring(moneyAmount)),
                Duration = 3,
                Icon = "check"
            })
        end
    })

    Main:Button({
        Title = "更新钱包显示",
        Icon = "refresh-cw",
        Callback = function()
            pcall(function()
                local equippedItem = v3item.inventory.getEquipped()
                if equippedItem and equippedItem.name == "Wallet" then
                    local moneydata = tostring(moneyAmount)
                    equippedItem.controller:updateMoney(moneydata)
                    
                    WindUI:Notify({
                        Title = "钱包更新",
                        Content = "已更新钱包显示",
                        Duration = 2,
                        Icon = "check"
                    })
                else
                    WindUI:Notify({
                        Title = "错误",
                        Content = "请先装备钱包",
                        Duration = 3,
                        Icon = "x"
                    })
                end
            end)
        end
    })
end

setupCurrencyCheats()

local Main = Window:Tab({Title = "金钱", Icon = "dollar-sign"})

local autobank = false
local bankTeleportCFrame = CFrame.new(1112.12671, 10.1856346, -324.815613)  
local originalPosition = nil  

local function robBankAndReturn()
    if not autobank then return end
    
    local player = game:GetService("Players").LocalPlayer
    local character = player.Character
    if not character then return end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end
    
    originalPosition = rootPart.CFrame
    
    rootPart.CFrame = bankTeleportCFrame
    task.wait(0.1)
    
    local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
    
    local waitTime = 0.1
    local maxWait = 5.0
    
    local startTime = tick()
    while autobank and (tick() - startTime) < maxWait do
        Signal.FireServer("stealBankCash")
        task.wait(waitTime)
    end
    
    if autobank and originalPosition then
        rootPart.CFrame = originalPosition
        task.wait(0.1)
    end
    
    originalPosition = nil
end

local bankThread = nil

local function startBankRobberyLoop()
    if bankThread then return end
    
    bankThread = task.spawn(function()
        while autobank do
            robBankAndReturn()
            task.wait(0.5)
        end
        bankThread = nil
    end)
end

local function stopBankRobberyLoop()
    if bankThread then
        task.cancel(bankThread)
        bankThread = nil
    end
end

Main:Toggle({
    Title = "自动抢银行",
    Value = false,
    Callback = function(state) 
        autobank = state
        if autobank then
            startBankRobberyLoop()
        else
            stopBankRobberyLoop()
        end
    end
})

Main:Toggle({
    Title = "自动ATM",
    Default = false,
    Callback = function(Value)
        autoATMCashCombo = Value
        
        if autoATMCashCombo then
            local function collectCash()
                local player = game:GetService("Players").LocalPlayer
                local cashSize = Vector3.new(2, 0.2499999850988388, 1)
                
                for _, part in ipairs(workspace.Game.Entities.CashBundle:GetDescendants()) do
                    if part:IsA("BasePart") and part.Size == cashSize then
                        player.Character.HumanoidRootPart.CFrame = part.CFrame
                        task.wait()
                    end
                end
            end
            
            coroutine.wrap(function()
                while autoATMCashCombo and task.wait() do
                   
                    local ATMsFolder = workspace:FindFirstChild("ATMs")
                    local localPlayer = game:GetService("Players").LocalPlayer
                    local hasActiveATM = false
                    
                    if ATMsFolder and localPlayer.Character then
                        for _, atm in ipairs(ATMsFolder:GetChildren()) do
                            if atm:IsA("Model") then
                                local hp = atm:GetAttribute("health")
                                if hp ~= 0 then
                                    hasActiveATM = true
                                    for _, part in ipairs(atm:GetChildren()) do
                                        if part.Name == "Main" and part:IsA("BasePart") then
                                            localPlayer.Character.HumanoidRootPart.CFrame = part.CFrame
                                            task.wait()
                                            atm:SetAttribute("health", 0)
                                            break
                                        end
                                    end
                                    task.wait()
                                end
                            end
                        end
                    end
                    
                    if hasActiveATM then
                        task.wait(1)
                    else
                        collectCash()
                        
                 
                        task.wait()
                    end
                end
            end)()
        end
    end
})

local autoCraftEnabled = false
local autoClaimEnabled = false
local craftConnection

local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")

local function performCrafting()
    if autoCraftEnabled then
        Signal.InvokeServer("beginCraft", 'RollieCraft')
    end
    
    if autoClaimEnabled then
        Signal.InvokeServer("claimCraft", 'RollieCraft')
    end
end

game:GetService("RunService").Heartbeat:Connect(function()
    if autoCraftEnabled or autoClaimEnabled then
        performCrafting()
    end
end)

Main:Toggle({
    Title = "自动制作萝莉",
    Default = false,
    Callback = function(Value)
        autoCraftEnabled = Value
    end
})

Main:Toggle({
    Title = "自动领取萝莉",
    Default = false,
    Callback = function(Value)
        autoClaimEnabled = Value
    end
})

local autoStoreGems = false
local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
local b1 = require(game:GetService('ReplicatedStorage').devv).load('v3item').inventory.items

local function storeGems()
    for _, v in pairs(workspace.HousingPlots:GetDescendants()) do
        if v:IsA("ProximityPrompt") then
            if v.ActionText == "Add Gem" or v.ActionText == "Equip a Gem" then
                local houseid = v.Parent.Parent.Name
                local hitid = v.Parent.Name
                for i, item in next, b1 do
                    if item.name == "Diamond" or item.name == "Rollie" or item.name == "Dark Matter Gem" or item.name == "Diamond Ring" or item.name == "Void Gem" then
                        Signal.FireServer("equip", item.guid)
                        Signal.FireServer("updateGemDisplay", houseid, hitid, item.guid)
                    end
                end
            end
        end
    end
end

game:GetService("RunService").Heartbeat:Connect(function()
    if autoStoreGems then
        storeGems()
    end
end)

Main:Toggle({
    Title = "自动存放珠宝到家用珠宝柜",
    Desc = "需要有房子和珠宝柜",
    Default = false,
    Callback = function(Value)
        autoStoreGems = Value
    end
})
local autoRentHouse = false

local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")

local function rentHouse()
    for _, v in pairs(workspace.HousingPlots:GetChildren()) do
        if not v:GetAttribute("Owner") then
            local housename = v
            Signal.InvokeServer("rentHouse", v)
        end
    end
end

local lastRentTime = 0
game:GetService("RunService").Heartbeat:Connect(function()
    if autoRentHouse and tick() - lastRentTime >= 2 then
        rentHouse()
        lastRentTime = tick()
    end
end)

Main:Toggle({
    Title = "自动租用房屋",
    Default = false,
    Callback = function(Value)
        autoRentHouse = Value
    end
})
local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")

local autoClaimEnabled = false
local autoClaimConnection = nil

local function autoClaimRewards()
   
    for day = 1, 12 do
        Signal.InvokeServer("claimDailyReward", day)
        task.wait(0.1)
    end
    
   
    for tier = 1, 3 do
        for level = 1, 6 do
            Signal.InvokeServer("claimPlaytimeReward", tier, level)
            task.wait(0.1)
        end
    end
    
    WindUI:Notify({Title = "自动领取", Content = "奖励领取完成", Duration = 2})
end

local function startAutoClaimLoop()
    autoClaimEnabled = true
    autoClaimConnection = task.spawn(function()
        while autoClaimEnabled do
            autoClaimRewards()
            task.wait(5) 
        end
    end)
end

local function stopAutoClaimLoop()
    autoClaimEnabled = false
    if autoClaimConnection then
        autoClaimConnection:Disconnect()
        autoClaimConnection = nil
    end
end

Main:Toggle({
    Title = "自动领取奖励",
    Default = false,
    Callback = function(Value)
        if Value then
            startAutoClaimLoop()
        else
            stopAutoClaimLoop()
        end
    end
})
local function teleportToAirdrop()
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer
    local character = localPlayer.Character
    if not character then return false end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return false end
    
    local originalPosition = rootPart.CFrame
    local foundAirdrop = false
    local airdrops = game:GetService('Workspace').Game.Airdrops:GetChildren()
    for _, airdrop in pairs(airdrops) do
        if airdrop:FindFirstChild('Airdrop') and airdrop.Airdrop:FindFirstChild('ProximityPrompt') then
            local prompt = airdrop.Airdrop.ProximityPrompt
            prompt.RequiresLineOfSight = false
            prompt.HoldDuration = 0
            rootPart.CFrame = airdrop.Airdrop.CFrame
            task.wait(0.1) 
            
      
            for i = 1, 15 do
                fireproximityprompt(prompt)
                task.wait(0.02) 
            end
            
            foundAirdrop = true
            break
        end
    end
    
 
    if not foundAirdrop then
        rootPart.CFrame = originalPosition
    else
       
        task.wait(0.3)
        rootPart.CFrame = originalPosition
    end
    
    return foundAirdrop
end
local airdropAutoEnabled = false
Main:Toggle({
    Title = "自动空投",
    Default = false,
    Callback = function(Value)
        airdropAutoEnabled = Value
        if Value then
            task.spawn(function()
                while airdropAutoEnabled do
                    local collected = teleportToAirdrop()
                    if not collected then
                  
                        for i = 1, 10 do
                            if not airdropAutoEnabled then break end
                            task.wait(0.1)
                        end
                    else
                     
                        for i = 1, 3 do
                            if not airdropAutoEnabled then break end
                            task.wait(0.1)
                        end
                    end
                end
            end)
        end
    end
})

local function fastCollectMoney()
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer
    local character = localPlayer.Character
    if not character then return false end
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return false end
    local originalPosition = humanoidRootPart.CFrame
    local foundMoney = false
    local moneyEntities = workspace.Game.Entities.CashBundle:GetChildren()
    for i = 1, #moneyEntities do
        local l = moneyEntities[i]
        local moneyValue = l:FindFirstChildWhichIsA("IntValue")
        if moneyValue and moneyValue.Value >= setting.minMoney then
            humanoidRootPart.CFrame = l:FindFirstChildWhichIsA("Part").CFrame
            task.wait(0.2)
            humanoidRootPart.CFrame = originalPosition
            foundMoney = true
            break
        end
    end
    return foundMoney
end

Main:Toggle({
    Title = "自动捡钱",
    Default = false,
    Callback = function(Value)
        setting.autoMoney = Value
        if Value then
            task.spawn(function()
                while setting.autoMoney and task.wait(0.1) do
                    fastCollectMoney()
                end
            end)
        end
    end
})

Main:Slider({
    Title = "最低钱数设置",
    Value = {
        Min = 250,
        Max = 1000,
        Default = 250,
    },
    Callback = function(Value)
        setting.minMoney = Value
    end
})

local function crackSafes()
    while autoOpenSafes do
        if not checkAnyTargetExists() then
            teleportToHideSpot()
            task.wait(1)
        else
            pcall(function()
                local rootPart = getRootPart()
                if not rootPart then return end

                for _, obj in ipairs(workspace.Game.Entities:GetDescendants()) do
                    if not autoOpenSafes then break end
                    if obj:IsA("ProximityPrompt") and obj.ActionText == "Crack Safe" and obj.Enabled then
                        obj.RequiresLineOfSight = false
                        obj.HoldDuration = 0

                        local target = obj.Parent and obj.Parent.Parent
                        if target and target:IsA("BasePart") then
                            rootPart.CFrame = CFrame.new(target.Position)
                            task.wait(1)
                            fireproximityprompt(obj)
                            task.wait(0.5)
                            task.wait(2)
                            pickupAll15m(target.Position)
                        end
                    end
                end
            end)
            task.wait(1)
        end
    end
end

local function crackChests()
    while autoOpenChests do
        if not checkAnyTargetExists() then
            teleportToHideSpot()
            task.wait(1)
        else
            pcall(function()
                local rootPart = getRootPart()
                if not rootPart then return end

                for _, obj in ipairs(workspace.Game.Entities:GetDescendants()) do
                    if not autoOpenChests then break end
                    if obj:IsA("ProximityPrompt") and obj.ActionText == "Crack Chest" and obj.Enabled then
                        obj.RequiresLineOfSight = false
                        obj.HoldDuration = 0

                        local target = obj.Parent and obj.Parent.Parent
                        if target and target:IsA("BasePart") then
                            rootPart.CFrame = CFrame.new(target.Position)
                            task.wait(1)
                            fireproximityprompt(obj)
                            task.wait(0.5)
                            task.wait(2)
                            pickupAll15m(target.Position)
                        end
                    end
                end
            end)
            task.wait(1)
        end
    end
end

local function updateThreads()
    if safeThread then
        task.cancel(safeThread)
        safeThread = nil
    end
    if autoOpenSafes then
        safeThread = task.spawn(crackSafes)
    end

    if chestThread then
        task.cancel(chestThread)
        chestThread = nil
    end
    if autoOpenChests then
        chestThread = task.spawn(crackChests)
    end
end

Main:Toggle({
    Title = "自动保险箱",
    Default = false,
    Callback = function(Value)
        autoOpenSafes = Value
        updateThreads()
    end
})

Main:Toggle({
    Title = "自动宝箱",
    Default = false,
    Callback = function(Value)
        autoOpenChests = Value
        updateThreads()
    end
})

Main:Toggle({
    Title = "自动购买撬锁",
    Default = false,
    Callback = function(Value)
        lock = Value
        task.spawn(function()
            while lock and task.wait() do
                pcall(function()
                    local Players = game:GetService("Players")
                    local localPlayer = Players.LocalPlayer
                    if localPlayer.Character then
                        local rootPart = localPlayer.Character:FindFirstChild("HumanoidRootPart")
                        if rootPart then
                            Signal.InvokeServer("attemptPurchase", "Lockpick")
                        end
                    end
                end)
            end
        end)
    end
})

local F2 = Window:Tab({Title = "物品", Icon = "box"})
F2:Toggle({
    Title = "自动捡价值宝石",
    --Image = "bird",
    Value = false,
    Callback = function(state) 
    autobs = state
    if autobs then
    while autobs and wait() do 
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer
    local rootPart = localPlayer.Character.HumanoidRootPart

    for _, l in pairs(game.Workspace.Game.Entities.ItemPickup:GetChildren()) do
        for _, v in pairs(l:GetChildren()) do
            if v:IsA("MeshPart") or v:IsA("Part") then
                local e = v:FindFirstChildOfClass("ProximityPrompt")
                if e and (e.ObjectText == "" or e.ObjectText == "+" or e.ObjectText == ""  or e.ObjectText == ""  or e.ObjectText == ""  or e.ObjectText == "Diamond Ring"  or e.ObjectText == "Diamond" or e.ObjectText == "Void Gem" or e.ObjectText == "Dark Matter Gem" or e.ObjectText == "Rollie" or e.ObjectText == "") then
                    rootPart.CFrame = v.CFrame * CFrame.new(0, 2, 0)
                    e.RequiresLineOfSight = false
                    e.HoldDuration = 0
                    fireproximityprompt(e)
                end
            end
        end
    end
    end
    end
    end
})
F2:Toggle({
    Title = "自动捡贵重物品",
    --Image = "bird",
    Value = false,
    Callback = function(state) 
    autogzwp = state
    if autogzwp then
    while autogzwp and wait() do 
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer
    local rootPart = localPlayer.Character.HumanoidRootPart
    for _, l in pairs(game.Workspace.Game.Entities.ItemPickup:GetChildren()) do
        for _, v in pairs(l:GetChildren()) do
            if v:IsA("MeshPart") or v:IsA("Part") then
                local e = v:FindFirstChildOfClass("ProximityPrompt")
                if e and (e.ObjectText == "Green Lucky Block" or e.ObjectText == "Orange Lucky Block" or e.ObjectText == "Purple Lucky Block" or e.ObjectText == "Blue Candy Cane" or e.ObjectText == "Suitcase Nuke" or e.ObjectText == "Nuke Launcher" or e.ObjectText == "Easter Basket" or e.ObjectText == "Gold Cup" or e.ObjectText == "Gold Crown" or e.ObjectText == "Pearl Necklace" or e.ObjectText == "Treasure Map"or e.ObjectText == "Spectral Scythe" or e.ObjectText == "Bunny Balloon" or e.ObjectText == "Ghost Balloon" or e.ObjectText == "Clover Balloon" or e.ObjectText == "Bat Balloon" or e.ObjectText == "Gold Clover Balloon" or e.ObjectText == "Golden Rose" or e.ObjectText == "Black Rose" or e.ObjectText == "Heart Balloon" or e.ObjectText == "Skull Balloon" or e.ObjectText == "Money Printer") then
                    rootPart.CFrame = v.CFrame * CFrame.new(0, 2, 0)
                    e.RequiresLineOfSight = false
                    e.HoldDuration = 0
                    fireproximityprompt(e)
                end
            end
        end
    end
    end
    end
    end
})

F2:Toggle({
    Title = "自动捡普通宝石",
    --Image = "bird",
    Value = false,
    Callback = function(state) 
    autobs = state
    if autobs then
    while autobs and wait() do 
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer
    local rootPart = localPlayer.Character.HumanoidRootPart

    for _, l in pairs(game.Workspace.Game.Entities.ItemPickup:GetChildren()) do
        for _, v in pairs(l:GetChildren()) do
            if v:IsA("MeshPart") or v:IsA("Part") then
                local e = v:FindFirstChildOfClass("ProximityPrompt")
                if e and (e.ObjectText == "Amethyst" or e.ObjectText == "Sapphire" or e.ObjectText == "Emerald"  or e.ObjectText == "Topaz"  or e.ObjectText == "Ruby"  or e.ObjectText == "Diamond Ring"  or e.ObjectText == "Diamond" or e.ObjectText == "Void Gem" or e.ObjectText == "Dark Matter Gem" or e.ObjectText == "Rollie" or e.ObjectText == "Gold Bar") then
                    rootPart.CFrame = v.CFrame * CFrame.new(0, 2, 0)
                    e.RequiresLineOfSight = false
                    e.HoldDuration = 0
                    fireproximityprompt(e)
                end
            end
        end
    end
    end
    end
    end
})
local Players            = game:GetService("Players")
local ReplicatedStorage  = game:GetService("ReplicatedStorage")
local devv               = require(ReplicatedStorage.devv)
local item               = devv.load("v3item")
local Signal             = devv.load("Signal")
local junkWeps  = {"Uzi","M1911","C4","Glock","Mossberg","Stagecouch","Python"}
local junkGems  = {"","","","",""}
local junkMisc  = {"Baseball Bat","Basketball","Bloxaide","Bloxy Cola","Cake","Stop Sign"}
local setting = { collect = {} }
local function rmList(list)
    for _, v in next, item.inventory.items do
        for _, name in ipairs(list) do
            if v.name == name then
                Signal.FireServer("removeItem", v.guid)
             
                break
            end
        end
    end
end
local running = {}         
local function loopClean(key, list)
    if running[key] then return end        
    running[key] = true
    task.spawn(function()
        while setting.collect[key] do
            rmList(list)
            task.wait(0.5)
        end
        running[key] = false
    end)
end
local function addToggle(title, key, list)
    F2:Toggle({
        Title   = title,
        Default = false,
        Callback = function(v)
            setting.collect[key] = v
            if v then loopClean(key, list) end
        end
    })
end

do
    local allJunk = {}
    for _, v in ipairs(junkWeps)  do table.insert(allJunk, v) end
    for _, v in ipairs(junkGems)  do table.insert(allJunk, v) end
    for _, v in ipairs(junkMisc)  do table.insert(allJunk, v) end
    rmList(allJunk)
end
addToggle("自动移除垃圾枪",   "autoremoveweps",  junkWeps)
addToggle("自动移除垃圾宝石", "autoremovegems",  junkGems)
addToggle("自动移除其它垃圾", "autoremovemisc",  junkMisc)

F2:Section({ Title = "物品栏数量", Icon = "box" })

F2:Slider({
    Title = "物品栏数量",
    Desc = "调整背包物品栏的数量",
    Value = {
        Min = 1,
        Max = 12,
        Default = 6,
    },
    Callback = function(Value)
        local sum = require(game.ReplicatedStorage.devv.client.Objects.v3item.modules.inventory)
        sum.numSlots = Value
    end
})


local Main = Window:Tab({Title = "骚扰类", Icon = "phone"})

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Signal = require(ReplicatedStorage.devv).load("Signal")
local TweenService = game:GetService("TweenService")

harassSettings = {
    targetPlayer = nil,
    messageText = "我是神",
    isSpamming = false,
    spamInterval = 1,
    autoMessages = {
        "孩子干啥呢啊",
        "有什么实力",
        "活着干啥呢",
        "XH HUB",
        "BYPASS"
    },
    autoMessageIndex = 1,
    isAutoCalling = false,
    callInterval = 5,
    currentCallId = nil,
    playerList = {},
    lastPlayerRefresh = 0,
    playerRefreshInterval = 5,
    spamAllEnabled = false,
    blockAllEnabled = false
}

function startAutoCall()
    if not harassSettings.targetPlayer then
        WindUI:Notify({Title = "打电话", Content = "请先选择目标玩家", Duration = 3, Icon = "phone-off"})
        return false
    end
    
    harassSettings.isAutoCalling = true
    
    task.spawn(function()
        while harassSettings.isAutoCalling and harassSettings.targetPlayer do
            pcall(function()
                local success, callId = Signal.InvokeServer("attemptCall", harassSettings.targetPlayer.UserId)
                
                if success then
                    harassSettings.currentCallId = callId
                    WindUI:Notify({
                        Title = "打电话", 
                        Content = "正在呼叫: " .. harassSettings.targetPlayer.Name,
                        Duration = 3, 
                        Icon = "phone-outgoing"
                    })
                    
                    local callDuration = math.random(10, 30)
                    local startTime = os.time()
                    
                    while harassSettings.isAutoCalling and os.time() - startTime < callDuration do
                        task.wait(1)
                    end
                    
                    if harassSettings.currentCallId then
                        Signal.FireServer("sendPhoneAction", harassSettings.currentCallId, "hangup")
                        harassSettings.currentCallId = nil
                    end
                else
                    WindUI:Notify({
                        Title = "打电话", 
                        Content = "呼叫失败: " .. harassSettings.targetPlayer.Name,
                        Duration = 3, 
                        Icon = "phone-missed"
                    })
                end
            end)
            
            if harassSettings.isAutoCalling then
                task.wait(harassSettings.callInterval)
            end
        end
    end)
end

function stopAutoCall()
    harassSettings.isAutoCalling = false
    if harassSettings.currentCallId then
        Signal.FireServer("sendPhoneAction", harassSettings.currentCallId, "hangup")
        harassSettings.currentCallId = nil
    end
end

function startSpam()
    harassSettings.isSpamming = true
    task.spawn(function()
        while harassSettings.isSpamming and harassSettings.targetPlayer do
            pcall(function()
                Signal.FireServer("sendMessage", harassSettings.targetPlayer.UserId, harassSettings.messageText)
            end)
            task.wait(harassSettings.spamInterval)
        end
    end)
end

function startAutoMessages()
    task.spawn(function()
        while harassSettings.isSpamming and harassSettings.targetPlayer do
            pcall(function()
                Signal.FireServer("sendMessage", harassSettings.targetPlayer.UserId, 
                    harassSettings.autoMessages[harassSettings.autoMessageIndex])
                
                harassSettings.autoMessageIndex = harassSettings.autoMessageIndex + 1
                if harassSettings.autoMessageIndex > #harassSettings.autoMessages then
                    harassSettings.autoMessageIndex = 1
                end
            end)
            task.wait(harassSettings.spamInterval)
        end
    end)
end

function startSpamAll()
    harassSettings.spamAllEnabled = true
    task.spawn(function()
        while harassSettings.spamAllEnabled do
            pcall(function()
                for _, player in ipairs(Players:GetPlayers()) do
                    if player ~= Players.LocalPlayer then
                        Signal.FireServer("sendMessage", player.UserId, harassSettings.messageText)
                    end
                end
            end)
            task.wait(harassSettings.spamInterval)
        end
    end)
end

function stopSpamAll()
    harassSettings.spamAllEnabled = false
end

function blockAllMessages()
    if not harassSettings.blockAllEnabled then return end
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= Players.LocalPlayer then
            Signal.FireServer("blockPlayer", player.UserId)
        end
    end
end

function refreshPlayerList()
    local currentTime = os.time()
    if currentTime - harassSettings.lastPlayerRefresh < harassSettings.playerRefreshInterval then
        return harassSettings.playerList
    end
    
    harassSettings.lastPlayerRefresh = currentTime
    harassSettings.playerList = {}
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= Players.LocalPlayer then
            table.insert(harassSettings.playerList, {
                text = player.Name .. " (@" .. player.DisplayName .. ")",
                value = player.Name
            })
        end
    end
    
    table.sort(harassSettings.playerList, function(a, b)
        return a.text:lower() < b.text:lower()
    end)
    
    return harassSettings.playerList
end

function getPlayerListValues()
    refreshPlayerList()
    local values = {}
    for _, player in ipairs(harassSettings.playerList) do
        table.insert(values, player.text)
    end
    return values
end

Main:Paragraph({
    Title = "小伙伴赶紧骚扰小伙伴吧",
    Desc = "有缺陷请提出",
    Image = "phone",
    ImageSize = 20,
    Color = "Red"
})

local playerDropdown = Main:Dropdown({
    Title = "选择目标玩家",
    Desc = "自动刷新玩家列表",
    Values = getPlayerListValues(),
    Value = "",
    Callback = function(value)
        if value and value ~= "" then
            local playerName = value:match("^([^%s]+)")
            if playerName then
                harassSettings.targetPlayer = Players:FindFirstChild(playerName)
                if harassSettings.targetPlayer then
                    WindUI:Notify({
                        Title = "目标设置", 
                        Content = "已选择: " .. harassSettings.targetPlayer.Name,
                        Duration = 2, 
                        Icon = "user-check"
                    })
                else
                    WindUI:Notify({
                        Title = "错误", 
                        Content = "未找到玩家: " .. playerName,
                        Duration = 3, 
                        Icon = "user-x"
                    })
                end
            end
        else
            harassSettings.targetPlayer = nil
        end
    end
})

Main:Button({
    Title = "刷新玩家列表",
    Icon = "refresh-cw",
    Callback = function()
        local newValues = getPlayerListValues()
        playerDropdown:Refresh(newValues)
        WindUI:Notify({
            Title = "玩家列表", 
            Content = "已刷新，找到 " .. #newValues .. " 个玩家",
            Duration = 2, 
            Icon = "users"
        })
    end
})

Main:Toggle({
    Title = "自动打电话",
    Value = false,
    Callback = function(isEnabled)
        if isEnabled and not harassSettings.targetPlayer then
            WindUI:Notify({
                Title = "错误", 
                Content = "请先选择目标玩家",
                Duration = 3, 
                Icon = "user-x"
            })
            return false
        end
        
        if isEnabled then
            startAutoCall()
            WindUI:Notify({
                Title = "开始打电话", 
                Content = "开始自动呼叫: " .. harassSettings.targetPlayer.Name,
                Duration = 3, 
                Icon = "phone-outgoing"
            })
        else
            stopAutoCall()
            WindUI:Notify({
                Title = "停止打电话", 
                Content = "已停止自动呼叫",
                Duration = 2, 
                Icon = "phone-off"
            })
        end
    end
})

Main:Slider({
    Title = "呼叫间隔",
    Desc = "设置每次呼叫的时间间隔（秒）",
    Value = {Min = 3, Max = 60, Default = 5},
    Callback = function(value)
        harassSettings.callInterval = value
    end
})

Main:Input({
    Title = "自定义消息",
    Value = "我是神",
    Placeholder = "输入要发送的消息内容",
    Callback = function(value)
        harassSettings.messageText = value
    end
})

Main:Toggle({
    Title = "消息轰炸[自定义]",
    Value = false,
    Callback = function(isEnabled)
        if isEnabled and not harassSettings.targetPlayer then
            WindUI:Notify({
                Title = "错误", 
                Content = "请先选择目标玩家",
                Duration = 3, 
                Icon = "user-x"
            })
            return false
        end
        
        harassSettings.isSpamming = isEnabled
        if isEnabled then
            startSpam()
            WindUI:Notify({
                Title = "开始轰炸", 
                Content = "开始向 " .. harassSettings.targetPlayer.Name .. " 发送消息",
                Duration = 3, 
                Icon = "send"
            })
        else
            WindUI:Notify({
                Title = "停止轰炸", 
                Content = "已停止发送消息",
                Duration = 2, 
                Icon = "square"
            })
        end
    end
})

Main:Toggle({
    Title = "自动发送预设消息",
    Value = false,
    Callback = function(isEnabled)
        if isEnabled and not harassSettings.targetPlayer then
            WindUI:Notify({
                Title = "错误", 
                Content = "请先选择目标玩家",
                Duration = 3, 
                Icon = "user-x"
            })
            return false
        end
        
        harassSettings.isSpamming = isEnabled
        if isEnabled then
            startAutoMessages()
            WindUI:Notify({
                Title = "开始自动消息", 
                Content = "开始发送预设消息给 " .. harassSettings.targetPlayer.Name,
                Duration = 3, 
                Icon = "message-circle"
            })
        else
            WindUI:Notify({
                Title = "停止自动消息", 
                Content = "已停止发送预设消息",
                Duration = 2, 
                Icon = "message-square"
            })
        end
    end
})

Main:Slider({
    Title = "消息间隔",
    Desc = "设置发送消息的时间间隔（秒）",
    Value = {Min = 0.1, Max = 5, Default = 1},
    Callback = function(value)
        harassSettings.spamInterval = value
    end
})

Main:Toggle({
    Title = "群发消息",
    Value = false,
    Callback = function(isEnabled)
        if isEnabled then
            startSpamAll()
            WindUI:Notify({
                Title = "开始群发", 
                Content = "开始向所有玩家发送消息",
                Duration = 3, 
                Icon = "send"
            })
        else
            stopSpamAll()
            WindUI:Notify({
                Title = "停止群发", 
                Content = "已停止群发消息",
                Duration = 2, 
                Icon = "square"
            })
        end
    end
})

Main:Toggle({
    Title = "屏蔽所有人消息和电话",
    Value = false,
    Callback = function(isEnabled)
        harassSettings.blockAllEnabled = isEnabled
        if isEnabled then
            blockAllMessages()
            WindUI:Notify({
                Title = "开启屏蔽", 
                Content = "已屏蔽所有玩家消息和电话",
                Duration = 3, 
                Icon = "shield"
            })
            
            task.spawn(function()
                while harassSettings.blockAllEnabled do
                    blockAllMessages()
                    task.wait(5)
                end
            end)
        else
            WindUI:Notify({
                Title = "关闭屏蔽", 
                Content = "已取消屏蔽所有玩家",
                Duration = 2, 
                Icon = "shield-off"
            })
        end
    end
})

local CasePurchase = Window:Tab({Title = "皮肤箱子", Icon = "shopping-bag"})

local casesList = {}
local skins = require(game:GetService("ReplicatedStorage").devv).load("skins")

for caseName, caseData in pairs(skins.cases) do
    if caseData.cashPrice or caseData.candyPrice or caseData.gingerbreadPrice then
        table.insert(casesList, caseName)
    end
end

local selectedCase = casesList[1]
local selectedOpenCase = casesList[1]
local autoOpenSelected = false
local autoBuySelected = false
local autoOpenAll = false

CasePurchase:Dropdown({
    Title = "选择要购买的箱子",
    Values = casesList,
    Callback = function(Value)
        selectedCase = Value
    end
})

CasePurchase:Button({
    Title = "购买一次选中箱子",
    Callback = function()
        local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
        Signal.InvokeServer("buyCases", selectedCase, 1)
    end
})

CasePurchase:Toggle({
    Title = "自动购买选中箱子",
    Value = false,
    Callback = function(state)
        autoBuySelected = state
        if state then
            task.spawn(function()
                local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
                
                while autoBuySelected do
                    Signal.InvokeServer("buyCases", selectedCase, 1)
                    task.wait(0.5)
                end
            end)
        end
    end
})

CasePurchase:Dropdown({
    Title = "选择要开启的箱子",
    Values = casesList,
    Callback = function(Value)
        selectedOpenCase = Value
    end
})

CasePurchase:Toggle({
    Title = "自动开启选中箱子",
    Value = false,
    Callback = function(state)
        autoOpenSelected = state
        if state then
            task.spawn(function()
                local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
                local state = require(game:GetService("ReplicatedStorage").devv).load("state")
                
                while autoOpenSelected do
                    local ownedCount = state.data.ownedCases[selectedOpenCase] or 0
                    if ownedCount > 0 then
                        Signal.InvokeServer("openCase", selectedOpenCase)
                        task.wait(0.5)
                    else
                        task.wait(1)
                    end
                end
            end)
        end
    end
})

CasePurchase:Toggle({
    Title = "自动开全部箱子",
    Value = false,
    Callback = function(state)
        autoOpenAll = state
        if state then
            task.spawn(function()
                local Signal = require(game:GetService("ReplicatedStorage").devv).load("Signal")
                local state = require(game:GetService("ReplicatedStorage").devv).load("state")
                
                while autoOpenAll do
                    for caseName, ownedCount in pairs(state.data.ownedCases or {}) do
                        if ownedCount > 0 and not autoOpenSelected then
                            Signal.InvokeServer("openCase", caseName)
                            task.wait(0.3)
                        end
                    end
                    task.wait(1)
                end
            end)
        end
    end
})

local Main = Window:Tab({Title = "人物", Icon = "settings"})

Main:Toggle({
    Title = "速度",
    Default = false,
    Callback = function(v)
        if v == true then
            sudu = game:GetService("RunService").Heartbeat:Connect(function()
                if game:GetService("Players").LocalPlayer.Character and game:GetService("Players").LocalPlayer.Character.Humanoid and game:GetService("Players").LocalPlayer.Character.Humanoid.Parent then
                    if game:GetService("Players").LocalPlayer.Character.Humanoid.MoveDirection.Magnitude > 0 then
                        game:GetService("Players").LocalPlayer.Character:TranslateBy(game:GetService("Players").LocalPlayer.Character.Humanoid.MoveDirection * Speed / 10)
                    end
                end
            end)
        elseif not v and sudu then
            sudu:Disconnect()
            sudu = nil
        end
    end
})

Main:Slider({
    Title = "速度",
    Value = {
        Min = 1,
        Max = 100,
        Default = 1,
    },
    Callback = function(Value)
        Speed = Value
    end
})

Main:Toggle({
    Title = "扩大视野",
    Default = false,
    Callback = function(v)
        if v == true then
            fovConnection = game:GetService("RunService").Heartbeat:Connect(function()
                workspace.CurrentCamera.FieldOfView = 130
            end)
        elseif not v and fovConnection then
            fovConnection:Disconnect()
            fovConnection = nil
        end
    end
})

Main:Toggle({
    Title = "无限跳",
    Default = false,
    Callback = function(Value)
        local jumpConn
        if Value then
            jumpConn = game:GetService("UserInputService").JumpRequest:Connect(function()
                local humanoid = game:GetService("Players").LocalPlayer.Character and
                                 game:GetService("Players").LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                end
            end)
        else
            if jumpConn then
                jumpConn:Disconnect()
                jumpConn = nil
            end
        end
    end
})

local plrs = game:GetService("Players")
local rs = game:GetService("ReplicatedStorage")
local runService = game:GetService("RunService")
local lp = plrs.LocalPlayer

local dvv = require(rs.devv)
local sig = dvv.load("Signal")
local guid = dvv.load("GUID")
local inv = dvv.load("v3item").inventory

local dartOn = false
local dartTeleportTargets = false
local dartCachedHitId = nil
local dartCurrentTarget = nil
local dartHeartConnections = {}
local dartNinjaStarBuyThread = nil

local function dartCleanupConnections()
    for _, conn in ipairs(dartHeartConnections) do
        if conn then conn:Disconnect() end
    end
    dartHeartConnections = {}
end

local function dartEquipNinjaStar()
    local itm = inv.getItems and inv.getItems() or inv.items or {}
    for _, v in next, itm do
        if v.name == "Ninja Star" then
            sig.FireServer("equip", v.guid)
            return v.guid
        end
    end
    return nil
end

local function dartInitThrow()
    local sg = dartEquipNinjaStar()
    if not sg then return end
    
    local c = lp.Character
    if not c then return end
    
    local rh = c:FindFirstChild("RightHand")
    local hrp = c:FindFirstChild("HumanoidRootPart")
    if not rh or not hrp then return end
    
    local mp = rh.Position + Vector3.new(0, 0.5, 0)
    local tp = mp + Vector3.new(50, 0, 0)
    local vel = (tp - mp).Unit * 150
    
    local ok, r1, hid = pcall(function()
        return sig.InvokeServer("throwSticky", guid(), "Ninja Star", sg, vel, tp)
    end)
    
    if ok and r1 and hid then
        dartCachedHitId = hid
    end
end

local function dartHasShield(targetPlayer)
    if not targetPlayer or not targetPlayer.Character then return false end
    
    local char = targetPlayer.Character
    local humanoid = char:FindFirstChild("Humanoid")
    if not humanoid then return false end
    
    for _, desc in pairs(char:GetDescendants()) do
        if desc:IsA("ForceField") then
            return true
        end
    end
    
    return false
end

local function dartFindValidTarget()
    local closest = nil
    local minDist = math.huge
    local myPos = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") and lp.Character.HumanoidRootPart.Position
    
    if not myPos then return nil end
    
    for _, player in ipairs(plrs:GetPlayers()) do
        if player ~= lp and player.Character then
            local char = player.Character
            local humanoid = char:FindFirstChild("Humanoid")
            local head = char:FindFirstChild("Head")
            local hrp = char:FindFirstChild("HumanoidRootPart")
            
            if humanoid and head and hrp and humanoid.Health > 0 and not dartHasShield(player) then
                local dist = (hrp.Position - myPos).Magnitude
                if dist < minDist and dist <= 50 then
                    minDist = dist
                    closest = {player = player, head = head}
                end
            end
        end
    end
    return closest
end

local function dartRapidThrowAttack()
    if not dartOn or not dartCachedHitId then return end
    
    local targetData = dartFindValidTarget()
    if not targetData then return end
    
    local head = targetData.head 
    local tp = head.Position
    local wcf = CFrame.new(tp, tp + Vector3.new(0, 1, 0))
    local rcf = CFrame.new(0, 0, 0) 
    
    for i = 1, 15 do 
        sig.InvokeServer("hitSticky", dartCachedHitId, head, rcf, wcf)
    end
end

local function dartFindNextTeleportTarget()
    local players = plrs:GetPlayers()
    
    for _, player in ipairs(players) do
        if player ~= lp and player.Character then
            local humanoid = player.Character:FindFirstChild("Humanoid")
            if humanoid and humanoid.Health > 0 and not dartHasShield(player) then
                return player
            end
        end
    end
    return nil
end

local function dartFastTeleport()
    if not dartTeleportTargets or not dartOn then return end
    
    if not dartCurrentTarget then
        dartCurrentTarget = dartFindNextTeleportTarget()
        if not dartCurrentTarget then return end
    end
    
    if not dartCurrentTarget.Character then
        dartCurrentTarget = dartFindNextTeleportTarget()
        if not dartCurrentTarget then return end
    end
    
    local humanoid = dartCurrentTarget.Character:FindFirstChild("Humanoid")
    if not humanoid or humanoid.Health <= 0 or dartHasShield(dartCurrentTarget) then
        dartCurrentTarget = dartFindNextTeleportTarget()
        if not dartCurrentTarget then return end
    end
    
    local char = lp.Character
    if not char or not char.PrimaryPart then return end
    
    local targetChar = dartCurrentTarget.Character
    local targetHRP = targetChar:FindFirstChild("HumanoidRootPart")
    if not targetHRP then return end
    
    char.PrimaryPart.CFrame = targetHRP.CFrame * CFrame.new(0, 0, 1.5)
end

local dartTab = Window:Tab({Title = "飞镖", Icon = "target"})

dartTab:Section({ Title = "飞镖功能", Icon = "target", Opened = true })

dartTab:Toggle({
    Title = "忍者飞镖光环",
    Default = false,
    Callback = function(state)
        dartOn = state
        dartCleanupConnections()
        
        if state then
            dartEquipNinjaStar()
            task.wait(0.1)
            dartInitThrow()
            
            local fastAttackConn = runService.RenderStepped:Connect(function()
                if not dartOn then return end
                dartRapidThrowAttack()
            end)
            table.insert(dartHeartConnections, fastAttackConn)
        end
    end
})

dartTab:Toggle({
    Title = "传送攻击",
    Default = false,
    Callback = function(state)
        dartTeleportTargets = state
        
        if state and dartOn then
            local fastTeleportConn = runService.RenderStepped:Connect(function()
                dartFastTeleport()
            end)
            table.insert(dartHeartConnections, fastTeleportConn)
            
            WindUI:Notify({
                Title = "传送攻击",
                Content = "已开启传送攻击",
                Duration = 2,
                Icon = "zap"
            })
        elseif state then
            local checkConnection
            checkConnection = runService.Heartbeat:Connect(function()
                if dartOn then
                    checkConnection:Disconnect()
                    local fastTeleportConn = runService.RenderStepped:Connect(function()
                        dartFastTeleport()
                    end)
                    table.insert(dartHeartConnections, fastTeleportConn)
                elseif not dartTeleportTargets then
                    checkConnection:Disconnect()
                end
            end)
        end
    end
})

dartTab:Toggle({
    Title = "自动购买飞镖",
    Default = false,
    Callback = function(Value)
        if dartNinjaStarBuyThread then
            dartNinjaStarBuyThread:Disconnect()
            dartNinjaStarBuyThread = nil
        end
        if Value then
            local heartbeat = game:GetService("RunService").Heartbeat
            dartNinjaStarBuyThread = heartbeat:Connect(function()
                sig.InvokeServer("attemptPurchase", "Ninja Star")
                for _, v in next, inv.items do
                    if v.name == "Ninja Star" then
                        break
                    end
                end
            end)
        end
    end
})

local originalOnDestroy = Window.OnDestroy or function() end
Window.OnDestroy = function(...)
    originalOnDestroy(...)
    dartCleanupConnections()
    if dartNinjaStarBuyThread then
        dartNinjaStarBuyThread:Disconnect()
        dartNinjaStarBuyThread = nil
    end
end


local Settings = Window:Tab({Title = "ui设置", Icon = "palette"})
Settings:Paragraph({
    Title = "ui设置",
    Desc = "二改wind原版ui",
    Image = "settings",
    ImageSize = 20,
    Color = "White"
})

Settings:Toggle({
    Title = "启用边框",
    Value = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and windowOpen and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                
                WindUI:Notify({
                    Title = "边框",
                    Content = value and "已启用" or "已禁用",
                    Duration = 2,
                    Icon = value and "eye" or "eye-off"
                })
            end
        end
    end
})

Settings:Toggle({
    Title = "启用字体颜色",
    Value = fontColorEnabled,
    Callback = function(value)
        fontColorEnabled = value
        applyFontColorsToWindow(currentFontColorScheme)
        
        WindUI:Notify({
            Title = "字体颜色",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "type" or "type"
        })
    end
})

Settings:Toggle({
    Title = "启用音效",
    Value = soundEnabled,
    Callback = function(value)
        soundEnabled = value
        WindUI:Notify({
            Title = "音效",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "volume-2" or "volume-x"
        })
    end
})

Settings:Toggle({
    Title = "启用背景模糊",
    Value = blurEnabled,
    Callback = function(value)
        blurEnabled = value
        applyBlurEffect(value)
        WindUI:Notify({
            Title = "背景模糊",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "cloud-rain" or "cloud"
        })
    end
})

local colorSchemeNames = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames, name)
end
table.sort(colorSchemeNames)

Settings:Dropdown({
    Title = "边框颜色方案",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames,
    Value = "糖果颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})

Settings:Dropdown({
    Title = "字体颜色方案",
    Desc = "选择文字颜色组合",
    Values = colorSchemeNames,
    Value = "彩虹颜色",
    Callback = function(value)
        currentFontColorScheme = value
        applyFontColorsToWindow(value)
        playSound()
    end
})

local fontOptions = {}
for _, fontName in ipairs(FONT_STYLES) do
    local description = FONT_DESCRIPTIONS[fontName] or fontName
    table.insert(fontOptions, {text = description, value = fontName})
end

table.sort(fontOptions, function(a, b)
    return a.text < b.text
end)

local fontValues = {}
local fontValueToName = {}
for _, option in ipairs(fontOptions) do
    table.insert(fontValues, option.text)
    fontValueToName[option.text] = option.value
end

Settings:Dropdown({
    Title = "字体样式",
    Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
    Values = fontValues,
    Value = "标准粗体",
    Callback = function(value)
        local fontName = fontValueToName[value]
        if fontName then
            currentFontStyle = fontName
            local successCount, totalCount = applyFontStyleToWindow(fontName)
            playSound()
        end
    end
})

Settings:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = { 
        Min = 1,
        Max = 10,
        Default = 5,
    },
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Slider({
    Title = "UI整体缩放",
    Desc = "调整UI大小比例",
    Value = { 
        Min = 0.5,
        Max = 1.5,
        Default = 1,
    },
    Step = 0.1,
    Callback = function(value)
        uiScale = value
        applyUIScale(value)
        playSound()
    end
})

Settings:Divider()

Settings:Slider({
    Title = "UI透明度",
    Desc = "调整整个UI的透明度",
    Value = { 
        Min = 0,
        Max = 1,
        Default = 0.2,
    },
    Step = 0.1,
    Callback = function(value)
        Window:ToggleTransparency(tonumber(value) > 0)
        WindUI.TransparencyValue = tonumber(value)
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI宽度",
    Desc = "调整窗口的宽度",
    Value = { 
        Min = 500,
        Max = 800,
        Default = 600,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI高度",
    Desc = "调整窗口的高度",
    Value = { 
        Min = 300,
        Max = 600,
        Default = 400,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            local currentWidth = Window.UIElements.Main.Size.X.Offset
            Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = { 
        Min = 1,
        Max = 5,
        Default = 1.5,
    },
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})

Settings:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = { 
        Min = 0,
        Max = 20,
        Default = 16,
    },
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})

Settings:Button({
    Title = "恢复UI到原位",
    Icon = "rotate-ccw",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
            playSound()
        end
    end
})

Settings:Button({
    Title = "重置UI大小",
    Icon = "maximize-2",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
            playSound()
        end
    end
})

Settings:Button({
    Title = "随机字体",
    Icon = "shuffle",
    Callback = function()
        local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
        currentFontStyle = randomFont
        applyFontStyleToWindow(randomFont)
        playSound()
    end
})

Settings:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

Settings:Divider()

Settings:Button({
    Title = "刷新字体颜色",
    Icon = "refresh-cw",
    Callback = function()
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Button({
    Title = "刷新字体样式",
    Icon = "refresh-cw",
    Callback = function()
        local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
        playSound()
    end
})

Settings:Button({
    Title = "测试所有字体",
    Icon = "check-circle",
    Callback = function()
        local workingFonts = {}
        local totalFonts = #FONT_STYLES
        
        for i, fontName in ipairs(FONT_STYLES) do
            local success = pcall(function()
                local test = Enum.Font[fontName]
            end)
            
            if success then
                table.insert(workingFonts, fontName)
            end
        end
        playSound()
    end
})

Settings:Button({
    Title = "导出设置",
    Icon = "download",
    Callback = function()
        local settings = {
            font = currentFontStyle,
            borderColor = currentBorderColorScheme,
            fontSize = currentFontColorScheme,
            speed = animationSpeed,
            scale = uiScale
        }
        setclipboard("YG SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
        playSound()
    end
})

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    applyBlurEffect(false)
end)

Window:OnDestroy(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    for _, animation in pairs(fontColorAnimations) do
        animation:Disconnect()
    end
    fontColorAnimations = {}
    applyBlurEffect(false)
end)

end

elseif game.PlaceId == 7541759836 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/dream77239/china-ui/refs/heads/main/China%20ui.lua"))()

local gradientColors = {
    "rgb(0, 255, 0)",
    "rgb(0, 230, 0)",
    "rgb(0, 210, 0)",
    "rgb(0, 190, 0)",
    "rgb(0, 170, 0)",
    "rgb(0, 150, 0)",
    "rgb(0, 140, 0)",
    "rgb(0, 130, 0)",
    "rgb(0, 120, 0)",
    "rgb(0, 110, 0)"
}

local username = game.Players.LocalPlayer.Name
local coloredUsername = ""
for i = 1, #username do
    local colorIndex = (i - 1) % #gradientColors + 1
    coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. username:sub(i, i) .. '</font>'
end

local version = "v9.1.7.8"
local coloredVersion = ""
for i = 1, #version do
    local colorIndex = (i - 1) % #gradientColors + 1
    coloredVersion = coloredVersion .. '<font color="' .. gradientColors[colorIndex] .. '">' .. version:sub(i, i) .. '</font>'
end

local Confirmed = false

WindUI:Popup({
    Title = '<font color="' .. gradientColors[1] .. '">作者:一野</font><font color="' .. gradientColors[5] .. '">(培根)</font>',
    IconThemed = true,
    Content = "尊敬的用户 " .. coloredUsername .. " \n您使用的 <font color='" .. gradientColors[1] .. "'>凹凸世界</font><font color='" .. gradientColors[5] .. "'>付费版</font> 当前版本型号是: " .. coloredVersion .. "\n感谢你的大力支持在这里Tnine Hub祝你们新年快乐！",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = "凹凸世界付费版",
        Icon = "sword",
        IconThemed = true,
        Author = "v9.1.7.8",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(400, 300),
        Transparent = true,
        Theme = "Dark",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/XxwanhexxX/UN/main/preview_png.png",
        BackgroundImageTransparency = 0.5,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "个人信息",
                    Content = "一野(培根)", 
                    Duration = 2,
                    Icon = "user"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 180,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索:", searchText)
            end
        }
    })

    Window:EditOpenButton({
        Title = "凹凸世界付费版",
        Icon = "sword",
        CornerRadius = UDim.new(0,12),
        StrokeThickness = 3,
        Color = ColorSequence.new(Color3.fromHex("00FF00")),
        Draggable = true,
    })

    Window:Tag({
        Title = "v9.1.7.8",
        Color = Color3.fromHex("#32CD32")
    })

    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)

    local refereeTab = Window:Tab({Title = "物品", Icon = "sports"})
    refereeTab:Button({
        Title = "直接获得裁判球",
        Icon = "download",
        Callback = function()
            local RemoteEvent = game:GetService("ReplicatedStorage").Project.RemoteEvent.ControlMessageEvent
            if not RemoteEvent then
                WindUI:Notify({
                    Title = "获取失败",
                    Content = "未找到目标RemoteEvent",
                    Duration = 3,
                    Icon = "x-circle"
                })
                return
            end

            WindUI:Notify({
                Title = "开始获取",
                Content = "正在获取50个裁判球",
                Duration = 2,
                Icon = "play"
            })

            spawn(function()
                for i = 1, 50 do
                    local args = {[1] = 2, [2] = {[1] = 1, [2] = 1, [3] = 19}}
                    RemoteEvent:FireServer(unpack(args))
                    
                    if i % 10 == 0 then
                        WindUI:Notify({
                            Title = "获取进度",
                            Content = "已获取 " .. i .. "/50 个裁判球",
                            Duration = 1,
                            Icon = "check-circle"
                        })
                    end
                    
                    task.wait(0.1)
                end

                WindUI:Notify({
                    Title = "获取完成",
                    Content = "已成功获取50个裁判球",
                    Duration = 4,
                    Icon = "success"
                })
            end)
        end
    })

    local aboutTab = Window:Tab({Title = "关于", Icon = "info"})
    local aboutSection = aboutTab:Section({Title = "信息", Opened = true})
    aboutSection:Paragraph({
        Title = "凹凸世界付费版",
        Desc = "作者: 一野(培根)\n版本: v9.1.7.8",
        Image = "sword",
        ImageSize = 20,
        Color = "White"
    })
    aboutSection:Paragraph({
        Title = "感谢支持",
        Desc = "游戏ID\njmk6536",
        Image = "heart",
        ImageSize = 16,
        Color = "Red"
    })
    aboutSection:Button({
        Title = "支持我们",
        Icon = "heart",
        Callback = function()
            WindUI:Notify({
                Title = "感谢支持",
                Content = "您的支持是我们的动力！",
                Duration = 3,
                Icon = "heart"
            })
        end
    })

    refereeTab:Select()

    WindUI:Notify({
        Title = "凹凸世界付费版",
        Content = "UI框架已加载完成！",
        Duration = 3,
        Icon = "sword"
    })
end

elseif game.PlaceId == 286090429 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

    Window:EditOpenButton({
        Title = "Paid user",
        Icon = "crown",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
        Draggable = true,
    })
    Window:Tag({
        Title = "付费版",
        Color = Color3.fromHex("#FFA500") 
    })
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)
    if not borderInitialized then
        spawn(function()
            wait(0.5)
            initializeRainbowBorder("糖果颜色", animationSpeed)
            wait(1)
            applyFontStyleToWindow(currentFontStyle)
        end)
    end

    local windowOpen = true

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
    end)

    local originalOpenFunction = Window.Open
    Window.Open = function(...)
        windowOpen = true
        local result = originalOpenFunction(...)
        
        if borderInitialized and borderEnabled and not rainbowBorderAnimation then
            wait(0.1)
            startBorderAnimation(Window, animationSpeed)
        end
        
        return result
    end

    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

    local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

    infoSection:Divider()

    infoSection:Paragraph({
        Title = "您当前的服务器为",
        Desc = tostring(game.PlaceId) .. "\n欢迎使用YG/TNINE",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "持续更新 有bug请提出来",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "作者:怀 凌乱",
        ThumbnailSize = 190,
    })

    local LockSection = Window:Section({
        Title = "功能以及UI设置",
        Icon = "crown",
        Opened = true,
    })

    local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
    Settings:Paragraph({
        Title = "UI设置",
        Desc = "绝妙二改WindUI",
        Image = "settings",
        ImageSize = 20,
        Color = "White"
    })

    Settings:Toggle({
        Title = "启用边框",
        Value = borderEnabled,
        Callback = function(value)
            borderEnabled = value
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Enabled = value
                    if value and windowOpen and not rainbowBorderAnimation then
                        startBorderAnimation(Window, animationSpeed)
                    elseif not value and rainbowBorderAnimation then
                        rainbowBorderAnimation:Disconnect()
                        rainbowBorderAnimation = nil
                    end
                    
                    WindUI:Notify({
                        Title = "边框",
                        Content = value and "已启用" or "已禁用",
                        Duration = 2,
                        Icon = value and "eye" or "eye-off"
                    })
                end
            end
        end
    })

    Settings:Toggle({
        Title = "启用字体颜色",
        Value = fontColorEnabled,
        Callback = function(value)
            fontColorEnabled = value
            applyFontColorsToWindow(currentFontColorScheme)
            
            WindUI:Notify({
                Title = "字体颜色",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "type" or "type"
            })
        end
    })

    Settings:Toggle({
        Title = "启用音效",
        Value = soundEnabled,
        Callback = function(value)
            soundEnabled = value
            WindUI:Notify({
                Title = "音效",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "volume-2" or "volume-x"
            })
        end
    })

    Settings:Toggle({
        Title = "启用背景模糊",
        Value = blurEnabled,
        Callback = function(value)
            blurEnabled = value
            applyBlurEffect(value)
            WindUI:Notify({
                Title = "背景模糊",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "cloud-rain" or "cloud"
            })
        end
    })

    local colorSchemeNames = {}
    for name, _ in pairs(COLOR_SCHEMES) do
        table.insert(colorSchemeNames, name)
    end
    table.sort(colorSchemeNames)

    Settings:Dropdown({
        Title = "边框颜色方案",
        Desc = "选择喜欢的颜色组合",
        Values = colorSchemeNames,
        Value = "糖果颜色",
        Callback = function(value)
            currentBorderColorScheme = value
            local success = initializeRainbowBorder(value, animationSpeed)
            playSound()
        end
    })

    Settings:Dropdown({
        Title = "字体颜色方案",
        Desc = "选择文字颜色组合",
        Values = colorSchemeNames,
        Value = "彩虹颜色",
        Callback = function(value)
            currentFontColorScheme = value
            applyFontColorsToWindow(value)
            playSound()
        end
    })

    local fontOptions = {}
    for _, fontName in ipairs(FONT_STYLES) do
        local description = FONT_DESCRIPTIONS[fontName] or fontName
        table.insert(fontOptions, {text = description, value = fontName})
    end

    table.sort(fontOptions, function(a, b)
        return a.text < b.text
    end)

    local fontValues = {}
    local fontValueToName = {}
    for _, option in ipairs(fontOptions) do
        table.insert(fontValues, option.text)
        fontValueToName[option.text] = option.value
    end

    Settings:Dropdown({
        Title = "字体样式",
        Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
        Values = fontValues,
        Value = "标准粗体",
        Callback = function(value)
            local fontName = fontValueToName[value]
            if fontName then
                currentFontStyle = fontName
                local successCount, totalCount = applyFontStyleToWindow(fontName)
                playSound()
            end
        end
    })

    Settings:Slider({
        Title = "边框转动速度",
        Desc = "调整边框旋转的快慢",
        Value = { 
            Min = 1,
            Max = 10,
            Default = 5,
        },
        Callback = function(value)
            animationSpeed = value
            if rainbowBorderAnimation then
                rainbowBorderAnimation:Disconnect()
                rainbowBorderAnimation = nil
            end
            if borderEnabled then
                startBorderAnimation(Window, animationSpeed)
            end
            
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Slider({
        Title = "UI整体缩放",
        Desc = "调整UI大小比例",
        Value = { 
            Min = 0.5,
            Max = 1.5,
            Default = 1,
        },
        Step = 0.1,
        Callback = function(value)
            uiScale = value
            applyUIScale(value)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Slider({
        Title = "UI透明度",
        Desc = "调整整个UI的透明度",
        Value = { 
            Min = 0,
            Max = 1,
            Default = 0.2,
        },
        Step = 0.1,
        Callback = function(value)
            Window:ToggleTransparency(tonumber(value) > 0)
            WindUI.TransparencyValue = tonumber(value)
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI宽度",
        Desc = "调整窗口的宽度",
        Value = { 
            Min = 500,
            Max = 800,
            Default = 600,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI高度",
        Desc = "调整窗口的高度",
        Value = { 
            Min = 300,
            Max = 600,
            Default = 400,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                local currentWidth = Window.UIElements.Main.Size.X.Offset
                Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "边框粗细",
        Desc = "调整边框的粗细",
        Value = { 
            Min = 1,
            Max = 5,
            Default = 1.5,
        },
        Step = 0.5,
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Thickness = value
                end
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "圆角大小",
        Desc = "调整UI圆角的大小",
        Value = { 
            Min = 0,
            Max = 20,
            Default = 16,
        },
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local corner = mainFrame:FindFirstChildOfClass("UICorner")
                if not corner then
                    corner = Instance.new("UICorner")
                    corner.Parent = mainFrame
                end
                corner.CornerRadius = UDim.new(0, value)
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "恢复UI到原位",
        Icon = "rotate-ccw",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "重置UI大小",
        Icon = "maximize-2",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "随机字体",
        Icon = "shuffle",
        Callback = function()
            local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
            currentFontStyle = randomFont
            applyFontStyleToWindow(randomFont)
            playSound()
        end
    })

    Settings:Button({
        Title = "随机颜色",
        Icon = "palette",
        Callback = function()
            local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
            currentBorderColorScheme = randomColor
            initializeRainbowBorder(randomColor, animationSpeed)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Button({
        Title = "刷新字体颜色",
        Icon = "refresh-cw",
        Callback = function()
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Button({
        Title = "刷新字体样式",
        Icon = "refresh-cw",
        Callback = function()
            local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
            playSound()
        end
    })

    Settings:Button({
        Title = "测试所有字体",
        Icon = "check-circle",
        Callback = function()
            local workingFonts = {}
            local totalFonts = #FONT_STYLES
            
            for i, fontName in ipairs(FONT_STYLES) do
                local success = pcall(function()
                    local test = Enum.Font[fontName]
                end)
                
                if success then
                    table.insert(workingFonts, fontName)
                end
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "导出设置",
        Icon = "download",
        Callback = function()
            local settings = {
                font = currentFontStyle,
                borderColor = currentBorderColorScheme,
                fontSize = currentFontColorScheme,
                speed = animationSpeed,
                scale = uiScale
            }
            setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
            playSound()
        end
    })

    local HitboxTab = Window:Tab({  
        Title = "杀戮功能",  
        Icon = "box",  
        Locked = false,
    })
    local hitboxEnabled = false
    local noCollisionEnabled = false
    local hitbox_original_properties = {}
    local hitboxSize = 21
    local hitboxTransparency = 6
    local teamCheck = "FFA"

    local defaultBodyParts = {
        "UpperTorso",
        "Head",
        "HumanoidRootPart"
    }

    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    local ScreenGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
    local WarningText = Instance.new("TextLabel", ScreenGui)
    WarningText.Size = UDim2.new(0, 200, 0, 50)
    WarningText.TextSize = 16
    WarningText.Position = UDim2.new(0.5, -150, 0, 0)
    WarningText.Text = "警告：可能出现碰撞问题"
    WarningText.TextColor3 = Color3.new(1, 0, 0)
    WarningText.BackgroundTransparency = 1
    WarningText.Visible = false

    local function savedPart(player, part)
        if not hitbox_original_properties[player] then
            hitbox_original_properties[player] = {}
        end
        if not hitbox_original_properties[player][part.Name] then
            hitbox_original_properties[player][part.Name] = {
                CanCollide = part.CanCollide,
                Transparency = part.Transparency,
                Size = part.Size
            }
        end
    end

    local function restoredPart(player)
        if hitbox_original_properties[player] then
            for partName, properties in pairs(hitbox_original_properties[player]) do
                local part = player.Character and player.Character:FindFirstChild(partName)
                if part and part:IsA("BasePart") then
                    part.CanCollide = properties.CanCollide
                    part.Transparency = properties.Transparency
                    part.Size = properties.Size
                end
            end
        end
    end

    local function findClosestPart(player, partName)
        if not player.Character then return nil end
        for _, part in ipairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name:lower():match(partName:lower()) then
                return part
            end
        end
        return nil
    end

    local function extendHitbox(player)
        for _, partName in ipairs(defaultBodyParts) do
            local part = player.Character and (player.Character:FindFirstChild(partName) or findClosestPart(player, partName))
            if part and part:IsA("BasePart") then
                savedPart(player, part)
                part.CanCollide = not noCollisionEnabled
                part.Transparency = hitboxTransparency / 10
                part.Size = Vector3.new(hitboxSize, hitboxSize, hitboxSize)
            end
        end
    end

    local function isEnemy(player)
        if teamCheck == "FFA" or teamCheck == "Everyone" then
            return true
        end
        return player.Team ~= LocalPlayer.Team
    end

    local function shouldExtendHitbox(player)
        return isEnemy(player)
    end

    local function updateHitboxes()
        for _, v in ipairs(Players:GetPlayers()) do
            if v ~= LocalPlayer and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
                if shouldExtendHitbox(v) then
                    extendHitbox(v)
                else
                    restoredPart(v)
                end
            end
        end
    end

    local function onCharacterAdded(character)
        task.wait(0.1)
        if hitboxEnabled then
            updateHitboxes()
        end
    end

    local function onPlayerAdded(player)
        player.CharacterAdded:Connect(onCharacterAdded)
        player.CharacterRemoving:Connect(function()
            restoredPart(player)
            hitbox_original_properties[player] = nil
        end)
    end

    local function checkForDeadPlayers()
        for player, _ in pairs(hitbox_original_properties) do
            if not player.Parent or not player.Character or not player.Character:IsDescendantOf(game) then
                restoredPart(player)
                hitbox_original_properties[player] = nil
            end
        end
    end

    Players.PlayerAdded:Connect(onPlayerAdded)
    for _, player in ipairs(Players:GetPlayers()) do
        onPlayerAdded(player)
    end

    HitboxTab:Button({
        Title = "点击此处启动Hitbox功能",
        Callback = function()
            coroutine.wrap(function()
                while true do
                    if hitboxEnabled then
                        updateHitboxes()
                        checkForDeadPlayers()
                    end
                    task.wait(0.1)
                end
            end)()
        end
    })

    HitboxTab:Toggle({
        Title = "开启Hitbox",
        Value = false,
        Callback = function(state)
            hitboxEnabled = state
            if not state then
                for _, player in ipairs(Players:GetPlayers()) do
                    restoredPart(player)
                end
                hitbox_original_properties = {}
            else
                updateHitboxes()
            end
        end
    })

    HitboxTab:Slider({
        Title = "Hitbox大小",
        Value = {
            Min = 1,
            Max = 25,
            Default = 21
        },
        Callback = function(value)
            hitboxSize = value
            if hitboxEnabled then
                updateHitboxes()
            end
        end
    })

    HitboxTab:Slider({
        Title = "Hitbox透明度",
        Value = {
            Min = 1,
            Max = 10,
            Default = 6
        },
        Callback = function(value)
            hitboxTransparency = value
            if hitboxEnabled then
                updateHitboxes()
            end
        end
    })

    HitboxTab:Dropdown({
        Title = "队伍检测",
        Multi = false,
        AllowNone = false,
        Value = "FFA",
        Values = {"FFA", "队伍模式", "所有人"},
        Callback = function(value)
            teamCheck = value
            if hitboxEnabled then
                updateHitboxes()
            end
        end
    })

    HitboxTab:Toggle({
        Title = "无碰撞模式",
        Value = false,
        Callback = function(state)
            noCollisionEnabled = state
            WarningText.Visible = state
            coroutine.wrap(function()
                while noCollisionEnabled do
                    if hitboxEnabled then
                        updateHitboxes()
                    end
                    task.wait(0.01)
                end
                if hitboxEnabled then
                    updateHitboxes()
                end
            end)()
        end
    })

    HitboxTab:Toggle({
        Title = "半自动农场",
        Value = false,
        Callback = function(bool)
            getgenv().AutoFarm = bool
            local runServiceConnection
            local mouseDown = false
            local player = game.Players.LocalPlayer
            local camera = game.Workspace.CurrentCamera
            game:GetService("ReplicatedStorage").wkspc.CurrentCurse.Value = bool and "Infinite Ammo" or ""

            local function getClosestEnemyPlayer()
                local closestDistance = math.huge
                local closestPlayer = nil
                for _, enemyPlayer in pairs(game.Players:GetPlayers()) do
                    if enemyPlayer ~= player and enemyPlayer.TeamColor ~= player.TeamColor and enemyPlayer.Character then
                        local hrp = enemyPlayer.Character:FindFirstChild("HumanoidRootPart")
                        local humanoid = enemyPlayer.Character:FindFirstChild("Humanoid")
                        if hrp and humanoid and humanoid.Health > 0 then
                            local dist = (player.Character.HumanoidRootPart.Position - hrp.Position).Magnitude
                            if dist < closestDistance and hrp.Position.Y >= 0 then
                                closestDistance = dist
                                closestPlayer = enemyPlayer
                            end
                        end
                    end
                end
                return closestPlayer
            end

            local function startAutoFarm()
                game:GetService("ReplicatedStorage").wkspc.TimeScale.Value = 12
                runServiceConnection = game:GetService("RunService").Stepped:Connect(function()
                    if getgenv().AutoFarm then
                        local target = getClosestEnemyPlayer()
                        if target then
                            local pos = target.Character.HumanoidRootPart.Position + Vector3.new(0, 0, -4)
                            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                                player.Character.HumanoidRootPart.CFrame = CFrame.new(pos)
                                camera.CFrame = CFrame.new(camera.CFrame.Position, target.Character.Head.Position)
                                if not mouseDown then
                                    mouse1press()
                                    mouseDown = true
                                end
                            end
                        else
                            if mouseDown then
                                mouse1release()
                                mouseDown = false
                            end
                        end
                    else
                        if runServiceConnection then
                            runServiceConnection:Disconnect()
                            runServiceConnection = nil
                        end
                        if mouseDown then
                            mouse1release()
                            mouseDown = false
                        end
                    end
                end)
            end

            local function onCharacterAdded(character)
                wait(0.5)
                startAutoFarm()
            end

            player.CharacterAdded:Connect(onCharacterAdded)
            if bool then
                wait(0.5)
                startAutoFarm()
            else
                game:GetService("ReplicatedStorage").wkspc.CurrentCurse.Value = ""
                getgenv().AutoFarm = false
                game:GetService("ReplicatedStorage").wkspc.TimeScale.Value = 1
                if runServiceConnection then
                    runServiceConnection:Disconnect()
                    runServiceConnection = nil
                end
                if mouseDown then
                    mouse1release()
                    mouseDown = false
                end
            end
        end
    })

    local GunTab = Window:Tab({  
        Title = "枪械设置",  
        Icon = "crosshair",  
        Locked = false,
    })

    local originalValues = {
        FireRate = {},
        ReloadTime = {},
        EReloadTime = {},
        Auto = {},
        Spread = {},
        Recoil = {}
    }

    GunTab:Toggle({
        Title = "无限弹药 v1",
        Value = false,
        Callback = function(state)
            game:GetService("ReplicatedStorage").wkspc.CurrentCurse.Value = state and "Infinite Ammo" or ""
        end
    })

    GunTab:Toggle({
        Title = "快速换弹",
        Value = false,
        Callback = function(state)
            for _, v in pairs(game.ReplicatedStorage.Weapons:GetChildren()) do
                if v:FindFirstChild("ReloadTime") then
                    if state then
                        if not originalValues.ReloadTime[v] then
                            originalValues.ReloadTime[v] = v.ReloadTime.Value
                        end
                        v.ReloadTime.Value = 0.01
                    else
                        v.ReloadTime.Value = originalValues.ReloadTime[v] or 0.8
                    end
                end
                if v:FindFirstChild("EReloadTime") then
                    if state then
                        if not originalValues.EReloadTime[v] then
                            originalValues.EReloadTime[v] = v.EReloadTime.Value
                        end
                        v.EReloadTime.Value = 0.01
                    else
                        v.EReloadTime.Value = originalValues.EReloadTime[v] or 0.8
                    end
                end
            end
        end
    })

    GunTab:Toggle({
        Title = "快速射击",
        Value = false,
        Callback = function(state)
            for _, v in pairs(game.ReplicatedStorage.Weapons:GetDescendants()) do
                if v.Name == "FireRate" or v.Name == "BFireRate" then
                    if state then
                        if not originalValues.FireRate[v] then
                            originalValues.FireRate[v] = v.Value
                        end
                        v.Value = 0.02
                    else
                        v.Value = originalValues.FireRate[v] or 0.8
                    end
                end
            end
        end
    })

    GunTab:Toggle({
        Title = "自动连发",
        Value = false,
        Callback = function(state)
            for _, v in pairs(game.ReplicatedStorage.Weapons:GetDescendants()) do
                if v.Name == "Auto" or v.Name == "AutoFire" or v.Name == "Automatic" or v.Name == "AutoShoot" or v.Name == "AutoGun" then
                    if state then
                        if not originalValues.Auto[v] then
                            originalValues.Auto[v] = v.Value
                        end
                        v.Value = true
                    else
                        v.Value = originalValues.Auto[v] or false
                    end
                end
            end
        end
    })

    GunTab:Toggle({
        Title = "无扩散",
        Value = false,
        Callback = function(state)
            for _, v in pairs(game.ReplicatedStorage.Weapons:GetDescendants()) do
                if v.Name == "MaxSpread" or v.Name == "Spread" or v.Name == "SpreadControl" then
                    if state then
                        if not originalValues.Spread[v] then
                            originalValues.Spread[v] = v.Value
                        end
                        v.Value = 0
                    else
                        v.Value = originalValues.Spread[v] or 1
                    end
                end
            end
        end
    })

    GunTab:Toggle({
        Title = "无后坐力",
        Value = false,
        Callback = function(state)
            for _, v in pairs(game.ReplicatedStorage.Weapons:GetDescendants()) do
                if v.Name == "RecoilControl" or v.Name == "Recoil" then
                    if state then
                        if not originalValues.Recoil[v] then
                            originalValues.Recoil[v] = v.Value
                        end
                        v.Value = 0
                    else
                        v.Value = originalValues.Recoil[v] or 1
                    end
                end
            end
        end
    })

    local PlayerTab = Window:Tab({  
        Title = "玩家",  
        Icon = "person-standing",  
        Locked = false,
    })
    PlayerTab:Button({
        Title = "移速(懒得写)",
        Desc = nil,
        Locked = false,
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/dohyynd/Y_-SCRIPT/refs/heads/main/READM%E3%80%82E.lua"))()
        end
    })
    local isJumpPowerEnabled = false
    local jumpMethods = {"Velocity", "Vector", "CFrame"}
    local selectedJumpMethod = jumpMethods[1]

    PlayerTab:Toggle({
        Title = "自定义跳跃高度",
        Value = false,
        Callback = function(state)
            isJumpPowerEnabled = state
        end
    })

    PlayerTab:Dropdown({
        Title = "跳跃方法",
        Multi = false,
        AllowNone = false,
        Value = selectedJumpMethod,
        Values = jumpMethods,
        Callback = function(selected)
            selectedJumpMethod = selected
        end
    })

    PlayerTab:Slider({
        Title = "跳跃高度",
        Value = {
            Min = 30,
            Max = 500,
            Default = 30,
        },
        Callback = function(value)
            local player = game:GetService("Players").LocalPlayer
            local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.UseJumpPower = true
                humanoid.Jumping:Connect(function(isActive)
                    if isJumpPowerEnabled and isActive then
                        local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
                        if rootPart then
                            if selectedJumpMethod == "Velocity" then
                                rootPart.Velocity = Vector3.new(rootPart.Velocity.X, value, rootPart.Velocity.Z)
                            elseif selectedJumpMethod == "Vector" then
                                rootPart.Velocity = Vector3.new(0, value, 0)
                            elseif selectedJumpMethod == "CFrame" then
                                player.Character:SetPrimaryPartCFrame(player.Character:GetPrimaryPartCFrame() + Vector3.new(0, value, 0))
                            end
                        end
                    end
                end)
            end
        end
    })

    local SkinTab = Window:Tab({  
        Title = "美化",  
        Icon = "hand-platter",  
        Locked = false,
    })

    local armMaterial = "Plastic"
    local armColor = Color3.fromRGB(50, 50, 50)
    local armCharmsEnabled = false

    SkinTab:Dropdown({
        Title = "手臂材质",
        Multi = false,
        AllowNone = false,
        Value = armMaterial,
        Values = {"Plastic", "ForceField", "Wood", "Grass"},
        Callback = function(value)
            armMaterial = value
        end
    })

    SkinTab:Colorpicker({
        Title = "手臂颜色",
        Default = Color3.fromRGB(50, 50, 50),
        Callback = function(color)
            armColor = color
        end
    })

    SkinTab:Toggle({
        Title = "开启手臂美化",
        Value = false,
        Callback = function(state)
            armCharmsEnabled = state
            if armCharmsEnabled then
                spawn(function()
                    while armCharmsEnabled do
                        task.wait(0.01)
                        local cameraArms = workspace.Camera:FindFirstChild("Arms")
                        if cameraArms then
                            for _, part in pairs(cameraArms:GetDescendants()) do
                                if part.Name == 'Right Arm' or part.Name == 'Left Arm' then
                                    if part:IsA("BasePart") then
                                        part.Material = Enum.Material[armMaterial]
                                        part.Color = armColor
                                    end
                                elseif part:IsA("SpecialMesh") then
                                    if part.TextureId == '' then
                                        part.TextureId = 'rbxassetid://0'
                                        part.VertexColor = Vector3.new(armColor.R, armColor.G, armColor.B)
                                    end
                                elseif part.Name == 'L' or part.Name == 'R' then
                                    part:Destroy()
                                end
                            end
                        end
                    end
                end)
            end
        end
    })

    local gunMaterial = "Plastic"
    local gunColor = Color3.fromRGB(50, 50, 50)
    local gunCharmsEnabled = false

    SkinTab:Dropdown({
        Title = "枪械材质",
        Multi = false,
        AllowNone = false,
        Value = gunMaterial,
        Values = {"Plastic", "ForceField", "Wood", "Grass"},
        Callback = function(value)
            gunMaterial = value
        end
    })

    SkinTab:Colorpicker({
        Title = "枪械颜色",
        Default = Color3.fromRGB(50, 50, 50),
        Callback = function(color)
            gunColor = color
        end
    })

    SkinTab:Toggle({
        Title = "开启枪械美化",
        Value = false,
        Callback = function(state)
            gunCharmsEnabled = state
            if gunCharmsEnabled then
                spawn(function()
                    while gunCharmsEnabled do
                        task.wait(0.01)
                        local cameraArms = workspace.Camera:FindFirstChild("Arms")
                        if cameraArms then
                            for _, part in pairs(cameraArms:GetDescendants()) do
                                if part:IsA("MeshPart") then
                                    part.Material = Enum.Material[gunMaterial]
                                    part.Color = gunColor
                                end
                            end
                        end
                    end
                end)
            end
        end
    })

    local ChatTab = Window:Tab({  
        Title = "聊天标签/娱乐",  
        Icon = "message-circle",  
        Locked = false,
    })
    ChatTab:Toggle({
        Title = "IsChad",
        Value = false,
        Callback = function(state)
            local player = game.Players.LocalPlayer
            if player:FindFirstChild("IsChad") then
                player.IsChad:Destroy()
            end
            if state then
                local val = Instance.new("IntValue", player)
                val.Name = "IsChad"
            end
        end
    })

    ChatTab:Toggle({
        Title = "VIP",
        Value = false,
        Callback = function(state)
            local player = game.Players.LocalPlayer
            if player:FindFirstChild("VIP") then
                player.VIP:Destroy()
            end
            if state then
                local val = Instance.new("IntValue", player)
                val.Name = "VIP"
            end
        end
    })

    ChatTab:Toggle({
        Title = "OldVIP",
        Value = false,
        Callback = function(state)
            local player = game.Players.LocalPlayer
            if player:FindFirstChild("OldVIP") then
                player.OldVIP:Destroy()
            end
            if state then
                local val = Instance.new("IntValue", player)
                val.Name = "OldVIP"
            end
        end
    })

    ChatTab:Toggle({
        Title = "Romin",
        Value = false,
        Callback = function(state)
            local player = game.Players.LocalPlayer
            if player:FindFirstChild("Romin") then
                player.Romin:Destroy()
            end
            if state then
                local val = Instance.new("IntValue", player)
                val.Name = "Romin"
            end
        end
    })

    ChatTab:Toggle({
        Title = "管理员",
        Value = false,
        Callback = function(state)
            local player = game.Players.LocalPlayer
            if player:FindFirstChild("IsAdmin") then
                player.IsAdmin:Destroy()
            end
            if state then
                local val = Instance.new("IntValue", player)
                val.Name = "IsAdmin"
            end
        end
    })

    local ThemeTab = Window:Tab({
        Title = "设置",
        Icon = "settings",
        Locked = false,
    })
    local themeValues = {}
    for name, _ in pairs(WindUI:GetThemes()) do
        table.insert(themeValues, name)
    end

    ThemeTab:Dropdown({
        Title = "更改ui颜色",
        Multi = false,
        AllowNone = false,
        Value = nil,
        Values = themeValues,
        Callback = function(theme)
            WindUI:SetTheme(theme)
        end
    })

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        applyBlurEffect(false)
    end)

    Window:OnDestroy(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        for _, animation in pairs(fontColorAnimations) do
            animation:Disconnect()
        end
        fontColorAnimations = {}
        applyBlurEffect(false)
    end)
end

elseif game.PlaceId == 119048529960596 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local HttpService = cloneref(game:GetService("HttpService"))
local isfunctionhooked = clonefunction(isfunctionhooked)

if isfunctionhooked(game.HttpGet) or isfunctionhooked(getnamecallmethod) or isfunctionhooked(request) then
    return
end

local function verifyKey(k)
    local ok, res = pcall(function()
        return request({
            Url = "https://ouo.lat/api/verify.php",
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = HttpService:JSONEncode({key = k, time = os.time()})
        })
    end)
    
    if not ok then return false end
    
    if res.Body ~= "True" then
        return false
    end
    
    local ok2, res2 = pcall(function()
        return game:HttpGet("https://www.wtb.lat/keysystem/check-key?key="..k.."&user="..game.Players.LocalPlayer.Name)
    end)
    
    return ok2 and res2 == "success"
end

local key = ""
pcall(function() key = readfile("DyzhKey.json") end)
if key ~= "" then
    if verifyKey(key) then
        print('验证完成')
    else
        return
    end
end

local Data = {
    ["自动收集钱"] = false,
    ["自动收集餐具"] = false,
    ["自动烹饪"] = false,
    ["自动给食物"] = false,
    ["自动拿订单"] = false,
    ["自动接订单"] = false,
    ["自动选桌子"] = false,
    ["自动拿零钱"] = false,
    ["自动领奖励"] = false,
}

local Players = cloneref(game:GetService("Players"))
local LocalPlayer = cloneref(Players.LocalPlayer)
local ReplicatedStorage = cloneref(game:GetService("ReplicatedStorage"))
local cn = string.find(LocalPlayer.LocaleId, "zh") ~= nil
local T = {
    Title = cn and "YG餐厅大亨3" or "Restaurant Tycoon 3",
    MainSection = cn and "我的大亨" or "My Tycoon",
    FriendSection = cn and "好友大亨" or "Friend Tycoon",
    AutoCollectBill = cn and "自动收集账单" or "Auto Collect Bill",
    AutoCollectDishes = cn and "自动收集餐具" or "Auto Collect Dishes",
    AutoCook = cn and "自动烹饪" or "Auto Cook",
    AutoGiveFood = cn and "自动送餐" or "Auto Give Food",
    AutoDoOrder = cn and "自动处理订单" or "Auto Do Order",
    AutoTakeOrder = cn and "自动接单" or "Auto Take Order",
    AutoSendTable = cn and "自动安排座位" or "Auto Send Table",
    AutoTips = cn and "自动收取小费" or "Auto Tips",
    Author = cn and "作者 | YG" or "Author | Nova"
}

pcall(function()
    hookfunction(require(ReplicatedStorage:FindFirstChild("Source"):FindFirstChild("Utility"):FindFirstChild("NPC"):FindFirstChild("PathUtility")).GetMovementTime, function(...)
        return 0.1
    end)
end)

function GetFriend()
    for _, v in next, Players:GetPlayers() do
        if LocalPlayer:IsFriendsWith(v.UserId) then
            return v
        end
    end
    return nil
end

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
for i = 1, #username do
    local char = username:sub(i, i)
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

    Window:EditOpenButton({
        Title = "Paid user",
        Icon = "crown",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
        Draggable = true,
    })
    Window:Tag({
        Title = "付费版",
        Color = Color3.fromHex("#FFA500") 
    })
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)
    
    if not borderInitialized then
        spawn(function()
            wait(0.5)
            initializeRainbowBorder("糖果颜色", animationSpeed)
            wait(1)
            applyFontStyleToWindow(currentFontStyle)
        end)
    end

    local windowOpen = true

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
    end)

    local originalOpenFunction = Window.Open
    Window.Open = function(...)
        windowOpen = true
        local result = originalOpenFunction(...)
        
        if borderInitialized and borderEnabled and not rainbowBorderAnimation then
            wait(0.1)
            startBorderAnimation(Window, animationSpeed)
        end
        
        return result
    end

    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})
    local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})
    infoSection:Divider()
    infoSection:Paragraph({
        Title = "您当前的服务器为",
        Desc = tostring(game.PlaceId) .. "\n欢迎使用YG/TNINE",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "持续更新 有bug请提出来",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "作者:怀 凌乱",
        ThumbnailSize = 190,
    })

    local LockSection = Window:Section({
        Title = "功能以及UI设置",
        Icon = "crown",
        Opened = true,
    })

    local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
    Settings:Paragraph({
        Title = "UI设置",
        Desc = "绝妙二改WindUI",
        Image = "settings",
        ImageSize = 20,
        Color = "White"
    })

    Settings:Toggle({
        Title = "启用边框",
        Value = borderEnabled,
        Callback = function(value)
            borderEnabled = value
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Enabled = value
                    if value and windowOpen and not rainbowBorderAnimation then
                        startBorderAnimation(Window, animationSpeed)
                    elseif not value and rainbowBorderAnimation then
                        rainbowBorderAnimation:Disconnect()
                        rainbowBorderAnimation = nil
                    end
                    
                    WindUI:Notify({
                        Title = "边框",
                        Content = value and "已启用" or "已禁用",
                        Duration = 2,
                        Icon = value and "eye" or "eye-off"
                    })
                end
            end
        end
    })

    Settings:Toggle({
        Title = "启用字体颜色",
        Value = fontColorEnabled,
        Callback = function(value)
            fontColorEnabled = value
            applyFontColorsToWindow(currentFontColorScheme)
            
            WindUI:Notify({
                Title = "字体颜色",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "type" or "type"
            })
        end
    })

    Settings:Toggle({
        Title = "启用音效",
        Value = soundEnabled,
        Callback = function(value)
            soundEnabled = value
            WindUI:Notify({
                Title = "音效",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "volume-2" or "volume-x"
            })
        end
    })

    Settings:Toggle({
        Title = "启用背景模糊",
        Value = blurEnabled,
        Callback = function(value)
            blurEnabled = value
            applyBlurEffect(value)
            WindUI:Notify({
                Title = "背景模糊",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "cloud-rain" or "cloud"
            })
        end
    })

    local colorSchemeNames = {}
    for name, _ in pairs(COLOR_SCHEMES) do
        table.insert(colorSchemeNames, name)
    end
    table.sort(colorSchemeNames)

    Settings:Dropdown({
        Title = "边框颜色方案",
        Desc = "选择喜欢的颜色组合",
        Values = colorSchemeNames,
        Value = "糖果颜色",
        Callback = function(value)
            currentBorderColorScheme = value
            local success = initializeRainbowBorder(value, animationSpeed)
            playSound()
        end
    })

    Settings:Dropdown({
        Title = "字体颜色方案",
        Desc = "选择文字颜色组合",
        Values = colorSchemeNames,
        Value = "彩虹颜色",
        Callback = function(value)
            currentFontColorScheme = value
            applyFontColorsToWindow(value)
            playSound()
        end
    })

    local fontOptions = {}
    for _, fontName in ipairs(FONT_STYLES) do
        local description = FONT_DESCRIPTIONS[fontName] or fontName
        table.insert(fontOptions, {text = description, value = fontName})
    end

    table.sort(fontOptions, function(a, b)
        return a.text < b.text
    end)

    local fontValues = {}
    local fontValueToName = {}
    for _, option in ipairs(fontOptions) do
        table.insert(fontValues, option.text)
        fontValueToName[option.text] = option.value
    end

    Settings:Dropdown({
        Title = "字体样式",
        Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
        Values = fontValues,
        Value = "标准粗体",
        Callback = function(value)
            local fontName = fontValueToName[value]
            if fontName then
                currentFontStyle = fontName
                local successCount, totalCount = applyFontStyleToWindow(fontName)
                playSound()
            end
        end
    })

    Settings:Slider({
        Title = "边框转动速度",
        Desc = "调整边框旋转的快慢",
        Value = { 
            Min = 1,
            Max = 10,
            Default = 5,
        },
        Callback = function(value)
            animationSpeed = value
            if rainbowBorderAnimation then
                rainbowBorderAnimation:Disconnect()
                rainbowBorderAnimation = nil
            end
            if borderEnabled then
                startBorderAnimation(Window, animationSpeed)
            end
            
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Slider({
        Title = "UI整体缩放",
        Desc = "调整UI大小比例",
        Value = { 
            Min = 0.5,
            Max = 1.5,
            Default = 1,
        },
        Step = 0.1,
        Callback = function(value)
            uiScale = value
            applyUIScale(value)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Slider({
        Title = "UI透明度",
        Desc = "调整整个UI的透明度",
        Value = { 
            Min = 0,
            Max = 1,
            Default = 0.2,
        },
        Step = 0.1,
        Callback = function(value)
            Window:ToggleTransparency(tonumber(value) > 0)
            WindUI.TransparencyValue = tonumber(value)
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI宽度",
        Desc = "调整窗口的宽度",
        Value = { 
            Min = 500,
            Max = 800,
            Default = 600,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI高度",
        Desc = "调整窗口的高度",
        Value = { 
            Min = 300,
            Max = 600,
            Default = 400,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                local currentWidth = Window.UIElements.Main.Size.X.Offset
                Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "边框粗细",
        Desc = "调整边框的粗细",
        Value = { 
            Min = 1,
            Max = 5,
            Default = 1.5,
        },
        Step = 0.5,
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Thickness = value
                end
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "圆角大小",
        Desc = "调整UI圆角的大小",
        Value = { 
            Min = 0,
            Max = 20,
            Default = 16,
        },
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local corner = mainFrame:FindFirstChildOfClass("UICorner")
                if not corner then
                    corner = Instance.new("UICorner")
                    corner.Parent = mainFrame
                end
                corner.CornerRadius = UDim.new(0, value)
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "恢复UI到原位",
        Icon = "rotate-ccw",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "重置UI大小",
        Icon = "maximize-2",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "随机字体",
        Icon = "shuffle",
        Callback = function()
            local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
            currentFontStyle = randomFont
            applyFontStyleToWindow(randomFont)
            playSound()
        end
    })

    Settings:Button({
        Title = "随机颜色",
        Icon = "palette",
        Callback = function()
            local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
            currentBorderColorScheme = randomColor
            initializeRainbowBorder(randomColor, animationSpeed)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Button({
        Title = "刷新字体颜色",
        Icon = "refresh-cw",
        Callback = function()
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Button({
        Title = "刷新字体样式",
        Icon = "refresh-cw",
        Callback = function()
            local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
            playSound()
        end
    })

    Settings:Button({
        Title = "测试所有字体",
        Icon = "check-circle",
        Callback = function()
            local workingFonts = {}
            local totalFonts = #FONT_STYLES
            
            for i, fontName in ipairs(FONT_STYLES) do
                local success = pcall(function()
                    local test = Enum.Font[fontName]
                end)
                
                if success then
                    table.insert(workingFonts, fontName)
                end
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "导出设置",
        Icon = "download",
        Callback = function()
            local settings = {
                font = currentFontStyle,
                borderColor = currentBorderColorScheme,
                fontSize = currentFontColorScheme,
                speed = animationSpeed,
                scale = uiScale
            }
            setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
            playSound()
        end
    })

    local RestaurantTab = Window:Tab({Title = T.Title, Icon = "crown"})
    local MainSection = RestaurantTab:Section({Title = T.MainSection, Opened = true})
    local FriendSection = RestaurantTab:Section({Title = T.FriendSection, Opened = true})

    MainSection:Toggle({
        Title = T.AutoCollectBill,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动收集钱"] = state
            spawn(function()
                while Data["自动收集钱"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v.Player.Value == game.Players.LocalPlayer then
                                for _, a in pairs(v.Items.Surface:GetChildren()) do
                                    if a:FindFirstChild("Bill") then
                                        ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer({
                                            ["Tycoon"] = v,
                                            ["Name"] = "CollectBill",
                                            ["FurnitureModel"] = a
                                        })
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    MainSection:Toggle({
        Title = T.AutoCollectDishes,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动收集餐具"] = state
            spawn(function()
                while Data["自动收集餐具"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v.Player.Value == game.Players.LocalPlayer then
                                for _, a in pairs(v.Items.Surface:GetChildren()) do
                                    if a.Name:find("T") and a:FindFirstChild("Trash") then
                                        ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer({
                                            ["Tycoon"] = v,
                                            ["Name"] = "CollectDishes",
                                            ["FurnitureModel"] = a
                                        })
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    MainSection:Toggle({
        Title = T.AutoCook,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动烹饪"] = state
            spawn(function()
                while Data["自动烹饪"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v:FindFirstChild("Player") and v.Player.Value == game.Players.LocalPlayer then
                                for _, a in pairs(v.Items.Surface:GetDescendants()) do
                                    if a.Name:find("Oven") then
                                        ReplicatedStorage.Events.Cook.CookInputRequested:FireServer(
                                            "Interact",
                                            a.Parent,
                                            "Oven"
                                        )
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    MainSection:Toggle({
        Title = T.AutoGiveFood,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动给食物"] = state
            spawn(function()
                while Data["自动给食物"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v:FindFirstChild("Player") and v.Player.Value == game.Players.LocalPlayer then
                                if #v.Objects.Food:GetChildren() > 0 then
                                    for _, a in pairs(v.Objects.Food:GetChildren()) do
                                        if not a:GetAttribute("Taken") then
                                            ReplicatedStorage.Events.Restaurant.GrabFood:InvokeServer(a)
                                            for _, gui in pairs(game.Players.LocalPlayer.PlayerGui:GetDescendants()) do
                                                if gui:IsA("ImageLabel") and gui.Parent and 
                                                   gui.Parent.Parent.Parent.Name == "CustomerSpeechUI" and
                                                   gui.Parent.Parent.Size == UDim2.new(1, 0, 1, 0) then
                                                   ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer({
                                                        Name = "Serve",
                                                        GroupId = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Parent.Name),
                                                        Tycoon = v,
                                                        FoodModel = a,
                                                        CustomerId = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Name)
                                                    })
                                                    task.wait(0.1)
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    MainSection:Toggle({
        Title = T.AutoDoOrder,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动拿订单"] = state
            spawn(function()
                while Data["自动拿订单"] do
                    pcall(function()
                        for _,v in next,workspace.Temp:GetChildren() do
                            if v.Name == "Part" and v:FindFirstChildOfClass("ProximityPrompt") then
                                fireproximityprompt(v:FindFirstChildOfClass("ProximityPrompt"))
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    MainSection:Toggle({
        Title = T.AutoTakeOrder,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动接订单"] = state
            spawn(function()
                while Data["自动接订单"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v:FindFirstChild("Player") and v.Player.Value == game.Players.LocalPlayer then
                                for _, gui in pairs(game.Players.LocalPlayer.PlayerGui:GetDescendants()) do
                                    if
                                        gui:IsA("ImageLabel") and gui.Parent and gui.Parent.Parent.Parent.Name == "CustomerSpeechUI" and
                                            gui.Parent.Parent.Size == UDim2.new(1, 0, 1, 0)
                                     then
                                        ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer(
                                            {
                                                Name = "TakeOrder",
                                                GroupId = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Parent.Name),
                                                Tycoon = v,
                                                CustomerId = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Name)
                                            }
                                        )
                                        task.wait(0.1)
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    MainSection:Toggle({
        Title = T.AutoSendTable,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动选桌子"] = state
            spawn(function()
                while Data["自动选桌子"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v.Player.Value == game.Players.LocalPlayer then
                                for _, a in pairs(v.Items.Surface:GetChildren()) do
                                    if a.Name:find("T") and not a:GetAttribute("InUse") then
                                        for _, gui in pairs(game.Players.LocalPlayer.PlayerGui:GetDescendants()) do
                                            if gui:IsA("ImageLabel") and gui.Parent and gui.Parent.Parent.Parent.Name == "CustomerSpeechUI" and gui.Parent.Parent.Size == UDim2.new(1, 0, 1, 0) then
                                                ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer({
                                                    ["FurnitureModel"] = a,
                                                    ["Tycoon"] = v,
                                                    ["Name"] = "SendToTable",
                                                    ["GroupId"] = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Parent.Name)
                                                })
                                                task.wait(0.1)
                                            end
                                        end
                                    end
                                end
                            end
                            task.wait(0.1)
                        end
                    end)
                    task.wait()
                end
            end)
        end
    })

    MainSection:Toggle({
        Title = T.AutoTips,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动拿零钱"] = state
            spawn(function()
                while Data["自动拿零钱"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v:FindFirstChild("Player") and v.Player.Value == game.Players.LocalPlayer then
                                ReplicatedStorage.Events.Restaurant.TipsCollected:FireServer(v)
                            end
                        end
                    end)
                    task.wait()
                end
            end)
        end
    })

    FriendSection:Toggle({
        Title = T.AutoCollectBill,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动收集钱"] = state
            spawn(function()
                while Data["自动收集钱"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v.Player.Value == GetFriend() then
                                for _, a in pairs(v.Items.Surface:GetChildren()) do
                                    if a:FindFirstChild("Bill") then
                                        ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer({
                                            ["Tycoon"] = v,
                                            ["Name"] = "CollectBill",
                                            ["FurnitureModel"] = a
                                        })
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    FriendSection:Toggle({
        Title = T.AutoCollectDishes,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动收集餐具"] = state
            spawn(function()
                while Data["自动收集餐具"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v.Player.Value == GetFriend() then
                                for _, a in pairs(v.Items.Surface:GetChildren()) do
                                    if a.Name:find("T") and a:FindFirstChild("Trash") then
                                        ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer({
                                            ["Tycoon"] = v,
                                            ["Name"] = "CollectDishes",
                                            ["FurnitureModel"] = a
                                        })
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    FriendSection:Toggle({
        Title = T.AutoCook,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动烹饪"] = state
            spawn(function()
                while Data["自动烹饪"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v:FindFirstChild("Player") and v.Player.Value == GetFriend() then
                                for _, a in pairs(v.Items.Surface:GetDescendants()) do
                                    if a.Name:find("Oven") then
                                        ReplicatedStorage.Events.Cook.CookInputRequested:FireServer(
                                            "Interact",
                                            a.Parent,
                                            "Oven"
                                        )
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    FriendSection:Toggle({
        Title = T.AutoGiveFood,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动给食物"] = state
            spawn(function()
                while Data["自动给食物"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v:FindFirstChild("Player") and v.Player.Value == GetFriend() then
                                if #v.Objects.Food:GetChildren() > 0 then
                                    for _, a in pairs(v.Objects.Food:GetChildren()) do
                                        if not a:GetAttribute("Taken") then
                                            ReplicatedStorage.Events.Restaurant.GrabFood:InvokeServer(a)
                                            for _, gui in pairs(GetFriend().PlayerGui:GetDescendants()) do
                                                if gui:IsA("ImageLabel") and gui.Parent and 
                                                   gui.Parent.Parent.Parent.Name == "CustomerSpeechUI" and
                                                   gui.Parent.Parent.Size == UDim2.new(1, 0, 1, 0) then
                                                   ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer({
                                                        Name = "Serve",
                                                        GroupId = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Parent.Name),
                                                        Tycoon = v,
                                                        FoodModel = a,
                                                        CustomerId = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Name)
                                                    })
                                                    task.wait(0.1)
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    FriendSection:Toggle({
        Title = T.AutoDoOrder,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动拿订单"] = state
            spawn(function()
                while Data["自动拿订单"] do
                    pcall(function()
                        for _,v in next,workspace.Temp:GetChildren() do
                            if v.Name == "Part" and v:FindFirstChildOfClass("ProximityPrompt") then
                                fireproximityprompt(v:FindFirstChildOfClass("ProximityPrompt"))
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    FriendSection:Toggle({
        Title = T.AutoTakeOrder,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动接订单"] = state
            spawn(function()
                while Data["自动接订单"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v:FindFirstChild("Player") and v.Player.Value == GetFriend() then
                                for _, gui in pairs(GetFriend().PlayerGui:GetDescendants()) do
                                    if
                                        gui:IsA("ImageLabel") and gui.Parent and gui.Parent.Parent.Parent.Name == "CustomerSpeechUI" and
                                            gui.Parent.Parent.Size == UDim2.new(1, 0, 1, 0)
                                     then
                                        ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer(
                                            {
                                                Name = "TakeOrder",
                                                GroupId = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Parent.Name),
                                                Tycoon = v,
                                                CustomerId = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Name)
                                            }
                                        )
                                        task.wait(0.1)
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    })

    FriendSection:Toggle({
        Title = T.AutoSendTable,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动选桌子"] = state
            spawn(function()
                while Data["自动选桌子"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v.Player.Value == GetFriend() then
                                for _, a in pairs(v.Items.Surface:GetChildren()) do
                                    if a.Name:find("T") and not a:GetAttribute("InUse") then
                                        for _, gui in pairs(GetFriend().PlayerGui:GetDescendants()) do
                                            if gui:IsA("ImageLabel") and gui.Parent and gui.Parent.Parent.Parent.Name == "CustomerSpeechUI" and gui.Parent.Parent.Size == UDim2.new(1, 0, 1, 0) then
                                                ReplicatedStorage.Events.Restaurant.TaskCompleted:FireServer({
                                                    ["FurnitureModel"] = a,
                                                    ["Tycoon"] = v,
                                                    ["Name"] = "SendToTable",
                                                    ["GroupId"] = tostring(gui.Parent.Parent.Parent.Adornee.Parent.Parent.Name)
                                                })
                                                task.wait(0.1)
                                            end
                                        end
                                    end
                                end
                            end
                            task.wait(0.1)
                        end
                    end)
                    task.wait()
                end
            end)
        end
    })

    FriendSection:Toggle({
        Title = T.AutoTips,
        Image = "swords",
        Value = false,
        Callback = function(state)
            Data["自动拿零钱"] = state
            spawn(function()
                while Data["自动拿零钱"] do
                    pcall(function()
                        for _, v in pairs(workspace.Tycoons:GetChildren()) do
                            if v:FindFirstChild("Player") and v.Player.Value == GetFriend() then
                                ReplicatedStorage.Events.Restaurant.TipsCollected:FireServer(v)
                            end
                        end
                    end)
                    task.wait()
                end
            end)
        end
    })

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        applyBlurEffect(false)
    end)

    Window:OnDestroy(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        for _, animation in pairs(fontColorAnimations) do
            animation:Disconnect()
        end
        fontColorAnimations = {}
        applyBlurEffect(false)
    end)
end

elseif game.PlaceId == 16480898254 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local autoGrabEnabled = false
local grabThread = nil
local grabInterval = 0.8
local autoEatEnabled = false
local eatThread = nil
local eatInterval = 0.2
local autoAttackEnabled = false
local attackThread = nil
local attackInterval = 0.5

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function PerformGrab()
    local args = {[1] = false, [2] = false, [3] = false}
    local success, err = pcall(function()
        game:GetService("Players").LocalPlayer.Character.Events.Grab:FireServer(unpack(args))
    end)
    return success
end

local function StartAutoGrab()
    if grabThread then return end
    grabThread = task.spawn(function()
        while autoGrabEnabled do
            PerformGrab()
            task.wait(grabInterval)
        end
        grabThread = nil
    end)
end

local function StopAutoGrab()
    autoGrabEnabled = false
    if grabThread then
        task.cancel(grabThread)
        grabThread = nil
    end
end

local function PerformEat()
    local success, err = pcall(function()
        game:GetService("Players").LocalPlayer.Character.Events.Eat:FireServer()
    end)
    return success
end

local function StartAutoEat()
    if eatThread then return end
    eatThread = task.spawn(function()
        while autoEatEnabled do
            PerformEat()
            task.wait(eatInterval)
        end
        eatThread = nil
    end)
end

local function StopAutoEat()
    autoEatEnabled = false
    if eatThread then
        task.cancel(eatThread)
        eatThread = nil
    end
end

local function PerformAttack()
    local success, err = pcall(function()
        game:GetService("Players").LocalPlayer.Character.Events.Throw:FireServer()
    end)
    return success
end

local function StartAutoAttack()
    if attackThread then return end
    attackThread = task.spawn(function()
        while autoAttackEnabled do
            PerformAttack()
            task.wait(attackInterval)
        end
        attackThread = nil
    end)
end

local function StopAutoAttack()
    autoAttackEnabled = false
    if attackThread then
        task.cancel(attackThread)
        attackThread = nil
    end
end

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT付费版',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})
function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "Version Beat",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

Window:EditOpenButton({
    Title = "Paid user",
    Icon = "crown",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 4,
    Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
    Draggable = true,
})
Window:Tag({
    Title = "吃吃世界",
    Color = Color3.fromHex("#FFA500") 
})
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do  
            local color = Color3.fromHSV(hue, 0.8, 1)  
            Window:EditOpenButton({
                Color = ColorSequence.new(color)
            })
            wait(0.04)  
        end
    end
end)
if not borderInitialized then
    spawn(function()
        wait(0.5)
        initializeRainbowBorder("糖果颜色", animationSpeed)
        wait(1)
        applyFontStyleToWindow(currentFontStyle)
    end)
end

local windowOpen = true

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
end)

local originalOpenFunction = Window.Open
Window.Open = function(...)
    windowOpen = true
    local result = originalOpenFunction(...)
    
    if borderInitialized and borderEnabled and not rainbowBorderAnimation then
        wait(0.1)
        startBorderAnimation(Window, animationSpeed)
    end
    
    return result
end

local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

infoSection:Divider()

infoSection:Paragraph({
    Title = "您当前的服务器为",
    Desc = "吃吃世界\n欢迎使用YG/TNINE",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "持续更新 有bug请提出来",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "作者:怀 凌乱",
    ThumbnailSize = 190,
})

local LockSection = Window:Section({
    Title = "功能以及UI设置",
    Icon = "crown",
    Opened = true,
})

local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
Settings:Paragraph({
    Title = "UI设置",
    Desc = "绝妙二改WindUI",
    Image = "settings",
    ImageSize = 20,
    Color = "White"
})

Settings:Toggle({
    Title = "启用边框",
    Value = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and windowOpen and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                
                WindUI:Notify({
                    Title = "边框",
                    Content = value and "已启用" or "已禁用",
                    Duration = 2,
                    Icon = value and "eye" or "eye-off"
                })
            end
        end
    end
})

Settings:Toggle({
    Title = "启用字体颜色",
    Value = fontColorEnabled,
    Callback = function(value)
        fontColorEnabled = value
        applyFontColorsToWindow(currentFontColorScheme)
        
        WindUI:Notify({
            Title = "字体颜色",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "type" or "type"
        })
    end
})

Settings:Toggle({
    Title = "启用音效",
    Value = soundEnabled,
    Callback = function(value)
        soundEnabled = value
        WindUI:Notify({
            Title = "音效",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "volume-2" or "volume-x"
        })
    end
})

Settings:Toggle({
    Title = "启用背景模糊",
    Value = blurEnabled,
    Callback = function(value)
        blurEnabled = value
        applyBlurEffect(value)
        WindUI:Notify({
            Title = "背景模糊",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "cloud-rain" or "cloud"
        })
    end
})

local colorSchemeNames = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames, name)
end
table.sort(colorSchemeNames)

Settings:Dropdown({
    Title = "边框颜色方案",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames,
    Value = "糖果颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})

Settings:Dropdown({
    Title = "字体颜色方案",
    Desc = "选择文字颜色组合",
    Values = colorSchemeNames,
    Value = "彩虹颜色",
    Callback = function(value)
        currentFontColorScheme = value
        applyFontColorsToWindow(value)
        playSound()
    end
})

local fontOptions = {}
for _, fontName in ipairs(FONT_STYLES) do
    local description = FONT_DESCRIPTIONS[fontName] or fontName
    table.insert(fontOptions, {text = description, value = fontName})
end

table.sort(fontOptions, function(a, b)
    return a.text < b.text
end)

local fontValues = {}
local fontValueToName = {}
for _, option in ipairs(fontOptions) do
    table.insert(fontValues, option.text)
    fontValueToName[option.text] = option.value
end

Settings:Dropdown({
    Title = "字体样式",
    Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
    Values = fontValues,
    Value = "标准粗体",
    Callback = function(value)
        local fontName = fontValueToName[value]
        if fontName then
            currentFontStyle = fontName
            local successCount, totalCount = applyFontStyleToWindow(fontName)
            playSound()
        end
    end
})

Settings:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = { 
        Min = 1,
        Max = 10,
        Default = 5,
    },
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Slider({
    Title = "UI整体缩放",
    Desc = "调整UI大小比例",
    Value = { 
        Min = 0.5,
        Max = 1.5,
        Default = 1,
    },
    Step = 0.1,
    Callback = function(value)
        uiScale = value
        applyUIScale(value)
        playSound()
    end
})

Settings:Divider()

Settings:Slider({
    Title = "UI透明度",
    Desc = "调整整个UI的透明度",
    Value = { 
        Min = 0,
        Max = 1,
        Default = 0.2,
    },
    Step = 0.1,
    Callback = function(value)
        Window:ToggleTransparency(tonumber(value) > 0)
        WindUI.TransparencyValue = tonumber(value)
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI宽度",
    Desc = "调整窗口的宽度",
    Value = { 
        Min = 500,
        Max = 800,
        Default = 600,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI高度",
    Desc = "调整窗口的高度",
    Value = { 
        Min = 300,
        Max = 600,
        Default = 400,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            local currentWidth = Window.UIElements.Main.Size.X.Offset
            Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = { 
        Min = 1,
        Max = 5,
        Default = 1.5,
    },
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})

Settings:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = { 
        Min = 0,
        Max = 20,
        Default = 16,
    },
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})

Settings:Button({
    Title = "恢复UI到原位",
    Icon = "rotate-ccw",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
            playSound()
        end
    end
})

Settings:Button({
    Title = "重置UI大小",
    Icon = "maximize-2",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
            playSound()
        end
    end
})

Settings:Button({
    Title = "随机字体",
    Icon = "shuffle",
    Callback = function()
        local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
        currentFontStyle = randomFont
        applyFontStyleToWindow(randomFont)
        playSound()
    end
})

Settings:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

Settings:Divider()

Settings:Button({
    Title = "刷新字体颜色",
    Icon = "refresh-cw",
    Callback = function()
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Button({
    Title = "刷新字体样式",
    Icon = "refresh-cw",
    Callback = function()
        local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
        playSound()
    end
})

Settings:Button({
    Title = "测试所有字体",
    Icon = "check-circle",
    Callback = function()
        local workingFonts = {}
        local totalFonts = #FONT_STYLES
        
        for i, fontName in ipairs(FONT_STYLES) do
            local success = pcall(function()
                local test = Enum.Font[fontName]
            end)
            
            if success then
                table.insert(workingFonts, fontName)
            end
        end
        playSound()
    end
})

Settings:Button({
    Title = "导出设置",
    Icon = "download",
    Callback = function()
        local settings = {
            font = currentFontStyle,
            borderColor = currentBorderColorScheme,
            fontSize = currentFontColorScheme,
            speed = animationSpeed,
            scale = uiScale
        }
        setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
        playSound()
    end
})

local AutoTab = Window:Tab({Title = "自动功能", Icon = "zap"})
local AttackTab = Window:Tab({Title = "攻击功能", Icon = "swords"})

AutoTab:Toggle({
    Title = "启用自动抓取 ",
    Value = autoGrabEnabled,
    Callback = function(Value)
        autoGrabEnabled = Value
        if Value then
            StartAutoGrab()
            WindUI:Notify({
                Title = "自动抓取",
                Content = "已启用自动抓取功能",
                Duration = 2,
                Icon = "4483362458"
            })
        else
            StopAutoGrab()
            WindUI:Notify({
                Title = "自动抓取",
                Content = "已关闭自动抓取功能",
                Duration = 2,
                Icon = "4483362458"
            })
        end
    end
})

AutoTab:Toggle({
    Title = "启用自动吃",
    Value = autoEatEnabled,
    Callback = function(Value)
        autoEatEnabled = Value
        if Value then
            StartAutoEat()
            WindUI:Notify({
                Title = "自动吃",
                Content = "已启用自动吃功能",
                Duration = 2,
                Icon = "4483362458"
            })
        else
            StopAutoEat()
            WindUI:Notify({
                Title = "自动吃",
                Content = "已关闭自动吃功能",
                Duration = 2,
                Icon = "4483362458"
            })
        end
    end
})

AttackTab:Toggle({
    Title = "启用自动攻击",
    Value = autoAttackEnabled,
    Callback = function(Value)
        autoAttackEnabled = Value
        if Value then
            StartAutoAttack()
            WindUI:Notify({
                Title = "自动攻击",
                Content = "已启用自动攻击功能",
                Duration = 2,
                Icon = "4483362458"
            })
        else
            StopAutoAttack()
            WindUI:Notify({
                Title = "自动攻击",
                Content = "已关闭自动攻击功能",
                Duration = 2,
                Icon = "4483362458"
            })
        end
    end
})

AttackTab:Slider({
    Title = "攻击间隔 (秒)",
    Desc = "调整攻击间隔时间",
    Value = { 
        Min = 0.1,
        Max = 3,
        Default = 0.5,
    },
    Step = 0.1,
    Callback = function(Value)
        attackInterval = Value
        WindUI:Notify({
            Title = "攻击间隔",
            Content = "已设置为 " .. Value .. " 秒",
            Duration = 1.5,
            Icon = "4483362458"
        })
    end
})

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    applyBlurEffect(false)
end)

Window:OnDestroy(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    for _, animation in pairs(fontColorAnimations) do
        animation:Disconnect()
    end
    fontColorAnimations = {}
    applyBlurEffect(false)
end)

WindUI:Notify({
    Title = "脚本加载完成",
    Content = "所有功能已就绪",
    Duration = 5,
    Icon = "4483362458"
})

print("tnine team")

end

elseif game.PlaceId == 4588604953 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/dream77239/china-ui/refs/heads/main/China%20ui.lua"))()

-- 渐变颜色配置（可自定义）
local gradientColors = {
    "rgb(0, 255, 0)",
    "rgb(0, 230, 0)",
    "rgb(0, 210, 0)",
    "rgb(0, 190, 0)",
    "rgb(0, 170, 0)",
    "rgb(0, 150, 0)",
    "rgb(0, 140, 0)",
    "rgb(0, 130, 0)",
    "rgb(0, 120, 0)",
    "rgb(0, 110, 0)"
}

-- 渐变用户名生成
local username = game.Players.LocalPlayer.Name
local coloredUsername = ""
for i = 1, #username do
    local colorIndex = (i - 1) % #gradientColors + 1
    coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. username:sub(i, i) .. '</font>'
end

-- 渐变版本号生成
local version = "v9.1.7.8" -- 可修改版本号
local coloredVersion = ""
for i = 1, #version do
    local colorIndex = (i - 1) % #gradientColors + 1
    coloredVersion = coloredVersion .. '<font color="' .. gradientColors[colorIndex] .. '">' .. version:sub(i, i) .. '</font>'
end

local Confirmed = false

-- 启动弹窗（保留原样式）
WindUI:Popup({
    Title = '<font color="' .. gradientColors[1] .. '">作者:一野</font><font color="' .. gradientColors[5] .. '">(培根)</font>',
    IconThemed = true,
    Content = "尊敬的用户 " .. coloredUsername .. " \n您使用的 <font color='" .. gradientColors[1] .. "'>POX HUB</font><font color='" .. gradientColors[5] .. "'>付费版</font> 当前版本型号是: " .. coloredVersion .. "\n感谢你的大力支持在这里TnineHub祝你们新年快乐！",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

-- 游戏服务变量
local plrs = game:GetService("Players")
local me = plrs.LocalPlayer
local input = game:GetService("UserInputService")
local run = game:GetService("RunService")
local camera = workspace.CurrentCamera
local tween = game:GetService("TweenService")
local light = game:GetService("Lighting")
local rp = game:GetService("ReplicatedStorage")

-- 功能状态变量
local functions = {
    Fullbright = false,
    AutoOpenDoors = false,
    NoBarriers = false,
    NoGrinder = false,
    FastPickup = false,
    AutoPickupScraps = false,
    AutoPickupTools = false,
    AutopickupCrates = false,
    AutoPickupMoney = false,
    Infstamina = false,
    Nofalldamage = false,
    Noclip = false,
    FakeDown = true,
    Stopneckmove = false,
    Unbreaklimbs = false,
    SilentAim = false,
    AimBot = false,
    Instantreload = false,
    Meleeaura = false,
    RageBot = false,
    TrigerBot = false,
    RocketControl = false,
    ESP = false,
    ArmsChams = false,
    ToolsChams = false,
}

-- 设置变量
local SectionSettings = {
    SilentAim = {
        Draw = false,
        DrawSize = 50,
        DrawColor = Color3.new(1, 1, 1),
        TargetParts = {"Head"},
        CheckDowned = false,
        CheckWall = false,
        CheckTeam = false,
        CheckWhiteList = false,
    },
    Aimbot = {
        Draw = false,
        DrawSize = 50,
        DrawColor = Color3.new(1, 1, 1),
        TargetParts = {"Head"},
        CheckDowned = false,
        CheckWall = false,
        CheckTeam = false,
        CheckWhiteList = false,
        Velocity = false,
        Smooth = false,
        SmoothSize = 0.5
    },
    MeleeAura = {
        ShowAnim = false,
        TargetParts = {"Head"},
        CheckDowned = false,
        CheckTeam = false,
        CheckWhiteList = false,
        Distance = 15,
    },
    RageBot = {
        CheckDowned = false,
        CheckWhiteList = false
    },
    ESP = {
        Name = false,
        Box = false,
        Weapon = false,
        Highlight = false,
    }
}

-- 方法变量
local Methods = {
    Fly = "Bypass",
    Infstamina = "Getgc"
}

-- 存储变量
local cockie = {
    SilentAimCircle = nil,
    SilentAim_body = nil,
    ESPHighlight = nil,
    AimBotCircle = nil,
    aimbot_button = nil,
    Aimbot_body = nil,
    MeleeAura_body = nil,
}

-- 运行连接
local RUNS = {
    cameraFOV = nil,
    JumpHeight = nil,
    AutoOpenDoors = nil,
    AutopickupScraps = nil,
    AutopickupTools = nil,
    AutopickupCrates = nil,
    AutopickupMoney = nil,
    Infstamina = nil,
    Fly = nil,
    Noclip = nil,
    Meleeaura = nil,
    ESP = nil,
}

-- 索引变量
local funcindex = {
    Fullbright = {
        oldClockTime = nil,
        oldBrightness = nil,
    }
}

-- 白名单
local WhiteList = {}

-- 角色统计函数
function CharStats(plr)
    local folder = rp.CharStats[plr.Name]
    return folder
end

function createUI()
    local Window = WindUI:CreateWindow({
        Title = "犯罪付费版",
        Icon = "sword",
        IconThemed = true,
        Author = version,
        Folder = "CloudHub",
        Size = UDim2.fromOffset(400, 300),
        Transparent = true,
        Theme = "Dark",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/XxwanhexxX/UN/main/preview_png.png",
        BackgroundImageTransparency = 0.5,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "个人信息",
                    Content = "一野(培根)", 
                    Duration = 2,
                    Icon = "user"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 180,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索:", searchText)
            end
        }
    })

    -- 窗口按钮样式（保留动态颜色）
    Window:EditOpenButton({
        Title = "犯罪付费版",
        Icon = "sword",
        CornerRadius = UDim.new(0,12),
        StrokeThickness = 3,
        Color = ColorSequence.new(Color3.fromHex("00FF00")),
        Draggable = true,
    })

    -- 版本标签
    Window:Tag({
        Title = version,
        Color = Color3.fromHex("#32CD32")
    })

    -- 按钮动态颜色动画
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)

    -- 创建选项卡
    local Tabs = {
        World = Window:Tab({Title = "世界功能", Icon = "globe"}),
        Player = Window:Tab({Title = "玩家功能", Icon = "user"}),
        Combat = Window:Tab({Title = "战斗功能", Icon = "target"}),
        Visual = Window:Tab({Title = "视觉功能", Icon = "eye"}),
        Misc = Window:Tab({Title = "其他功能", Icon = "settings"}),
        About = Window:Tab({Title = "关于", Icon = "info"})
    }

    -- 世界功能
    Tabs.World:Toggle({
        Title = "夜视",
        Description = "使地图变亮",
        Default = functions.Fullbright,
        Callback = function(Value)
            functions.Fullbright = Value
            local Folder
            if Value then
                if #light:GetChildren() ~= 0 then
                    Folder = Instance.new("Folder")
                    Folder.Parent = rp
                    Folder.Name = "Index"
                    for _, a in pairs(light:GetChildren()) do
                        a.Parent = Folder
                    end
                end
                funcindex.Fullbright.oldClockTime = light.ClockTime
                light.ClockTime = 14
                funcindex.Fullbright.oldBrightness = light.Brightness
                light.Brightness = 4
                light.ExposureCompensation = .7
            else
                Folder = rp:FindFirstChild("Index")
                if Folder ~= nil then
                    for _, a in pairs(Folder:GetChildren()) do
                        a.Parent = light
                    end
                    Folder:Destroy()
                    Folder = nil
                end
                light.ClockTime = funcindex.Fullbright.oldClockTime or 14
                light.Brightness = funcindex.Fullbright.oldBrightness or 1
                light.ExposureCompensation = 0
            end
        end
    })

    Tabs.World:Toggle({
        Title = "自动开门",
        Description = "自动打开附近的门",
        Default = functions.AutoOpenDoors,
        Callback = function(Value)
            functions.AutoOpenDoors = Value
            if Value then
                RUNS.AutoOpenDoors = run.RenderStepped:Connect(function()
                    local function GetDoor()
                        local mapFolder = workspace:FindFirstChild("Map")
                        if not mapFolder then return nil end
                        local folderDoors = mapFolder:FindFirstChild("Doors")
                        if not folderDoors then return nil end

                        local closestDoor, dist = nil, 15
                        for _, door in pairs(folderDoors:GetChildren()) do
                            local doorBase = door:FindFirstChild("DoorBase")
                            if doorBase and me.Character:FindFirstChild("HumanoidRootPart") then
                                local distance = (me.Character.HumanoidRootPart.Position - doorBase.Position).Magnitude
                                if distance < dist then
                                    dist = distance
                                    closestDoor = door
                                end
                            end
                        end
                        return closestDoor
                    end

                    local door = GetDoor()
                    if door then
                        local values = door:FindFirstChild("Values")
                        local events = door:FindFirstChild("Events")
                        if values and events then
                            local locked = values:FindFirstChild("Locked")
                            local openValue = values:FindFirstChild("Open")
                            local toggleEvent = events:FindFirstChild("Toggle")
                            if locked and openValue and toggleEvent then
                                if locked.Value == true then
                                    toggleEvent:FireServer("Unlock", door.Lock)
                                elseif locked.Value == false and openValue.Value == false then
                                    local knob1 = door:FindFirstChild("Knob1")
                                    local knob2 = door:FindFirstChild("Knob2")
                                    if knob1 and knob2 then
                                        local knob1pos = (me.Character.HumanoidRootPart.Position - knob1.Position).Magnitude
                                        local knob2pos = (me.Character.HumanoidRootPart.Position - knob2.Position).Magnitude
                                        local chosenKnob = (knob1pos < knob2pos) and knob1 or knob2
                                        toggleEvent:FireServer("Open", chosenKnob)
                                    end
                                end
                            end
                        end
                    end
                end)
            else
                if RUNS.AutoOpenDoors then
                    RUNS.AutoOpenDoors:Disconnect()
                    RUNS.AutoOpenDoors = nil
                end
            end
        end
    })

    Tabs.World:Toggle({
        Title = "无屏障",
        Description = "移除地图屏障",
        Default = functions.NoBarriers,
        Callback = function(Value)
            functions.NoBarriers = Value
            for _, a in pairs(workspace.Filter.Parts["F_Parts"]:GetDescendants()) do
                if a:IsA("Part") or a:IsA("MeshPart") then
                    a.CanTouch = not a.CanTouch
                end
            end
        end
    })

    Tabs.World:Toggle({
        Title = "防研磨机",
        Description = "防止研磨机伤害",
        Default = functions.NoGrinder,
        Callback = function(Value)
            functions.NoGrinder = Value
            for _, a in pairs(workspace.Map.Parts.Grinders:GetDescendants()) do
                if a:IsA("Part") or a:IsA("MeshPart") then
                    a.CanTouch = not a.CanTouch
                end
            end
            for _, a in pairs(workspace.Map.Parts.M_Parts:GetDescendants()) do
                if a:IsA("Part") and a.Name == "FirePart" then
                    a.CanTouch = not a.CanTouch
                end
            end
        end
    })

    Tabs.World:Toggle({
        Title = "快速拾取",
        Description = "瞬间拾取物品",
        Default = functions.FastPickup,
        Callback = function(Value)
            functions.FastPickup = Value
            if Value then
                game.DescendantAdded:Connect(function(obj)
                    if obj:IsA("ProximityPrompt") then
                        obj.HoldDuration = 0
                        obj:GetPropertyChangedSignal("HoldDuration"):Connect(function()
                            if functions.FastPickup then
                                obj.HoldDuration = 0
                            end
                        end)
                    end
                end)
            end
        end
    })

    Tabs.World:Toggle({
        Title = "自动拾取废料",
        Description = "自动拾取附近的废料",
        Default = functions.AutoPickupScraps,
        Callback = function(Value)
            functions.AutoPickupScraps = Value
            local remote = rp.Events.PIC_PU
            local scrapsfolder = workspace.Filter.SpawnedPiles
            local canPickup = true
            local startTick = tick()

            if Value then
                RUNS.AutopickupScraps = run.RenderStepped:Connect(function()
                    local function GetClosestScrap()
                        local maxdist = 15
                        local closest = nil

                        for _, a in pairs(scrapsfolder:GetChildren()) do
                            if a and (a.Name == "S1" or a.Name == "S2") then
                                if me.Character and me.Character.HumanoidRootPart then
                                    local getdist = (me.Character.HumanoidRootPart.Position - a.MeshPart.Position).Magnitude
                                    if getdist < maxdist then
                                        maxdist = getdist
                                        closest = a
                                    end
                                end
                            end
                        end
                        maxdist = 15
                        return closest
                    end

                    local getscrap = GetClosestScrap()
                    if getscrap then
                        if canPickup then
                            remote:FireServer(string.reverse(getscrap:GetAttribute("jzu")))
                            canPickup = false
                        end
                    end
                    if canPickup == false and tick() - startTick >= 4.5 then
                        canPickup = true
                        startTick = tick()
                    end
                end)
            else
                if RUNS.AutopickupScraps then
                    RUNS.AutopickupScraps:Disconnect()
                    RUNS.AutopickupScraps = nil
                end
            end
        end
    })

    Tabs.World:Toggle({
        Title = "自动拾取工具",
        Description = "自动拾取附近的工具",
        Default = functions.AutoPickupTools,
        Callback = function(Value)
            functions.AutoPickupTools = Value
            local remote = rp.Events.PIC_TLO
            local toolsfolder = workspace.Filter.SpawnedTools
            local canPickup = true
            local startTick = tick()

            if Value then
                RUNS.AutopickupTools = run.RenderStepped:Connect(function()
                    local function GetClosestTool()
                        local maxdist = 15
                        local closest = nil

                        for _, a in pairs(toolsfolder:GetChildren()) do
                            if a and me.Character and me.Character.HumanoidRootPart then
                                local handle = a:FindFirstChild("Handle") or a:FindFirstChild("WeaponHandle")
                                if handle and (handle:IsA("Part") or handle:IsA("MeshPart")) then
                                    if me.Character and me.Character:FindFirstChild("HumanoidRootPart") then
                                        local getdist = (me.Character.HumanoidRootPart.Position - handle.Position).Magnitude
                                        if getdist < maxdist then
                                            maxdist = getdist
                                            closest = a
                                        end
                                    end
                                end
                            end
                        end
                        maxdist = 15
                        return closest
                    end

                    local tool = GetClosestTool()
                    if tool then
                        local Handle = tool:FindFirstChild("Handle") or tool:FindFirstChild("WeaponHandle")
                        if Handle then
                            if canPickup then
                                remote:FireServer(Handle)
                                canPickup = false
                            end
                        end
                    end
                    if canPickup == false and tick() - startTick >= 1.5 then
                        canPickup = true
                        startTick = tick()
                    end
                end)
            else
                if RUNS.AutopickupTools then
                    RUNS.AutopickupTools:Disconnect()
                    RUNS.AutopickupTools = nil
                end
            end
        end
    })

    Tabs.World:Toggle({
        Title = "自动拾取金钱",
        Description = "自动拾取附近的金钱",
        Default = functions.AutoPickupMoney,
        Callback = function(Value)
            functions.AutoPickupMoney = Value
            local remote = rp.Events:FindFirstChild("CZDPZUS")
            local moneyfolder = workspace.Filter.SpawnedBread
            local canPickup = true
            local startTick = tick()

            if Value then
                RUNS.AutopickupMoney = run.RenderStepped:Connect(function()
                    local function GetMoney()
                        local maxdist = 15
                        local closest = nil

                        for _, a in pairs(moneyfolder:GetChildren()) do
                            if a and me.Character and me.Character.HumanoidRootPart then
                                local getdist = (me.Character.HumanoidRootPart.Position - a.Position).Magnitude
                                if getdist < maxdist then
                                    maxdist = getdist
                                    closest = a
                                end
                            end
                        end
                        maxdist = 15
                        return closest
                    end

                    local foundmoney = GetMoney()
                    if foundmoney then
                        if canPickup then
                            remote:FireServer(foundmoney)
                            canPickup = false
                        end
                    end
                    if canPickup == false and tick() - startTick >= 1 then
                        canPickup = true
                        startTick = tick()
                    end
                end)
            else
                if RUNS.AutopickupMoney then
                    RUNS.AutopickupMoney:Disconnect()
                    RUNS.AutopickupMoney = nil
                end
            end
        end
    })

    -- 玩家功能
    Tabs.Player:Slider({
        Title = "FOV",
        Description = "调整相机视野",
        Default = camera.FieldOfView,
        Min = 70,
        Max = 120,
        Callback = function(Value)
            if RUNS.cameraFOV ~= nil then
                RUNS.cameraFOV:Disconnect()
                RUNS.cameraFOV = nil
            end
            RUNS.cameraFOV = run.RenderStepped:Connect(function()
                camera.FieldOfView = Value
            end)
        end
    })

    Tabs.Player:Slider({
        Title = "相机距离",
        Description = "调整相机最大距离",
        Default = me.CameraMaxZoomDistance,
        Min = 10,
        Max = 500,
        Callback = function(Value)
            me.CameraMaxZoomDistance = Value
        end
    })

    Tabs.Player:Slider({
        Title = "跳跃高度",
        Description = "调整跳跃高度",
        Default = 7.1,
        Min = 7.1,
        Max = 25,
        Callback = function(Value)
            if RUNS.JumpHeight then
                RUNS.JumpHeight:Disconnect()
                RUNS.JumpHeight = nil
            end
            RUNS.JumpHeight = run.RenderStepped:Connect(function()
                if me.Character and me.Character:FindFirstChild("Humanoid") then
                    me.Character:FindFirstChild("Humanoid").UseJumpPower = false
                    me.Character:FindFirstChild("Humanoid").JumpHeight = Value
                end
            end)
        end
    })

    Tabs.Player:Slider({
        Title = "重力",
        Description = "调整世界重力",
        Default = workspace.Gravity,
        Min = workspace.Gravity,
        Max = 75,
        Callback = function(Value)
            workspace.Gravity = Value
        end
    })

    Tabs.Player:Toggle({
        Title = "无限体力",
        Description = "拥有无限体力",
        Default = functions.Infstamina,
        Callback = function(Value)
            functions.Infstamina = Value
            if Value then
                while functions.Infstamina do
                    if Methods.Infstamina == "Getgc" then
                        local stamina = {}
                        function get()
                            for index, value in pairs(getgc(true)) do
                                if type(value) == "table" and rawget(value, "S") then
                                    stamina[#stamina + 1] = value
                                end
                            end
                        end
                        local ss, nn = pcall(function()
                            get()
                        end)
                        if ss then
                            for _, a in pairs(stamina) do
                                a.S = 100
                            end
                        end
                    elseif Methods.Infstamina == "low exploit" then
                        if me.Character then
                            local hum = me.Character:FindFirstChild("Humanoid")
                            if hum and not hum:GetAttribute("ZSPRN_M") then
                                hum:SetAttribute("ZSPRN_M", true)
                            end
                        end
                        me.CharacterAdded:Connect(function(char)
                            if functions.Infstamina then
                                if char and char:WaitForChild("Humanoid") then
                                    local hum = char:FindFirstChild("Humanoid")
                                    if hum and not hum:GetAttribute("ZSPRN_M") then
                                        hum:SetAttribute("ZSPRN_M", true)
                                    end
                                end
                            end
                        end)
                    end
                    run.RenderStepped:Wait()
                end
            else
                if me.Character then
                    local hum = me.Character:FindFirstChild("Humanoid")
                    if hum then
                        local check = hum:GetAttribute("ZSPRN_M")
                        if check then
                            hum:SetAttribute("ZSPRN_M", nil)
                        end
                    end
                end
            end
        end
    })

    Tabs.Player:Dropdown({
        Title = "无限体力方法",
        Description = "选择实现方法",
        Options = {"Getgc", "low exploit"},
        Default = Methods.Infstamina,
        Callback = function(Value)
            Methods.Infstamina = Value
        end
    })

    Tabs.Player:Toggle({
        Title = "无坠落伤害",
        Description = "防止坠落伤害",
        Default = functions.Nofalldamage,
        Callback = function(Value)
            functions.Nofalldamage = Value
            if Value then
                if me.Character then
                    local ff = Instance.new("ForceField")
                    ff.Parent = me.Character
                    ff.Visible = false
                end
                me.CharacterAdded:Connect(function(char)
                    if functions.Nofalldamage and char and char:WaitForChild("HumanoidRootPart") and char:WaitForChild("Humanoid") then
                        local ff = Instance.new("ForceField")
                        ff.Parent = char
                        ff.Visible = false
                    end
                end)
            else
                if me.Character then
                    for _, a in pairs(me.Character:GetChildren()) do
                        if a:IsA("ForceField") and a.Visible == false then
                            a:Destroy()
                        end
                    end
                end
            end
        end
    })

    Tabs.Player:Toggle({
        Title = "穿墙模式",
        Description = "可以穿过墙壁",
        Default = functions.Noclip,
        Callback = function(Value)
            functions.Noclip = Value
            if Value then
                local function LoopNoclip()
                    local char = me.Character
                    if char then
                        for _, a in pairs(char:GetDescendants()) do
                            if a:IsA("BasePart") and a.CanCollide == true then
                                a.CanCollide = false
                            end
                        end
                    end
                end

                RUNS.Noclip = run.RenderStepped:Connect(LoopNoclip)
            else
                if RUNS.Noclip then
                    RUNS.Noclip:Disconnect()
                    RUNS.Noclip = nil
                end
            end
        end
    })

    Tabs.Player:Toggle({
        Title = "伪装倒地",
        Description = "伪装成倒地状态",
        Default = functions.FakeDown,
        Callback = function(Value)
            functions.FakeDown = Value
            if Value then
                local getvalue = CharStats(me).Downed
                getvalue.Value = true
                getvalue:GetPropertyChangedSignal("Value"):Connect(function()
                    if functions.FakeDown then
                        getvalue.Value = true
                    end
                end)
            else
                CharStats(me).Downed.Value = false
            end
        end
    })

    Tabs.Player:Toggle({
        Title = "停止颈部移动",
        Description = "停止角色颈部移动",
        Default = functions.Stopneckmove,
        Callback = function(Value)
            functions.Stopneckmove = Value
            if Value then
                if me.Character then
                    me.Character:SetAttribute("NoNeckMovement", true)
                end
                me.CharacterAdded:Connect(function(char)
                    if char and char:FindFirstChild("Humanoid") then
                        if functions.Stopneckmove then
                            char:SetAttribute("NoNeckMovement", true)
                        end
                    else
                        repeat wait() until char and char:FindFirstChild("Humanoid")
                        if functions.Stopneckmove then
                            char:SetAttribute("NoNeckMovement", true)
                        end
                    end
                end)
            else
                if me.Character then
                    local get = me.Character:GetAttribute("NoNeckMovement")
                    if get then
                        me.Character:SetAttribute("NoNeckMovement", nil)
                    end
                end
            end
        end
    })

    Tabs.Player:Toggle({
        Title = "肢体不碎",
        Description = "防止肢体断裂",
        Default = functions.Unbreaklimbs,
        Callback = function(Value)
            functions.Unbreaklimbs = Value
            local limbsfolder = CharStats(me).HealthValues
            for _, a in pairs(limbsfolder:GetChildren()) do
                for _, i in pairs(a:GetChildren()) do
                    if i and i.Name == "Broken" then
                        if functions.Unbreaklimbs then
                            i.Value = false
                            i:GetPropertyChangedSignal("Value"):Connect(function()
                                if functions.Unbreaklimbs then
                                    i.Value = false
                                end
                            end)
                        end
                    end
                end
            end
            limbsfolder.ChildAdded:Connect(function()
                for _, a in pairs(limbsfolder:GetChildren()) do
                    for _, i in pairs(a:GetChildren()) do
                        if i and i.Name == "Broken" then
                            if functions.Unbreaklimbs then
                                i.Value = false
                                i:GetPropertyChangedSignal("Value"):Connect(function()
                                    if functions.Unbreaklimbs then
                                        i.Value = false
                                    end
                                end)
                            end
                        end
                    end
                end
            end)
        end
    })

    -- 战斗功能
    Tabs.Combat:Toggle({
        Title = "静默瞄准",
        Description = "自动瞄准敌人",
        Default = functions.SilentAim,
        Callback = function(Value)
            functions.SilentAim = Value
            if Value then
                cockie.SilentAimCircle = Drawing.new("Circle")
                cockie.SilentAimCircle.Color = Color3.new(1, 1, 1)
                cockie.SilentAimCircle.Thickness = 2
                cockie.SilentAimCircle.NumSides = 50
                cockie.SilentAimCircle.Radius = SectionSettings.SilentAim.DrawSize
                cockie.SilentAimCircle.Filled = false
                cockie.SilentAimCircle.Visible = true

                cockie.SilentAimCircle.Position = Vector2.new(camera.ViewportSize.X/2, camera.ViewportSize.Y/2)

                local target = nil

                local function GetClosest()
                    target = nil
                    local shortest = SectionSettings.SilentAim.DrawSize
                    for _, a in pairs(plrs:GetPlayers()) do
                        if a ~= me and a.Character then

                            if SectionSettings.SilentAim.CheckDowned and CharStats(a).Downed.Value == true then
                                continue
                            end

                            if SectionSettings.SilentAim.CheckTeam and a.Team == me.Team then
                                continue
                            end

                            if SectionSettings.SilentAim.CheckWhiteList and table.find(WhiteList, a) then
                                continue
                            end

                            local hrp = a.Character:FindFirstChild("HumanoidRootPart")
                            if hrp then
                                local screenpos, onScreen = camera:WorldToViewportPoint(hrp.Position)
                                if onScreen then
                                    local dist = (Vector2.new(camera.ViewportSize.X/2, camera.ViewportSize.Y/2) - Vector2.new(screenpos.X, screenpos.Y)).Magnitude
                                    if dist < shortest then
                                        target = a
                                    end
                                end
                            end
                        end
                    end
                end

                run.RenderStepped:Connect(GetClosest)

                local VisualizeEvent = rp.Events2.Visualize
                local DamageEvent = rp.Events["ZFKLF__H"]

                VisualizeEvent.Event:Connect(function(_, ShotCode, _, Gun, _, StartPos, BulletsPerShot)
                    if not functions.SilentAim then return end
                    if not Gun or not target or not target.Character or not target.Character:FindFirstChild("Humanoid") or target.Character:FindFirstChild("Humanoid").Health == 0 then return end
                    if not me.Character or not me.Character:FindFirstChildOfClass("Tool") then return end

                    local parts = SectionSettings.SilentAim.TargetParts[math.random(1, #SectionSettings.SilentAim.TargetParts)] or SectionSettings.SilentAim.TargetParts[1] or "Head"
                    local targetPart = target.Character:FindFirstChild(parts)
                    if not targetPart then return end

                    local partPos = targetPart.Position
                    local Bullets = {}
                    for i = 1, math.clamp(#BulletsPerShot, 1, 100) do
                        table.insert(Bullets, CFrame.new(StartPos, partPos).LookVector)
                    end
                    task.wait(0.005)
                    for i, dir in pairs(Bullets) do
                        DamageEvent:FireServer("🧈", Gun, ShotCode, i, targetPart, partPos, dir)
                    end

                    if Gun:FindFirstChild("Hitmarker") then
                        Gun.Hitmarker:Fire(targetPart)
                    end
                end)
            else
                if cockie.SilentAimCircle then
                    cockie.SilentAimCircle:Remove()
                    cockie.SilentAimCircle = nil
                end
            end
        end
    })

    Tabs.Combat:Slider({
        Title = "静默瞄准范围",
        Description = "调整瞄准范围大小",
        Default = SectionSettings.SilentAim.DrawSize,
        Min = 20,
        Max = 500,
        Callback = function(Value)
            SectionSettings.SilentAim.DrawSize = math.floor(Value)
            if cockie.SilentAimCircle then
                cockie.SilentAimCircle.Radius = SectionSettings.SilentAim.DrawSize
            end
        end
    })

    Tabs.Combat:Toggle({
        Title = "检查倒地状态",
        Description = "忽略倒地的玩家",
        Default = SectionSettings.SilentAim.CheckDowned,
        Callback = function(Value)
            SectionSettings.SilentAim.CheckDowned = Value
        end
    })

    Tabs.Combat:Toggle({
        Title = "检查队伍",
        Description = "忽略同队伍玩家",
        Default = SectionSettings.SilentAim.CheckTeam,
        Callback = function(Value)
            SectionSettings.SilentAim.CheckTeam = Value
        end
    })

    Tabs.Combat:Toggle({
        Title = "自瞄",
        Description = "自动瞄准敌人",
        Default = functions.AimBot,
        Callback = function(Value)
            functions.AimBot = Value
            if Value == true then
                cockie.aimbot_button = Instance.new("TextButton")
                cockie.aimbot_button.Parent = game.CoreGui
                cockie.aimbot_button.Name = "Aim"
                cockie.aimbot_button.BackgroundColor3 = Color3.new(0, 0, 0)
                cockie.aimbot_button.Position = UDim2.new(0.689, 0, 0.521, 0)
                cockie.aimbot_button.Size = UDim2.new(0, 40, 0, 40)
                cockie.aimbot_button.TextSize = 10
                cockie.aimbot_button.TextColor3 = Color3.new(1, 1, 1)
                cockie.aimbot_button.Text = "Aim"
                cockie.aimbot_button.Visible = true

                local target = nil
                local pressed = false
                local aimtarget
                local canusing = false
                local FirstPerson = true
                local predict = 15

                local part
                local randpart = nil
                local LastTick = tick()

                cockie.AimBotCircle = Drawing.new("Circle")
                cockie.AimBotCircle.Color = Color3.new(1, 1, 1)
                cockie.AimBotCircle.Thickness = 2
                cockie.AimBotCircle.NumSides = 50
                cockie.AimBotCircle.Radius = SectionSettings.Aimbot.DrawSize
                cockie.AimBotCircle.Filled = false
                cockie.AimBotCircle.Visible = true

                local centerScreen = Vector2.new(camera.ViewportSize.X/2, camera.ViewportSize.Y/2)
                cockie.AimBotCircle.Position = centerScreen

                local function getClosestTarget()
                    local closest, closestDist = nil, SectionSettings.Aimbot.DrawSize
                    for _, player in pairs(plrs:GetPlayers()) do
                        if player ~= me and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then

                            local count = #SectionSettings.Aimbot.TargetParts

                            if count == 0 then
                                part = "Head"
                            elseif count == 1 then
                                part = SectionSettings.Aimbot.TargetParts[count]
                            elseif count > 1 then
                                if tick() - LastTick >= .5 then
                                    local rand = math.random(1, count)
                                    randpart = SectionSettings.Aimbot.TargetParts[rand]
                                    LastTick = tick()
                                end
                                part = randpart or SectionSettings.Aimbot.TargetParts[1]
                            end

                            local pos, onScreen = camera:WorldToViewportPoint(player.Character:FindFirstChild(part).Position)
                            if onScreen then
                                if SectionSettings.Aimbot.CheckTeam and player.Team == me.Team then
                                    continue
                                end
                                if SectionSettings.Aimbot.CheckWhiteList and table.find(WhiteList, player) then
                                    continue
                                end

                                local centerScreen = Vector2.new(camera.ViewportSize.X/2, camera.ViewportSize.Y/2)
                                local distance = (Vector2.new(pos.X, pos.Y) - centerScreen).Magnitude
                                if distance < closestDist then
                                    closestDist = distance
                                    closest = player
                                end
                            end
                        end
                    end
                    return closest
                end

                cockie.aimbot_button.MouseButton1Click:Connect(function()
                    pressed = not pressed
                    aimtarget = getClosestTarget() or nil
                end)

                run.RenderStepped:Connect(function()
                    if FirstPerson then
                        local magnitude = (camera.Focus.p - camera.CFrame.p).Magnitude
                        canusing = magnitude <= 1.5
                    end
                    if functions.AimBot and pressed and aimtarget and aimtarget.Character then
                        local head = aimtarget.Character:FindFirstChild(part)
                        local humanoid = aimtarget.Character:FindFirstChild("Humanoid")
                        if head and humanoid and humanoid.Health ~= 0 and canusing then
                            local targetPosition = head.Position

                            if SectionSettings.Aimbot.CheckDowned and CharStats(target).Downed.Value == true then
                                return
                            end

                            if SectionSettings.Aimbot.Velocity then
                                targetPosition = targetPosition + head.Velocity / predict
                            end
                            camera.CFrame = camera.CFrame:Lerp(CFrame.new(camera.CFrame.p, targetPosition), 0.9)
                        end
                    end
                end)

            else
                if cockie.AimBotCircle then 
                    cockie.AimBotCircle:Remove() 
                    cockie.AimBotCircle = nil
                end
                if cockie.aimbot_button then 
                    cockie.aimbot_button:Destroy()
                    cockie.aimbot_button = nil
                end
            end
        end
    })

    Tabs.Combat:Toggle({
        Title = "近战光环",
        Description = "自动攻击附近敌人",
        Default = functions.Meleeaura,
        Callback = function(Value)
            functions.Meleeaura = Value
            if Value then
                local remote1 = rp.Events["XMHH.2"]
                local remote2 = rp.Events["XMHH2.2"]

                local part
                local randpart = nil

                local LastTick = tick()
                local AttachTick = tick()

                local attach = false
                local attachcd = .1

                local AttachCD = {
                    ["Fists"] = .05,
                    ["Knuckledusters"] = .05,
                    ["Nunchucks"] = 0.05,
                    ["Shiv"] = .05,
                    ["Bat"] = 1,
                    ["Metal-Bat"] = 1,
                    ["Chainsaw"] = 2.5,
                    ["Balisong"] = .05,
                    ["Rambo"] = .3,
                    ["Shovel"] = 3,
                    ["Sledgehammer"] = 2,
                    ["Katana"] = .1,
                    ["Wrench"] = .1,
                    ["FireAxe"] = 2.6
                }

                local function Attack(target)
                    if not (target and target:FindFirstChild("Head")) then return end

                    local mychar = me.Character
                    if not mychar then return end
                    local TOOL = mychar:FindFirstChildOfClass("Tool")
                    if not TOOL then return end
                    local AnimFolder = TOOL:FindFirstChild("AnimsFolder")
                    if not AnimFolder then return end
                    local anim = AnimFolder:FindFirstChild("Slash1")
                    if not anim then return end

                    if tick() - AttachTick >= attachcd then
                        local result = remote1:InvokeServer("🍞", tick(), TOOL, "43TRFWX", "Normal", tick(), true)

                        attachcd = AttachCD[TOOL.Name] or 1/2

                        if SectionSettings.MeleeAura.ShowAnim then
                            local load = me.Character:FindFirstChildOfClass("Humanoid"):FindFirstChild("Animator"):LoadAnimation(anim)
                            load:Play()
                            load:AdjustSpeed(1.3)
                        end

                        task.wait(0.3 + math.random() * 0.2)

                        if TOOL then
                            local Handle = TOOL:FindFirstChild("WeaponHandle") or TOOL:FindFirstChild("Handle") or me.Character:FindFirstChild("Right Arm")
                            local arg2 = {
                                "🍞",
                                tick(),
                                TOOL,
                                "2389ZFX34",
                                result,
                                true,
                                Handle,
                                target:FindFirstChild(part),
                                target,
                                me.Character.HumanoidRootPart.Position,
                                target:FindFirstChild(part).Position
                            }
                            if TOOL.Name == "Chainsaw" then
                                for i = 1, 15 do
                                    remote2:FireServer(unpack(arg2)) 
                                end
                            else
                                remote2:FireServer(unpack(arg2))
                            end
                            AttachTick = tick()
                        else
                            return
                        end
                    end
                end

                while functions.Meleeaura do
                    local mychar = me.Character or me.CharacterAdded:Wait()
                    if mychar then
                        local myhrp = mychar:FindFirstChild("HumanoidRootPart")
                        if myhrp then
                            for _, a in ipairs(plrs:GetPlayers()) do
                                if a ~= me then
                                    local char = a.Character
                                    if char then
                                        local hrp = char:FindFirstChild("HumanoidRootPart")
                                        if hrp then
                                            local distance = (myhrp.Position - hrp.Position).Magnitude
                                            if distance < SectionSettings.MeleeAura.Distance and a.Character:FindFirstChildOfClass("Humanoid").Health ~= 0 and not char:FindFirstChildOfClass("ForceField") then

                                                if SectionSettings.MeleeAura.CheckWhiteList and table.find(WhiteList, a) then
                                                    continue
                                                end

                                                if SectionSettings.MeleeAura.CheckTeam and a.Team == me.Team then
                                                    continue
                                                end

                                                if SectionSettings.MeleeAura.CheckDowned and CharStats(a).Downed.Value == true then
                                                    continue
                                                end

                                                local count = #SectionSettings.MeleeAura.TargetParts

                                                if count == 0 then
                                                    part = "Head"
                                                elseif count == 1 then
                                                    part = SectionSettings.MeleeAura.TargetParts[#SectionSettings.MeleeAura.TargetParts]
                                                elseif count > 1 then
                                                    if tick() - LastTick >= .2 then
                                                        local rand = math.random(1, count)
                                                        randpart = SectionSettings.MeleeAura.TargetParts[rand]
                                                        LastTick = tick()
                                                    end
                                                    part = randpart or SectionSettings.MeleeAura.TargetParts[1]
                                                end

                                                Attack(char)
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    run.Heartbeat:Wait()
                end
            end
        end
    })

    Tabs.Combat:Toggle({
        Title = "显示动画",
        Description = "显示攻击动画",
        Default = SectionSettings.MeleeAura.ShowAnim,
        Callback = function(Value)
            SectionSettings.MeleeAura.ShowAnim = Value
        end
    })

    Tabs.Combat:Toggle({
        Title = "狂暴模式",
        Description = "自动射击附近敌人",
        Default = functions.RageBot,
        Callback = function(Value)
            functions.RageBot = Value
            if Value then
                local function RandomString(length)
                    local res = ""
                    for i = 1, length do
                        res = res .. string.char(math.random(97, 122))
                    end
                    return res
                end

                local function GetClosestEnemy()
                    if not me.Character 
                        or not me.Character:FindFirstChild("HumanoidRootPart") 
                    then return nil end

                    local closestEnemy = nil
                    local shortestDistance = 100

                    for _, player in pairs(plrs:GetPlayers()) do
                        if player == me then continue end

                        local character = player.Character
                        local humanoid = character and character:FindFirstChildOfClass("Humanoid")
                        local rootPart = character and character:FindFirstChild("HumanoidRootPart")

                        if character 
                            and rootPart 
                            and humanoid 
                            and humanoid.Health > 15 
                            and not character:FindFirstChildOfClass("ForceField") 
                        then
                            if SectionSettings.RageBot.CheckWhiteList and table.find(WhiteList, player) then
                                continue
                            end

                            local distance = (rootPart.Position - me.Character.HumanoidRootPart.Position).Magnitude
                            if distance < shortestDistance then
                                shortestDistance = distance
                                closestEnemy = player
                            end
                        end
                    end
                    return closestEnemy
                end

                local function Shoot(target)
                    if not target or not target.Character then return end

                    local head = target.Character:FindFirstChild("Head")
                    if not head then return end

                    local tool = me.Character and me.Character:FindFirstChildOfClass("Tool")
                    if not tool then return end

                    local values = tool:FindFirstChild("Values")
                    local hitMarker = tool:FindFirstChild("Hitmarker")
                    if not values or not hitMarker then return end

                    local ammo = values:FindFirstChild("SERVER_Ammo")
                    local storedAmmo = values:FindFirstChild("SERVER_StoredAmmo")
                    if not ammo or not storedAmmo then return end

                    local hitPosition = head.Position
                    local hitDirection = (hitPosition - camera.CFrame.Position).unit
                    local randomKey = RandomString(30) ..0

                    if tool.Name == "Beretta" or tool.Name == "TEC-9" then
                        if ammo.Value > 0 then
                            rp.Events.GNX_S:FireServer(
                                tick(),
                                randomKey,
                                tool,
                                "FDS9I83",
                                camera.CFrame.Position,
                                {hitDirection},
                                false
                            )

                            task.delay(0.00001, function()
                                rp.Events["ZFKLF__H"]:FireServer(
                                    "🧈",
                                    tool,
                                    randomKey,
                                    1,
                                    head,
                                    hitPosition,
                                    hitDirection
                                )

                                ammo.Value = math.max(ammo.Value - 1, 0)
                                hitMarker:Fire(head)
                                storedAmmo.Value = values:FindFirstChild("SERVER_StoredAmmo").Value
                                rp.Events.GNX_R:FireServer(tick(), "KLWE89U0", tool)
                            end)
                        end
                    end
                end

                local function RageBotLoop()
                    while functions.RageBot do
                        if me.Character and me.Character:FindFirstChildOfClass("Tool") then
                            local target = GetClosestEnemy()
                            if target then
                                Shoot(target)
                            end
                        end
                        run.RenderStepped:Wait()
                    end
                end
                RageBotLoop()
            end
        end
    })

    Tabs.Combat:Toggle({
        Title = "瞬间换弹",
        Description = "瞬间完成换弹",
        Default = functions.Instantreload,
        Callback = function(Value)
            functions.Instantreload = Value
            local gunR_remote = rp.Events.GNX_R
            if Value then
                local charme = me.Character
                if charme then
                    local tool = charme:FindFirstChildOfClass("Tool")
                    if tool and tool:FindFirstChild("IsGun") then
                        local value = tool:FindFirstChild("Values"):FindFirstChild("SERVER_Ammo")
                        local value2 = tool:FindFirstChild("Values"):FindFirstChild("SERVER_StoredAmmo")
                        value2:GetPropertyChangedSignal("Value"):Connect(function()
                            if functions.Instantreload then
                                gunR_remote:FireServer(tick(), "KLWE89U0", tool);
                            end
                        end)
                        if value2.Value ~= 0 then
                            if functions.Instantreload then
                                gunR_remote:FireServer(tick(), "KLWE89U0", tool);
                            end
                        end
                        value:GetPropertyChangedSignal("Value"):Connect(function()
                            if functions.Instantreload and value2.Value ~= 0 then
                                gunR_remote:FireServer(tick(), "KLWE89U0", tool);
                            end
                        end)
                    else
                        charme.ChildAdded:Connect(function(obj)
                            if obj:IsA("Tool") and obj:FindFirstChild("IsGun") then
                                local value = obj:FindFirstChild("Values"):FindFirstChild("SERVER_Ammo")
                                local value2 = obj:FindFirstChild("Values"):FindFirstChild("SERVER_StoredAmmo")
                                value2:GetPropertyChangedSignal("Value"):Connect(function()
                                    if functions.Instantreload then
                                        gunR_remote:FireServer(tick(), "KLWE89U0", obj);
                                    end
                                end)
                                if value2.Value ~= 0 then
                                    if functions.Instantreload then
                                        gunR_remote:FireServer(tick(), "KLWE89U0", obj);
                                    end
                                end
                                value:GetPropertyChangedSignal("Value"):Connect(function()
                                    if functions.Instantreload and value2.Value ~= 0 then
                                        gunR_remote:FireServer(tick(), "KLWE89U0", obj);
                                    end
                                end)
                            end
                        end)
                    end
                    me.CharacterAdded:Connect(function(charr)
                        repeat wait() until charr and charr.Parent
                        charr.ChildAdded:Connect(function(obj)
                            if obj:IsA("Tool") and obj:FindFirstChild("IsGun") then
                                local value = obj:FindFirstChild("Values"):FindFirstChild("SERVER_Ammo")
                                local value2 = obj:FindFirstChild("Values"):FindFirstChild("SERVER_StoredAmmo")
                                value2:GetPropertyChangedSignal("Value"):Connect(function()
                                    if functions.Instantreload then
                                        gunR_remote:FireServer(tick(), "KLWE89U0", obj);
                                    end
                                end)
                                if value2.Value ~= 0 then
                                    if functions.Instantreload then
                                        gunR_remote:FireServer(tick(), "KLWE89U0", obj);
                                    end
                                end
                                value:GetPropertyChangedSignal("Value"):Connect(function()
                                    if functions.Instantreload and value2.Value ~= 0 then
                                        gunR_remote:FireServer(tick(), "KLWE89U0", obj);
                                    end
                                end)
                            end
                        end)
                    end)
                end
            end
        end
    })

    -- 视觉功能
    Tabs.Visual:Toggle({
        Title = "ESP",
        Description = "显示玩家轮廓",
        Default = functions.ESP,
        Callback = function(Value)
            functions.ESP = Value
            if Value then
                RUNS.ESP = run.Heartbeat:Connect(function()
                    if SectionSettings.ESP.Highlight then
                        local function Update()
                            for _, a in pairs(plrs:GetPlayers()) do
                                if a ~= me then
                                    local char = a.Character
                                    if char and not char:FindFirstChild("Highlight") then
                                        local hg = Instance.new("Highlight")
                                        hg.Parent = char
                                        hg.FillTransparency = 1
                                    end
                                end
                            end
                        end
                        Update()

                        plrs.PlayerAdded:Connect(function(player)
                            if functions.ESP then
                                local char = player.Character or player.CharacterAdded:Wait()
                                if char and SectionSettings.ESP.Highlight and not char:FindFirstChild("Highlight") then
                                    local hg = Instance.new("Highlight")
                                    hg.Parent = char
                                    hg.FillTransparency = 1
                                end
                            end
                        end)
                    else
                        for _, a in pairs(plrs:GetPlayers()) do
                            if a ~= me then
                                local char = a.Character
                                if char then
                                    local h = char:FindFirstChild("Highlight")
                                    if h then h:Destroy() end
                                end
                            end
                        end
                    end
                end)
            else
                if RUNS.ESP then
                    RUNS.ESP:Disconnect()
                    RUNS.ESP = nil
                end
                for _, a in pairs(plrs:GetPlayers()) do
                    if a ~= me then
                        local char = a.Character
                        if char then
                            local h = char:FindFirstChild("Highlight")
                            if h then h:Destroy() end
                        end
                    end
                end
            end
        end
    })

    Tabs.Visual:Toggle({
        Title = "高亮显示",
        Description = "高亮显示其他玩家",
        Default = SectionSettings.ESP.Highlight,
        Callback = function(Value)
            SectionSettings.ESP.Highlight = Value
        end
    })

    Tabs.Visual:Toggle({
        Title = "手臂特效",
        Description = "改变手臂材质",
        Default = functions.ArmsChams,
        Callback = function(Value)
            functions.ArmsChams = Value
            local viewfolder = camera:WaitForChild("ViewModel")
            if Value == true then
                viewfolder["Left Arm"].Material = Enum.Material.ForceField
                viewfolder["Right Arm"].Material = Enum.Material.ForceField
            else
                viewfolder["Left Arm"].Material = Enum.Material.Plastic
                viewfolder["Right Arm"].Material = Enum.Material.Plastic
            end
            me.CharacterAdded:Connect(function(char)
                repeat wait() until char and char.Parent
                local viewfolder = camera:WaitForChild("ViewModel")
                if functions.ArmsChams == true then
                    viewfolder["Left Arm"].Material = Enum.Material.ForceField
                    viewfolder["Right Arm"].Material = Enum.Material.ForceField
                else
                    viewfolder["Left Arm"].Material = Enum.Material.Plastic
                    viewfolder["Right Arm"].Material = Enum.Material.Plastic
                end
            end)
        end
    })

    -- 其他功能
    Tabs.Misc:Button({
        Title = "清理效果",
        Description = "清理所有视觉效果",
        Callback = function()
            if cockie.SilentAimCircle then
                cockie.SilentAimCircle:Remove()
                cockie.SilentAimCircle = nil
            end
            
            if cockie.AimBotCircle then
                cockie.AimBotCircle:Remove()
                cockie.AimBotCircle = nil
            end
            
            if cockie.aimbot_button then
                cockie.aimbot_button:Destroy()
                cockie.aimbot_button = nil
            end
            
            for _, player in pairs(plrs:GetPlayers()) do
                if player ~= me then
                    local char = player.Character
                    if char then
                        local h = char:FindFirstChild("Highlight")
                        if h then h:Destroy() end
                    end
                end
            end
            
            WindUI:Notify({
                Title = "清理完成",
                Content = "所有视觉效果已清理",
                Duration = 3
            })
        end
    })

    Tabs.Misc:Button({
        Title = "重置设置",
        Description = "重置所有功能设置",
        Callback = function()
            for key, _ in pairs(functions) do
                functions[key] = false
            end
            
            for key, connection in pairs(RUNS) do
                if connection then
                    connection:Disconnect()
                    RUNS[key] = nil
                end
            end
            
            WindUI:Notify({
                Title = "重置完成",
                Content = "所有设置已重置",
                Duration = 3
            })
        end
    })

    -- 关于选项卡
    Tabs.About:Paragraph({
        Title = "POX HUB付费版",
        Desc = "作者: 一野(培根)\n版本: " .. version,
        Image = "sword",
        ImageSize = 20,
        Color = "White"
    })
    Tabs.About:Paragraph({
        Title = "感谢支持",
        Desc = "游戏ID\njmk6536",
        Image = "heart",
        ImageSize = 16,
        Color = "Red"
    })
    Tabs.About:Button({
        Title = "支持我们",
        Icon = "heart",
        Callback = function()
            WindUI:Notify({
                Title = "感谢支持",
                Content = "您的支持是我们的动力！",
                Duration = 3,
                Icon = "heart"
            })
        end
    })

    -- 默认打开第一个选项卡
    Tabs.World:Select()

    -- 加载完成通知
    WindUI:Notify({
        Title = "犯罪付费版",
        Content = "所有功能已加载完成！",
        Duration = 3,
        Icon = "sword"
    })
end

elseif game.PlaceId == 3101667897 then--极速传奇
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

    Window:EditOpenButton({
        Title = "Paid user",
        Icon = "crown",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
        Draggable = true,
    })
    
    Window:Tag({
        Title = "付费版",
        Color = Color3.fromHex("#FFA500") 
    })
    
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)
    
    if not borderInitialized then
        spawn(function()
            wait(0.5)
            initializeRainbowBorder("糖果颜色", animationSpeed)
            wait(1)
            applyFontStyleToWindow(currentFontStyle)
        end)
    end

    local windowOpen = true

    local CollectAllChests = false
    local Interstellar = {mainexe = false}
    local HoopEnabled = false
    local autoRace = false

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
    end)

    local originalOpenFunction = Window.Open
    Window.Open = function(...)
        windowOpen = true
        local result = originalOpenFunction(...)
        
        if borderInitialized and borderEnabled and not rainbowBorderAnimation then
            wait(0.1)
            startBorderAnimation(Window, animationSpeed)
        end
        
        return result
    end

    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})
    local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})
    infoSection:Divider()
    infoSection:Paragraph({
        Title = "您当前的服务器为",
        Desc = tostring(game.PlaceId) .. "\n欢迎使用YG/TNINE",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "持续更新 有bug请提出来",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "作者:怀 凌乱",
        ThumbnailSize = 190,
    })

    local LockSection = Window:Section({
        Title = "功能以及UI设置",
        Icon = "crown",
        Opened = true,
    })

    local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
    Settings:Paragraph({
        Title = "UI设置",
        Desc = "绝妙二改WindUI",
        Image = "settings",
        ImageSize = 20,
        Color = "White"
    })

    Settings:Toggle({
        Title = "启用边框",
        Value = borderEnabled,
        Callback = function(value)
            borderEnabled = value
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Enabled = value
                    if value and windowOpen and not rainbowBorderAnimation then
                        startBorderAnimation(Window, animationSpeed)
                    elseif not value and rainbowBorderAnimation then
                        rainbowBorderAnimation:Disconnect()
                        rainbowBorderAnimation = nil
                    end
                    
                    WindUI:Notify({
                        Title = "边框",
                        Content = value and "已启用" or "已禁用",
                        Duration = 2,
                        Icon = value and "eye" or "eye-off"
                    })
                end
            end
        end
    })

    Settings:Toggle({
        Title = "启用字体颜色",
        Value = fontColorEnabled,
        Callback = function(value)
            fontColorEnabled = value
            applyFontColorsToWindow(currentFontColorScheme)
            
            WindUI:Notify({
                Title = "字体颜色",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "type" or "type"
            })
        end
    })

    Settings:Toggle({
        Title = "启用音效",
        Value = soundEnabled,
        Callback = function(value)
            soundEnabled = value
            WindUI:Notify({
                Title = "音效",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "volume-2" or "volume-x"
            })
        end
    })

    Settings:Toggle({
        Title = "启用背景模糊",
        Value = blurEnabled,
        Callback = function(value)
            blurEnabled = value
            applyBlurEffect(value)
            WindUI:Notify({
                Title = "背景模糊",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "cloud-rain" or "cloud"
            })
        end
    })

    local colorSchemeNames = {}
    for name, _ in pairs(COLOR_SCHEMES) do
        table.insert(colorSchemeNames, name)
    end
    table.sort(colorSchemeNames)

    Settings:Dropdown({
        Title = "边框颜色方案",
        Desc = "选择喜欢的颜色组合",
        Values = colorSchemeNames,
        Value = "糖果颜色",
        Callback = function(value)
            currentBorderColorScheme = value
            local success = initializeRainbowBorder(value, animationSpeed)
            playSound()
        end
    })

    Settings:Dropdown({
        Title = "字体颜色方案",
        Desc = "选择文字颜色组合",
        Values = colorSchemeNames,
        Value = "彩虹颜色",
        Callback = function(value)
            currentFontColorScheme = value
            applyFontColorsToWindow(value)
            playSound()
        end
    })

    local fontOptions = {}
    for _, fontName in ipairs(FONT_STYLES) do
        local description = FONT_DESCRIPTIONS[fontName] or fontName
        table.insert(fontOptions, {text = description, value = fontName})
    end

    table.sort(fontOptions, function(a, b)
        return a.text < b.text
    end)

    local fontValues = {}
    local fontValueToName = {}
    for _, option in ipairs(fontOptions) do
        table.insert(fontValues, option.text)
        fontValueToName[option.text] = option.value
    end

    Settings:Dropdown({
        Title = "字体样式",
        Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
        Values = fontValues,
        Value = "标准粗体",
        Callback = function(value)
            local fontName = fontValueToName[value]
            if fontName then
                currentFontStyle = fontName
                local successCount, totalCount = applyFontStyleToWindow(fontName)
                playSound()
            end
        end
    })

    Settings:Slider({
        Title = "边框转动速度",
        Desc = "调整边框旋转的快慢",
        Value = { 
            Min = 1,
            Max = 10,
            Default = 5,
        },
        Callback = function(value)
            animationSpeed = value
            if rainbowBorderAnimation then
                rainbowBorderAnimation:Disconnect()
                rainbowBorderAnimation = nil
            end
            if borderEnabled then
                startBorderAnimation(Window, animationSpeed)
            end
            
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Slider({
        Title = "UI整体缩放",
        Desc = "调整UI大小比例",
        Value = { 
            Min = 0.5,
            Max = 1.5,
            Default = 1,
        },
        Step = 0.1,
        Callback = function(value)
            uiScale = value
            applyUIScale(value)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Slider({
        Title = "UI透明度",
        Desc = "调整整个UI的透明度",
        Value = { 
            Min = 0,
            Max = 1,
            Default = 0.2,
        },
        Step = 0.1,
        Callback = function(value)
            Window:ToggleTransparency(tonumber(value) > 0)
            WindUI.TransparencyValue = tonumber(value)
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI宽度",
        Desc = "调整窗口的宽度",
        Value = { 
            Min = 500,
            Max = 800,
            Default = 600,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI高度",
        Desc = "调整窗口的高度",
        Value = { 
            Min = 300,
            Max = 600,
            Default = 400,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                local currentWidth = Window.UIElements.Main.Size.X.Offset
                Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "边框粗细",
        Desc = "调整边框的粗细",
        Value = { 
            Min = 1,
            Max = 5,
            Default = 1.5,
        },
        Step = 0.5,
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Thickness = value
                end
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "圆角大小",
        Desc = "调整UI圆角的大小",
        Value = { 
            Min = 0,
            Max = 20,
            Default = 16,
        },
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local corner = mainFrame:FindFirstChildOfClass("UICorner")
                if not corner then
                    corner = Instance.new("UICorner")
                    corner.Parent = mainFrame
                end
                corner.CornerRadius = UDim.new(0, value)
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "恢复UI到原位",
        Icon = "rotate-ccw",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "重置UI大小",
        Icon = "maximize-2",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "随机字体",
        Icon = "shuffle",
        Callback = function()
            local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
            currentFontStyle = randomFont
            applyFontStyleToWindow(randomFont)
            playSound()
        end
    })

    Settings:Button({
        Title = "随机颜色",
        Icon = "palette",
        Callback = function()
            local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
            currentBorderColorScheme = randomColor
            initializeRainbowBorder(randomColor, animationSpeed)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Button({
        Title = "刷新字体颜色",
        Icon = "refresh-cw",
        Callback = function()
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Button({
        Title = "刷新字体样式",
        Icon = "refresh-cw",
        Callback = function()
            local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
            playSound()
        end
    })

    Settings:Button({
        Title = "测试所有字体",
        Icon = "check-circle",
        Callback = function()
            local workingFonts = {}
            local totalFonts = #FONT_STYLES
            
            for i, fontName in ipairs(FONT_STYLES) do
                local success = pcall(function()
                    local test = Enum.Font[fontName]
                end)
                
                if success then
                    table.insert(workingFonts, fontName)
                end
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "导出设置",
        Icon = "download",
        Callback = function()
            local settings = {
                font = currentFontStyle,
                borderColor = currentBorderColorScheme,
                fontSize = currentFontColorScheme,
                speed = animationSpeed,
                scale = uiScale
            }
            setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
            playSound()
        end
    })

    local Tab1 = Window:Tab({Title = "主要", Icon = "zap"})
    local Tab2 = Window:Tab({Title = "传送", Icon = "map-pin"})
    local Tab3 = Window:Tab({Title = "美化", Icon = "palette"})

    local MainSection1 = Tab1:Section({Title = "主要功能", Icon = "zap", Opened = true})
    
    MainSection1:Toggle({
        Title = "收集全部宝箱",
        Value = CollectAllChests,
        Callback = function(Value)
            CollectAllChests = Value
            if Value then
                pcall(function()
                    for _, v in pairs(game.ReplicatedStorage.chestRewards:GetChildren()) do
                        game.ReplicatedStorage.rEvents.checkChestRemote:InvokeServer(v.Name)
                    end
                end)
            end
        end
    })

    MainSection1:Toggle({
        Title = "自动重生",
        Value = Interstellar.mainexe,
        Callback = function(state)
            Interstellar.mainexe = state
            if Interstellar.mainexe then
                spawn(function()
                    while Interstellar.mainexe do
                        pcall(function()
                            game:GetService("ReplicatedStorage").rEvents.rebirthEvent:FireServer("rebirthRequest")
                        end)
                        wait()
                    end
                end)
            end
        end
    })

    MainSection1:Button({
        Title = "破解全部通行证",
        Icon = "unlock",
        Callback = function()
            pcall(function()
                for i, v in ipairs(game:GetService("ReplicatedStorage").gamepassIds:GetChildren()) do
                    v.Parent = game.Players.LocalPlayer.ownedGamepasses
                end
            end)
        end
    })

    MainSection1:Toggle({
        Title = "吸全部环",
        Value = HoopEnabled,
        Callback = function(state)
            HoopEnabled = state
            if state then
                spawn(function()
                    while HoopEnabled and task.wait() do
                        pcall(function()
                            local character = game.Players.LocalPlayer.Character
                            if character and character:FindFirstChild("HumanoidRootPart") then
                                local hrp = character.HumanoidRootPart
                                for _, hoop in ipairs(workspace.Hoops:GetChildren()) do
                                    if hoop.Name == "Hoop" then
                                        hoop.CFrame = hrp.CFrame
                                    end
                                end
                            end
                        end)
                    end
                end)
            end
        end
    })

    MainSection1:Toggle({
        Title = "自动比赛",
        Value = autoRace,
        Callback = function(state)
            autoRace = state
            if state then
                spawn(function()
                    while autoRace do
                        game:GetService("ReplicatedStorage").rEvents.raceEvent:FireServer("joinRace")
                        wait()
                    end
                end)
            end
        end
    })

    local TeleportSection1 = Tab2:Section({Title = "传送位置", Icon = "map-pin", Opened = true})
    
    TeleportSection1:Button({
        Title = "城市",
        Icon = "map-pin",
        Callback = function()
            pcall(function()
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(2002.0133056640625, 1.2624330520629883, 985.2265625)
            end)
        end
    })

    TeleportSection1:Button({
        Title = "雪城",
        Icon = "map-pin",
        Callback = function()
            pcall(function()
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-9675.25, 59.63568115234375, 3783.50146484375)
            end)
        end
    })

    TeleportSection1:Button({
        Title = "丛林",
        Icon = "map-pin",
        Callback = function()
            pcall(function()
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-15267.9,399.0,5575.7)
            end)
        end
    })

    TeleportSection1:Button({
        Title = "熔岩城",
        Icon = "map-pin",
        Callback = function()
            pcall(function()
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-11052.4189453125, 217.59571838378906, 4898.76416015625)
            end)
        end
    })

    TeleportSection1:Button({
        Title = "传奇公路",
        Icon = "map-pin",
        Callback = function()
            pcall(function()
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-13095.255859375, 217.59567260742188, 5905.240234375)
            end)
        end
    })

    local BeautySection1 = Tab3:Section({Title = "美化功能", Icon = "palette", Opened = true})
    
    local gemValue = ""
    local expValue = ""
    local levelValue = ""
    
    BeautySection1:Textbox({
        Title = "修改钻石",
        Placeholder = "输入数据",
        Callback = function(Text)
            gemValue = Text
        end
    })

    BeautySection1:Button({
        Title = "应用钻石修改",
        Icon = "check",
        Callback = function()
            if gemValue ~= "" then
                pcall(function()
                    game:GetService("Players").LocalPlayer.Gems.Value = gemValue
                end)
            end
        end
    })

    BeautySection1:Textbox({
        Title = "修改经验值",
        Placeholder = "输入数据",
        Callback = function(Text)
            expValue = Text
        end
    })

    BeautySection1:Button({
        Title = "应用经验修改",
        Icon = "check",
        Callback = function()
            if expValue ~= "" then
                pcall(function()
                    game:GetService("Players").LocalPlayer.exp.Value = expValue
                end)
            end
        end
    })

    BeautySection1:Textbox({
        Title = "修改等级",
        Placeholder = "输入数据",
        Callback = function(Text)
            levelValue = Text
        end
    })

    BeautySection1:Button({
        Title = "应用等级修改",
        Icon = "check",
        Callback = function()
            if levelValue ~= "" then
                pcall(function()
                    game:GetService("Players").LocalPlayer.isTrading.level.Value = levelValue
                end)
            end
        end
    })

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        applyBlurEffect(false)
    end)

    Window:OnDestroy(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        for _, animation in pairs(fontColorAnimations) do
            animation:Disconnect()
        end
        fontColorAnimations = {}
        applyBlurEffect(false)
    end)
end

elseif game.PlaceId == 3351674303 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

    Window:EditOpenButton({
        Title = "Paid user",
        Icon = "crown",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
        Draggable = true,
    })
    
    Window:Tag({
        Title = "付费版",
        Color = Color3.fromHex("#FFA500") 
    })
    
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)
    
    if not borderInitialized then
        spawn(function()
            wait(0.5)
            initializeRainbowBorder("糖果颜色", animationSpeed)
            wait(1)
            applyFontStyleToWindow(currentFontStyle)
        end)
    end

    local windowOpen = true

    local LocalPlayer = game:GetService("Players").LocalPlayer
    local AutoFarm = false
    local AutoFarmRunning = false
    local _G = {
        Rewards = false,
        antiAFK = false
    }
    local LastNotif = 0
    local TouchTheRoad = false

    local function GetCurrentVehicle()
        return LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") and LocalPlayer.Character.Humanoid.SeatPart and LocalPlayer.Character.Humanoid.SeatPart.Parent
    end

    local function TP(cframe)
        local vehicle = GetCurrentVehicle()
        if vehicle then
            vehicle:SetPrimaryPartCFrame(cframe)
        end
    end

    local function VelocityTP(cframe)
        local TeleportSpeed = math.random(600, 600)
        local Car = GetCurrentVehicle()
        if Car then
            local BodyGyro = Instance.new("BodyGyro", Car.PrimaryPart)
            BodyGyro.P = 5000
            BodyGyro.maxTorque = Vector3.new(9e9, 9e9, 9e9)
            BodyGyro.CFrame = Car.PrimaryPart.CFrame
            local BodyVelocity = Instance.new("BodyVelocity", Car.PrimaryPart)
            BodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
            BodyVelocity.Velocity = CFrame.new(Car.PrimaryPart.Position, cframe.p).LookVector * TeleportSpeed
            wait((Car.PrimaryPart.Position - cframe.p).Magnitude / TeleportSpeed)
            BodyVelocity.Velocity = Vector3.new()
            wait(0.1)
            BodyVelocity:Destroy()
            BodyGyro:Destroy()
        end
    end

    local StartPosition = CFrame.new(Vector3.new(-34567.375, 34.895652770996094, -32846.046875), Vector3.new())
    local EndPosition = CFrame.new(Vector3.new(-31448.3515625, 34.925010681152344, -26616.25), Vector3.new())
    
    local AutoFarmFunc = coroutine.create(function()
        while wait() do
            if not AutoFarm then
                AutoFarmRunning = false
                coroutine.yield()
            end
            AutoFarmRunning = true
            pcall(function()
                if not GetCurrentVehicle() and tick() - (LastNotif or 0) > 5 then
                    LastNotif = tick()
                    WindUI:Notify({
                        Title = "自动刷钱",
                        Content = "请先进入车辆！",
                        Duration = 3,
                        Icon = "4483362458"
                    })
                else
                    TP(StartPosition + (TouchTheRoad and Vector3.new(0,-5,0) or Vector3.new(0, -5, 0)))
                    VelocityTP(EndPosition + (TouchTheRoad and Vector3.new(0,-5,0) or Vector3.new(0, -5, 0)))
                    TP(EndPosition + (TouchTheRoad and Vector3.new(0,-5,0) or Vector3.new(0, -5, 0)))
                    VelocityTP(StartPosition + (TouchTheRoad and Vector3.new(0,-5,0) or Vector3.new(0, -5, 0)))
                end
            end)
        end
    end)

    local function AutoRewards()
        while _G.Rewards do
            wait()
            local args = {[1] = 1}
            game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("PlayRewards"):FireServer(unpack(args))
            args = {[1] = 2}
            game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("PlayRewards"):FireServer(unpack(args))
            args = {[1] = 3}
            game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("PlayRewards"):FireServer(unpack(args))
            args = {[1] = 4}
            game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("PlayRewards"):FireServer(unpack(args))
            args = {[1] = 5}
            game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("PlayRewards"):FireServer(unpack(args))
            args = {[1] = 6}
            game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("PlayRewards"):FireServer(unpack(args))
            args = {[1] = 7}
            game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("PlayRewards"):FireServer(unpack(args))
        end
    end

    local function AntiAFK()
        while _G.antiAFK do
            wait(20)
            game:GetService'VirtualUser':Button1Down(Vector2.new(788, 547))
        end
    end

    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})
    local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})
    infoSection:Divider()
    infoSection:Paragraph({
        Title = "您当前的服务器为",
        Desc = tostring(game.PlaceId) .. "\n欢迎使用YG/TNINE",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "持续更新 有bug请提出来",
        ThumbnailSize = 190,
    })
    infoSection:Paragraph({
        Title = "作者:怀 凌乱",
        ThumbnailSize = 190,
    })

    local LockSection = Window:Section({
        Title = "功能以及UI设置",
        Icon = "crown",
        Opened = true,
    })

    local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
    Settings:Paragraph({
        Title = "UI设置",
        Desc = "绝妙二改WindUI",
        Image = "settings",
        ImageSize = 20,
        Color = "White"
    })

    Settings:Toggle({
        Title = "启用边框",
        Value = borderEnabled,
        Callback = function(value)
            borderEnabled = value
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Enabled = value
                    if value and windowOpen and not rainbowBorderAnimation then
                        startBorderAnimation(Window, animationSpeed)
                    elseif not value and rainbowBorderAnimation then
                        rainbowBorderAnimation:Disconnect()
                        rainbowBorderAnimation = nil
                    end
                    
                    WindUI:Notify({
                        Title = "边框",
                        Content = value and "已启用" or "已禁用",
                        Duration = 2,
                        Icon = value and "eye" or "eye-off"
                    })
                end
            end
        end
    })

    Settings:Toggle({
        Title = "启用字体颜色",
        Value = fontColorEnabled,
        Callback = function(value)
            fontColorEnabled = value
            applyFontColorsToWindow(currentFontColorScheme)
            
            WindUI:Notify({
                Title = "字体颜色",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "type" or "type"
            })
        end
    })

    Settings:Toggle({
        Title = "启用音效",
        Value = soundEnabled,
        Callback = function(value)
            soundEnabled = value
            WindUI:Notify({
                Title = "音效",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "volume-2" or "volume-x"
            })
        end
    })

    Settings:Toggle({
        Title = "启用背景模糊",
        Value = blurEnabled,
        Callback = function(value)
            blurEnabled = value
            applyBlurEffect(value)
            WindUI:Notify({
                Title = "背景模糊",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "cloud-rain" or "cloud"
            })
        end
    })

    local colorSchemeNames = {}
    for name, _ in pairs(COLOR_SCHEMES) do
        table.insert(colorSchemeNames, name)
    end
    table.sort(colorSchemeNames)

    Settings:Dropdown({
        Title = "边框颜色方案",
        Desc = "选择喜欢的颜色组合",
        Values = colorSchemeNames,
        Value = "糖果颜色",
        Callback = function(value)
            currentBorderColorScheme = value
            local success = initializeRainbowBorder(value, animationSpeed)
            playSound()
        end
    })

    Settings:Dropdown({
        Title = "字体颜色方案",
        Desc = "选择文字颜色组合",
        Values = colorSchemeNames,
        Value = "彩虹颜色",
        Callback = function(value)
            currentFontColorScheme = value
            applyFontColorsToWindow(value)
            playSound()
        end
    })

    local fontOptions = {}
    for _, fontName in ipairs(FONT_STYLES) do
        local description = FONT_DESCRIPTIONS[fontName] or fontName
        table.insert(fontOptions, {text = description, value = fontName})
    end

    table.sort(fontOptions, function(a, b)
        return a.text < b.text
    end)

    local fontValues = {}
    local fontValueToName = {}
    for _, option in ipairs(fontOptions) do
        table.insert(fontValues, option.text)
        fontValueToName[option.text] = option.value
    end

    Settings:Dropdown({
        Title = "字体样式",
        Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
        Values = fontValues,
        Value = "标准粗体",
        Callback = function(value)
            local fontName = fontValueToName[value]
            if fontName then
                currentFontStyle = fontName
                local successCount, totalCount = applyFontStyleToWindow(fontName)
                playSound()
            end
        end
    })

    Settings:Slider({
        Title = "边框转动速度",
        Desc = "调整边框旋转的快慢",
        Value = { 
            Min = 1,
            Max = 10,
            Default = 5,
        },
        Callback = function(value)
            animationSpeed = value
            if rainbowBorderAnimation then
                rainbowBorderAnimation:Disconnect()
                rainbowBorderAnimation = nil
            end
            if borderEnabled then
                startBorderAnimation(Window, animationSpeed)
            end
            
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Slider({
        Title = "UI整体缩放",
        Desc = "调整UI大小比例",
        Value = { 
            Min = 0.5,
            Max = 1.5,
            Default = 1,
        },
        Step = 0.1,
        Callback = function(value)
            uiScale = value
            applyUIScale(value)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Slider({
        Title = "UI透明度",
        Desc = "调整整个UI的透明度",
        Value = { 
            Min = 0,
            Max = 1,
            Default = 0.2,
        },
        Step = 0.1,
        Callback = function(value)
            Window:ToggleTransparency(tonumber(value) > 0)
            WindUI.TransparencyValue = tonumber(value)
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI宽度",
        Desc = "调整窗口的宽度",
        Value = { 
            Min = 500,
            Max = 800,
            Default = 600,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "调整UI高度",
        Desc = "调整窗口的高度",
        Value = { 
            Min = 300,
            Max = 600,
            Default = 400,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                local currentWidth = Window.UIElements.Main.Size.X.Offset
                Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "边框粗细",
        Desc = "调整边框的粗细",
        Value = { 
            Min = 1,
            Max = 5,
            Default = 1.5,
        },
        Step = 0.5,
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Thickness = value
                end
            end
            playSound()
        end
    })

    Settings:Slider({
        Title = "圆角大小",
        Desc = "调整UI圆角的大小",
        Value = { 
            Min = 0,
            Max = 20,
            Default = 16,
        },
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local corner = mainFrame:FindFirstChildOfClass("UICorner")
                if not corner then
                    corner = Instance.new("UICorner")
                    corner.Parent = mainFrame
                end
                corner.CornerRadius = UDim.new(0, value)
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "恢复UI到原位",
        Icon = "rotate-ccw",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "重置UI大小",
        Icon = "maximize-2",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
                playSound()
            end
        end
    })

    Settings:Button({
        Title = "随机字体",
        Icon = "shuffle",
        Callback = function()
            local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
            currentFontStyle = randomFont
            applyFontStyleToWindow(randomFont)
            playSound()
        end
    })

    Settings:Button({
        Title = "随机颜色",
        Icon = "palette",
        Callback = function()
            local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
            currentBorderColorScheme = randomColor
            initializeRainbowBorder(randomColor, animationSpeed)
            playSound()
        end
    })

    Settings:Divider()

    Settings:Button({
        Title = "刷新字体颜色",
        Icon = "refresh-cw",
        Callback = function()
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })

    Settings:Button({
        Title = "刷新字体样式",
        Icon = "refresh-cw",
        Callback = function()
            local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
            playSound()
        end
    })

    Settings:Button({
        Title = "测试所有字体",
        Icon = "check-circle",
        Callback = function()
            local workingFonts = {}
            local totalFonts = #FONT_STYLES
            
            for i, fontName in ipairs(FONT_STYLES) do
                local success = pcall(function()
                    local test = Enum.Font[fontName]
                end)
                
                if success then
                    table.insert(workingFonts, fontName)
                end
            end
            playSound()
        end
    })

    Settings:Button({
        Title = "导出设置",
        Icon = "download",
        Callback = function()
            local settings = {
                font = currentFontStyle,
                borderColor = currentBorderColorScheme,
                fontSize = currentFontColorScheme,
                speed = animationSpeed,
                scale = uiScale
            }
            setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
            playSound()
        end
    })

    local AutoTab = Window:Tab({Title = "自动功能", Icon = "zap"})
    
    local AutoFarmSection = AutoTab:Section({Title = "自动刷钱", Icon = "dollar-sign", Opened = true})
    
    AutoFarmSection:Toggle({
        Title = "自动刷钱",
        Value = AutoFarm,
        Callback = function(Value)
            AutoFarm = Value
            if Value and not AutoFarmRunning then
                coroutine.resume(AutoFarmFunc)
                WindUI:Notify({
                    Title = "自动刷钱",
                    Content = "已开启自动刷钱",
                    Duration = 3,
                    Icon = "4483362458"
                })
            elseif not Value then
                WindUI:Notify({
                    Title = "自动刷钱",
                    Content = "已关闭自动刷钱",
                    Duration = 3,
                    Icon = "4483362458"
                })
            end
        end
    })

    AutoFarmSection:Toggle({
        Title = "触地模式",
        Value = TouchTheRoad,
        Callback = function(Value)
            TouchTheRoad = Value
            WindUI:Notify({
                Title = "刷钱设置",
                Content = Value and "已开启接触路面模式" or "已关闭接触路面模式",
                Duration = 3,
                Icon = "4483362458"
            })
        end
    })

    local AutoFeaturesSection = AutoTab:Section({Title = "自动功能", Icon = "settings", Opened = true})
    
    AutoFeaturesSection:Toggle({
        Title = "自动签到",
        Value = _G.Rewards,
        Callback = function(Value)
            _G.Rewards = Value
            if Value then
                coroutine.wrap(AutoRewards)()
                WindUI:Notify({
                    Title = "自动签到",
                    Content = "已开启自动签到",
                    Duration = 3,
                    Icon = "4483362458"
                })
            else
                WindUI:Notify({
                    Title = "自动签到",
                    Content = "已关闭自动签到",
                    Duration = 3,
                    Icon = "4483362458"
                })
            end
        end
    })

    AutoFeaturesSection:Toggle({
        Title = "反挂机",
        Value = _G.antiAFK,
        Callback = function(Value)
            _G.antiAFK = Value
            if Value then
                coroutine.wrap(AntiAFK)()
                WindUI:Notify({
                    Title = "反挂机",
                    Content = "已开启防掉线功能",
                    Duration = 3,
                    Icon = "4483362458"
                })
            else
                WindUI:Notify({
                    Title = "反挂机",
                    Content = "已关闭防掉线功能",
                    Duration = 3,
                    Icon = "4483362458"
                })
            end
        end
    })

    local TeleportTab = Window:Tab({Title = "传送功能", Icon = "map-pin"})
    
    local TeleportLocationsSection = TeleportTab:Section({Title = "传送位置", Icon = "navigation", Opened = true})
    
    local TeleportLocations = {
        ["刷钱起点"] = CFrame.new(Vector3.new(-34567.375, 34.895652770996094, -32846.046875), Vector3.new()),
        ["刷钱终点"] = CFrame.new(Vector3.new(-31448.3515625, 34.925010681152344, -26616.25), Vector3.new()),
        ["出生点"] = CFrame.new(0, 5, 0)
    }
    
    local selectedTeleportOption = "刷钱起点"
    
    TeleportLocationsSection:Dropdown({
        Title = "选择传送位置",
        Desc = "选择要传送的位置",
        Values = {"刷钱起点", "刷钱终点", "出生点"},
        Value = "刷钱起点",
        Callback = function(value)
            selectedTeleportOption = value
            WindUI:Notify({
                Title = "传送位置",
                Content = "已选择: " .. value,
                Duration = 3,
                Icon = "4483362458"
            })
        end
    })

    TeleportLocationsSection:Button({
        Title = "传送到选中位置",
        Icon = "arrow-right",
        Callback = function()
            if TeleportLocations[selectedTeleportOption] then
                TP(TeleportLocations[selectedTeleportOption])
                WindUI:Notify({
                    Title = "传送成功",
                    Content = "已传送到: " .. selectedTeleportOption,
                    Duration = 3,
                    Icon = "4483362458"
                })
            end
        end
    })

    local CustomTeleportSection = TeleportTab:Section({Title = "自定义传送", Icon = "crosshair", Opened = true})
    
    local customX = 0
    local customY = 0
    local customZ = 0
    
    CustomTeleportSection:Textbox({
        Title = "X坐标",
        Placeholder = "输入X坐标",
        Callback = function(text)
            customX = tonumber(text) or 0
        end
    })

    CustomTeleportSection:Textbox({
        Title = "Y坐标",
        Placeholder = "输入Y坐标",
        Callback = function(text)
            customY = tonumber(text) or 0
        end
    })

    CustomTeleportSection:Textbox({
        Title = "Z坐标",
        Placeholder = "输入Z坐标",
        Callback = function(text)
            customZ = tonumber(text) or 0
        end
    })

    CustomTeleportSection:Button({
        Title = "传送到自定义坐标",
        Icon = "arrow-right",
        Callback = function()
            if customX ~= 0 or customY ~= 0 or customZ ~= 0 then
                TP(CFrame.new(customX, customY, customZ))
                WindUI:Notify({
                    Title = "自定义传送",
                    Content = string.format("已传送到: X=%d, Y=%d, Z=%d", customX, customY, customZ),
                    Duration = 3,
                    Icon = "4483362458"
                })
            else
                WindUI:Notify({
                    Title = "错误",
                    Content = "请输入有效的坐标值",
                    Duration = 3,
                    Icon = "4483362458"
                })
            end
        end
    })

    local GameSettingsTab = Window:Tab({Title = "游戏设置", Icon = "settings"})
    
    local InterfaceSection = GameSettingsTab:Section({Title = "界面设置", Icon = "layout", Opened = true})
    
    InterfaceSection:Keybind({
        Title = "UI显示/隐藏键",
        Current = Enum.KeyCode.F6,
        Callback = function(key)
            WindUI:Notify({
                Title = "按键绑定",
                Content = "UI快捷键已设置为: " .. tostring(key),
                Duration = 3,
                Icon = "4483362458"
            })
        end
    })

    InterfaceSection:Colorpicker({
        Title = "主题颜色",
        Default = Color3.fromRGB(0, 255, 0),
        Callback = function(color)
            WindUI:Notify({
                Title = "主题设置",
                Content = "主题颜色已更改",
                Duration = 3,
                Icon = "4483362458"
            })
        end
    })

    local InfoSection = GameSettingsTab:Section({Title = "信息", Icon = "info", Opened = true})
    
    InfoSection:Paragraph({
        Title = "关于TnineHub",
        Desc = "使用过程中如遇问题请联系管理员",
        ThumbnailSize = 190,
    })

    InfoSection:Button({
        Title = "销毁UI",
        Icon = "trash-2",
        Callback = function()
            Window:Destroy()
            WindUI:Notify({
                Title = "UI已销毁",
                Content = "TnineHub UI已被销毁",
                Duration = 3,
                Icon = "4483362458"
            })
        end
    })

    local identifiedexec = ""
    if identifyexecutor then
        identifiedexec = select(1, identifyexecutor())
    end

    WindUI:Notify({
        Title = "TnineHub加载完成",
        Content = "脚本已成功加载！执行器: " .. identifiedexec,
        Duration = 5,
        Icon = "4483362458"
    })

    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        applyBlurEffect(false)
    end)

    Window:OnDestroy(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        for _, animation in pairs(fontColorAnimations) do
            animation:Disconnect()
        end
        fontColorAnimations = {}
        applyBlurEffect(false)
    end)
end

elseif game.PlaceId == 1554960397 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local owbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

Window:EditOpenButton({
    Title = "Paid user",
    Icon = "crown",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 4,
    Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
    Draggable = true,
})
Window:Tag({
    Title = "汽车经销商大亨",
    Color = Color3.fromHex("#FFA500") 
})
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do  
            local color = Color3.fromHSV(hue, 0.8, 1)  
            Window:EditOpenButton({
                Color = ColorSequence.new(color)
            })
            wait(0.04)  
        end
    end
end)
if not borderInitialized then
    spawn(function()
        wait(0.5)
        initializeRainbowBorder("糖果颜色", animationSpeed)
        wait(1)
        applyFontStyleToWindow(currentFontStyle)
    end)
end

local windowOpen = true

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
end)

local originalOpenFunction = Window.Open
Window.Open = function(...)
    windowOpen = true
    local result = originalOpenFunction(...)
    
    if borderInitialized and borderEnabled and not rainbowBorderAnimation then
        wait(0.1)
        startBorderAnimation(Window, animationSpeed)
    end
    
    return result
end

local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

infoSection:Divider()

infoSection:Paragraph({
    Title = "您当前的服务器为",
    Desc = "俄亥俄州\n欢迎使用YG/TNINE",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "持续更新 有bug请提出来",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "作者:怀 凌乱",
    ThumbnailSize = 190,
})

local LockSection = Window:Section({
    Title = "功能以及UI设置",
    Icon = "crown",
    Opened = true,
})

local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
Settings:Paragraph({
    Title = "UI设置",
    Desc = "绝妙二改WindUI",
    Image = "settings",
    ImageSize = 20,
    Color = "White"
})

Settings:Toggle({
    Title = "启用边框",
    Value = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and windowOpen and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                
                WindUI:Notify({
                    Title = "边框",
                    Content = value and "已启用" or "已禁用",
                    Duration = 2,
                    Icon = value and "eye" or "eye-off"
                })
            end
        end
    end
})

Settings:Toggle({
    Title = "启用字体颜色",
    Value = fontColorEnabled,
    Callback = function(value)
        fontColorEnabled = value
        applyFontColorsToWindow(currentFontColorScheme)
        
        WindUI:Notify({
            Title = "字体颜色",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "type" or "type"
        })
    end
})

Settings:Toggle({
    Title = "启用音效",
    Value = soundEnabled,
    Callback = function(value)
        soundEnabled = value
        WindUI:Notify({
            Title = "音效",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "volume-2" or "volume-x"
        })
    end
})

Settings:Toggle({
    Title = "启用背景模糊",
    Value = blurEnabled,
    Callback = function(value)
        blurEnabled = value
        applyBlurEffect(value)
        WindUI:Notify({
            Title = "背景模糊",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "cloud-rain" or "cloud"
        })
    end
})

local colorSchemeNames = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames, name)
end
table.sort(colorSchemeNames)

Settings:Dropdown({
    Title = "边框颜色方案",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames,
    Value = "糖果颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})

Settings:Dropdown({
    Title = "字体颜色方案",
    Desc = "选择文字颜色组合",
    Values = colorSchemeNames,
    Value = "彩虹颜色",
    Callback = function(value)
        currentFontColorScheme = value
        applyFontColorsToWindow(value)
        playSound()
    end
})

local fontOptions = {}
for _, fontName in ipairs(FONT_STYLES) do
    local description = FONT_DESCRIPTIONS[fontName] or fontName
    table.insert(fontOptions, {text = description, value = fontName})
end

table.sort(fontOptions, function(a, b)
    return a.text < b.text
end)

local fontValues = {}
local fontValueToName = {}
for _, option in ipairs(fontOptions) do
    table.insert(fontValues, option.text)
    fontValueToName[option.text] = option.value
end

Settings:Dropdown({
    Title = "字体样式",
    Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
    Values = fontValues,
    Value = "标准粗体",
    Callback = function(value)
        local fontName = fontValueToName[value]
        if fontName then
            currentFontStyle = fontName
            local successCount, totalCount = applyFontStyleToWindow(fontName)
            playSound()
        end
    end
})

Settings:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = { 
        Min = 1,
        Max = 10,
        Default = 5,
    },
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Slider({
    Title = "UI整体缩放",
    Desc = "调整UI大小比例",
    Value = { 
        Min = 0.5,
        Max = 1.5,
        Default = 1,
    },
    Step = 0.1,
    Callback = function(value)
        uiScale = value
        applyUIScale(value)
        playSound()
    end
})

Settings:Divider()

Settings:Slider({
    Title = "UI透明度",
    Desc = "调整整个UI的透明度",
    Value = { 
        Min = 0,
        Max = 1,
        Default = 0.2,
    },
    Step = 0.1,
    Callback = function(value)
        Window:ToggleTransparency(tonumber(value) > 0)
        WindUI.TransparencyValue = tonumber(value)
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI宽度",
    Desc = "调整窗口的宽度",
    Value = { 
        Min = 500,
        Max = 800,
        Default = 600,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI高度",
    Desc = "调整窗口的高度",
    Value = { 
        Min = 300,
        Max = 600,
        Default = 400,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            local currentWidth = Window.UIElements.Main.Size.X.Offset
            Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = { 
        Min = 1,
        Max = 5,
        Default = 1.5,
    },
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})

Settings:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = { 
        Min = 0,
        Max = 20,
        Default = 16,
    },
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})

Settings:Button({
    Title = "恢复UI到原位",
    Icon = "rotate-ccw",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
            playSound()
        end
    end
})

Settings:Button({
    Title = "重置UI大小",
    Icon = "maximize-2",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
            playSound()
        end
    end
})

Settings:Button({
    Title = "随机字体",
    Icon = "shuffle",
    Callback = function()
        local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
        currentFontStyle = randomFont
        applyFontStyleToWindow(randomFont)
        playSound()
    end
})

Settings:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

Settings:Divider()

Settings:Button({
    Title = "刷新字体颜色",
    Icon = "refresh-cw",
    Callback = function()
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Button({
    Title = "刷新字体样式",
    Icon = "refresh-cw",
    Callback = function()
        local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
        playSound()
    end
})

Settings:Button({
    Title = "测试所有字体",
    Icon = "check-circle",
    Callback = function()
        local workingFonts = {}
        local totalFonts = #FONT_STYLES
        
        for i, fontName in ipairs(FONT_STYLES) do
            local success = pcall(function()
                local test = Enum.Font[fontName]
            end)
            
            if success then
                table.insert(workingFonts, fontName)
            end
        end
        playSound()
    end
})

Settings:Button({
    Title = "导出设置",
    Icon = "download",
    Callback = function()
        local settings = {
            font = currentFontStyle,
            borderColor = currentBorderColorScheme,
            fontSize = currentFontColorScheme,
            speed = animationSpeed,
            scale = uiScale
        }
        setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
        playSound()
    end
})

local Auto = false
local season = false
local oval = false
local gokart = false
local circuit = false
local police = false
local city = false
local highway = false
local mountain = false
local Sponge = false

local AutoTab = Window:Tab({Title = "自动功能", Icon = "zap"})
local RaceTab = Window:Tab({Title = "比赛功能", Icon = "flag"})

AutoTab:Section({Title = "自动功能", Opened = true})

AutoTab:Toggle({
    Title = "自动刷钱",
    Value = false,
    Callback = function(Value)
        Auto = Value
        if Value then
            task.spawn(function()
                local part = Instance.new("Part")
                part.Position = Vector3.new(0,60,0)
                part.Size = Vector3.new(1000,5,1000)
                part.Anchored = true
                part.Name = "Keaths Platform"
                part.CollisionGroupId = 5
                part.Parent = workspace

                local part2 = Instance.new("Part")
                part2.Position = Vector3.new(0,10,0)
                part2.Size = Vector3.new(1000,5,1000)
                part2.Anchored = true
                part2.Name = "Keaths Platform"
                part2.CollisionGroupId = 5
                part2.Parent = workspace

                local part3 = Instance.new("Part")
                part3.Position = Vector3.new(0,99,0)
                part3.Size = Vector3.new(1000,5,1000)
                part3.Anchored = true
                part3.Name = "Keaths Platform"
                part3.CollisionGroupId = 5
                part3.Parent = workspace

                while Auto and task.wait() do
                    local chr = game.Players.LocalPlayer.Character
                    if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                        local car = chr.Humanoid.SeatPart.Parent.Parent
                        car:PivotTo(CFrame.new(0,0,0))
                        wait(0.81)
                        car:PivotTo(part.CFrame)
                        wait(1)
                        car:PivotTo(part2.CFrame)
                        wait(1)
                        car:PivotTo(part3.CFrame)
                    else
                        wait(1)
                    end
                end
                
                if part then part:Destroy() end
                if part2 then part2:Destroy() end
                if part3 then part3:Destroy() end
            end)
        end
    end
})

AutoTab:Toggle({
    Title = "自动建造",
    Value = false,
    Callback = function(Value)
        local buyer = Value
        if Value then
            task.spawn(function()
                while buyer and task.wait() do
                    local function plot()
                        local tycoon = nil
                        for i,v in pairs(workspace.Tycoons:GetDescendants()) do
                            if v.Name == "Owner" and v.ClassName == "StringValue" and v.Value == game.Players.LocalPlayer.Name then
                                tycoon = v.Parent
                            end
                        end
                        return tycoon
                    end
                    local plotResult = plot()
                    if plotResult then
                        for i,v in pairs(plotResult.Dealership.Purchases:GetChildren()) do 
                            if buyer == true and v.TycoonButton.Button.Transparency == 0 then
                                game:GetService("ReplicatedStorage").Remotes.Build:FireServer("BuyItem", v.Name)
                                wait(0.3)
                            end 
                        end
                    end
                end
            end)
        end
    end
})

RaceTab:Section({Title = "自动比赛", Opened = true})

RaceTab:Toggle({
    Title = "自动完成赛季11比赛",
    Value = false,
    Callback = function(Value)
        season = Value
        if Value then
            task.spawn(function()
                while season and task.wait() do
                    for i, v in pairs(game:GetService("Workspace").Races.Season.Checkpoints:GetDescendants()) do
                        if not season then break end
                        if v.Name == "IsActive" and v.Value == true and v.Parent.Name ~= "20" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                            end
                        elseif v.Name == "IsActive" and v.Value == true and v.Parent.Name == "20" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                                car:PivotTo(CFrame.new(v.Parent.Parent.Parent.GoalPart.Position))
                            end
                        end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成圆形赛",
    Value = false,
    Callback = function(Value)
        oval = Value
        if Value then
            task.spawn(function()
                while oval and task.wait() do
                    for i, v in pairs(game:GetService("Workspace").Races.Race.Oval.Checkpoints:GetDescendants()) do
                        if not oval then break end
                        if v.Name == "IsActive" and v.Value == true and v.Parent.Name ~= "4" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                            end
                        elseif v.Name == "IsActive" and v.Value == true and v.Parent.Name == "4" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                                car:PivotTo(CFrame.new(v.Parent.Parent.Parent.GoalPart.Position))
                            end
                        end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成卡丁车赛",
    Value = false,
    Callback = function(Value)
        gokart = Value
        if Value then
            task.spawn(function()
                while gokart and task.wait() do
                    for i, v in pairs(game:GetService("Workspace").Races.Race.Gokart.Checkpoints:GetDescendants()) do
                        if not gokart then break end
                        if v.Name == "IsActive" and v.Value == true and v.Parent.Name ~= "9" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                            end
                        elseif v.Name == "IsActive" and v.Value == true and v.Parent.Name == "9" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                                car:PivotTo(CFrame.new(v.Parent.Parent.Parent.GoalPart.Position))
                            end
                        end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成转圈赛",
    Value = false,
    Callback = function(Value)
        circuit = Value
        if Value then
            task.spawn(function()
                while circuit and task.wait() do
                    for i, v in pairs(game:GetService("Workspace").Races.Race.Circuit.Checkpoints:GetDescendants()) do
                        if not circuit then break end
                        if v.Name == "IsActive" and v.Value == true and v.Parent.Name ~= "13" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                            end
                        elseif v.Name == "IsActive" and v.Value == true and v.Parent.Name == "13" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                                car:PivotTo(CFrame.new(v.Parent.Parent.Parent.GoalPart.Position))
                            end
                        end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成漂移赛",
    Value = false,
    Callback = function(Value)
        _G.racetest3 = Value
        if Value then
            task.spawn(function()
                local partvelo = nil
                while _G.racetest3 and task.wait() do
                    if game:GetService("Players").LocalPlayer.PlayerGui.Menu.Race.Visible == false then
                        local chr = game.Players.LocalPlayer.Character
                        if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                            local car = chr.Humanoid.SeatPart.Parent.Parent
                            car:PivotTo(CFrame.new(-2502.25146484375, 601.9251708984375, 2013.3966064453125))
                            car.Engine.Velocity = Vector3.new(0,0,0)
                            chr.Head.Anchored = true
                            wait(1)
                            chr.Head.Anchored = false
                            wait(1)
                            workspace.Races.RaceHandler.StartLobby:FireServer("Drift")
                            partvelo = nil
                            repeat wait()
                                if game.Players.LocalPlayer:DistanceFromCharacter(Vector3.new(-2502.25146484375, 601.9251708984375, 2013.3966064453125)) > 10 then
                                    car:PivotTo(CFrame.new(-2502.25146484375, 601.9251708984375, 2013.3966064453125))
                                    car.Engine.Velocity = Vector3.new(0,0,0)
                                    wait(0.1)
                                    workspace.Races.RaceHandler.StartLobby:FireServer("Drift")
                                end
                            until game:GetService("Players").LocalPlayer.PlayerGui.Menu.Race.Visible == true or _G.racetest3 == false
                        end
                    elseif game:GetService("Players").LocalPlayer.PlayerGui.Menu.Race.Visible == true then
                        if partvelo == nil then
                            local distance = math.huge
                            for a,b in pairs(workspace.DriftTrack:GetDescendants()) do
                                if b.Name == "DriftAsphalt" and b.Parent.Name == "Model" then
                                    local Dist = (Vector3.new(-2567.529296875, 601.9335327148438, 2018.6964111328125) - b.Position).magnitude
                                    if Dist < distance then
                                        distance = Dist
                                        partvelo = b
                                    end
                                end
                            end
                            if partvelo then
                                partvelo.Velocity = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame.LookVector*1000
                            end
                        end
                        if partvelo and game.Players.LocalPlayer:DistanceFromCharacter(partvelo.Position) > 10 then
                            local chr = game.Players.LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(partvelo.CFrame)
                            end
                        end
                    end
                end
            end)
        else
            local distance = math.huge
            local partvelo = nil
            for a,b in pairs(workspace.DriftTrack:GetDescendants()) do
                if b.Name == "DriftAsphalt" and b.Parent.Name == "Model" then
                    local Dist = (Vector3.new(-2567.529296875, 601.9335327148438, 2018.6964111328125) - b.Position).magnitude
                    if Dist < distance then
                        distance = Dist
                        partvelo = b
                    end
                end
            end
            if partvelo then
                partvelo.Velocity = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame.LookVector*0
            end
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成警察抓小偷赛",
    Value = false,
    Callback = function(Value)
        police = Value
        if Value then
            task.spawn(function()
                while police and task.wait() do
                    for i, v in pairs(game:GetService("Workspace").Races.Police.Checkpoints:GetDescendants()) do
                        if not police then break end
                        if v.Name == "IsActive" and v.Value == true and v.Parent.Name ~= "18" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                            end
                        elseif v.Name == "IsActive" and v.Value == true and v.Parent.Name == "18" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                                car:PivotTo(CFrame.new(v.Parent.Parent.Parent.GoalPart.Position))
                            end
                        end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成城市赛",
    Value = false,
    Callback = function(Value)
        city = Value
        if Value then
            task.spawn(function()
                while city and task.wait() do
                    for i, v in pairs(game:GetService("Workspace").Races.City.City.Checkpoints:GetDescendants()) do
                        if not city then break end
                        if v.Name == "IsActive" and v.Value == true and v.Parent.Name ~= "17" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                            end
                        elseif v.Name == "IsActive" and v.Value == true and v.Parent.Name == "17" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                                car:PivotTo(CFrame.new(v.Parent.Parent.Parent.GoalPart.Position))
                            end
                        end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成公路赛",
    Value = false,
    Callback = function(Value)
        highway = Value
        if Value then
            task.spawn(function()
                while highway and task.wait() do
                    for i, v in pairs(game:GetService("Workspace").Races.City.Highway.Checkpoints:GetDescendants()) do
                        if not highway then break end
                        if v.Name == "IsActive" and v.Value == true and v.Parent.Name ~= "23" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                            end
                        elseif v.Name == "IsActive" and v.Value == true and v.Parent.Name == "23" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                                car:PivotTo(CFrame.new(v.Parent.Parent.Parent.GoalPart.Position))
                            end
                        end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成山脉赛",
    Value = false,
    Callback = function(Value)
        mountain = Value
        if Value then
            task.spawn(function()
                while mountain and task.wait() do
                    for i, v in pairs(game:GetService("Workspace").Races.Mountain.Checkpoints:GetDescendants()) do
                        if not mountain then break end
                        if v.Name == "IsActive" and v.Value == true and v.Parent.Name ~= "26" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                            end
                        elseif v.Name == "IsActive" and v.Value == true and v.Parent.Name == "26" then
                            local chr = game:GetService("Players").LocalPlayer.Character
                            if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                                local car = chr.Humanoid.SeatPart.Parent.Parent
                                car:PivotTo(CFrame.new(v.Parent.Checkpoint.Position))
                                task.wait(0.2)
                                car:PivotTo(CFrame.new(v.Parent.Parent.Parent.GoalPart.Position))
                            end
                        end
                        task.wait(0.2)
                    end
                end
            end)
        end
    end
})

RaceTab:Toggle({
    Title = "自动完成海绵赛",
    Value = false,
    Callback = function(Value)
        Sponge = Value
        if Value then
            task.spawn(function()
                while Sponge and task.wait() do
                    local chr = game.Players.LocalPlayer.Character
                    if chr and chr.Humanoid and chr.Humanoid.SeatPart and chr.Humanoid.SeatPart.Parent and chr.Humanoid.SeatPart.Parent.Parent then
                        local car = chr.Humanoid.SeatPart.Parent.Parent
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["1"].Checkpoint.CFrame)
                        wait(1)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["2"].Checkpoint.CFrame)
                        wait(0.1)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["3"].Checkpoint.CFrame)
                        wait(1)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["4"].Checkpoint.CFrame)
                        wait(0.1)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["5"].Checkpoint.CFrame)
                        wait(1)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["6"].Checkpoint.CFrame)
                        wait(0.1)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["7"].Checkpoint.CFrame)
                        wait(1)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["8"].Checkpoint.CFrame)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["9"].Checkpoint.CFrame)
                        wait(1)
                        car:PivotTo(workspace.Races.SpongeBobRace.Checkpoints["10"].Checkpoint.CFrame)
                        wait(0.2)
                        car:PivotTo(CFrame.new(0,0,0))
                    end
                end
            end)
        end
    end
})

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    applyBlurEffect(false)
end)

Window:OnDestroy(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    for _, animation in pairs(fontColorAnimations) do
        animation:Disconnect()
    end
    fontColorAnimations = {}
    applyBlurEffect(false)
end)

end

elseif game.PlaceId == 4282985734 then
local clk = os.clock() local ncc = newcclosure or function(f) return f end local ggc = getgc or function() return {} end local hkm = hookmetamethod local cc = checkcaller or function() return false end local sr = setreadonly or function() end local grm = getrawmetatable local gcs = getconnections or get_signal_cons local plr = game.Players.LocalPlayer local chr = plr.Character plr.CharacterAdded:Connect(function(c) chr = c end) local ovi ovi = hkm(game, "__index", ncc(function(s, k) if cc() then return ovi(s, k) end if not chr then return ovi(s, k) end if k == "Velocity" and typeof(s) == "Instance" and s:IsA("BasePart") and s:IsDescendantOf(chr) then local vl = ovi(s, k) return Vector3.new(vl.X, vl.Y + 0.001, vl.Z) end if k == "WalkSpeed" and typeof(s) == "Instance" and s:IsA("Humanoid") and s:IsDescendantOf(chr) then return 16 end if k == "JumpPower" and typeof(s) == "Instance" and s:IsA("Humanoid") and s:IsDescendantOf(chr) then return 50 end return ovi(s, k) end)) if gcs then task.defer(function() if not chr then chr = plr.CharacterAdded:Wait() end local hum = chr:WaitForChild("Humanoid", 5) if not hum then return end for _, sg in {hum.StateChanged, hum:GetPropertyChangedSignal("WalkSpeed"), hum:GetPropertyChangedSignal("JumpPower")} do for _, cn in gcs(sg) do local ok, src = pcall(function() return debug.info(cn.Function, "s") end) if ok and src and src:find("AntiCheat") then cn:Disconnect() end end end end) end local fgs = {} local hkd = {} for _, tbl in ggc(true) do if type(tbl) ~= "table" or hkd[tbl] then continue end hkd[tbl] = true if rawget(tbl, "getEnvVariables") then local oev = tbl.getEnvVariables rawset(tbl, "getEnvVariables", ncc(function() local suc, tb = pcall(oev) if suc and type(tb) == "table" then for kk in pairs(tb) do if type(kk) == "string" and (kk:match("^acCode") or kk:match("^enable")) then tb[kk] = false end end end return tb or {} end)) end if rawget(tbl, "enableASC") ~= nil then rawset(tbl, "enableASC", false) rawset(tbl, "enablePunishment", false) end if rawget(tbl, "getIsAcDisabled") then rawset(tbl, "getIsAcDisabled", ncc(function() return true end)) end if rawget(tbl, "getIsBodyMoverCreatedByGame") then rawset(tbl, "getIsBodyMoverCreatedByGame", ncc(function() return true end)) end if rawget(tbl, "_flags") ~= nil and rawget(tbl, "_maxFlags") then rawset(tbl, "_maxFlags", 999999999) fgs[tbl] = true end if rawget(tbl, "getValueContainer") then local ovc = tbl.getValueContainer rawset(tbl, "getValueContainer", ncc(function() local suc, vc = pcall(ovc) if not suc or not vc then return vc end if vc.getValue then rawset(vc, "getValue", ncc(function() return chr and chr:FindFirstChild("Humanoid") and chr.Humanoid.WalkSpeed or 16 end)) end return vc end)) end if rawget(tbl, "getValue") and rawget(tbl, "getBaseValue") then rawset(tbl, "getValue", ncc(function() return chr and chr:FindFirstChild("Humanoid") and chr.Humanoid.WalkSpeed or 16 end)) end if rawget(tbl, "getJumpPowerValueContainer") then local ojp = tbl.getJumpPowerValueContainer rawset(tbl, "getJumpPowerValueContainer", ncc(function() local suc, vc = pcall(ojp) if not suc or not vc then return vc end if vc.getValue then rawset(vc, "getValue", ncc(function() return chr and chr:FindFirstChild("Humanoid") and chr.Humanoid.JumpPower or 50 end)) end return vc end)) end end pcall(function() local flg = require(game.ReplicatedStorage.Shared.Vendor.Flag) local mt = grm(flg.new(1)) if mt then sr(mt, false) local oi = rawget(mt, "__index") rawset(mt, "__index", ncc(function(s, k) if k == "addFlags" or k == "removeFlags" or k == "resetFlags" then return ncc(function() end) end if k == "getIsMaxed" then return ncc(function() return false end) end if k == "getFlags" or k == "getNumOfConsecutiveMaxes" then return ncc(function() return 0 end) end return type(oi) == "function" and oi(s, k) or (type(oi) == "table" and oi[k]) end)) end end) task.defer(function() while plr.Parent do for tb in fgs do rawset(tb, "_flags", 0) rawset(tb, "_numOfConsecutiveMaxes", 0) end task.wait(0.5) end end) print("[Anti Cheta] Bypassed time consuming: " .. math.floor((os.clock() - clk) * 1000) .. " ms")

if not LPH_OBFUSCATED then
    LPH_JIT_MAX = function(...) return ... end
    LPH_NO_VIRTUALIZE = function(...) return ... end
end

local request = syn and syn.request or http and http.request or http_request or fluxus and fluxus.request or request
local RunService = cloneref(game:GetService("RunService"))
local Players = cloneref(game:GetService("Players"))
local ReplicatedStorage = cloneref(game:GetService("ReplicatedStorage"))
local Workspace = cloneref(game:GetService("Workspace"))
local LocalPlayer = Players.LocalPlayer
local Camera = Workspace.CurrentCamera
local CoreGui = game:GetService("CoreGui")
local Lighting = cloneref(game:GetService("Lighting"))

local get = function(URL)
    return request({Url = URL, Method = "GET"}).Body
end

local Modules = {}
setthreadidentity(2)
for _, child in pairs(ReplicatedStorage:GetDescendants()) do
    if child:IsA("ModuleScript") then
        local success, module = pcall(require, child)
        if success then
            Modules[child.Name] = module
        end
    end
end
setthreadidentity(8)

local Network = Modules["Network"]
local EventHandler

for i, v in getgc(true) do
    if typeof(v) == "function" then
        local name = debug.info(v, "n")
        if name and name:match("GetEventHandler") then
            EventHandler = v
            break
        end
    end
end

local Remotes
if EventHandler then
    Remotes = getupvalue(EventHandler, 1)
end

local Framework = {}
local Hooks = {}

local OnFireServer = Network.FireServer
Network.FireServer = function(_, Name, ...)
    if Hooks[Name] then
        return pcall(Hooks[Name], OnFireServer, _, Name, ...)
    end
    return OnFireServer(_, Name, ...)
end

function Framework:AddHook(Name, Function)
    Hooks[Name] = Function
end

function Framework:FireServer(Name, ...)
    Network:FireServer(Name, ...)
end

function Framework:InvokeServer(Name, ...)
    return Network:InvokeServer(Name, ...)
end

function Framework:GetWeapon(Player)
    local Player = Player or LocalPlayer
    local Character = Player.Character or Player.CharacterAdded:Wait()
    
    for i, v in Character:GetChildren() do
        if not v:IsA("Tool") then continue end
        if v:GetAttribute("ItemType") == "weapon" and Modules["WeaponMetadata"][v:GetAttribute("ItemId")].class:lower():match("melee") then
            return v, Modules["MeleeWeaponClient"].getObj(v)
        end
    end
    return
end

function Framework:GetSessionData(Player)
    return Modules["DataHandler"].getSessionDataRoduxStoreForPlayer(Player or LocalPlayer)
end

function Framework:GetClosest(Distance, Priority, CheckFunction)
    local function n(Player)
        if (Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") and Player.Character:FindFirstChild("Humanoid") and Player.Character.Humanoid.Health ~= 0) then
            return true
        end
        return
    end
    
    local Distance = Distance or math.huge
    local CheckFunction = CheckFunction or n
    local Player = {}
    
    for i, v in Players:GetPlayers() do
        if v == LocalPlayer then continue end
        if not CheckFunction(v) then continue end
        
        local HRP = v.Character.HumanoidRootPart
        local Magnitude = (HRP.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
        
        if Magnitude < Distance then
            Distance = Magnitude
            Player[v.Name] = v.Character.Humanoid.Health
        end
    end
    
    if Priority then
        table.sort(Player)
    end
    
    return Player
end

function Framework:Check(Character)
    if not Character then return end
    
    local Player = Players:GetPlayerFromCharacter(Character)
    if Player then
        local Rodux = Framework:GetSessionData(Player)
        if Rodux and Rodux:getState().parry.isParrying then
            return
        end
    end
    
    local Humanoid = Character:FindFirstChildOfClass("Humanoid")
    if Humanoid then
        local Animator = Humanoid.Animator
        local PlayingAnimations = Animator:GetPlayingAnimationTracks()
        for i, v in PlayingAnimations do
            local Name = v.Animation.Name:match("Parry")
            if Name then
                return
            end
        end
    end
    
    for i, v in Character:GetChildren() do
        if v:GetAttribute("ParryShieldId") and #v:GetChildren() == 1 then
            return v:GetChildren()[1].Transparency == 1
        end
    end
    
    return
end

local KillAuraSettings = {
    Enabled = false,
    Range = 15,
    Cooldown = 0.35,
    UseWeaponCD = false,
    Type = "Single Person",
    Teleport = false,
    TPType = "Behind",
    TPRange = 10,
    PlayAnimation = false
}

local KADebounce = false

local function TeleportToEnemy(targetPosition, tpType, range)
    local Character = LocalPlayer.Character
    if not Character then return end
    
    local HumanoidRootPart = Character:FindFirstChild("HumanoidRootPart")
    if not HumanoidRootPart then return end
    
    if tpType == "Behind" then
        local targetCF = CFrame.new(targetPosition)
        HumanoidRootPart.CFrame = targetCF * CFrame.new(0, 0, range)
    elseif tpType == "Above" then
        HumanoidRootPart.CFrame = CFrame.new(targetPosition) * CFrame.new(0, range, 0)
    elseif tpType == "Orbit" then
        local angle = tick() * 5 % (2 * math.pi)
        HumanoidRootPart.CFrame = CFrame.new(targetPosition) * CFrame.new(math.cos(angle) * range, 0, math.sin(angle) * range)
    elseif tpType == "Random" then
        local X, Y, Z = math.random(-6, 6), math.random(-3, 3), math.random(-6, 6)
        HumanoidRootPart.CFrame = CFrame.new(targetPosition) * CFrame.new(X, Y, Z)
    end
end

local function KillAuraLoop()
    while task.wait() do
        if KillAuraSettings.Enabled and not KADebounce then
            local weapon, metadata = Framework:GetWeapon()
            if weapon and metadata then
                local closest = Framework:GetClosest(KillAuraSettings.Range, true)
                if closest and next(closest) then
                    KADebounce = true
                    
                    if KillAuraSettings.Teleport then
                        for playerName, health in closest do
                            local targetPlayer = Players:FindFirstChild(playerName)
                            if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                                TeleportToEnemy(targetPlayer.Character.HumanoidRootPart.Position, KillAuraSettings.TPType, KillAuraSettings.TPRange)
                                break
                            end
                        end
                    end
                    
                    local onCooldown = false
                    if KillAuraSettings.UseWeaponCD then
                        onCooldown = metadata._cooldownProgressTimer:getValue() < 0.75
                    else
                        if weapon.Name == "Sickle" then
                            task.wait(0.25)
                        else
                            task.wait(math.clamp(metadata._itemConfig.cooldown - KillAuraSettings.Cooldown, 0.45, math.huge) - 0.1)
                        end
                    end
                    
                    if not onCooldown then
                        if not KillAuraSettings.PlayAnimation then
                            local slash = math.random(1, #metadata._itemConfig.slashMetadata)
                            
                            metadata._cooldownProgressTimer:setValue(0)
                            metadata:setSlashCount(slash)
                            Framework:FireServer("MeleeSwing", weapon, slash)
                            metadata._lastSlashTick = tick()
                            weapon:SetAttribute("LastSlashTick", metadata._lastSlashTick)
                            
                            task.wait(0.1)
                            
                            for i, v in metadata.meleeHitboxes do
                                for playerName, health in closest do
                                    local targetPlayer = Players:FindFirstChild(playerName)
                                    
                                    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Head") and health ~= 0 and Framework:Check(targetPlayer.Character) then
                                        local character = targetPlayer.Character
                                        local session = Framework:GetSessionData(targetPlayer)
                                        
                                        if session and not session:getState().parry.isParrying then
                                            local data = metadata._humanoidsAlreadyHit[character]
                                            if not data then
                                                metadata._humanoidsAlreadyHit[character] = {
                                                    ["hitDetectionStage"] = 0,
                                                    ["amountOfTimesHit"] = 0,
                                                    ["lastHitTick"] = 0
                                                }
                                                data = metadata._humanoidsAlreadyHit[character]
                                            end
                                            
                                            Framework:FireServer("MeleeDamage",
                                                weapon,
                                                character.Head,
                                                i,
                                                character.Head.Position,
                                                character.Head.CFrame:ToObjectSpace(CFrame.new(character.Head.Position)),
                                                metadata._character.HumanoidRootPart.CFrame.LookVector,
                                                (character.Head.Position - character.Head.Position).Unit,
                                                Vector3.yAxis,
                                                tick() - metadata._lastSlashTick
                                            )
                                            
                                            data.hitDetectionStage = metadata.hitDetectionStage or 1
                                            data.amountOfTimesHit += 1
                                            data.lastHitTick = tick()
                                            
                                            if KillAuraSettings.Type == "Single Person" then
                                                break
                                            end
                                        end
                                    end
                                end
                                break
                            end
                        else
                            if metadata:getShouldSlash() then
                                metadata._activateSignal:Fire()
                                local anim = metadata.animations.slashes[metadata._currSlashCount]
                                
                                task.wait(0.1)
                                
                                for i, v in metadata.meleeHitboxes do
                                    v.HitboxStopTime = 1
                                    for playerName, health in closest do
                                        local targetPlayer = Players:FindFirstChild(playerName)
                                        
                                        if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Head") and health ~= 0 and Framework:Check(targetPlayer.Character) then
                                            local character = targetPlayer.Character
                                            local data = Framework:GetSessionData(targetPlayer)
                                            
                                            if data and not data:getState().parry.isParrying then
                                                v.OnHit:Fire(character.Head, character.Humanoid, {
                                                    Distance = 1,
                                                    Instance = character.Head,
                                                    Material = Enum.Material.SmoothPlastic,
                                                    Position = character.Head.Position,
                                                    Normal = Vector3.yAxis
                                                }, character.Head.Position, character.Head.Position)
                                                
                                                if KillAuraSettings.Type == "Single Person" then
                                                    break
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    KADebounce = false
                end
            end
        end
    end
end

local ESP = {
    Enabled = true,
    TeamCheck = true,
    MaxDistance = 200,
    FontSize = 11,
    FadeOut = {
        OnDistance = true,
        OnDeath = false,
        OnLeave = false,
    },
    Options = { 
        Teamcheck = false, TeamcheckRGB = Color3.fromRGB(0, 255, 0),
        Friendcheck = true, FriendcheckRGB = Color3.fromRGB(0, 255, 0),
        Highlight = false, HighlightRGB = Color3.fromRGB(255, 0, 0),
    },
    Drawing = {
        Chams = {
            Enabled  = true,
            Thermal = true,
            FillRGB = Color3.fromRGB(119, 120, 255),
            Fill_Transparency = 100,
            OutlineRGB = Color3.fromRGB(119, 120, 255),
            Outline_Transparency = 100,
            VisibleCheck = true,
        },
        Names = {
            Enabled = true,
            RGB = Color3.fromRGB(255, 255, 255),
        },
        Flags = {
            Enabled = true,
        },
        Distances = {
            Enabled = true, 
            Position = "Text",
            RGB = Color3.fromRGB(255, 255, 255),
        },
        Weapons = {
            Enabled = true, WeaponTextRGB = Color3.fromRGB(119, 120, 255),
            Outlined = false,
            Gradient = false,
            GradientRGB1 = Color3.fromRGB(255, 255, 255), GradientRGB2 = Color3.fromRGB(119, 120, 255),
        },
        Healthbar = {
            Enabled = true,  
            HealthText = true, Lerp = false, HealthTextRGB = Color3.fromRGB(119, 120, 255),
            Width = 2.5,
            Gradient = true, GradientRGB1 = Color3.fromRGB(200, 0, 0), GradientRGB2 = Color3.fromRGB(60, 60, 125), GradientRGB3 = Color3.fromRGB(119, 120, 255), 
        },
        Boxes = {
            Animate = true,
            RotationSpeed = 300,
            Gradient = false, GradientRGB1 = Color3.fromRGB(119, 120, 255), GradientRGB2 = Color3.fromRGB(0, 0, 0), 
            GradientFill = true, GradientFillRGB1 = Color3.fromRGB(119, 120, 255), GradientFillRGB2 = Color3.fromRGB(0, 0, 0), 
            Filled = {
                Enabled = true,
                Transparency = 0.75,
                RGB = Color3.fromRGB(0, 0, 0),
            },
            Full = {
                Enabled = true,
                RGB = Color3.fromRGB(255, 255, 255),
            },
            Corner = {
                Enabled = true,
                RGB = Color3.fromRGB(255, 255, 255),
            },
        };
    };
    Connections = {
        RunService = RunService;
    };
    Fonts = {};
}

local Euphoria = ESP.Connections
local lplayer = Players.LocalPlayer
local camera = Workspace.CurrentCamera
local Cam = Workspace.CurrentCamera
local RotationAngle, Tick = -45, tick()

local Weapon_Icons = {
    ["Wooden Bow"] = "http://www.roblox.com/asset/?id=17677465400",
    ["Crossbow"] = "http://www.roblox.com/asset/?id=17677473017",
    ["Salvaged SMG"] = "http://www.roblox.com/asset/?id=17677463033",
    ["Salvaged AK47"] = "http://www.roblox.com/asset/?id=17677455113",
    ["Salvaged AK74u"] = "http://www.roblox.com/asset/?id=17677442346",
    ["Salvaged M14"] = "http://www.roblox.com/asset/?id=17677444642",
    ["Salvaged Python"] = "http://www.roblox.com/asset/?id=17677451737",
    ["Military PKM"] = "http://www.roblox.com/asset/?id=17677449448",
    ["Military M4A1"] = "http://www.roblox.com/asset/?id=17677479536",
    ["Bruno's M4A1"] = "http://www.roblox.com/asset/?id=17677471185",
    ["Military Barrett"] = "http://www.roblox.com/asset/?id=17677482998",
    ["Salvaged Skorpion"] = "http://www.roblox.com/asset/?id=17677459658",
    ["Salvaged Pump Action"] = "http://www.roblox.com/asset/?id=17677457186",
    ["Military AA12"] = "http://www.roblox.com/asset/?id=17677475227",
    ["Salvaged Break Action"] = "http://www.roblox.com/asset/?id=17677468751",
    ["Salvaged Pipe Rifle"] = "http://www.roblox.com/asset/?id=17677468751",
    ["Salvaged P250"] = "http://www.roblox.com/asset/?id=17677447257",
    ["Nail Gun"] = "http://www.roblox.com/asset/?id=17677484756"
}

local Functions = {}
do
    function Functions:Create(Class, Properties)
        local _Instance = typeof(Class) == 'string' and Instance.new(Class) or Class
        for Property, Value in pairs(Properties) do
            _Instance[Property] = Value
        end
        return _Instance
    end
    
    function Functions:FadeOutOnDist(element, distance)
        local transparency = math.max(0.1, 1 - (distance / ESP.MaxDistance))
        if element:IsA("TextLabel") then
            element.TextTransparency = 1 - transparency
        elseif element:IsA("ImageLabel") then
            element.ImageTransparency = 1 - transparency
        elseif element:IsA("UIStroke") then
            element.Transparency = 1 - transparency
        elseif element:IsA("Frame") and (element == Healthbar or element == BehindHealthbar) then
            element.BackgroundTransparency = 1 - transparency
        elseif element:IsA("Frame") then
            element.BackgroundTransparency = 1 - transparency
        elseif element:IsA("Highlight") then
            element.FillTransparency = 1 - transparency
            element.OutlineTransparency = 1 - transparency
        end
    end  
end

do
    local ScreenGui = Functions:Create("ScreenGui", {
        Parent = CoreGui,
        Name = "ESPHolder",
    })

    local DupeCheck = function(plr)
        if ScreenGui:FindFirstChild(plr.Name) then
            ScreenGui[plr.Name]:Destroy()
        end
    end

    local ESPFunc = function(plr)
        coroutine.wrap(DupeCheck)(plr)
        local Name = Functions:Create("TextLabel", {Parent = ScreenGui, Position = UDim2.new(0.5, 0, 0, -11), Size = UDim2.new(0, 100, 0, 20), AnchorPoint = Vector2.new(0.5, 0.5), BackgroundTransparency = 1, TextColor3 = Color3.fromRGB(255, 255, 255), Font = Enum.Font.Code, TextSize = ESP.FontSize, TextStrokeTransparency = 0, TextStrokeColor3 = Color3.fromRGB(0, 0, 0), RichText = true})
        local Distance = Functions:Create("TextLabel", {Parent = ScreenGui, Position = UDim2.new(0.5, 0, 0, 11), Size = UDim2.new(0, 100, 0, 20), AnchorPoint = Vector2.new(0.5, 0.5), BackgroundTransparency = 1, TextColor3 = Color3.fromRGB(255, 255, 255), Font = Enum.Font.Code, TextSize = ESP.FontSize, TextStrokeTransparency = 0, TextStrokeColor3 = Color3.fromRGB(0, 0, 0), RichText = true})
        local Weapon = Functions:Create("TextLabel", {Parent = ScreenGui, Position = UDim2.new(0.5, 0, 0, 31), Size = UDim2.new(0, 100, 0, 20), AnchorPoint = Vector2.new(0.5, 0.5), BackgroundTransparency = 1, TextColor3 = Color3.fromRGB(255, 255, 255), Font = Enum.Font.Code, TextSize = ESP.FontSize, TextStrokeTransparency = 0, TextStrokeColor3 = Color3.fromRGB(0, 0, 0), RichText = true})
        local Box = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = Color3.fromRGB(0, 0, 0), BackgroundTransparency = 0.75, BorderSizePixel = 0})
        local Gradient1 = Functions:Create("UIGradient", {Parent = Box, Enabled = ESP.Drawing.Boxes.GradientFill, Color = ColorSequence.new{ColorSequenceKeypoint.new(0, ESP.Drawing.Boxes.GradientFillRGB1), ColorSequenceKeypoint.new(1, ESP.Drawing.Boxes.GradientFillRGB2)}})
        local Outline = Functions:Create("UIStroke", {Parent = Box, Enabled = ESP.Drawing.Boxes.Gradient, Transparency = 0, Color = Color3.fromRGB(255, 255, 255), LineJoinMode = Enum.LineJoinMode.Miter})
        local Gradient2 = Functions:Create("UIGradient", {Parent = Outline, Enabled = ESP.Drawing.Boxes.Gradient, Color = ColorSequence.new{ColorSequenceKeypoint.new(0, ESP.Drawing.Boxes.GradientRGB1), ColorSequenceKeypoint.new(1, ESP.Drawing.Boxes.GradientRGB2)}})
        local Healthbar = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = Color3.fromRGB(255, 255, 255), BackgroundTransparency = 0})
        local BehindHealthbar = Functions:Create("Frame", {Parent = ScreenGui, ZIndex = -1, BackgroundColor3 = Color3.fromRGB(0, 0, 0), BackgroundTransparency = 0})
        local HealthbarGradient = Functions:Create("UIGradient", {Parent = Healthbar, Enabled = ESP.Drawing.Healthbar.Gradient, Rotation = -90, Color = ColorSequence.new{ColorSequenceKeypoint.new(0, ESP.Drawing.Healthbar.GradientRGB1), ColorSequenceKeypoint.new(0.5, ESP.Drawing.Healthbar.GradientRGB2), ColorSequenceKeypoint.new(1, ESP.Drawing.Healthbar.GradientRGB3)}})
        local HealthText = Functions:Create("TextLabel", {Parent = ScreenGui, Position = UDim2.new(0.5, 0, 0, 31), Size = UDim2.new(0, 100, 0, 20), AnchorPoint = Vector2.new(0.5, 0.5), BackgroundTransparency = 1, TextColor3 = Color3.fromRGB(255, 255, 255), Font = Enum.Font.Code, TextSize = ESP.FontSize, TextStrokeTransparency = 0, TextStrokeColor3 = Color3.fromRGB(0, 0, 0)})
        local Chams = Functions:Create("Highlight", {Parent = ScreenGui, FillTransparency = 1, OutlineTransparency = 0, OutlineColor = Color3.fromRGB(119, 120, 255), DepthMode = "AlwaysOnTop"})
        local WeaponIcon = Functions:Create("ImageLabel", {Parent = ScreenGui, BackgroundTransparency = 1, BorderColor3 = Color3.fromRGB(0, 0, 0), BorderSizePixel = 0, Size = UDim2.new(0, 40, 0, 40)})
        local Gradient3 = Functions:Create("UIGradient", {Parent = WeaponIcon, Rotation = -90, Enabled = ESP.Drawing.Weapons.Gradient, Color = ColorSequence.new{ColorSequenceKeypoint.new(0, ESP.Drawing.Weapons.GradientRGB1), ColorSequenceKeypoint.new(1, ESP.Drawing.Weapons.GradientRGB2)}})
        local LeftTop = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = ESP.Drawing.Boxes.Corner.RGB, Position = UDim2.new(0, 0, 0, 0)})
        local LeftSide = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = ESP.Drawing.Boxes.Corner.RGB, Position = UDim2.new(0, 0, 0, 0)})
        local RightTop = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = ESP.Drawing.Boxes.Corner.RGB, Position = UDim2.new(0, 0, 0, 0)})
        local RightSide = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = ESP.Drawing.Boxes.Corner.RGB, Position = UDim2.new(0, 0, 0, 0)})
        local BottomSide = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = ESP.Drawing.Boxes.Corner.RGB, Position = UDim2.new(0, 0, 0, 0)})
        local BottomDown = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = ESP.Drawing.Boxes.Corner.RGB, Position = UDim2.new(0, 0, 0, 0)})
        local BottomRightSide = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = ESP.Drawing.Boxes.Corner.RGB, Position = UDim2.new(0, 0, 0, 0)})
        local BottomRightDown = Functions:Create("Frame", {Parent = ScreenGui, BackgroundColor3 = ESP.Drawing.Boxes.Corner.RGB, Position = UDim2.new(0, 0, 0, 0)})
        local Flag1 = Functions:Create("TextLabel", {Parent = ScreenGui, Position = UDim2.new(1, 0, 0, 0), Size = UDim2.new(0, 100, 0, 20), AnchorPoint = Vector2.new(0.5, 0.5), BackgroundTransparency = 1, TextColor3 = Color3.fromRGB(255, 255, 255), Font = Enum.Font.Code, TextSize = ESP.FontSize, TextStrokeTransparency = 0, TextStrokeColor3 = Color3.fromRGB(0, 0, 0)})
        local Flag2 = Functions:Create("TextLabel", {Parent = ScreenGui, Position = UDim2.new(1, 0, 0, 0), Size = UDim2.new(0, 100, 0, 20), AnchorPoint = Vector2.new(0.5, 0.5), BackgroundTransparency = 1, TextColor3 = Color3.fromRGB(255, 255, 255), Font = Enum.Font.Code, TextSize = ESP.FontSize, TextStrokeTransparency = 0, TextStrokeColor3 = Color3.fromRGB(0, 0, 0)})
        
        local Updater = function()
            local Connection
            local function HideESP()
                Box.Visible = false
                Name.Visible = false
                Distance.Visible = false
                Weapon.Visible = false
                Healthbar.Visible = false
                BehindHealthbar.Visible = false
                HealthText.Visible = false
                WeaponIcon.Visible = false
                LeftTop.Visible = false
                LeftSide.Visible = false
                BottomSide.Visible = false
                BottomDown.Visible = false
                RightTop.Visible = false
                RightSide.Visible = false
                BottomRightSide.Visible = false
                BottomRightDown.Visible = false
                Flag1.Visible = false
                Chams.Enabled = false
                Flag2.Visible = false
                if not plr then
                    ScreenGui:Destroy()
                    Connection:Disconnect()
                end
            end
            
            Connection = Euphoria.RunService.RenderStepped:Connect(function()
                if ESP.Enabled and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                    local HRP = plr.Character.HumanoidRootPart
                    local Humanoid = plr.Character:WaitForChild("Humanoid")
                    local Pos, OnScreen = Cam:WorldToScreenPoint(HRP.Position)
                    local Dist = (Cam.CFrame.Position - HRP.Position).Magnitude / 3.5714285714
                    
                    if OnScreen and Dist <= ESP.MaxDistance then
                        local Size = HRP.Size.Y
                        local scaleFactor = (Size * Cam.ViewportSize.Y) / (Pos.Z * 2)
                        local w, h = 3 * scaleFactor, 4.5 * scaleFactor

                        if ESP.FadeOut.OnDistance then
                            Functions:FadeOutOnDist(Box, Dist)
                            Functions:FadeOutOnDist(Outline, Dist)
                            Functions:FadeOutOnDist(Name, Dist)
                            Functions:FadeOutOnDist(Distance, Dist)
                            Functions:FadeOutOnDist(Weapon, Dist)
                            Functions:FadeOutOnDist(Healthbar, Dist)
                            Functions:FadeOutOnDist(BehindHealthbar, Dist)
                            Functions:FadeOutOnDist(HealthText, Dist)
                            Functions:FadeOutOnDist(WeaponIcon, Dist)
                            Functions:FadeOutOnDist(LeftTop, Dist)
                            Functions:FadeOutOnDist(LeftSide, Dist)
                            Functions:FadeOutOnDist(BottomSide, Dist)
                            Functions:FadeOutOnDist(BottomDown, Dist)
                            Functions:FadeOutOnDist(RightTop, Dist)
                            Functions:FadeOutOnDist(RightSide, Dist)
                            Functions:FadeOutOnDist(BottomRightSide, Dist)
                            Functions:FadeOutOnDist(BottomRightDown, Dist)
                            Functions:FadeOutOnDist(Chams, Dist)
                            Functions:FadeOutOnDist(Flag1, Dist)
                            Functions:FadeOutOnDist(Flag2, Dist)
                        end

                        if ESP.TeamCheck and plr ~= lplayer and ((lplayer.Team ~= plr.Team and plr.Team) or (not lplayer.Team and not plr.Team)) and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and plr.Character:FindFirstChild("Humanoid") then

                            do
                                Chams.Adornee = plr.Character
                                Chams.Enabled = ESP.Drawing.Chams.Enabled
                                Chams.FillColor = ESP.Drawing.Chams.FillRGB
                                Chams.OutlineColor = ESP.Drawing.Chams.OutlineRGB
                                do
                                    if ESP.Drawing.Chams.Thermal then
                                        local breathe_effect = math.atan(math.sin(tick() * 2)) * 2 / math.pi
                                        Chams.FillTransparency = ESP.Drawing.Chams.Fill_Transparency * breathe_effect * 0.01
                                        Chams.OutlineTransparency = ESP.Drawing.Chams.Outline_Transparency * breathe_effect * 0.01
                                    end
                                end
                                if ESP.Drawing.Chams.VisibleCheck then
                                    Chams.DepthMode = "Occluded"
                                else
                                    Chams.DepthMode = "AlwaysOnTop"
                                end
                            end

                            do
                                LeftTop.Visible = ESP.Drawing.Boxes.Corner.Enabled
                                LeftTop.Position = UDim2.new(0, Pos.X - w / 2, 0, Pos.Y - h / 2)
                                LeftTop.Size = UDim2.new(0, w / 5, 0, 1)
                                
                                LeftSide.Visible = ESP.Drawing.Boxes.Corner.Enabled
                                LeftSide.Position = UDim2.new(0, Pos.X - w / 2, 0, Pos.Y - h / 2)
                                LeftSide.Size = UDim2.new(0, 1, 0, h / 5)
                                
                                BottomSide.Visible = ESP.Drawing.Boxes.Corner.Enabled
                                BottomSide.Position = UDim2.new(0, Pos.X - w / 2, 0, Pos.Y + h / 2)
                                BottomSide.Size = UDim2.new(0, 1, 0, h / 5)
                                BottomSide.AnchorPoint = Vector2.new(0, 5)
                                
                                BottomDown.Visible = ESP.Drawing.Boxes.Corner.Enabled
                                BottomDown.Position = UDim2.new(0, Pos.X - w / 2, 0, Pos.Y + h / 2)
                                BottomDown.Size = UDim2.new(0, w / 5, 0, 1)
                                BottomDown.AnchorPoint = Vector2.new(0, 1)
                                
                                RightTop.Visible = ESP.Drawing.Boxes.Corner.Enabled
                                RightTop.Position = UDim2.new(0, Pos.X + w / 2, 0, Pos.Y - h / 2)
                                RightTop.Size = UDim2.new(0, w / 5, 0, 1)
                                RightTop.AnchorPoint = Vector2.new(1, 0)
                                
                                RightSide.Visible = ESP.Drawing.Boxes.Corner.Enabled
                                RightSide.Position = UDim2.new(0, Pos.X + w / 2 - 1, 0, Pos.Y - h / 2)
                                RightSide.Size = UDim2.new(0, 1, 0, h / 5)
                                RightSide.AnchorPoint = Vector2.new(0, 0)
                                
                                BottomRightSide.Visible = ESP.Drawing.Boxes.Corner.Enabled
                                BottomRightSide.Position = UDim2.new(0, Pos.X + w / 2, 0, Pos.Y + h / 2)
                                BottomRightSide.Size = UDim2.new(0, 1, 0, h / 5)
                                BottomRightSide.AnchorPoint = Vector2.new(1, 1)
                                
                                BottomRightDown.Visible = ESP.Drawing.Boxes.Corner.Enabled
                                BottomRightDown.Position = UDim2.new(0, Pos.X + w / 2, 0, Pos.Y + h / 2)
                                BottomRightDown.Size = UDim2.new(0, w / 5, 0, 1)
                                BottomRightDown.AnchorPoint = Vector2.new(1, 1)                                                            
                            end

                            do
                                Box.Position = UDim2.new(0, Pos.X - w / 2, 0, Pos.Y - h / 2)
                                Box.Size = UDim2.new(0, w, 0, h)
                                Box.Visible = ESP.Drawing.Boxes.Full.Enabled

                                if ESP.Drawing.Boxes.Filled.Enabled then
                                    Box.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                                    if ESP.Drawing.Boxes.GradientFill then
                                        Box.BackgroundTransparency = ESP.Drawing.Boxes.Filled.Transparency
                                    else
                                        Box.BackgroundTransparency = 1
                                    end
                                    Box.BorderSizePixel = 1
                                else
                                    Box.BackgroundTransparency = 1
                                end

                                RotationAngle = RotationAngle + (tick() - Tick) * ESP.Drawing.Boxes.RotationSpeed * math.cos(math.pi / 4 * tick() - math.pi / 2)
                                if ESP.Drawing.Boxes.Animate then
                                    Gradient1.Rotation = RotationAngle
                                    Gradient2.Rotation = RotationAngle
                                else
                                    Gradient1.Rotation = -45
                                    Gradient2.Rotation = -45
                                end
                                Tick = tick()
                            end

                            do  
                                local health = Humanoid.Health / Humanoid.MaxHealth
                                Healthbar.Visible = ESP.Drawing.Healthbar.Enabled
                                Healthbar.Position = UDim2.new(0, Pos.X - w / 2 - 6, 0, Pos.Y - h / 2 + h * (1 - health))  
                                Healthbar.Size = UDim2.new(0, ESP.Drawing.Healthbar.Width, 0, h * health)  
                                
                                BehindHealthbar.Visible = ESP.Drawing.Healthbar.Enabled
                                BehindHealthbar.Position = UDim2.new(0, Pos.X - w / 2 - 6, 0, Pos.Y - h / 2)  
                                BehindHealthbar.Size = UDim2.new(0, ESP.Drawing.Healthbar.Width, 0, h)

                                do
                                    if ESP.Drawing.Healthbar.HealthText then
                                        local healthPercentage = math.floor(Humanoid.Health / Humanoid.MaxHealth * 100)
                                        HealthText.Position = UDim2.new(0, Pos.X - w / 2 - 6, 0, Pos.Y - h / 2 + h * (1 - healthPercentage / 100) + 3)
                                        HealthText.Text = tostring(healthPercentage)
                                        HealthText.Visible = Humanoid.Health < Humanoid.MaxHealth
                                        if ESP.Drawing.Healthbar.Lerp then
                                            local color = health >= 0.75 and Color3.fromRGB(0, 255, 0) or health >= 0.5 and Color3.fromRGB(255, 255, 0) or health >= 0.25 and Color3.fromRGB(255, 170, 0) or Color3.fromRGB(255, 0, 0)
                                            HealthText.TextColor3 = color
                                        else
                                            HealthText.TextColor3 = ESP.Drawing.Healthbar.HealthTextRGB
                                        end
                                    end                        
                                end
                            end

                            do
                                Name.Visible = ESP.Drawing.Names.Enabled
                                if ESP.Options.Friendcheck and lplayer:IsFriendsWith(plr.UserId) then
                                    Name.Text = string.format('(<font color="rgb(%d, %d, %d)">F</font>) %s', ESP.Options.FriendcheckRGB.R * 255, ESP.Options.FriendcheckRGB.G * 255, ESP.Options.FriendcheckRGB.B * 255, plr.Name)
                                else
                                    Name.Text = string.format('(<font color="rgb(%d, %d, %d)">E</font>) %s', 255, 0, 0, plr.Name)
                                end
                                Name.Position = UDim2.new(0, Pos.X, 0, Pos.Y - h / 2 - 9)
                            end
                            
                            do
                                if ESP.Drawing.Distances.Enabled then
                                    if ESP.Drawing.Distances.Position == "Bottom" then
                                        Weapon.Position = UDim2.new(0, Pos.X, 0, Pos.Y + h / 2 + 18)
                                        WeaponIcon.Position = UDim2.new(0, Pos.X - 21, 0, Pos.Y + h / 2 + 15)
                                        Distance.Position = UDim2.new(0, Pos.X, 0, Pos.Y + h / 2 + 7)
                                        Distance.Text = string.format("%d meters", math.floor(Dist))
                                        Distance.Visible = true
                                    elseif ESP.Drawing.Distances.Position == "Text" then
                                        Weapon.Position = UDim2.new(0, Pos.X, 0, Pos.Y + h / 2 + 8)
                                        WeaponIcon.Position = UDim2.new(0, Pos.X - 21, 0, Pos.Y + h / 2 + 5)
                                        Distance.Visible = false
                                        if ESP.Options.Friendcheck and lplayer:IsFriendsWith(plr.UserId) then
                                            Name.Text = string.format('(<font color="rgb(%d, %d, %d)">F</font>) %s [%d]', ESP.Options.FriendcheckRGB.R * 255, ESP.Options.FriendcheckRGB.G * 255, ESP.Options.FriendcheckRGB.B * 255, plr.Name, math.floor(Dist))
                                        else
                                            Name.Text = string.format('(<font color="rgb(%d, %d, %d)">E</font>) %s [%d]', 255, 0, 0, plr.Name, math.floor(Dist))
                                        end
                                        Name.Visible = ESP.Drawing.Names.Enabled
                                    end
                                end
                            end

                            do
                                Weapon.Text = "none"
                                Weapon.Visible = ESP.Drawing.Weapons.Enabled
                            end                            
                        else
                            HideESP()
                        end
                    else
                        HideESP()
                    end
                else
                    HideESP()
                end
            end)
        end
        coroutine.wrap(Updater)()
    end
    
    do
        for _, v in pairs(Players:GetPlayers()) do
            if v.Name ~= lplayer.Name then
                coroutine.wrap(ESPFunc)(v)
            end      
        end
        
        Players.PlayerAdded:Connect(function(v)
            coroutine.wrap(ESPFunc)(v)
        end)
    end
end

local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

    Window:EditOpenButton({
        Title = "Paid user",
        Icon = "crown",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
        Draggable = true,
    })
    
    Window:Tag({
        Title = "付费版",
        Color = Color3.fromHex("#FFA500") 
    })
    
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)
    
    if not borderInitialized then
        spawn(function()
            wait(0.5)
            initializeRainbowBorder("糖果颜色", animationSpeed)
            wait(1)
            applyFontStyleToWindow(currentFontStyle)
        end)
    end
    
    local windowOpen = true
    
    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
    end)
    
    local originalOpenFunction = Window.Open
    Window.Open = function(...)
        windowOpen = true
        local result = originalOpenFunction(...)
        
        if borderInitialized and borderEnabled and not rainbowBorderAnimation then
            wait(0.1)
            startBorderAnimation(Window, animationSpeed)
        end
        
        return result
    end

    local KillAuraTab = Window:Tab({Title = "杀戮类", Icon = "swords", Locked = false})
    
    local MainGroup = KillAuraTab:Section({Title = "主要功能", Icon = "settings", Opened = true})
    
    MainGroup:Toggle({
        Title = "杀戮光环",
        Value = KillAuraSettings.Enabled,
        Callback = function(value)
            KillAuraSettings.Enabled = value
            WindUI:Notify({
                Title = "杀戮光环",
                Content = value and "Enabled" or "Disabled",
                Duration = 2,
                Icon = value and "check" or "x"
            })
        end
    })
    
    MainGroup:Toggle({
        Title = "使用武器冷却",
        Value = KillAuraSettings.UseWeaponCD,
        Callback = function(value)
            KillAuraSettings.UseWeaponCD = value
        end
    })
    
    MainGroup:Toggle({
        Title = "播放动画",
        Value = KillAuraSettings.PlayAnimation,
        Callback = function(value)
            KillAuraSettings.PlayAnimation = value
        end
    })
    
    MainGroup:Divider()
    
    MainGroup:Slider({
        Title = "攻击范围",
        Desc = "Set attack range",
        Value = { 
            Min = 5,
            Max = 30,
            Default = 15,
        },
        Callback = function(value)
            KillAuraSettings.Range = value
        end
    })
    
    MainGroup:Slider({
        Title = "冷却时间",
        Desc = "Set cooldown time",
        Value = { 
            Min = 0.1,
            Max = 1,
            Default = 0.35,
            Step = 0.05,
        },
        Callback = function(value)
            KillAuraSettings.Cooldown = value
        end
    })
    
    local AttackTypeOptions = {"单目标", "多目标"}
    MainGroup:Dropdown({
        Title = "攻击类型",
        Desc = "Select attack type",
        Values = AttackTypeOptions,
        Value = "Single Person",
        Callback = function(value)
            KillAuraSettings.Type = value
        end
    })
    
    local TeleportGroup = KillAuraTab:Section({Title = "传送类", Icon = "move", Opened = true})
    
    TeleportGroup:Toggle({
        Title = "启用传送",
        Value = KillAuraSettings.Teleport,
        Callback = function(value)
            KillAuraSettings.Teleport = value
        end
    })
    
    TeleportGroup:Slider({
        Title = "传送距离",
        Desc = "Set teleport distance",
        Value = { 
            Min = 1,
            Max = 20,
            Default = 10,
        },
        Callback = function(value)
            KillAuraSettings.TPRange = value
        end
    })
    
    local TPTypeOptions = {"背后", "上方", "环绕", "随机"}
    TeleportGroup:Dropdown({
        Title = "传送方位",
        Desc = "Select teleport mode",
        Values = TPTypeOptions,
        Value = "Behind",
        Callback = function(value)
            KillAuraSettings.TPType = value
        end
    })

    local ESPTab = Window:Tab({Title = "ESP", Icon = "eye", Locked = false})
    
    local ESPMainGroup = ESPTab:Section({Title = "基本设置", Icon = "settings", Opened = true})
    
    ESPMainGroup:Toggle({
        Title = "启用ESP",
        Value = ESP.Enabled,
        Callback = function(value)
            ESP.Enabled = value
        end
    })
    
    ESPMainGroup:Toggle({
        Title = "队伍检测",
        Value = ESP.TeamCheck,
        Callback = function(value)
            ESP.TeamCheck = value
        end
    })
    
    ESPMainGroup:Slider({
        Title = "最大距离",
        Desc = "Set max ESP distance",
        Value = { 
            Min = 50,
            Max = 500,
            Default = 200,
        },
        Callback = function(value)
            ESP.MaxDistance = value
        end
    })
    
    ESPMainGroup:Slider({
        Title = "字体大小",
        Desc = "Set ESP font size",
        Value = { 
            Min = 8,
            Max = 20,
            Default = 11,
        },
        Callback = function(value)
            ESP.FontSize = value
        end
    })
    
    ESPMainGroup:Divider()
    
    ESPMainGroup:Toggle({
        Title = "距离绘制",
        Value = ESP.FadeOut.OnDistance,
        Callback = function(value)
            ESP.FadeOut.OnDistance = value
        end
    })
    
    local ESPVisualGroup = ESPTab:Section({Title = "视觉设置", Icon = "palette", Opened = true})
    
    ESPVisualGroup:Toggle({
        Title = "显示名称",
        Value = ESP.Drawing.Names.Enabled,
        Callback = function(value)
            ESP.Drawing.Names.Enabled = value
        end
    })
    
    ESPVisualGroup:Toggle({
        Title = "显示距离",
        Value = ESP.Drawing.Distances.Enabled,
        Callback = function(value)
            ESP.Drawing.Distances.Enabled = value
        end
    })
    
    ESPVisualGroup:Toggle({
        Title = "显示武器",
        Value = ESP.Drawing.Weapons.Enabled,
        Callback = function(value)
            ESP.Drawing.Weapons.Enabled = value
        end
    })
    
    ESPVisualGroup:Toggle({
        Title = "显示血条",
        Value = ESP.Drawing.Healthbar.Enabled,
        Callback = function(value)
            ESP.Drawing.Healthbar.Enabled = value
        end
    })
    
    ESPVisualGroup:Toggle({
        Title = "显示方框",
        Value = ESP.Drawing.Boxes.Full.Enabled,
        Callback = function(value)
            ESP.Drawing.Boxes.Full.Enabled = value
        end
    })
    
    ESPVisualGroup:Toggle({
        Title = "显示边角",
        Value = ESP.Drawing.Boxes.Corner.Enabled,
        Callback = function(value)
            ESP.Drawing.Boxes.Corner.Enabled = value
        end
    })
    
    ESPVisualGroup:Toggle({
        Title = "显示颜色",
        Value = ESP.Drawing.Chams.Enabled,
        Callback = function(value)
            ESP.Drawing.Chams.Enabled = value
        end
    })
    
    ESPVisualGroup:Toggle({
        Title = "热感特效",
        Value = ESP.Drawing.Chams.Thermal,
        Callback = function(value)
            ESP.Drawing.Chams.Thermal = value
        end
    })
    
    ESPVisualGroup:Toggle({
        Title = "方框动画",
        Value = ESP.Drawing.Boxes.Animate,
        Callback = function(value)
            ESP.Drawing.Boxes.Animate = value
        end
    })

    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})
    
    local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})
    
    infoSection:Divider()
    
    infoSection:Paragraph({
        Title = "您当前的服务器为",
        Desc = tostring(game.PlaceId) .. "\n欢迎使用YG/TNINE",
        ThumbnailSize = 190,
    })
    
    infoSection:Paragraph({
        Title = "持续更新 有bug请提出来",
        ThumbnailSize = 190,
    })
    
    infoSection:Paragraph({
        Title = "作者:怀 凌乱",
        ThumbnailSize = 190,
    })
    
    
    local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
    
    Settings:Paragraph({
        Title = "UI设置",
        Desc = "绝妙二改WindUI",
        Image = "settings",
        ImageSize = 20,
        Color = "White"
    })
    
    Settings:Toggle({
        Title = "启用边框",
        Value = borderEnabled,
        Callback = function(value)
            borderEnabled = value
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Enabled = value
                    if value and windowOpen and not rainbowBorderAnimation then
                        startBorderAnimation(Window, animationSpeed)
                    elseif not value and rainbowBorderAnimation then
                        rainbowBorderAnimation:Disconnect()
                        rainbowBorderAnimation = nil
                    end
                    
                    WindUI:Notify({
                        Title = "边框",
                        Content = value and "已启用" or "已禁用",
                        Duration = 2,
                        Icon = value and "eye" or "eye-off"
                    })
                end
            end
        end
    })
    
    Settings:Toggle({
        Title = "启用字体颜色",
        Value = fontColorEnabled,
        Callback = function(value)
            fontColorEnabled = value
            applyFontColorsToWindow(currentFontColorScheme)
            
            WindUI:Notify({
                Title = "字体颜色",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "type" or "type"
            })
        end
    })
    
    Settings:Toggle({
        Title = "启用音效",
        Value = soundEnabled,
        Callback = function(value)
            soundEnabled = value
            WindUI:Notify({
                Title = "音效",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "volume-2" or "volume-x"
            })
        end
    })
    
    Settings:Toggle({
        Title = "启用背景模糊",
        Value = blurEnabled,
        Callback = function(value)
            blurEnabled = value
            applyBlurEffect(value)
            WindUI:Notify({
                Title = "背景模糊",
                Content = value and "已启用" or "已禁用",
                Duration = 2,
                Icon = value and "cloud-rain" or "cloud"
            })
        end
    })
    
    local colorSchemeNames = {}
    for name, _ in pairs(COLOR_SCHEMES) do
        table.insert(colorSchemeNames, name)
    end
    table.sort(colorSchemeNames)
    
    Settings:Dropdown({
        Title = "边框颜色方案",
        Desc = "选择喜欢的颜色组合",
        Values = colorSchemeNames,
        Value = "糖果颜色",
        Callback = function(value)
            currentBorderColorScheme = value
            local success = initializeRainbowBorder(value, animationSpeed)
            playSound()
        end
    })
    
    Settings:Dropdown({
        Title = "字体颜色方案",
        Desc = "选择文字颜色组合",
        Values = colorSchemeNames,
        Value = "彩虹颜色",
        Callback = function(value)
            currentFontColorScheme = value
            applyFontColorsToWindow(value)
            playSound()
        end
    })
    
    local fontOptions = {}
    for _, fontName in ipairs(FONT_STYLES) do
        local description = FONT_DESCRIPTIONS[fontName] or fontName
        table.insert(fontOptions, {text = description, value = fontName})
    end
    
    table.sort(fontOptions, function(a, b)
        return a.text < b.text
    end)
    
    local fontValues = {}
    local fontValueToName = {}
    for _, option in ipairs(fontOptions) do
        table.insert(fontValues, option.text)
        fontValueToName[option.text] = option.value
    end
    
    Settings:Dropdown({
        Title = "字体样式",
        Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
        Values = fontValues,
        Value = "标准粗体",
        Callback = function(value)
            local fontName = fontValueToName[value]
            if fontName then
                currentFontStyle = fontName
                local successCount, totalCount = applyFontStyleToWindow(fontName)
                playSound()
            end
        end
    })
    
    Settings:Slider({
        Title = "边框转动速度",
        Desc = "调整边框旋转的快慢",
        Value = { 
            Min = 1,
            Max = 10,
            Default = 5,
        },
        Callback = function(value)
            animationSpeed = value
            if rainbowBorderAnimation then
                rainbowBorderAnimation:Disconnect()
                rainbowBorderAnimation = nil
            end
            if borderEnabled then
                startBorderAnimation(Window, animationSpeed)
            end
            
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })
    
    Settings:Slider({
        Title = "UI整体缩放",
        Desc = "调整UI大小比例",
        Value = { 
            Min = 0.5,
            Max = 1.5,
            Default = 1,
        },
        Step = 0.1,
        Callback = function(value)
            uiScale = value
            applyUIScale(value)
            playSound()
        end
    })
    
    Settings:Divider()
    
    Settings:Slider({
        Title = "UI透明度",
        Desc = "调整整个UI的透明度",
        Value = { 
            Min = 0,
            Max = 1,
            Default = 0.2,
        },
        Step = 0.1,
        Callback = function(value)
            Window:ToggleTransparency(tonumber(value) > 0)
            WindUI.TransparencyValue = tonumber(value)
            playSound()
        end
    })
    
    Settings:Slider({
        Title = "调整UI宽度",
        Desc = "调整窗口的宽度",
        Value = { 
            Min = 500,
            Max = 800,
            Default = 600,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
            end
            playSound()
        end
    })
    
    Settings:Slider({
        Title = "调整UI高度",
        Desc = "调整窗口的高度",
        Value = { 
            Min = 300,
            Max = 600,
            Default = 400,
        },
        Callback = function(value)
            if Window.UIElements and Window.UIElements.Main then
                local currentWidth = Window.UIElements.Main.Size.X.Offset
                Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
            end
            playSound()
        end
    })
    
    Settings:Slider({
        Title = "边框粗细",
        Desc = "调整边框的粗细",
        Value = { 
            Min = 1,
            Max = 5,
            Default = 1.5,
        },
        Step = 0.5,
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
                if rainbowStroke then
                    rainbowStroke.Thickness = value
                end
            end
            playSound()
        end
    })
    
    Settings:Slider({
        Title = "圆角大小",
        Desc = "调整UI圆角的大小",
        Value = { 
            Min = 0,
            Max = 20,
            Default = 16,
        },
        Callback = function(value)
            local mainFrame = Window.UIElements and Window.UIElements.Main
            if mainFrame then
                local corner = mainFrame:FindFirstChildOfClass("UICorner")
                if not corner then
                    corner = Instance.new("UICorner")
                    corner.Parent = mainFrame
                end
                corner.CornerRadius = UDim.new(0, value)
            end
            playSound()
        end
    })
    
    Settings:Button({
        Title = "恢复UI到原位",
        Icon = "rotate-ccw",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
                playSound()
            end
        end
    })
    
    Settings:Button({
        Title = "重置UI大小",
        Icon = "maximize-2",
        Callback = function()
            if Window.UIElements and Window.UIElements.Main then
                Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
                playSound()
            end
        end
    })
    
    Settings:Button({
        Title = "随机字体",
        Icon = "shuffle",
        Callback = function()
            local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
            currentFontStyle = randomFont
            applyFontStyleToWindow(randomFont)
            playSound()
        end
    })
    
    Settings:Button({
        Title = "随机颜色",
        Icon = "palette",
        Callback = function()
            local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
            currentBorderColorScheme = randomColor
            initializeRainbowBorder(randomColor, animationSpeed)
            playSound()
        end
    })
    
    Settings:Divider()
    
    Settings:Button({
        Title = "刷新字体颜色",
        Icon = "refresh-cw",
        Callback = function()
            applyFontColorsToWindow(currentFontColorScheme)
            playSound()
        end
    })
    
    Settings:Button({
        Title = "刷新字体样式",
        Icon = "refresh-cw",
        Callback = function()
            local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
            playSound()
        end
    })
    
    Settings:Button({
        Title = "测试所有字体",
        Icon = "check-circle",
        Callback = function()
            local workingFonts = {}
            local totalFonts = #FONT_STYLES
            
            for i, fontName in ipairs(FONT_STYLES) do
                local success = pcall(function()
                    local test = Enum.Font[fontName]
                end)
                
                if success then
                    table.insert(workingFonts, fontName)
                end
            end
            playSound()
        end
    })
    
    Settings:Button({
        Title = "导出设置",
        Icon = "download",
        Callback = function()
            local settings = {
                font = currentFontStyle,
                borderColor = currentBorderColorScheme,
                fontSize = currentFontColorScheme,
                speed = animationSpeed,
                scale = uiScale
            }
            setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
            playSound()
        end
    })
    
    Window:OnClose(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        applyBlurEffect(false)
    end)
    
    Window:OnDestroy(function()
        windowOpen = false
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        for _, animation in pairs(fontColorAnimations) do
            animation:Disconnect()
        end
        fontColorAnimations = {}
        applyBlurEffect(false)
    end)
    
    task.spawn(KillAuraLoop)
    
    WindUI:Notify({
        Title = "YG/TNINE SCRIPT",
        Content = "脚本加载成功!",
        Duration = 3,
        Icon = "check"
    })
end

elseif game.PlaceId == 4639625707 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/dream77239/china-ui/refs/heads/main/China%20ui.lua"))()

local gradientColors = {
    "rgb(0, 255, 0)",
    "rgb(0, 230, 0)",
    "rgb(0, 210, 0)",
    "rgb(0, 190, 0)",
    "rgb(0, 170, 0)",
    "rgb(0, 150, 0)",
    "rgb(0, 140, 0)",
    "rgb(0, 130, 0)",
    "rgb(0, 120, 0)",
    "rgb(0, 110, 0)"
}

local username = game.Players.LocalPlayer.Name
local coloredUsername = ""
for i = 1, #username do
    local colorIndex = (i - 1) % #gradientColors + 1
    coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. username:sub(i, i) .. '</font>'
end

local version = "v1"
local coloredVersion = ""
for i = 1, #version do
    local colorIndex = (i - 1) % #gradientColors + 1
    coloredVersion = coloredVersion .. '<font color="' .. gradientColors[colorIndex] .. '">' .. version:sub(i, i) .. '</font>'
end

local Confirmed = false

WindUI:Popup({
    Title = '<font color="' .. gradientColors[1] .. '">作者:一野</font><font color="' .. gradientColors[5] .. '">(培根)</font>',
    IconThemed = true,
    Content = "尊敬的用户 " .. coloredUsername .. " \n您使用的 <font color='" .. gradientColors[1] .. "'>战争大亨</font><font color='" .. gradientColors[5] .. "'>付费版</font> 当前版本型号是: " .. coloredVersion .. "\n感谢你的大力支持在这里Tnine Hub祝你们新年快乐！",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = "战争大亨付费版",
        Icon = "sword",
        IconThemed = true,
        Author = "v1",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(300, 200),
        Transparent = true,
        Theme = "Dark",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/XxwanhexxX/UN/main/preview_png.png",
        BackgroundImageTransparency = 0.5,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "培根",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

    Window:EditOpenButton({
        Title = "战争大亨付费版",
        Icon = "sword",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 4,
        Color = ColorSequence.new(Color3.fromHex("00FF00")),
        Draggable = true,
    })

    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do  
                local color = Color3.fromHSV(hue, 0.8, 1)  
                Window:EditOpenButton({
                    Color = ColorSequence.new(color)
                })
                wait(0.04)  
            end
        end
    end)

    local A = Window:Tab({Title = "玩家", Icon = "rbxassetid://4335480896"})
    local B = Window:Tab({Title = "透视", Icon = "eye"})
    local C = Window:Tab({Title = "传送", Icon = "rbxassetid://3944688398"})
    local D = Window:Tab({Title = "自瞄", Icon = "rbxassetid://4483345998"})
    local E = Window:Tab({Title = "子追", Icon = "rbxassetid://4483345998"})
    local F = Window:Tab({Title = "攻击", Icon = "rbxassetid://4384392464"})
    local G = Window:Tab({Title = "修改", Icon = "rbxassetid://94831304996747"})
    local H = Window:Tab({Title = "内置", Icon = "settings"})
    local I = Window:Tab({Title = "自动", Icon = "rbxassetid://4450736564"})
    local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

    local playerSection = A:Section({Title = "主功能", Opened = true})

    playerSection:Slider({
        Title = "视野",
        Step = 1,
        Value = {Min = 10, Max = 180, Default = workspace.CurrentCamera.FieldOfView},
        Callback = function(FOV)
            getgenv().TargetFOV = FOV
            workspace.CurrentCamera.FieldOfView = FOV
            
            if not getgenv().FOVLoop then
                getgenv().FOVLoop = game:GetService("RunService").Heartbeat:Connect(function()
                    if workspace.CurrentCamera then
                        workspace.CurrentCamera.FieldOfView = getgenv().TargetFOV
                    end
                end)
                
                game.Players.LocalPlayer.CharacterAdded:Connect(function()
                    wait(1)
                    if workspace.CurrentCamera then
                        workspace.CurrentCamera.FieldOfView = getgenv().TargetFOV
                    end
                end)
            end
        end
    })

    playerSection:Toggle({
        Title = "穿墙",
        Value = false,
        Callback = function(state)
            if state then
                getgenv().noclipConnection = game:GetService("RunService").Stepped:Connect(function()
                    local LocalPlayer = game:GetService("Players").LocalPlayer
                    if LocalPlayer.Character then
                        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.CanCollide = false
                            end
                        end
                    end
                end)
            else
                if getgenv().noclipConnection then
                    getgenv().noclipConnection:Disconnect()
                    getgenv().noclipConnection = nil
                end
                
                local LocalPlayer = game:GetService("Players").LocalPlayer
                if LocalPlayer.Character then
                    for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = true
                        end
                    end
                end
            end
        end
    })

    playerSection:Toggle({
        Title = "快速互动",
        Value = false,
        Callback = function(state)
            if state then
                local ProximityPromptService = game:GetService("ProximityPromptService")
                
                getgenv().fastInteractionConnection = ProximityPromptService.PromptButtonHoldBegan:Connect(function(prompt)
                    prompt.HoldDuration = 0.01
                end)
                
                for _, prompt in pairs(workspace:GetDescendants()) do
                    if prompt:IsA("ProximityPrompt") then
                        prompt.HoldDuration = 0.01
                    end
                end
            else
                if getgenv().fastInteractionConnection then
                    getgenv().fastInteractionConnection:Disconnect()
                    getgenv().fastInteractionConnection = nil
                end
                
                for _, prompt in pairs(workspace:GetDescendants()) do
                    if prompt:IsA("ProximityPrompt") then
                        prompt.HoldDuration = 0.5
                    end
                end
            end
        end
    })

    playerSection:Divider({
        Text = "移动功能"
    })

    local walkSpeed = 150
    local walkMultiplier = 3
    playerSection:Toggle({
        Title = "移动开关",
        Value = false,
        Callback = function(state)
            getgenv().WalkEnabled = state
            if state then
                local function updateWalkSpeed()
                    local character = game.Players.LocalPlayer.Character
                    if character and character:FindFirstChild("Humanoid") then
                        character.Humanoid.WalkSpeed = walkSpeed * walkMultiplier
                    end
                end
                
                updateWalkSpeed()
                
                getgenv().WalkConnection = game.Players.LocalPlayer.CharacterAdded:Connect(function(newChar)
                    wait(1)
                    updateWalkSpeed()
                end)
                
                getgenv().WalkLoop = game:GetService("RunService").Heartbeat:Connect(function()
                    if getgenv().WalkEnabled then
                        updateWalkSpeed()
                    end
                end)
            else
                if getgenv().WalkConnection then
                    getgenv().WalkConnection:Disconnect()
                end
                if getgenv().WalkLoop then
                    getgenv().WalkLoop:Disconnect()
                end
                local character = game.Players.LocalPlayer.Character
                if character and character:FindFirstChild("Humanoid") then
                    character.Humanoid.WalkSpeed = 16
                end
            end
        end
    })

    playerSection:Slider({
        Title = "移动倍率",
        Step = 0.1,
        Value = {Min = 1, Max = 10, Default = 3},
        Callback = function(multiplier)
            walkMultiplier = multiplier
            if getgenv().WalkEnabled and game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
                game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = walkSpeed * walkMultiplier
            end
        end
    })

    playerSection:Toggle({
        Title = "跳跃高度开关",
        Value = false,
        Callback = function(state)
            getgenv().JumpHeightEnabled = state
            
            if state then
                local function updateJumpPower()
                    local character = game.Players.LocalPlayer.Character
                    if character and character:FindFirstChild("Humanoid") then
                        character.Humanoid.JumpPower = getgenv().JumpHeightValue or 50
                    end
                end
                
                updateJumpPower()
                
                getgenv().JumpConnection = game.Players.LocalPlayer.CharacterAdded:Connect(function(newChar)
                    wait(1)
                    updateJumpPower()
                end)
                
                getgenv().JumpLoop = game:GetService("RunService").Heartbeat:Connect(function()
                    if getgenv().JumpHeightEnabled then
                        updateJumpPower()
                    end
                end)
            else
                if getgenv().JumpConnection then
                    getgenv().JumpConnection:Disconnect()
                end
                if getgenv().JumpLoop then
                    getgenv().JumpLoop:Disconnect()
                end
                local character = game.Players.LocalPlayer.Character
                if character and character:FindFirstChild("Humanoid") then
                    character.Humanoid.JumpPower = 50
                end
            end
        end
    })

    playerSection:Slider({
        Title = "跳跃高度",
        Step = 1,
        Value = {Min = 50, Max = 500, Default = 100},
        Callback = function(height)
            getgenv().JumpHeightValue = height
            if getgenv().JumpHeightEnabled and game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
                game.Players.LocalPlayer.Character.Humanoid.JumpPower = height
            end
        end
    })

    playerSection:Divider({
        Text = "飞行功能"
    })

    local flySpeed = 150
    local flyMultiplier = 5
    playerSection:Slider({
        Title = "飞行速度",
        Step = 0.1,
        Value = {Min = 1, Max = 20, Default = 5},
        Callback = function(multiplier)
            flyMultiplier = multiplier
        end
    })

    playerSection:Toggle({
        Title = "飞行开关",
        Value = false,
        Callback = function(bak)
            getgenv().fly = bak
            if bak then
                local controlModule = require(game.Players.LocalPlayer.PlayerScripts:WaitForChild('PlayerModule'):WaitForChild("ControlModule"))
                local character = game.Players.LocalPlayer.Character
                if not character or not character:FindFirstChild("HumanoidRootPart") then return end
                
                local function setupFlight(character)
                    local hrp = character:FindFirstChild("HumanoidRootPart")
                    if not hrp then return end
                    
                    if hrp:FindFirstChild("VelocityHandler") then hrp.VelocityHandler:Destroy() end
                    if hrp:FindFirstChild("GyroHandler") then hrp.GyroHandler:Destroy() end
                    
                    local bv = Instance.new("BodyVelocity")
                    bv.Name = "VelocityHandler"
                    bv.Parent = hrp
                    bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
                    bv.Velocity = Vector3.new(0, 0, 0)
                    
                    local bg = Instance.new("BodyGyro")
                    bg.Name = "GyroHandler"
                    bg.Parent = hrp
                    bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
                    bg.P = 1000
                    bg.D = 50
                    
                    return bv, bg
                end
                
                local bv, bg = setupFlight(character)
                
                local camera = game.Workspace.CurrentCamera
                getgenv().FlyLoop = game:GetService("RunService").RenderStepped:Connect(function()
                    local currentCharacter = game.Players.LocalPlayer.Character
                    local hrp = currentCharacter and currentCharacter:FindFirstChild("HumanoidRootPart")
                    if currentCharacter and hrp and hrp:FindFirstChild("VelocityHandler") and hrp:FindFirstChild("GyroHandler") and getgenv().fly then
                        currentCharacter.Humanoid.PlatformStand = true
                        hrp.GyroHandler.CFrame = camera.CFrame
                        
                        local direction = controlModule:GetMoveVector()
                        local actualSpeed = flySpeed * flyMultiplier
                        
                        hrp.VelocityHandler.Velocity = Vector3.new()
                        if direction.X ~= 0 then
                            hrp.VelocityHandler.Velocity = hrp.VelocityHandler.Velocity + camera.CFrame.RightVector * (direction.X * actualSpeed)
                        end
                        if direction.Z ~= 0 then
                            hrp.VelocityHandler.Velocity = hrp.VelocityHandler.Velocity - camera.CFrame.LookVector * (direction.Z * actualSpeed)
                        end
                        if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.Space) then
                            hrp.VelocityHandler.Velocity = hrp.VelocityHandler.Velocity + Vector3.new(0, actualSpeed/2, 0)
                        end
                        if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.LeftShift) then
                            hrp.VelocityHandler.Velocity = hrp.VelocityHandler.Velocity - Vector3.new(0, actualSpeed/2, 0)
                        end
                    end
                end)
            else
                if getgenv().FlyLoop then
                    getgenv().FlyLoop:Disconnect()
                end
                local character = game.Players.LocalPlayer.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    local hrp = character.HumanoidRootPart
                    if hrp:FindFirstChild("VelocityHandler") then hrp.VelocityHandler:Destroy() end
                    if hrp:FindFirstChild("GyroHandler") then hrp.GyroHandler:Destroy() end
                    character.Humanoid.PlatformStand = false
                end
            end
        end
    })

    playerSection:Divider({
        Text = "空中行走"
    })

    playerSection:Toggle({
        Title = "空中行走开关",
        Value = false,
        Callback = function(state)
            getgenv().AirWalkEnabled = state
            
            if state then
                local character = game.Players.LocalPlayer.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    local hrp = character.HumanoidRootPart
                    getgenv().BodyPositionInstance = Instance.new("BodyPosition")
                    getgenv().BodyPositionInstance.Position = Vector3.new(hrp.Position.X, getgenv().AirWalkHeight or hrp.Position.Y, hrp.Position.Z)
                    getgenv().BodyPositionInstance.MaxForce = Vector3.new(0, 40000, 0)
                    getgenv().BodyPositionInstance.P = 10000
                    getgenv().BodyPositionInstance.Parent = hrp
                    
                    getgenv().AirWalkConnection = game.Players.LocalPlayer.CharacterAdded:Connect(function(newChar)
                        wait(1)
                        if getgenv().AirWalkEnabled and newChar:FindFirstChild("HumanoidRootPart") then
                            getgenv().BodyPositionInstance = Instance.new("BodyPosition")
                            getgenv().BodyPositionInstance.Position = Vector3.new(newChar.HumanoidRootPart.Position.X, getgenv().AirWalkHeight or newChar.HumanoidRootPart.Position.Y, newChar.HumanoidRootPart.Position.Z)
                            getgenv().BodyPositionInstance.MaxForce = Vector3.new(0, 40000, 0)
                            getgenv().BodyPositionInstance.Parent = newChar.HumanoidRootPart
                        end
                    end)
                    
                    getgenv().AirWalkLoop = game:GetService("RunService").Heartbeat:Connect(function()
                        if getgenv().AirWalkEnabled and character and character:FindFirstChild("HumanoidRootPart") and getgenv().BodyPositionInstance then
                            local hrp = character.HumanoidRootPart
                            getgenv().BodyPositionInstance.Position = Vector3.new(hrp.Position.X, getgenv().AirWalkHeight, hrp.Position.Z)
                        end
                    end)
                end
            else
                if getgenv().BodyPositionInstance then
                    getgenv().BodyPositionInstance:Destroy()
                    getgenv().BodyPositionInstance = nil
                end
                if getgenv().AirWalkConnection then
                    getgenv().AirWalkConnection:Disconnect()
                end
                if getgenv().AirWalkLoop then
                    getgenv().AirWalkLoop:Disconnect()
                end
            end
        end
    })

    playerSection:Slider({
        Title = "Y轴高度",
        Step = 1,
        Value = {Min = -100, Max = 500, Default = 50},
        Callback = function(height)
            getgenv().AirWalkHeight = height
            if getgenv().AirWalkEnabled and getgenv().BodyPositionInstance then
                local character = game.Players.LocalPlayer.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    local hrp = character.HumanoidRootPart
                    getgenv().BodyPositionInstance.Position = Vector3.new(hrp.Position.X, height, hrp.Position.Z)
                end
            end
        end
    })

    local espSection = B:Section({Title = "ESP设置", Opened = true})

    getgenv().ShowBox = false
    getgenv().ShowHealth = false
    getgenv().ShowName = false
    getgenv().ShowDistance = false
    getgenv().ShowTracer = false
    getgenv().TeamCheck = false
    getgenv().ShowSkeleton = false
    getgenv().ShowWeapon = false
    getgenv().ShowRadar = false

    getgenv().TracerColor = Color3.new(1, 1, 1)
    getgenv().SkeletonColor = Color3.new(0.2, 0.8, 1)
    getgenv().BoxColor = Color3.new(1, 1, 1)
    getgenv().HealthBarColor = Color3.new(0, 1, 0)
    getgenv().HealthTextColor = Color3.new(1, 1, 1)
    getgenv().NameColor = Color3.new(1, 1, 1)
    getgenv().DistanceColor = Color3.new(1, 1, 0)
    getgenv().WeaponColor = Color3.new(1, 0.5, 0)

    getgenv().BoxThickness = 1
    getgenv().TracerThickness = 1
    getgenv().SkeletonThickness = 2

    local ESPComponents = {}

    local function createESP(player)
        local box = Drawing.new("Square")
        box.Visible = false
        box.Color = getgenv().BoxColor
        box.Thickness = getgenv().BoxThickness
        box.Filled = false

        local healthBar = Drawing.new("Square")
        healthBar.Visible = false
        healthBar.Color = getgenv().HealthBarColor
        healthBar.Thickness = 1
        healthBar.Filled = true

        local healthBarBackground = Drawing.new("Square")
        healthBarBackground.Visible = false
        healthBarBackground.Color = Color3.new(0, 0, 0)
        healthBarBackground.Transparency = 0.5
        healthBarBackground.Thickness = 1
        healthBarBackground.Filled = true

        local healthBarBorder = Drawing.new("Square")
        healthBarBorder.Visible = false
        healthBarBorder.Color = Color3.new(1, 1, 1)
        healthBarBorder.Thickness = 1
        healthBarBorder.Filled = false

        local healthText = Drawing.new("Text")
        healthText.Visible = false
        healthText.Color = getgenv().HealthTextColor
        healthText.Size = 14
        healthText.Font = Drawing.Fonts.Monospace
        healthText.Outline = true
        healthText.OutlineColor = Color3.new(0, 0, 0)

        local nameText = Drawing.new("Text")
        nameText.Visible = false
        nameText.Color = getgenv().NameColor
        nameText.Size = 16
        nameText.Font = Drawing.Fonts.Monospace
        nameText.Outline = true
        nameText.OutlineColor = Color3.new(0, 0, 0)

        local distanceText = Drawing.new("Text")
        distanceText.Visible = false
        distanceText.Color = getgenv().DistanceColor
        distanceText.Size = 14
        distanceText.Font = Drawing.Fonts.Monospace
        distanceText.Outline = true
        distanceText.OutlineColor = Color3.new(0, 0, 0)

        local weaponText = Drawing.new("Text")
        weaponText.Visible = false
        weaponText.Color = getgenv().WeaponColor
        weaponText.Size = 14
        weaponText.Font = Drawing.Fonts.Monospace
        weaponText.Outline = true
        weaponText.OutlineColor = Color3.new(0, 0, 0)

        local tracer = Drawing.new("Line")
        tracer.Visible = false
        tracer.Color = getgenv().TracerColor
        tracer.Thickness = getgenv().TracerThickness

        local skeletonLines = {}
        local skeletonPoints = {}

        local function createSkeleton()
            for i = 1, 15 do
                skeletonLines[i] = Drawing.new("Line")
                skeletonLines[i].Visible = false
                skeletonLines[i].Color = getgenv().SkeletonColor
                skeletonLines[i].Thickness = getgenv().SkeletonThickness
            end

            skeletonPoints["Head"] = Drawing.new("Circle")
            skeletonPoints["Head"].Visible = false
            skeletonPoints["Head"].Color = getgenv().SkeletonColor
            skeletonPoints["Head"].Thickness = 0.1
            skeletonPoints["Head"].Filled = false
            skeletonPoints["Head"].Radius = 4
        end

        createSkeleton()

        ESPComponents[player] = {
            box = box,
            healthBar = healthBar,
            healthBarBackground = healthBarBackground,
            healthBarBorder = healthBarBorder,
            healthText = healthText,
            nameText = nameText,
            distanceText = distanceText,
            weaponText = weaponText,
            tracer = tracer,
            skeletonLines = skeletonLines,
            skeletonPoints = skeletonPoints
        }

        game:GetService("RunService").RenderStepped:Connect(function()
            local espEnabled = getgenv().ShowBox or getgenv().ShowHealth or getgenv().ShowName or 
                              getgenv().ShowDistance or getgenv().ShowTracer or getgenv().ShowSkeleton or 
                              getgenv().ShowWeapon
            
            if not espEnabled or not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") or not player.Character:FindFirstChild("Humanoid") or player == game.Players.LocalPlayer then
                box.Visible = false
                healthBar.Visible = false
                healthBarBackground.Visible = false
                healthBarBorder.Visible = false
                healthText.Visible = false
                nameText.Visible = false
                distanceText.Visible = false
                weaponText.Visible = false
                tracer.Visible = false
                for _, line in pairs(skeletonLines) do
                    line.Visible = false
                end
                for _, point in pairs(skeletonPoints) do
                    point.Visible = false
                end
                return
            end

            if getgenv().TeamCheck and player.Team == game.Players.LocalPlayer.Team then
                box.Visible = false
                healthBar.Visible = false
                healthBarBackground.Visible = false
                healthBarBorder.Visible = false
                healthText.Visible = false
                nameText.Visible = false
                distanceText.Visible = false
                weaponText.Visible = false
                tracer.Visible = false
                for _, line in pairs(skeletonLines) do
                    line.Visible = false
                end
                for _, point in pairs(skeletonPoints) do
                    point.Visible = false
                end
                return
            end

            local character = player.Character
            local rootPart = character:FindFirstChild("HumanoidRootPart")
            local humanoid = character:FindFirstChild("Humanoid")

            if rootPart and humanoid and humanoid.Health > 0 then
                local rootPos, onScreen = workspace.CurrentCamera:WorldToViewportPoint(rootPart.Position)
                local headPos, _ = workspace.CurrentCamera:WorldToViewportPoint(rootPart.Position + Vector3.new(0, 3, 0))
                local legPos, _ = workspace.CurrentCamera:WorldToViewportPoint(rootPart.Position - Vector3.new(0, 3, 0))

                local weaponName = "无武器"
                for _, tool in ipairs(character:GetChildren()) do
                    if tool:IsA("Tool") then
                        weaponName = tool.Name
                        break
                    end
                end

                if getgenv().ShowBox and onScreen then
                    box.Size = Vector2.new(1000 / rootPos.Z, headPos.Y - legPos.Y)
                    box.Position = Vector2.new(rootPos.X - box.Size.X / 2, rootPos.Y - box.Size.Y / 2)
                    box.Visible = true
                else
                    box.Visible = false
                end

                if getgenv().ShowHealth and onScreen then
                    local healthPercentage = humanoid.Health / humanoid.MaxHealth
                    local barWidth = 50
                    local barHeight = 5
                    local barX = headPos.X - barWidth / 2
                    local barY = headPos.Y - 20

                    healthBarBackground.Size = Vector2.new(barWidth, barHeight)
                    healthBarBackground.Position = Vector2.new(barX, barY)
                    healthBarBackground.Visible = true

                    healthBarBorder.Size = Vector2.new(barWidth, barHeight)
                    healthBarBorder.Position = Vector2.new(barX, barY)
                    healthBarBorder.Visible = true

                    healthBar.Size = Vector2.new(barWidth * healthPercentage, barHeight)
                    healthBar.Position = Vector2.new(barX, barY)
                    healthBar.Visible = true

                    healthText.Position = Vector2.new(barX + barWidth + 5, barY - 5)
                    healthText.Text = math.floor(humanoid.Health) .. "/" .. math.floor(humanoid.MaxHealth)
                    healthText.Visible = true
                else
                    healthBar.Visible = false
                    healthBarBackground.Visible = false
                    healthBarBorder.Visible = false
                    healthText.Visible = false
                end

                if getgenv().ShowName and onScreen then
                    nameText.Position = Vector2.new(headPos.X, headPos.Y - 35)
                    nameText.Text = player.Name
                    nameText.Visible = true
                else
                    nameText.Visible = false
                end

                if getgenv().ShowWeapon and onScreen then
                    weaponText.Position = Vector2.new(headPos.X, headPos.Y - 50)
                    weaponText.Text = weaponName
                    weaponText.Visible = true
                else
                    weaponText.Visible = false
                end

                if getgenv().ShowDistance and onScreen then
                    local distance = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - rootPart.Position).Magnitude
                    distanceText.Position = Vector2.new(headPos.X, headPos.Y + 10)
                    distanceText.Text = math.floor(distance) .. "m"
                    distanceText.Visible = true
                else
                    distanceText.Visible = false
                end

                if getgenv().ShowTracer then
                    local head = character:FindFirstChild("Head")
                    if head then
                        local headPos, onScreen = workspace.CurrentCamera:WorldToViewportPoint(head.Position)
                        if onScreen then
                            tracer.From = Vector2.new(workspace.CurrentCamera.ViewportSize.X / 2, workspace.CurrentCamera.ViewportSize.Y)
                            tracer.To = Vector2.new(headPos.X, headPos.Y)
                            tracer.Visible = true
                        else
                            tracer.Visible = false
                        end
                    else
                        tracer.Visible = false
                    end
                else
                    tracer.Visible = false
                end

                if getgenv().ShowSkeleton and onScreen then
                    local head = character:FindFirstChild("Head")
                    local torso = character:FindFirstChild("Torso") or character:FindFirstChild("UpperTorso")
                    local leftArm = character:FindFirstChild("Left Arm") or character:FindFirstChild("LeftUpperArm")
                    local rightArm = character:FindFirstChild("Right Arm") or character:FindFirstChild("RightUpperArm")
                    local leftLeg = character:FindFirstChild("Left Leg") or character:FindFirstChild("LeftUpperLeg")
                    local rightLeg = character:FindFirstChild("Right Leg") or character:FindFirstChild("RightUpperLeg")
                    
                    if head and torso and leftArm and rightArm and leftLeg and rightLeg then
                        local headPos = workspace.CurrentCamera:WorldToViewportPoint(head.Position)
                        local torsoPos = workspace.CurrentCamera:WorldToViewportPoint(torso.Position)
                        local leftArmPos = workspace.CurrentCamera:WorldToViewportPoint(leftArm.Position)
                        local rightArmPos = workspace.CurrentCamera:WorldToViewportPoint(rightArm.Position)
                        local leftLegPos = workspace.CurrentCamera:WorldToViewportPoint(leftLeg.Position)
                        local rightLegPos = workspace.CurrentCamera:WorldToViewportPoint(rightLeg.Position)

                        skeletonPoints["Head"].Position = Vector2.new(headPos.X, headPos.Y)
                        skeletonPoints["Head"].Visible = true

                        skeletonLines[1].From = Vector2.new(headPos.X, headPos.Y)
                        skeletonLines[1].To = Vector2.new(torsoPos.X, torsoPos.Y)
                        skeletonLines[1].Visible = true

                        skeletonLines[2].From = Vector2.new(torsoPos.X, torsoPos.Y)
                        skeletonLines[2].To = Vector2.new(leftArmPos.X, leftArmPos.Y)
                        skeletonLines[2].Visible = true

                        skeletonLines[3].From = Vector2.new(torsoPos.X, torsoPos.Y)
                        skeletonLines[3].To = Vector2.new(rightArmPos.X, rightArmPos.Y)
                        skeletonLines[3].Visible = true

                        skeletonLines[4].From = Vector2.new(torsoPos.X, torsoPos.Y)
                        skeletonLines[4].To = Vector2.new(leftLegPos.X, leftLegPos.Y)
                        skeletonLines[4].Visible = true

                        skeletonLines[5].From = Vector2.new(torsoPos.X, torsoPos.Y)
                        skeletonLines[5].To = Vector2.new(rightLegPos.X, rightLegPos.Y)
                        skeletonLines[5].Visible = true
                    else
                        for _, line in pairs(skeletonLines) do
                            line.Visible = false
                        end
                        for _, point in pairs(skeletonPoints) do
                            point.Visible = false
                        end
                    end
                else
                    for _, line in pairs(skeletonLines) do
                        line.Visible = false
                    end
                    for _, point in pairs(skeletonPoints) do
                        point.Visible = false
                    end
                end
            else
                box.Visible = false
                healthBar.Visible = false
                healthBarBackground.Visible = false
                healthBarBorder.Visible = false
                healthText.Visible = false
                nameText.Visible = false
                distanceText.Visible = false
                weaponText.Visible = false
                tracer.Visible = false
                for _, line in pairs(skeletonLines) do
                    line.Visible = false
                end
                for _, point in pairs(skeletonPoints) do
                    point.Visible = false
                end
            end
        end)
    end

    local Players = game:GetService("Players")
    local RunService = game:GetService("RunService")
    local Camera = workspace.CurrentCamera
    local LocalPlayer = Players.LocalPlayer

    local radar = Drawing.new("Circle")
    radar.Visible = false
    radar.Color = Color3.new(1, 1, 1)
    radar.Thickness = 2
    radar.Filled = false
    radar.Radius = 100
    radar.Position = Vector2.new(Camera.ViewportSize.X - 120, 120)

    local radarCenter = Drawing.new("Circle")
    radarCenter.Visible = false
    radarCenter.Color = Color3.new(1, 1, 1)
    radarCenter.Thickness = 2
    radarCenter.Filled = true
    radarCenter.Radius = 3
    radarCenter.Position = radar.Position

    local radarDirection = Drawing.new("Line")
    radarDirection.Visible = false
    radarDirection.Color = Color3.new(1, 1, 1)
    radarDirection.Thickness = 2

    local radarGridLines = {}
    for i = 1, 4 do
        radarGridLines[i] = Drawing.new("Line")
        radarGridLines[i].Visible = false
        radarGridLines[i].Color = Color3.new(0.5, 0.5, 0.5)
        radarGridLines[i].Thickness = 1
    end

    local radarRangeText = Drawing.new("Text")
    radarRangeText.Visible = false
    radarRangeText.Color = Color3.new(1, 1, 1)
    radarRangeText.Size = 14
    radarRangeText.Font = Drawing.Fonts.Monospace
    radarRangeText.Outline = true
    radarRangeText.OutlineColor = Color3.new(0, 0, 0)
    radarRangeText.Text = "100m"

    local radarPlayers = {}

    local function updateRadar()
        if not getgenv().ShowRadar then
            radar.Visible = false
            radarCenter.Visible = false
            radarDirection.Visible = false
            radarRangeText.Visible = false
            
            for _, line in pairs(radarGridLines) do
                line.Visible = false
            end
            
            for _, player in pairs(radarPlayers) do
                if player.dot then player.dot.Visible = false end
                if player.direction then player.direction.Visible = false end
                if player.name then player.name.Visible = false end
            end
            return
        end

        radar.Visible = true
        radarCenter.Visible = true
        radarDirection.Visible = true
        radarRangeText.Visible = true
        
        radarRangeText.Position = Vector2.new(radar.Position.X, radar.Position.Y + radar.Radius + 5)
        
        for i = 1, 4 do
            local angle = (i-1) * math.pi / 2
            radarGridLines[i].From = radar.Position
            radarGridLines[i].To = Vector2.new(
                radar.Position.X + math.cos(angle) * radar.Radius,
                radar.Position.Y + math.sin(angle) * radar.Radius
            )
            radarGridLines[i].Visible = true
        end
        
        radarDirection.From = radar.Position
        radarDirection.To = Vector2.new(radar.Position.X, radar.Position.Y - radar.Radius)

        for _, player in pairs(Players:GetPlayers()) do
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player ~= LocalPlayer then
                local rootPart = player.Character.HumanoidRootPart
                local relativePosition = rootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position
                
                local radarX = radar.Position.X + (relativePosition.X / 10)
                local radarY = radar.Position.Y + (relativePosition.Z / 10)
                
                local distanceFromCenter = math.sqrt((radarX - radar.Position.X)^2 + (radarY - radar.Position.Y)^2)
                
                if distanceFromCenter > radar.Radius then
                    local angle = math.atan2(radarY - radar.Position.Y, radarX - radar.Position.X)
                    radarX = radar.Position.X + math.cos(angle) * radar.Radius
                    radarY = radar.Position.Y + math.sin(angle) * radar.Radius
                end
                
                if not radarPlayers[player] then
                    radarPlayers[player] = {
                        dot = Drawing.new("Circle"),
                        direction = Drawing.new("Line"),
                        name = Drawing.new("Text")
                    }
                    
                    radarPlayers[player].dot.Thickness = 1
                    radarPlayers[player].dot.Filled = true
                    radarPlayers[player].dot.Radius = 4
                    
                    radarPlayers[player].direction.Thickness = 2
                    radarPlayers[player].direction.Visible = true
                    
                    radarPlayers[player].name.Size = 12
                    radarPlayers[player].name.Font = Drawing.Fonts.Monospace
                    radarPlayers[player].name.Outline = true
                    radarPlayers[player].name.OutlineColor = Color3.new(0, 0, 0)
                end
                
                if player.Team == LocalPlayer.Team then
                    radarPlayers[player].dot.Color = Color3.new(0, 1, 0)  
                    radarPlayers[player].direction.Color = Color3.new(0, 0.8, 0)
                    radarPlayers[player].name.Color = Color3.new(0, 1, 0)
                else
                    radarPlayers[player].dot.Color = Color3.new(1, 0, 0) 
                    radarPlayers[player].direction.Color = Color3.new(1, 0, 0)
                    radarPlayers[player].name.Color = Color3.new(1, 0, 0)
                end
                
                radarPlayers[player].dot.Position = Vector2.new(radarX, radarY)
                radarPlayers[player].dot.Visible = true
                
                local lookVector = rootPart.CFrame.LookVector
                local directionLength = 10
                radarPlayers[player].direction.From = Vector2.new(radarX, radarY)
                radarPlayers[player].direction.To = Vector2.new(
                    radarX + lookVector.X * directionLength,
                    radarY + lookVector.Z * directionLength
                )
                
                radarPlayers[player].name.Position = Vector2.new(radarX, radarY - 15)
                radarPlayers[player].name.Text = player.Name
                radarPlayers[player].name.Visible = distanceFromCenter <= radar.Radius
            elseif radarPlayers[player] then
                radarPlayers[player].dot.Visible = false
                radarPlayers[player].direction.Visible = false
                radarPlayers[player].name.Visible = false
            end
        end
        
        for player, components in pairs(radarPlayers) do
            if not Players:FindFirstChild(player.Name) then
                components.dot.Visible = false
                components.direction.Visible = false
                components.name.Visible = false
                radarPlayers[player] = nil
            end
        end
    end

    RunService.RenderStepped:Connect(updateRadar)

    for _, player in pairs(game:GetService("Players"):GetPlayers()) do
        if player ~= game.Players.LocalPlayer then
            createESP(player)
        end
    end

    game:GetService("Players").PlayerAdded:Connect(function(player)
        if player ~= game.Players.LocalPlayer then
            createESP(player)
        end
    end)

    game:GetService("Players").PlayerRemoving:Connect(function(player)
        if ESPComponents[player] then
            for _, component in pairs(ESPComponents[player]) do
                if typeof(component) == "table" then
                    for _, drawing in pairs(component) do
                        drawing:Remove()
                    end
                else
                    component:Remove()
                end
            end
            ESPComponents[player] = nil
        end
    end)

    espSection:Toggle({
        Title = "方框透视", 
        Value = false, 
        Callback = function(Value)
            getgenv().ShowBox = Value
        end
    })

    espSection:Toggle({
        Title = "血量显示", 
        Value = false, 
        Callback = function(Value)
            getgenv().ShowHealth = Value
        end
    })

    espSection:Toggle({
        Title = "名字显示", 
        Value = false, 
        Callback = function(Value)
            getgenv().ShowName = Value
        end
    })

    espSection:Toggle({
        Title = "距离显示", 
        Value = false, 
        Callback = function(Value)
            getgenv().ShowDistance = Value
        end
    })

    espSection:Toggle({
        Title = "武器显示", 
        Value = false, 
        Callback = function(Value)
            getgenv().ShowWeapon = Value
        end
    })

    espSection:Toggle({
        Title = "射线显示", 
        Value = false, 
        Callback = function(Value)
            getgenv().ShowTracer = Value
        end
    })

    espSection:Toggle({
        Title = "骨架显示", 
        Value = false, 
        Callback = function(Value)
            getgenv().ShowSkeleton = Value
        end
    })

    espSection:Toggle({
        Title = "雷达系统", 
        Value = false, 
        Callback = function(Value)
            getgenv().ShowRadar = Value
        end
    })

    espSection:Toggle({
        Title = "队友检查", 
        Value = false, 
        Callback = function(Value)
            getgenv().TeamCheck = Value
        end
    })

    local teleportSection = C:Section({Title = "基地传送", Opened = true})

    local Positions = {
        ["Alpha"] = CFrame.new(-1197, 65, -4790),
        ["Bravo"] = CFrame.new(-220, 65, -4919),
        ["Charlie"] = CFrame.new(797, 65, -4740),
        ["Delta"] = CFrame.new(2044, 65, -3984),
        ["Echo"] = CFrame.new(2742, 65, -3031),
        ["Foxtrot"] = CFrame.new(3045, 65, -1788),
        ["Golf"] = CFrame.new(3376, 65, -562),
        ["Hotel"] = CFrame.new(3290, 65, 587),
        ["Juliet"] = CFrame.new(2955, 65, 1804),
        ["Kilo"] = CFrame.new(2569, 65, 2926),
        ["Lima"] = CFrame.new(989, 65, 3419),
        ["Omega"] = CFrame.new(-319, 65, 3932),
        ["Romeo"] = CFrame.new(-1479, 65, 3722),
        ["Sierra"] = CFrame.new(-2528, 65, 2549),
        ["Tango"] = CFrame.new(-3018, 65, 1503),
        ["Victor"] = CFrame.new(-3587, 65, 634),
        ["Yankee"] = CFrame.new(-3957, 65, -287),
        ["Zulu"] = CFrame.new(-4049, 65, -1334)
    }

    local BaseList = {
        "Alpha", "Bravo", "Charlie", "Delta", "Echo", "Foxtrot", "Golf", "Hotel", 
        "Juliet", "Kilo", "Lima", "Omega", "Romeo", "Sierra", "Tango", "Victor", 
        "Yankee", "Zulu"
    }

    local selectedBase = nil

    local function TeleportToBase(baseName)
        local position = Positions[baseName]
        if position then
            local player = game.Players.LocalPlayer
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                player.Character.HumanoidRootPart.CFrame = position
                WindUI:Notify({
                    Title = "传送成功",
                    Content = "已传送到 " .. baseName .. " 基地",
                    Duration = 3,
                })
            end
        end
    end

    teleportSection:Dropdown({
        Title = "传送列表", 
        Values = BaseList, 
        Value = "", 
        Callback = function(baseName) 
            selectedBase = baseName
        end
    })

    teleportSection:Button({
        Title = "传送到目标基地",
        Callback = function()
            if selectedBase and selectedBase ~= "" then
                TeleportToBase(selectedBase)
            else
                WindUI:Notify({
                    Title = "提示",
                    Content = "请先选择一个基地",
                    Duration = 3,
                })
            end
        end
    })

    teleportSection:Divider({
        Text = "其他传送"
    })

    teleportSection:Button({
        Title = "返回基地",
        Callback = function()
            local player = game.Players.LocalPlayer
            local tycoon = workspace.Tycoon.Tycoons:FindFirstChild(player.leaderstats.Team.Value)
            if tycoon and tycoon:FindFirstChild("Essentials") and tycoon.Essentials:FindFirstChild("Spawn") then
                player.Character.HumanoidRootPart.CFrame = tycoon.Essentials.Spawn.CFrame
                WindUI:Notify({
                    Title = "传送成功",
                    Content = "已返回基地",
                    Duration = 3,
                })
            end
        end
    })

    teleportSection:Button({
        Title = "随机传送",
        Callback = function()
            local player = game.Players.LocalPlayer
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local randomPos = Vector3.new(math.random(-500, 500),100,math.random(-500, 500))
                player.Character.HumanoidRootPart.CFrame = CFrame.new(randomPos)
                WindUI:Notify({
                    Title = "传送成功",
                    Content = "已随机传送",
                    Duration = 3,
                })
            end
        end
    })

    teleportSection:Button({
        Title = "捕捉点",
        Callback = function()
            local pl = game.Players.LocalPlayer.Character.HumanoidRootPart
            local location = CFrame.new(-652.087158203125, 121.78434753417969, -1259.2510986328125)
            local Humanoid = game.Players.LocalPlayer.Character.Humanoid
            Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            wait(0.2)
            pl.CFrame = location
        end
    })

    teleportSection:Button({
        Title = "捕捉点高楼",
        Callback = function()
            local pl = game.Players.LocalPlayer.Character.HumanoidRootPart
            local location = CFrame.new(-216.8485565185547, 447.56982421875, -1514.64599609375)
            local Humanoid = game.Players.LocalPlayer.Character.Humanoid
            Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            wait(0.2)
            pl.CFrame = location
        end
    })

    local oilTeleportSection = C:Section({Title = "油桶传送", Opened = true})

    oilTeleportSection:Button({
        Title = "传送油桶1",
        Callback = function()
            local player = game.Players.LocalPlayer
            local character = player.Character
            local rootPart = character and character:FindFirstChild("HumanoidRootPart")
            local targetPart = workspace:FindFirstChild("Game Systems")
                and workspace["Game Systems"]:FindFirstChild("Warehouses")
                and workspace["Game Systems"].Warehouses:FindFirstChild("Dock Warehouse1")
                and workspace["Game Systems"].Warehouses["Dock Warehouse1"]["Oil Capture"]
                and workspace["Game Systems"].Warehouses["Dock Warehouse1"]["Oil Capture"]["Barrel Template"]
                and workspace["Game Systems"].Warehouses["Dock Warehouse1"]["Oil Capture"]["Barrel Template"].PromptPart

            if rootPart and targetPart then
                rootPart.CFrame = targetPart.CFrame
                WindUI:Notify({
                    Title = "传送成功",
                    Content = "已传送到油桶1",
                    Duration = 3,
                })
            else
                WindUI:Notify({
                    Title = "传送失败",
                    Content = "未找到油桶1",
                    Duration = 3,
                })
            end
        end
    })

    oilTeleportSection:Button({
        Title = "传送油桶2",
        Callback = function()
            local player = game.Players.LocalPlayer
            local character = player.Character
            local rootPart = character and character:FindFirstChild("HumanoidRootPart")
            local targetPart = workspace:FindFirstChild("Game Systems")
                and workspace["Game Systems"]:FindFirstChild("Warehouses")
                and workspace["Game Systems"].Warehouses:FindFirstChild("Oil Rig1")
                and workspace["Game Systems"].Warehouses["Oil Rig1"]["Oil Capture"]
                and workspace["Game Systems"].Warehouses["Oil Rig1"]["Oil Capture"]["Barrel Template"]
                and workspace["Game Systems"].Warehouses["Oil Rig1"]["Oil Capture"]["Barrel Template"].PromptPart

            if rootPart and targetPart then
                rootPart.CFrame = targetPart.CFrame
                WindUI:Notify({
                    Title = "传送成功",
                    Content = "已传送到油桶2",
                    Duration = 3,
                })
            else
                WindUI:Notify({
                    Title = "传送失败",
                    Content = "未找到油桶2",
                    Duration = 3,
                })
            end
        end
    })

    oilTeleportSection:Button({
        Title = "传送油桶3",
        Callback = function()
            local player = game.Players.LocalPlayer
            local character = player.Character
            local rootPart = character and character:FindFirstChild("HumanoidRootPart")
            local targetPart = workspace:FindFirstChild("Game Systems")
                and workspace["Game Systems"]:FindFirstChild("Warehouses")
                and workspace["Game Systems"].Warehouses:FindFirstChild("Oil Rig2")
                and workspace["Game Systems"].Warehouses["Oil Rig2"]["Oil Capture"]
                and workspace["Game Systems"].Warehouses["Oil Rig2"]["Oil Capture"]["Barrel Template"]
                and workspace["Game Systems"].Warehouses["Oil Rig2"]["Oil Capture"]["Barrel Template"].PromptPart

            if rootPart and targetPart then
                rootPart.CFrame = targetPart.CFrame
                WindUI:Notify({
                    Title = "传送成功",
                    Content = "已传送到油桶3",
                    Duration = 3,
                })
            else
                WindUI:Notify({
                    Title = "传送失败",
                    Content = "未找到油桶3",
                    Duration = 3,
                })
            end
        end
    })

    oilTeleportSection:Button({
        Title = "传送油桶4",
        Callback = function()
            local player = game.Players.LocalPlayer
            local character = player.Character
            local rootPart = character and character:FindFirstChild("HumanoidRootPart")
            local targetPart = workspace:FindFirstChild("Game Systems")
                and workspace["Game Systems"]:FindFirstChild("Warehouses")
                and workspace["Game Systems"].Warehouses:FindFirstChild("Oil Rig3")
                and workspace["Game Systems"].Warehouses["Oil Rig3"]["Oil Capture"]
                and workspace["Game Systems"].Warehouses["Oil Rig3"]["Oil Capture"]["Barrel Template"]
                and workspace["Game Systems"].Warehouses["Oil Rig3"]["Oil Capture"]["Barrel Template"].PromptPart

            if rootPart and targetPart then
                rootPart.CFrame = targetPart.CFrame
                WindUI:Notify({
                    Title = "传送成功",
                    Content = "已传送到油桶4",
                    Duration = 3,
                })
            else
                WindUI:Notify({
                    Title = "传送失败",
                    Content = "未找到油桶4",
                    Duration = 3,
                })
            end
        end
    })

    local aimbotSection = D:Section({Title = "自瞄设置", Opened = true})

    local fov = 50
    local maxDistance = 500
    local autoAimEnabled = false
    local fovVisible = false
    local ignoreCover = false
    local aimTarget = "敌对"
    local aimPosition = "Head"
    local rainbowEnabled = false
    local fovColor = Color3.new(1, 1, 1)

    local whitelistPlayers = {}
    local playerDropdown

    local FOVring = Drawing.new("Circle")
    FOVring.Visible = false
    FOVring.Thickness = 1
    FOVring.Color = fovColor
    FOVring.Filled = false
    FOVring.Radius = fov
    FOVring.Position = workspace.CurrentCamera.ViewportSize / 2

    local function refreshPlayerList()
        local playerList = {}
        for _, player in ipairs(game.Players:GetPlayers()) do
            if player ~= game.Players.LocalPlayer then
                table.insert(playerList, player.Name)
            end
        end
        playerDropdown:Refresh(playerList)
    end

    local function updateDrawings()
        FOVring.Position = workspace.CurrentCamera.ViewportSize / 2
    end

    local function lookAt(target)
        local lookVector = (target - workspace.CurrentCamera.CFrame.Position).unit
        local newCFrame = CFrame.new(workspace.CurrentCamera.CFrame.Position, workspace.CurrentCamera.CFrame.Position + lookVector)
        workspace.CurrentCamera.CFrame = workspace.CurrentCamera.CFrame:Lerp(newCFrame, 0.7)
    end

    local function getClosestPlayerInFOV(trg_part)
        local nearest = nil
        local last = math.huge
        local playerMousePos = workspace.CurrentCamera.ViewportSize / 2
        
        for _, player in ipairs(game.Players:GetPlayers()) do
            if whitelistPlayers[player.Name] then
                continue
            end
            
            if player ~= game.Players.LocalPlayer and (aimTarget == "全部" or player.Team ~= game.Players.LocalPlayer.Team) then
                local character = player.Character
                local humanoid = character and character:FindFirstChildOfClass("Humanoid")
                local part = character and character:FindFirstChild(trg_part)
                
                if part and humanoid and humanoid.Health > 0 then
                    local ePos, isVisible = workspace.CurrentCamera:WorldToViewportPoint(part.Position)
                    local distance = (Vector2.new(ePos.x, ePos.y) - playerMousePos).Magnitude
                    
                    if distance < last and isVisible and distance < fov then
                        if (part.Position - workspace.CurrentCamera.CFrame.Position).Magnitude <= tonumber(maxDistance) then
                            if not ignoreCover or #workspace.CurrentCamera:GetPartsObscuringTarget({part.Position}, {character, game.Players.LocalPlayer.Character}) == 0 then
                                last = distance
                                nearest = player
                            end
                        end
                    end
                end
            end
        end
        
        return nearest
    end

    game:GetService("RunService").RenderStepped:Connect(function()
        updateDrawings()
        
        if autoAimEnabled then
            local closestPlayer = getClosestPlayerInFOV(aimPosition)
            if closestPlayer and closestPlayer.Character and closestPlayer.Character:FindFirstChild(aimPosition) then
                lookAt(closestPlayer.Character[aimPosition].Position)
            end
        end
        
        if rainbowEnabled then
            local t = tick() * 2
            local r = math.abs(math.sin(t))
            local g = math.abs(math.sin(t + 2 * math.pi / 3))
            local b = math.abs(math.sin(t + 4 * math.pi / 3))
            FOVring.Color = Color3.new(r, g, b)
        end
    end)

    game.Players.PlayerAdded:Connect(function(player)
        wait(0.5)
        refreshPlayerList()
    end)

    game.Players.PlayerRemoving:Connect(function(player)
        wait(0.5)
        refreshPlayerList()
        if whitelistPlayers[player.Name] then
            whitelistPlayers[player.Name] = nil
        end
    end)

    aimbotSection:Toggle({
        Title = "玩家自瞄",
        Value = false,
        Callback = function(t)
            autoAimEnabled = t
        end
    })

    aimbotSection:Toggle({
        Title = "显示范围",
        Value = false,
        Callback = function(t)
            fovVisible = t
            FOVring.Visible = fovVisible
        end
    })

    aimbotSection:Toggle({
        Title = "掩体不瞄",
        Value = false,
        Callback = function(t)
            ignoreCover = t
        end
    })

    aimbotSection:Slider({
        Title = "自瞄范围",
        Step = 1,
        Value = {Min = 1, Max = 200, Default = 50},
        Callback = function(s)
            fov = tonumber(s)
            FOVring.Radius = fov
        end
    })

    aimbotSection:Slider({
        Title = "自瞄距离",
        Step = 1,
        Value = {Min = 1, Max = 10000, Default = 500},
        Callback = function(s)
            maxDistance = tonumber(s)
        end
    })

    aimbotSection:Slider({
        Title = "自瞄圈粗细",
        Step = 1,
        Value = {Min = 0.5, Max = 10, Default = 1},
        Callback = function(s)
            FOVring.Thickness = tonumber(s)
        end
    })

    aimbotSection:Dropdown({
        Title = "选择自瞄目标", 
        Values = {"敌对", "全部"}, 
        Value = "敌对", 
        Callback = function(value) 
            aimTarget = value 
        end
    })

    aimbotSection:Dropdown({
        Title = "选择自瞄位置", 
        Values = {"头部", "躯干"}, 
        Value = "头部", 
        Callback = function(value)
            if value == "头部" then
                aimPosition = "Head"
            elseif value == "躯干" then
                aimPosition = "Torso"
            end
        end
    })

    aimbotSection:Dropdown({
        Title = "选择圈的颜色", 
        Values = {"白", "红", "黄", "蓝", "绿", "青", "紫", "彩虹"}, 
        Value = "白", 
        Callback = function(value)
            if value == "彩虹" then
                rainbowEnabled = true
            else
                rainbowEnabled = false
                local colors = {
                    ["白"] = Color3.new(1, 1, 1),
                    ["红"] = Color3.new(1, 0, 0),
                    ["黄"] = Color3.new(1, 1, 0),
                    ["蓝"] = Color3.new(0, 0, 1),
                    ["绿"] = Color3.new(0, 1, 0),
                    ["青"] = Color3.new(0, 1, 1),
                    ["紫"] = Color3.new(1, 0, 1)
                }
                fovColor = colors[value]
                FOVring.Color = fovColor
            end
        end
    })

    playerDropdown = aimbotSection:Dropdown({
        Title = "忽略玩家(白名单)", 
        Values = {}, 
        Value = {}, 
        Multi = true, 
        AllowNone = true, 
        Callback = function(selectedPlayers) 
            whitelistPlayers = {}
            for _, playerName in ipairs(selectedPlayers) do
                whitelistPlayers[playerName] = true
            end
        end
    })

    aimbotSection:Button({
        Title = "刷新玩家列表",
        Callback = function()
            refreshPlayerList()
            WindUI:Notify({
                Title = "刷新成功",
                Content = "玩家列表已更新",
                Duration = 2,
            })
        end
    })

    refreshPlayerList()

    local bulletTrackSection = E:Section({Title = "子弹追踪设置", Opened = true})

    local bulletTrackEnabled = false
    local bulletTrackTarget = "头部"
    local bulletTrackWhitelist = {}
    local bulletTrackFOV = 50
    local bulletTrackShowFOV = false
    local bulletTrackFOVColor = Color3.new(1, 1, 1)
    local bulletTrackRainbow = false
    local oldHook = nil
    local currentPlayerList = {}

    local BulletTrackFOV = Drawing.new("Circle")
    BulletTrackFOV.Visible = false
    BulletTrackFOV.Thickness = 1
    BulletTrackFOV.Color = bulletTrackFOVColor
    BulletTrackFOV.Filled = false
    BulletTrackFOV.Radius = bulletTrackFOV
    BulletTrackFOV.Position = workspace.CurrentCamera.ViewportSize / 2

    local function getPlayerList()
        local players = {}
        for _, player in ipairs(game:GetService("Players"):GetPlayers()) do
            if player ~= game.Players.LocalPlayer then
                table.insert(players, player.Name)
            end
        end
        return players
    end

    currentPlayerList = getPlayerList()

    local function setupBulletTracking()
        local Workspace = game:GetService("Workspace")
        local Players = game:GetService("Players")
        local LocalPlayer = Players.LocalPlayer
        local Camera = Workspace.CurrentCamera
        
        local function isInFOV(playerCharacter)
            if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                return false
            end
            
            if bulletTrackFOV >= 200 then
                return true
            end
            
            local targetPart = nil
            if bulletTrackTarget == "头部" then
                targetPart = playerCharacter:FindFirstChild("Head")
            else
                targetPart = playerCharacter:FindFirstChild("HumanoidRootPart") or playerCharacter:FindFirstChild("Torso")
            end
            
            if not targetPart then return false end
            
            local targetPos, onScreen = Camera:WorldToViewportPoint(targetPart.Position)
            if not onScreen then return false end
            
            local screenCenter = Camera.ViewportSize / 2
            local targetScreenPos = Vector2.new(targetPos.X, targetPos.Y)
            local distance = (targetScreenPos - screenCenter).Magnitude
            
            return distance <= bulletTrackFOV
        end
        
        local function getClosestTarget()
            if not LocalPlayer.Character then return nil end
            if not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then return nil end
            
            local closestTarget = nil
            local closestDistance = math.huge
            
            for _, player in ipairs(Players:GetPlayers()) do
                if table.find(bulletTrackWhitelist, player.Name) then
                    continue
                end
                
                if player ~= LocalPlayer and player.Character then
                    local character = player.Character
                    local root = character:FindFirstChild("HumanoidRootPart")
                    local targetPart = nil
                    
                    if bulletTrackTarget == "头部" then
                        targetPart = character:FindFirstChild("Head")
                    else
                        targetPart = character:FindFirstChild("HumanoidRootPart") or character:FindFirstChild("Torso")
                    end
                    
                    local humanoid = character:FindFirstChildOfClass("Humanoid")
                    local forcefield = character:FindFirstChild("ForceField")
                    
                    if root and targetPart and humanoid and not forcefield and humanoid.Health > 0 then
                        if bulletTrackFOV < 200 and not isInFOV(character) then
                            continue
                        end
                        
                        local distance = (root.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                        if distance < closestDistance then
                            closestTarget = targetPart
                            closestDistance = distance
                        end
                    end
                end
            end
            
            return closestTarget
        end
        
        if not oldHook then
            oldHook = hookmetamethod(game, "__namecall", function(self, ...)
                local method = getnamecallmethod()
                local args = {...}
                
                if bulletTrackEnabled and method == "Raycast" and not checkcaller() then
                    local origin = args[1] or Camera.CFrame.Position
                    local closestTarget = getClosestTarget()
                    
                    if closestTarget then
                        return {
                            Instance = closestTarget,
                            Position = closestTarget.Position,
                            Normal = (origin - closestTarget.Position).Unit,
                            Material = Enum.Material.Plastic,
                            Distance = (closestTarget.Position - origin).Magnitude
                        }
                    end
                end
                
                return oldHook(self, ...)
            end)
        end
    end

    game:GetService("RunService").RenderStepped:Connect(function()
        BulletTrackFOV.Position = workspace.CurrentCamera.ViewportSize / 2
        BulletTrackFOV.Radius = bulletTrackFOV
        
        if bulletTrackRainbow then
            local t = tick() * 2
            local r = math.abs(math.sin(t))
            local g = math.abs(math.sin(t + 2 * math.pi / 3))
            local b = math.abs(math.sin(t + 4 * math.pi / 3))
            BulletTrackFOV.Color = Color3.new(r, g, b)
        else
            BulletTrackFOV.Color = bulletTrackFOVColor
        end
    end)

    bulletTrackSection:Toggle({
        Title = "子弹追踪总开关",
        Value = false,
        Callback = function(state)
            bulletTrackEnabled = state
            if state then
                setupBulletTracking()
                WindUI:Notify({
                    Title = "子弹追踪",
                    Content = "子弹追踪已开启",
                    Duration = 2,
                })
            else
                if oldHook then
                    hookmetamethod(game, "__namecall", oldHook)
                    oldHook = nil
                end
                WindUI:Notify({
                    Title = "子弹追踪",
                    Content = "子弹追踪已关闭",
                    Duration = 2,
                })
            end
        end
    })

    bulletTrackSection:Toggle({
        Title = "显示追踪范围",
        Value = false,
        Callback = function(state)
            bulletTrackShowFOV = state
            BulletTrackFOV.Visible = state
        end
    })

    bulletTrackSection:Slider({
        Title = "追踪范围大小",
        Step = 1,
        Value = {Min = 10, Max = 400, Default = 50},
        Callback = function(value)
            bulletTrackFOV = value
            BulletTrackFOV.Radius = value
        end
    })

    bulletTrackSection:Slider({
        Title = "追踪范围粗细",
        Step = 1,
        Value = {Min = 0.5, Max = 5, Default = 1},
        Callback = function(value)
            BulletTrackFOV.Thickness = value
        end
    })

    bulletTrackSection:Dropdown({
        Title = "追踪部位",
        Values = {"头部", "身体"},
        Value = "头部",
        Callback = function(value)
            bulletTrackTarget = value
        end
    })

    bulletTrackSection:Dropdown({
        Title = "追踪圈颜色",
        Values = {"白", "红", "黄", "蓝", "绿", "青", "紫", "彩虹"},
        Value = "白",
        Callback = function(value)
            if value == "彩虹" then
                bulletTrackRainbow = true
            else
                bulletTrackRainbow = false
                local colors = {
                    ["白"] = Color3.new(1, 1, 1),
                    ["红"] = Color3.new(1, 0, 0),
                    ["黄"] = Color3.new(1, 1, 0),
                    ["蓝"] = Color3.new(0, 0, 1),
                    ["绿"] = Color3.new(0, 1, 0),
                    ["青"] = Color3.new(0, 1, 1),
                    ["紫"] = Color3.new(1, 0, 1)
                }
                bulletTrackFOVColor = colors[value]
            end
        end
    })

    local whitelistDropdown = bulletTrackSection:Dropdown({
        Title = "追踪白名单(不追踪的玩家)",
        Values = currentPlayerList,
        Value = {},
        Multi = true,
        AllowNone = true,
        Callback = function(selectedPlayers)
            bulletTrackWhitelist = selectedPlayers or {}
            WindUI:Notify({
                Title = "子弹追踪",
                Content = "白名单已更新为",
                Duration = 3,
            })
        end
    })

    bulletTrackSection:Button({
        Title = "刷新玩家列表",
        Callback = function()
            currentPlayerList = getPlayerList()
            whitelistDropdown:Refresh(currentPlayerList)
            WindUI:Notify({
                Title = "子弹追踪",
                Content = "玩家列表已刷新",
                Duration = 2,
            })
        end
    })

    local attackSection = F:Section({Title = "攻击功能", Opened = true})

    local C_NPlayers = {}
    local Plr = game:GetService("Players")
    local LP = Plr.LocalPlayer
    local PlayerList = {}

    local function initializePlayerList()
        PlayerList = {}
        for _, player in ipairs(Plr:GetPlayers()) do
            if player ~= LP then
                table.insert(PlayerList, player.Name)
            end
        end
    end

    local function refreshAttackPlayerList()
        initializePlayerList()
        if excludeTargetsDropdown then
            excludeTargetsDropdown:Refresh(PlayerList)
        end
    end

    Plr.PlayerAdded:Connect(function(player)
        if player ~= LP then
            table.insert(PlayerList, player.Name)
            if excludeTargetsDropdown then
                excludeTargetsDropdown:Refresh(PlayerList)
            end
        end
    end)

    Plr.PlayerRemoving:Connect(function(player)
        local index = table.find(PlayerList, player.Name)
        if index then
            table.remove(PlayerList, index)
            local whitelistIndex = table.find(C_NPlayers, player.Name)
            if whitelistIndex then
                table.remove(C_NPlayers, whitelistIndex)
            end
            if excludeTargetsDropdown then
                excludeTargetsDropdown:Refresh(PlayerList)
            end
        end
    end)

    initializePlayerList()

    local excludeTargetsDropdown = attackSection:Dropdown({
        Title = "忽略玩家(白名单)", 
        Values = PlayerList, 
        Value = {}, 
        Multi = true, 
        AllowNone = true, 
        Callback = function(values) 
            C_NPlayers = values or {}
            WindUI:Notify({
                Title = "白名单列表",
                Content = "已设置 " .. #C_NPlayers .. " 个玩家为白名单",
                Duration = 3,
            })
        end
    })

    attackSection:Button({
        Title = "刷新玩家列表",
        Callback = function()
            refreshAttackPlayerList()
        end
    })

    attackSection:Button({
        Title = "获取RPG",
        Callback = function()
            local Players = game:GetService("Players")
            local Workspace = game:GetService("Workspace")
            local TweenService = game:GetService("TweenService")
            local LPlayer = Players.LocalPlayer
            
            if LPlayer.Character and LPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local HumanoidRootPart = LPlayer.Character.HumanoidRootPart
                local initialPosition = HumanoidRootPart.CFrame
                
                local function hasRPG() 
                    return LPlayer.Backpack:FindFirstChild("RPG") or LPlayer.Character:FindFirstChild("RPG") 
                end
                
                local function findClosestRPGGiver()
                    local closestRPGGiver = nil
                    local closestDistance = math.huge
                    
                    for _, tycoon in pairs(Workspace.Tycoon.Tycoons:GetChildren()) do
                        local rpgGiver = tycoon:FindFirstChild("PurchasedObjects") and tycoon.PurchasedObjects:FindFirstChild("RPG Giver")
                        if rpgGiver and rpgGiver:FindFirstChild("Prompt") and rpgGiver.Prompt:FindFirstChild("Weapon Giver") then
                            local part = rpgGiver:FindFirstChildWhichIsA("BasePart")
                            if part then
                                local distance = (HumanoidRootPart.Position - part.Position).Magnitude
                                if distance < closestDistance then
                                    closestDistance = distance
                                    closestRPGGiver = rpgGiver
                                end
                            end
                        end
                    end
                    return closestRPGGiver
                end
                
                local function teleportTo(targetCFrame)
                    local tweenInfo = TweenInfo.new(0.1, Enum.EasingStyle.Linear)
                    local tween = TweenService:Create(HumanoidRootPart, tweenInfo, {CFrame = targetCFrame})
                    tween:Play()
                    tween.Completed:Wait()
                end
                
                local function activatePrompt(prompt)
                    if prompt then
                        prompt.MaxActivationDistance = 10
                        fireproximityprompt(prompt)
                    end
                end
                
                local function collectRPG()
                    local closestRPGGiver = findClosestRPGGiver()
                    if not closestRPGGiver then 
                        WindUI:Notify({
                            Title = "ERROR",
                            Content = "未能找到附近的RPG",
                            Duration = 4,
                        })
                        return 
                    end
                    
                    local part = closestRPGGiver:FindFirstChildWhichIsA("BasePart")
                    if part then
                        teleportTo(part.CFrame + Vector3.new(3, 0, 0))
                        task.wait(0.5)
                        
                        local prompt = closestRPGGiver.Prompt:FindFirstChild("Weapon Giver")
                        activatePrompt(prompt)
                        
                        local timeout = 0
                        while not hasRPG() and timeout < 50 do
                            activatePrompt(prompt)
                            task.wait(0.1)
                            timeout = timeout + 1
                        end
                        
                        if hasRPG() then
                            WindUI:Notify({
                                Title = "成功",
                                Content = "已获取RPG",
                                Duration = 3,
                            })
                        else
                            WindUI:Notify({
                                Title = "失败",
                                Content = "获取RPG超时",
                                Duration = 3,
                            })
                        end
                    end
                    teleportTo(initialPosition)
                end
                
                if not hasRPG() then 
                    collectRPG() 
                else 
                    WindUI:Notify({
                        Title = "提示",
                        Content = "已经拥有RPG",
                        Duration = 3,
                    })
                end
            end
        end
    })

    local loopActive = false
    local rpgAttackThread = nil

    attackSection:Toggle({
        Title = "RPG轰炸",
        Value = false,
        Callback = function(t)
            loopActive = t
            
            if t then
                if rpgAttackThread then
                    coroutine.close(rpgAttackThread)
                    rpgAttackThread = nil
                end
                
                rpgAttackThread = coroutine.create(function()
                    local Players = game:GetService("Players")
                    local LocalPlayer = Players.LocalPlayer
                    local ReplicatedStorage = game:GetService("ReplicatedStorage")
                    local RocketSystem = ReplicatedStorage:WaitForChild("RocketSystem")
                    local FireRocket = RocketSystem.Events.FireRocket
                    local RocketHit = RocketSystem.Events.RocketHit
                    local attackPhase = "attack"
                    local phaseStartTime = os.clock()
                    
                    while loopActive do
                        local currentTime = os.clock()
                        local elapsed = currentTime - phaseStartTime
                        
                        if not loopActive then break end
                        
                        if attackPhase == "attack" then
                            if elapsed >= 3 then
                                attackPhase = "pause"
                                phaseStartTime = os.clock()
                            else
                                local character = LocalPlayer.Character
                                if character and character:FindFirstChild("HumanoidRootPart") then
                                    local attackPosition = character.HumanoidRootPart.Position + Vector3.new(0, 1000, 0)
                                    local weapon = character:FindFirstChild("RPG")
                                    
                                    if weapon then
                                        for _, player in ipairs(Players:GetPlayers()) do
                                            if player ~= LocalPlayer and player.Character and not table.find(C_NPlayers, player.Name) then
                                                local target = player.Character:FindFirstChild("HumanoidRootPart")
                                                if target then
                                                    FireRocket:InvokeServer(Vector3.new(), weapon, weapon, attackPosition)
                                                    RocketHit:FireServer(attackPosition, Vector3.new(), weapon, weapon, target, nil, "asdfghvcqawRocket4")
                                                    task.wait(0.3)
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        elseif attackPhase == "pause" then
                            if elapsed >= 2 then
                                attackPhase = "attack"
                                phaseStartTime = os.clock()
                            end
                        end
                        
                        task.wait(0.1)
                    end
                end)
                
                coroutine.resume(rpgAttackThread)
            else
                if rpgAttackThread then
                    coroutine.close(rpgAttackThread)
                    rpgAttackThread = nil
                end
            end
        end
    })

    local shieldAttackActive = false
    local shieldAttackThread = nil

    attackSection:Toggle({
        Title = "攻击护盾",
        Value = false,
        Callback = function(t)
            shieldAttackActive = t
            
            if t then
                if shieldAttackThread then
                    coroutine.close(shieldAttackThread)
                    shieldAttackThread = nil
                end
                
                shieldAttackThread = coroutine.create(function()
                    while shieldAttackActive do
                        if not shieldAttackActive then break end
                        
                        local rpg = LP.Character and LP.Character:FindFirstChild("RPG")
                        if not rpg then
                            task.wait(1)
                            continue
                        end
                        
                        local attackPosition = LP.Character.HumanoidRootPart.Position + Vector3.new(0, 1000, 0)
                        local tycoonFolder = workspace:WaitForChild("Tycoon"):WaitForChild("Tycoons")
                        
                        for _, tycoon in ipairs(tycoonFolder:GetChildren()) do
                            if not shieldAttackActive then break end
                            
                            if tycoon:FindFirstChild("Owner") and tycoon.Owner.Value ~= LP then
                                local shield = tycoon:FindFirstChild("PurchasedObjects", true) and
                                              tycoon.PurchasedObjects:FindFirstChild("Base Shield", true) and
                                              tycoon.PurchasedObjects["Base Shield"]:FindFirstChild("Shield", true) and
                                              tycoon.PurchasedObjects["Base Shield"].Shield:FindFirstChild("Shield4", true)
                                
                                if shield then
                                    local fireArgs = { Vector3.new(0, 0, 0), rpg, rpg, attackPosition }
                                    
                                    for _ = 1, 2 do
                                        local hitArgs = {attackPosition, Vector3.new(0, -1, 0), rpg, rpg, shield, nil, string.format("%sRocket%d", string.char(math.random(65, 90)), math.random(1, 1000))}
                                        RocketSystem.Events.RocketHit:FireServer(unpack(hitArgs))
                                        RocketSystem.Events.FireRocket:InvokeServer(unpack(fireArgs))
                                        task.wait(0.3)
                                    end
                                end
                            end
                        end
                        
                        task.wait(0.3)
                    end
                end)
                
                coroutine.resume(shieldAttackThread)
            else
                if shieldAttackThread then
                    coroutine.close(shieldAttackThread)
                    shieldAttackThread = nil
                end
            end
        end
    })

    local modifySection = G:Section({Title = "武器修改", Opened = true})

    modifySection:Paragraph({
        Title = "关于",
        Desc = "功能在下\n \n使用教程\n 先把你要改的枪拿手里打开无限子弹 然后给你要改的强进行换弹然后切枪三次就行了\n 死了的话或者换枪的话依旧这样",
    })

    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    local gunEnabled = false
    local gunConnection = nil
    local deathConnection = nil
    local originalGunData = {}

    local function modifyGuns()
        for i, v in next, getgc(false) do
            if typeof(v) == "function" then
                local info = getinfo(v)
                if tostring(info.name) == "fireGun" then
                    local gunTable = getupvalue(v, 1)
                    
                    if not originalGunData[gunTable] then
                        originalGunData[gunTable] = {}
                        for key, value in pairs(gunTable) do
                            if typeof(value) ~= "function" then
                                originalGunData[gunTable][key] = value
                            end
                        end
                        
                        for key, value in pairs(gunTable) do
                            if typeof(value) == "table" then
                                originalGunData[gunTable][key] = {}
                                for subKey, subValue in pairs(value) do
                                    originalGunData[gunTable][key][subKey] = subValue
                                end
                            end
                        end
                    end
                    
                    rawset(gunTable, "Ammo", math.huge)
                    rawset(gunTable, "Distance", math.huge)
                    rawset(gunTable, "BSpeed", 9999)
                    rawset(gunTable, "BDrop", 0)
                    rawset(gunTable, "FireRate", 2000)
                    rawset(gunTable, "MaxSpread", 0)
                    rawset(gunTable, "MinSpread", 0)
                    rawset(gunTable.FireModes, "Auto", true)
                    rawset(gunTable.FireModes, "Semi", true)
                    rawset(gunTable.FireModes, "ChangeFiremode", true)
                    rawset(gunTable, "MinRecoilPower", 0)
                    rawset(gunTable, "MaxRecoilPower", 0)
                    rawset(gunTable, "RecoilPowerStepAmount", 0)
                    rawset(gunTable, "RecoilPunch", 0)
                    rawset(gunTable, "DPunchBase", 0)
                    rawset(gunTable, "AimRecover", 1)
                    rawset(gunTable, "HPunchBase", 0)
                    rawset(gunTable, "VPunchBase", 0)
                    rawset(gunTable, "PunchRecover", 1)
                    rawset(gunTable, "SwayBase", 0)
                    rawset(gunTable, "AimRecoilReduction", math.huge)
                    
                    for key, value in next, gunTable do
                        if typeof(value) == "table" then
                            for subKey, subValue in next, value do
                                if typeof(subValue) == "number" then
                                    rawset(value, subKey, 0)
                                end
                            end
                        end
                    end
                end
            end
        end
    end

    local function resetGuns()
        for gunTable, data in pairs(originalGunData) do
            for key, value in pairs(data) do
                if typeof(value) == "table" then
                    if gunTable[key] then
                        for subKey, subValue in pairs(value) do
                            rawset(gunTable[key], subKey, subValue)
                        end
                    end
                else
                    rawset(gunTable, key, value)
                end
            end
        end
        originalGunData = {}
    end

    local function onCharacterDeath()
        resetGuns()
        
        if gunEnabled then
            LocalPlayer.CharacterAdded:Wait()
            task.wait(1)
            modifyGuns()
        end
    end

    local function setupDeathListener()
        if deathConnection then
            deathConnection:Disconnect()
            deathConnection = nil
        end
        
        deathConnection = LocalPlayer.CharacterAdded:Connect(function(char)
            local humanoid = char:WaitForChild("Humanoid")
            humanoid.Died:Connect(onCharacterDeath)
        end)
        
        if LocalPlayer.Character then
            local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.Died:Connect(onCharacterDeath)
            end
        end
    end

    modifySection:Toggle({
        Title = "子弹无限+射速",
        Value = false,
        Callback = function(value)
            gunEnabled = value
            
            if value then
                if LocalPlayer.Character then
                    modifyGuns()
                end
                
                setupDeathListener()
                
                if gunConnection then
                    gunConnection:Disconnect()
                end
                
                gunConnection = LocalPlayer.CharacterAdded:Connect(function()
                    if gunEnabled then
                        task.wait(1)
                        modifyGuns()
                        setupDeathListener()
                    end
                end)
            else
                resetGuns()
                
                if gunConnection then
                    gunConnection:Disconnect()
                    gunConnection = nil
                end
                
                if deathConnection then
                    deathConnection:Disconnect()
                    deathConnection = nil
                end
            end
        end
    })

    modifySection:Toggle({
        Title = "getgc改（不推荐）",
        Value = false,
        Callback = function(value)
            for _,v in next,getgc(false) do
                if typeof(v)=="function"then
                    local info=debug.getinfo(v)
                    if tostring(info.name)=="fireGun"then
                        local tab=debug.getupvalue(v,1)
                        if value then
                            rawset(tab,"Ammo",math.huge)
                            rawset(tab,"Distance",math.huge)
                            rawset(tab,"BSpeed",99999)
                            rawset(tab,"BDrop",0)
                            rawset(tab,"FireRate",2000)
                            rawset(tab,"MaxSpread",0)
                            rawset(tab,"MinSpread",0)
                            rawset(tab.FireModes,"Auto",true)
                            rawset(tab.FireModes,"Semi",true)
                            rawset(tab.FireModes,"ChangeFiremode",true)
                            rawset(tab,"MinRecoilPower",0)
                            rawset(tab,"MaxRecoilPower",0)
                            rawset(tab,"RecoilPowerStepAmount",0)
                            rawset(tab,"RecoilPunch",0)
                            rawset(tab,"DPunchBase",0)
                            rawset(tab,"AimRecover",1)
                            rawset(tab,"HPunchBase",0)
                            rawset(tab,"VPunchBase",0)
                            rawset(tab,"PunchRecover",1)
                            rawset(tab,"SwayBase",0)
                            rawset(tab,"AimRecoilReduction",math.huge)
                            for i,v in next,tab do
                                if typeof(v)=="table"then
                                    for i,v in next,v do
                                        if typeof(v)=="number"then
                                            v=0
                                        end
                                    end
                                end
                            end
                        else
                            rawset(tab,"Ammo",30)
                            rawset(tab,"Distance",100)
                            rawset(tab,"BSpeed",500)
                            rawset(tab,"BDrop",0.5)
                            rawset(tab,"FireRate",60)
                            rawset(tab,"MaxSpread",0.1)
                            rawset(tab,"MinSpread",0.05)
                            rawset(tab.FireModes,"Auto",false)
                            rawset(tab.FireModes,"Semi",true)
                            rawset(tab.FireModes,"ChangeFiremode",true)
                            rawset(tab,"MinRecoilPower",0.5)
                            rawset(tab,"MaxRecoilPower",1.5)
                            rawset(tab,"RecoilPowerStepAmount",0.1)
                            rawset(tab,"RecoilPunch",0.5)
                            rawset(tab,"DPunchBase",0.3)
                            rawset(tab,"AimRecover",0.5)
                            rawset(tab,"HPunchBase",0.2)
                            rawset(tab,"VPunchBase",0.2)
                            rawset(tab,"PunchRecover",0.5)
                            rawset(tab,"SwayBase",0.1)
                            rawset(tab,"AimRecoilReduction",0.3)
                        end
                    end
                end
            end
        end
    })

    local builtinSection = H:Section({Title = "内置功能", Opened = true})

    builtinSection:Divider({
        Text = "其他"
    })

    local blockFDMG = false
    local oldNamecall = nil
    local isHookActive = false

    local function initHook()
        if isHookActive then return end
        
        oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
            if blockFDMG and getnamecallmethod() == "FireServer" and tostring(self) == "FDMG" then
                return nil
            end
            return oldNamecall(self, ...)
        end)
        
        isHookActive = true
    end

    local function removeHook()
        if not isHookActive or not oldNamecall then return end
        
        hookmetamethod(game, "__namecall", oldNamecall)
        oldNamecall = nil
        isHookActive = false
    end

    builtinSection:Toggle({
        Title = "摔落无伤害",
        Value = false,
        Callback = function(value)
            blockFDMG = value
            
            if value then
                if not isHookActive then
                    initHook()
                end
            else
                if isHookActive then
                    removeHook()
                end
            end
        end
    })

    builtinSection:Button({
        Title = "删除所有门",
        Callback = function()
           for k,v in pairs(workspace.Tycoon.Tycoons:GetChildren()) do
                for x,y in pairs(v.PurchasedObjects:GetChildren()) do
                    if(y.Name:find("Door") or y.Name:find("Gate")) then y:destroy(); end;
                end;
            end;
        end
    })

    builtinSection:Divider()

    builtinSection:Toggle({
        Title = "死后原地重生",
        Value = false,
        Callback = function(state)
            getgenv().respawnAtDeathPosition = state
            
            local deathPosition = nil
            local deathOrientation = nil
            
            local function setupDeathTracking()
                local player = game.Players.LocalPlayer
                
                player.CharacterAdded:Connect(function(character)
                    local humanoid = character:WaitForChild("Humanoid")
                    
                    humanoid.Died:Connect(function()
                        local rootPart = character:FindFirstChild("HumanoidRootPart")
                        if rootPart then
                            deathPosition = rootPart.Position
                            deathOrientation = rootPart.CFrame - rootPart.Position
                        end
                    end)
                end)
                
                if player.Character then
                    local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
                    if humanoid then
                        humanoid.Died:Connect(function()
                            local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
                            if rootPart then
                                deathPosition = rootPart.Position
                                deathOrientation = rootPart.CFrame - rootPart.Position
                            end
                        end)
                    end
                end
            end
            
            setupDeathTracking()
            
            game.Players.LocalPlayer.CharacterAdded:Connect(function(character)
                if getgenv().respawnAtDeathPosition and deathPosition then
                    local humanoidRootPart = character:WaitForChild("HumanoidRootPart", 5)
                    local humanoid = character:WaitForChild("Humanoid", 5)
                    
                    if humanoidRootPart and humanoid then
                        wait(0.5)
                        humanoidRootPart.CFrame = CFrame.new(deathPosition) * deathOrientation
                        deathPosition = nil
                        deathOrientation = nil
                    end
                end
            end)
        end
    })

    builtinSection:Divider()

    builtinSection:Toggle({
        Title = "删除死亡镜头",
        Value = false,
        Callback = function(kan)
            getgenv().KillCamSkipEnabled = kan
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local KillCamSkipEvent = ReplicatedStorage.Remotes:WaitForChild("KillCamSkipEvent")
            
            local function startKillCamSkip()
                while getgenv().KillCamSkipEnabled do
                    pcall(function()
                        KillCamSkipEvent:FireServer()
                    end)
                    task.wait(0.4)
                end
            end
            
            task.spawn(function()
                while true do
                    if getgenv().KillCamSkipEnabled then
                        startKillCamSkip()
                    end
                    task.wait(0.1)
                end
            end)
        end
    })

    builtinSection:Toggle({
        Title = "机枪防损坏",
        Value = false,
        Callback = function(state)
            getgenv().BlockCRAMHits = state
            
            local Players = game:GetService("Players")
            local LPlayer = Players.LocalPlayer
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local remote = ReplicatedStorage:WaitForChild("BulletFireSystem"):WaitForChild("RegisterTurretHit")
            
            local function isOwnVehicle(hitPart)
                if not hitPart then return false end
                
                local vehicleWorkspace = workspace:FindFirstChild("Game Systems"):FindFirstChild("Helicopter Workspace")
                if vehicleWorkspace and hitPart:IsDescendantOf(vehicleWorkspace) then
                    return true
                end
                return false
            end
            
            local oldNamecall
            oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
                local method = getnamecallmethod()
                local args = {...}
                
                if getgenv().BlockCRAMHits and method == "FireServer" and self == remote then
                    local turretPart = args[1] 
                    local hitData = args[4] 
                    local hitPart = hitData and hitData["hitPart"]
                    if turretPart and tostring(turretPart):find("CRAM") and isOwnVehicle(hitPart) then
                        return nil
                    end
                end
                return oldNamecall(self, ...)
            end)
        end
    })

    builtinSection:Button({
        Title = "防暴盾牌",
        Callback = function()
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            ReplicatedStorage.BulletFireSystem.GunReload:destroy()
            local gunReload = Instance.new("Part")
            gunReload.Name = "GunReload"
            gunReload.Parent = ReplicatedStorage.BulletFireSystem
            while true do
                wait(0)
                for _, v in pairs(game.Players.LocalPlayer.Character:GetChildren()) do
                    if v.ClassName == "Tool" then v.ACS_Modulo.Variaveis.Ammo.Value = 9999 end
                end
            end
        end
    })

    builtinSection:Button({
        Title = "删除视觉盔甲和头盔",
        Callback = function()
            local character = game.Players.LocalPlayer.Character
            for _, child in pairs(character:GetChildren()) do
                if child.ClassName == "Accessory" then
                    child:Destroy()
                elseif child:IsA("BasePart") then
                    if child.Name:find("Armor") then
                        if child:FindFirstChild("Mesh") then
                            child.Mesh:Destroy()
                        end
                    elseif child.Name:find("Helmet") then
                        child:Destroy()
                    end
                end
            end
        end
    })

    builtinSection:Toggle({
        Title = "获取所有玩家背包",
        Value = false,
        Callback = function(state)
            if state then
                task.spawn(function()
                    while state do
                        for i,v in pairs(game.Players:GetChildren()) do
                            task.wait()
                            for i,b in pairs(v.Backpack:GetChildren()) do
                                b.Parent = game.Players.LocalPlayer.Backpack
                                task.wait()
                            end
                        end
                    end
                end)
            end
        end
    })

    builtinSection:Button({
        Title = "重置角色",
        Callback = function()
            local player = game.Players.LocalPlayer
            if player.Character then 
                player.Character:BreakJoints() 
            end
        end
    })

    local autoSection = I:Section({Title = "自动功能", Opened = true})

    autoSection:Toggle({
        Title = "自动重生",
        Value = false,
        Callback = function(state)
            getgenv().autoRebirth = state
            task.spawn(function()
                while getgenv().autoRebirth and task.wait() do
                    pcall(function()
                        game:GetService("ReplicatedStorage").RebirthEVT:FireServer()
                    end)
                    task.wait(0.5)
                end
            end)
        end
    })

    autoSection:Button({
        Title = "自动空投",
        Callback = function()
            if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and workspace:FindFirstChild("Game Systems") then
                for _,v in next,workspace["Game Systems"]:GetChildren() do
                    if v.Name:find("Airdrop_") and v:FindFirstChild("MainPart") then
                        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.MainPart.CFrame
                        if v.MainPart:FindFirstChild("AirDropPrompt") then
                            fireproximityprompt(v.MainPart.AirDropPrompt)
                        end
                    end
                end
            end
        end
    })

    autoSection:Toggle({
        Title = "自动救人",
        Value = false,
        Callback = function(state)
            getgenv().autoRevive = state
            if state then
                local RunService = game:GetService("RunService")
                local CollectionService = game:GetService("CollectionService")

                local REVIVE_PROMPT_TAG = "RevivePromptTag"

                for _, prompt in ipairs(workspace:GetDescendants()) do
                    if prompt.Name == "RevivePrompt" then
                        CollectionService:AddTag(prompt, REVIVE_PROMPT_TAG)
                    end
                end

                workspace.DescendantAdded:Connect(function(descendant)
                    if descendant.Name == "RevivePrompt" then
                        CollectionService:AddTag(descendant, REVIVE_PROMPT_TAG)
                    end
                end)

                local function triggerPrompt(prompt)
                    if prompt.Parent then
                        fireproximityprompt(prompt)
                    end
                end

                while getgenv().autoRevive do
                    local tagged = CollectionService:GetTagged(REVIVE_PROMPT_TAG)
                    for _, prompt in ipairs(tagged) do
                        coroutine.wrap(triggerPrompt)(prompt)
                    end
                    task.wait()
                end
            end
        end
    })

    autoSection:Toggle({
        Title = "自动修电箱",
        Value = false,
        Callback = function(state)
            getgenv().autoFixGenerator = state
            if state then
                local player = game.Players.LocalPlayer
                local character = player.Character or player.CharacterAdded:Wait()

                while getgenv().autoFixGenerator do
                    pcall(function()
                        for _, room in pairs(workspace.Rooms:GetChildren()) do
                            local interactables = room:FindFirstChild("Interactables")
                            
                            if interactables then
                                for _, generator in pairs(interactables:GetChildren()) do
                                    if generator.Name == "Generator" and generator:FindFirstChild("Fixed") and generator:FindFirstChild("RemoteFunction") and generator:FindFirstChild("RemoteEvent") then
                                        local proximityPrompt = generator.ProxyPart:FindFirstChild("ProximityPrompt")
                                        
                                        generator.RemoteFunction:InvokeServer()

                                        local distance = (character.PrimaryPart.Position - generator.ProxyPart.Position).Magnitude

                                        if distance <= proximityPrompt.MaxActivationDistance and generator.Fixed.Value < 100 then
                                            local args = {
                                                [1] = true
                                            }
                                            generator.RemoteEvent:FireServer(unpack(args))
                                        end
                                    elseif generator.Name == "EncounterGenerator" and generator:FindFirstChild("Fixed") and generator:FindFirstChild("RemoteFunction") and generator:FindFirstChild("RemoteEvent") then
                                        local proximityPrompt = generator.ProxyPart:FindFirstChild("ProximityPrompt")
                                        
                                        generator.RemoteFunction:InvokeServer()

                                        local distance = (character.PrimaryPart.Position - generator.ProxyPart.Position).Magnitude

                                        if distance <= proximityPrompt.MaxActivationDistance and generator.Fixed.Value < 100 then
                                            local args = {
                                                [1] = true
                                            }
                                            generator.RemoteEvent:FireServer(unpack(args))
                                        end
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(0)
                end
            end
        end
    })

    infoTab:Select()

    WindUI:Notify({
        Title = "战争大亨付费版",
        Content = "所有功能已成功加载！",
        Duration = 5,
        Icon = "sword"
    })
end

elseif game.PlaceId == 10449761463 then
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/gycgchgyfytdttr/shenqin/refs/heads/main/ui.lua"))()
WindUI.TransparencyValue = 0.2
WindUI:SetTheme("Dark")

local rainbowBorderAnimation
local currentBorderColorScheme = "彩虹颜色"
local currentFontColorScheme = "彩虹颜色"
local borderInitialized = false
local animationSpeed = 2
local borderEnabled = true
local fontColorEnabled = false
local uiScale = 1
local blurEnabled = false
local soundEnabled = true

local FONT_STYLES = {
    "SourceSansBold","SourceSansItalic","SourceSansLight","SourceSans",
    "GothamSSm","GothamSSm-Bold","GothamSSm-Medium","GothamSSm-Light",
    "GothamSSm-Black","GothamSSm-Book","GothamSSm-XLight","GothamSSm-Thin",
    "GothamSSm-Ultra","GothamSSm-SemiBold","GothamSSm-ExtraLight","GothamSSm-Heavy",
    "GothamSSm-ExtraBold","GothamSSm-Regular","Gotham","GothamBold",
    "GothamMedium","GothamBlack","GothamLight","Arial","ArialBold",
    "Code","CodeLight","CodeBold","Highway","HighwayBold","HighwayLight",
    "SciFi","SciFiBold","SciFiItalic","Cartoon","CartoonBold","Handwritten"
}

local FONT_DESCRIPTIONS = {
    ["SourceSansBold"] = "标准粗体",["SourceSansItalic"] = "斜体",["SourceSansLight"] = "细体",
    ["SourceSans"] = "标准体",["GothamSSm"] = "哥特标准",["GothamSSm-Bold"] = "哥特粗体",
    ["GothamSSm-Medium"] = "哥特中等",["GothamSSm-Light"] = "哥特细体",["GothamSSm-Black"] = "哥特黑体",
    ["GothamSSm-Book"] = "哥特书本体",["GothamSSm-XLight"] = "哥特超细体",["GothamSSm-Thin"] = "哥特极细体",
    ["GothamSSm-Ultra"] = "哥特超黑体",["GothamSSm-SemiBold"] = "哥特半粗体",["GothamSSm-ExtraLight"] = "哥特特细体",
    ["GothamSSm-Heavy"] = "哥特粗重体",["GothamSSm-ExtraBold"] = "哥特特粗体",["GothamSSm-Regular"] = "哥特常规体",
    ["Gotham"] = "经典哥特体",["GothamBold"] = "经典哥特粗体",["GothamMedium"] = "经典哥特中等",
    ["GothamBlack"] = "经典哥特黑体",["GothamLight"] = "经典哥特细体",["Arial"] = "标准Arial体",
    ["ArialBold"] = "Arial粗体",["Code"] = "代码字体",["CodeLight"] = "代码细体",
    ["CodeBold"] = "代码粗体",["Highway"] = "高速公路体",["HighwayBold"] = "高速公路粗体",
    ["HighwayLight"] = "高速公路细体",["SciFi"] = "科幻字体",["SciFiBold"] = "科幻粗体",
    ["SciFiItalic"] = "科幻斜体",["Cartoon"] = "卡通字体",["CartoonBold"] = "卡通粗体",
    ["Handwritten"] = "手写体"
}

local currentFontStyle = "SourceSansBold"

local COLOR_SCHEMES = {
    ["彩虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.16, Color3.fromHex("FFA500")),ColorSequenceKeypoint.new(0.33, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(1, Color3.fromHex("EE82EE"))}),"palette"},
    ["黑红颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"alert-triangle"},
    ["蓝白颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFFFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFFFFF"))}),"droplet"},
    ["紫金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"crown"},
    ["蓝黑颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("0000FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("000000"))}),"moon"},
    ["绿紫颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("00FF00")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("800080")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FF00"))}),"zap"},
    ["粉蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00BFFF")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF69B4"))}),"heart"},
    ["橙青颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("00CED1")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF4500"))}),"sun"},
    ["红金颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFD700")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF0000"))}),"award"},
    ["银蓝颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("4682B4")),ColorSequenceKeypoint.new(1, Color3.fromHex("C0C0C0"))}),"star"},
    ["霓虹颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(0.25, Color3.fromHex("00FFFF")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FFFF00")),ColorSequenceKeypoint.new(0.75, Color3.fromHex("FF00FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00FFFF"))}),"sparkles"},
    ["森林颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("228B22")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("32CD32")),ColorSequenceKeypoint.new(1, Color3.fromHex("228B22"))}),"tree"},
    ["火焰颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF0000")),ColorSequenceKeypoint.new(1, Color3.fromHex("FF8C00"))}),"flame"},
    ["海洋颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("000080")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("1E90FF")),ColorSequenceKeypoint.new(1, Color3.fromHex("00BFFF"))}),"waves"},
    ["日落颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF4500")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF8C00")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFD700"))}),"sunset"},
    ["银河颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("4B0082")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("8A2BE2")),ColorSequenceKeypoint.new(1, Color3.fromHex("9370DB"))}),"galaxy"},
    ["糖果颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("FF69B4")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("FF1493")),ColorSequenceKeypoint.new(1, Color3.fromHex("FFB6C1"))}),"candy"},
    ["金属颜色"] = {ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromHex("C0C0C0")),ColorSequenceKeypoint.new(0.5, Color3.fromHex("A9A9A9")),ColorSequenceKeypoint.new(1, Color3.fromHex("696969"))}),"shield"}
}

local fontColorAnimations = {}

local function applyFontColorGradient(textElement, colorScheme)
    if not textElement or not textElement:IsA("TextLabel") and not textElement:IsA("TextButton") and not textElement:IsA("TextBox") then
        return
    end
    
    local existingGradient = textElement:FindFirstChild("FontColorGradient")
    if existingGradient then
        existingGradient:Destroy()
    end
    
    if fontColorAnimations[textElement] then
        fontColorAnimations[textElement]:Disconnect()
        fontColorAnimations[textElement] = nil
    end
    
    if not fontColorEnabled then
        textElement.TextColor3 = Color3.new(1, 1, 1)
        return
    end
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentFontColorScheme]
    if not schemeData then return end
    
    local fontGradient = Instance.new("UIGradient")
    fontGradient.Name = "FontColorGradient"
    fontGradient.Color = schemeData[1]
    fontGradient.Rotation = 0
    fontGradient.Parent = textElement
    
    textElement.TextColor3 = Color3.new(1, 1, 1)
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not textElement or textElement.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        if not fontGradient or fontGradient.Parent == nil then
            animation:Disconnect()
            fontColorAnimations[textElement] = nil
            return
        end
        
        local time = tick()
        fontGradient.Rotation = (time * animationSpeed * 30) % 360
    end)
    
    fontColorAnimations[textElement] = animation
end

local function applyFontStyleToWindow(fontStyle)
    if not Window or not Window.UIElements then 
        wait(0.5)
        if not Window or not Window.UIElements then
            return false
        end
    end
    
    local successCount = 0
    local totalCount = 0
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                totalCount = totalCount + 1
                pcall(function()
                    child.Font = Enum.Font[fontStyle]
                    successCount = successCount + 1
                end)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
    
    return successCount, totalCount
end

local function applyFontColorsToWindow(colorScheme)
    if not Window or not Window.UIElements then return end
    
    local function processElement(element)
        for _, child in ipairs(element:GetDescendants()) do
            if child:IsA("TextLabel") or child:IsA("TextButton") or child:IsA("TextBox") then
                applyFontColorGradient(child, colorScheme)
            end
        end
    end
    
    processElement(Window.UIElements.Main)
end

local function createRainbowBorder(window, colorScheme, speed)
    if not window or not window.UIElements then
        wait(1)
        if not window or not window.UIElements then
            return nil, nil
        end
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil, nil
    end
    
    local existingStroke = mainFrame:FindFirstChild("RainbowStroke")
    if existingStroke then
        local glowEffect = existingStroke:FindFirstChild("GlowEffect")
        if glowEffect then
            local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
            if schemeData then
                glowEffect.Color = schemeData[1]
            end
        end
        return existingStroke, rainbowBorderAnimation
    end
    
    if not mainFrame:FindFirstChildOfClass("UICorner") then
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 16)
        corner.Parent = mainFrame
    end
    
    local rainbowStroke = Instance.new("UIStroke")
    rainbowStroke.Name = "RainbowStroke"
    rainbowStroke.Thickness = 1.5
    rainbowStroke.Color = Color3.new(1, 1, 1)
    rainbowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    rainbowStroke.LineJoinMode = Enum.LineJoinMode.Round
    rainbowStroke.Enabled = borderEnabled
    rainbowStroke.Parent = mainFrame
    
    local glowEffect = Instance.new("UIGradient")
    glowEffect.Name = "GlowEffect"
    
    local schemeData = COLOR_SCHEMES[colorScheme or currentBorderColorScheme]
    if schemeData then
        glowEffect.Color = schemeData[1]
    else
        glowEffect.Color = COLOR_SCHEMES["彩虹颜色"][1]
    end
    
    glowEffect.Rotation = 0
    glowEffect.Parent = rainbowStroke
    
    return rainbowStroke, nil
end

local function startBorderAnimation(window, speed)
    if not window or not window.UIElements then
        return nil
    end
    
    local mainFrame = window.UIElements.Main
    if not mainFrame then
        return nil
    end
    
    local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
    if not rainbowStroke or not rainbowStroke.Enabled then
        return nil
    end
    
    local glowEffect = rainbowStroke:FindFirstChild("GlowEffect")
    if not glowEffect then
        return nil
    end
    
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    
    local animation
    animation = game:GetService("RunService").Heartbeat:Connect(function()
        if not rainbowStroke or rainbowStroke.Parent == nil or not rainbowStroke.Enabled then
            animation:Disconnect()
            return
        end
        
        local time = tick()
        glowEffect.Rotation = (time * speed * 60) % 360
    end)
    
    rainbowBorderAnimation = animation
    return animation
end

local function initializeRainbowBorder(scheme, speed)
    speed = speed or animationSpeed
    
    local rainbowStroke, _ = createRainbowBorder(Window, scheme, speed)
    if rainbowStroke then
        if borderEnabled then
            startBorderAnimation(Window, speed)
        end
        borderInitialized = true
        return true
    end
    return false
end

local function gradient(text, startColor, endColor)
    local result = ""
    for i = 1, #text do
        local t = (i - 1) / (#text - 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        result = result .. string.format('<font color="rgb(%d,%d,%d)">%s</font>', r, g, b, text:sub(i, i))
    end
    return result
end

local function playSound()
    if soundEnabled then
        pcall(function()
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxassetid://9047002353"
            sound.Volume = 0.3
            sound.Parent = game:GetService("SoundService")
            sound:Play()
            game:GetService("Debris"):AddItem(sound, 2)
        end)
    end
end

local function applyBlurEffect(enabled)
    if enabled then
        pcall(function()
            local blur = Instance.new("BlurEffect")
            blur.Size = 8
            blur.Name = "UIXH HUBBlur"
            blur.Parent = game:GetService("Lighting")
        end)
    else
        pcall(function()
            local existingBlur = game:GetService("Lighting"):FindFirstChild("UIXH HUBBlur")
            if existingBlur then
                existingBlur:Destroy()
            end
        end)
    end
end

local function applyUIScale(scale)
    if Window and Window.UIElements and Window.UIElements.Main then
        local mainFrame = Window.UIElements.Main
        mainFrame.Size = UDim2.new(0, 600 * scale, 0, 400 * scale)
    end
end

local Confirmed = false
local gradientColors = {
    "rgb(255, 230, 235)",
    "rgb(255, 210, 220)",
    "rgb(255, 190, 205)",
    "rgb(255, 170, 190)",
    "rgb(255, 150, 175)",
    "rgb(245, 140, 180)",
    "rgb(235, 130, 185)",
    "rgb(225, 120, 190)",
    "rgb(215, 110, 195)",
    "rgb(205, 100, 200)"
}
local username = game:GetService("Players").LocalPlayer.Name
local coloredUsername = ""
local gradientColors = {
    "#4169E1", 
    "#6A5ACD",  
    "#9370DB",  
    "#8A2BE2", 
    "#4B0082"   
}
local goldColor = "#FFD700"
for i = 1, #username do
    local char = username:sub(i, i)
    
    if char:match("[A-Za-z0-9]") then
        local colorIndex = (i - 1) % #gradientColors + 1
        coloredUsername = coloredUsername .. '<font color="' .. gradientColors[colorIndex] .. '">' .. char .. '</font>'
    else
        coloredUsername = coloredUsername .. '<font color="' .. goldColor .. '">' .. char .. '</font>'
    end
end

WindUI:Popup({
    Title = 'YG/TNINE SCRIPT',
    IconThemed = true,
    Icon = "crown",
    Content = "欢迎尊重的用户 " .. coloredUsername .. " \n感谢您使用我们的脚本\n加入我们QQ1015718032",
    Buttons = {
        {
            Title = "取消",
            Callback = function() end,
            Variant = "Secondary",
        },
        {
            Title = "执行",
            Icon = "arrow-right",
            Callback = function() 
                Confirmed = true
                createUI()
            end,
            Variant = "Primary",
        }
    }
})

function createUI()
    local Window = WindUI:CreateWindow({
        Title = 'YG/TNINE SCRIPT',
        Icon = "crown",
        IconThemed = true,
        Author = "怀/凌乱",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(375, 278),
        Transparent = true,
        Theme = "Rainbow",
        HideSearchBar = false,
        ScrollBarEnabled = true,
        Resizable = true,
        Background = "https://raw.githubusercontent.com/tnine-n9/TnineHubnb/refs/heads/main/1770443104414_edit_300225054024499.png",
        BackgroundImageTransparency = 0.45,
        User = {
            Enabled = true,
            Callback = function()
                WindUI:Notify({
                    Title = "点击了自己",
                    Content = "没什么", 
                    Duration = 1,
                    Icon = "4483362748"
                })
            end,
            Anonymous = false
        },
        SideBarWidth = 250,
        Search = {
            Enabled = true,
            Placeholder = "搜索...",
            Callback = function(searchText)
                print("搜索内容:", searchText)
            end
        },
        SidePanel = {
            Enabled = true,
            Content = {
                {
                    Type = "Button", 
                    Text = "",
                    Style = "Subtle", 
                    Size = UDim2.new(1, -20, 0, 30),
                    Callback = function()
                    end
                }
            }
        }
    })

Window:EditOpenButton({
    Title = "Paid user",
    Icon = "crown",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 4,
    Color = ColorSequence.new(Color3.fromHex("FF6B6B")),
    Draggable = true,
})
Window:Tag({
    Title = "付费版",
    Color = Color3.fromHex("#FFA500") 
})
spawn(function()
    while true do
        for hue = 0, 1, 0.01 do  
            local color = Color3.fromHSV(hue, 0.8, 1)  
            Window:EditOpenButton({
                Color = ColorSequence.new(color)
            })
            wait(0.04)  
        end
    end
end)
if not borderInitialized then
    spawn(function()
        wait(0.5)
        initializeRainbowBorder("糖果颜色", animationSpeed)
        wait(1)
        applyFontStyleToWindow(currentFontStyle)
    end)
end

local windowOpen = true

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
end)

local originalOpenFunction = Window.Open
Window.Open = function(...)
    windowOpen = true
    local result = originalOpenFunction(...)
    
    if borderInitialized and borderEnabled and not rainbowBorderAnimation then
        wait(0.1)
        startBorderAnimation(Window, animationSpeed)
    end
    
    return result
end

local infoTab = Window:Tab({Title = "通知", Icon = "layout-grid", Locked = false})

local infoSection = infoTab:Section({Title = "详情信息",Icon = "info", Opened = true})

infoSection:Divider()

infoSection:Paragraph({
    Title = "您当前的服务器为",
    Desc = tostring(game.PlaceId) .. "\n欢迎使用YG/TNINE",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "持续更新 有bug请提出来",
    ThumbnailSize = 190,
})
infoSection:Paragraph({
    Title = "作者:怀 凌乱",
    ThumbnailSize = 190,
})

local LockSection = Window:Section({
    Title = "功能以及UI设置",
    Icon = "crown",
    Opened = true,
})

local Settings = Window:Tab({Title = "UI设置", Icon = "palette"})
Settings:Paragraph({
    Title = "UI设置",
    Desc = "绝妙二改WindUI",
    Image = "settings",
    ImageSize = 20,
    Color = "White"
})

Settings:Toggle({
    Title = "启用边框",
    Value = borderEnabled,
    Callback = function(value)
        borderEnabled = value
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Enabled = value
                if value and windowOpen and not rainbowBorderAnimation then
                    startBorderAnimation(Window, animationSpeed)
                elseif not value and rainbowBorderAnimation then
                    rainbowBorderAnimation:Disconnect()
                    rainbowBorderAnimation = nil
                end
                
                WindUI:Notify({
                    Title = "边框",
                    Content = value and "已启用" or "已禁用",
                    Duration = 2,
                    Icon = value and "eye" or "eye-off"
                })
            end
        end
    end
})

Settings:Toggle({
    Title = "启用字体颜色",
    Value = fontColorEnabled,
    Callback = function(value)
        fontColorEnabled = value
        applyFontColorsToWindow(currentFontColorScheme)
        
        WindUI:Notify({
            Title = "字体颜色",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "type" or "type"
        })
    end
})

Settings:Toggle({
    Title = "启用音效",
    Value = soundEnabled,
    Callback = function(value)
        soundEnabled = value
        WindUI:Notify({
            Title = "音效",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "volume-2" or "volume-x"
        })
    end
})

Settings:Toggle({
    Title = "启用背景模糊",
    Value = blurEnabled,
    Callback = function(value)
        blurEnabled = value
        applyBlurEffect(value)
        WindUI:Notify({
            Title = "背景模糊",
            Content = value and "已启用" or "已禁用",
            Duration = 2,
            Icon = value and "cloud-rain" or "cloud"
        })
    end
})

local colorSchemeNames = {}
for name, _ in pairs(COLOR_SCHEMES) do
    table.insert(colorSchemeNames, name)
end
table.sort(colorSchemeNames)

Settings:Dropdown({
    Title = "边框颜色方案",
    Desc = "选择喜欢的颜色组合",
    Values = colorSchemeNames,
    Value = "糖果颜色",
    Callback = function(value)
        currentBorderColorScheme = value
        local success = initializeRainbowBorder(value, animationSpeed)
        playSound()
    end
})

Settings:Dropdown({
    Title = "字体颜色方案",
    Desc = "选择文字颜色组合",
    Values = colorSchemeNames,
    Value = "彩虹颜色",
    Callback = function(value)
        currentFontColorScheme = value
        applyFontColorsToWindow(value)
        playSound()
    end
})

local fontOptions = {}
for _, fontName in ipairs(FONT_STYLES) do
    local description = FONT_DESCRIPTIONS[fontName] or fontName
    table.insert(fontOptions, {text = description, value = fontName})
end

table.sort(fontOptions, function(a, b)
    return a.text < b.text
end)

local fontValues = {}
local fontValueToName = {}
for _, option in ipairs(fontOptions) do
    table.insert(fontValues, option.text)
    fontValueToName[option.text] = option.value
end

Settings:Dropdown({
    Title = "字体样式",
    Desc = "选择文字字体样式 (" .. #FONT_STYLES .. " 种可用)",
    Values = fontValues,
    Value = "标准粗体",
    Callback = function(value)
        local fontName = fontValueToName[value]
        if fontName then
            currentFontStyle = fontName
            local successCount, totalCount = applyFontStyleToWindow(fontName)
            playSound()
        end
    end
})

Settings:Slider({
    Title = "边框转动速度",
    Desc = "调整边框旋转的快慢",
    Value = { 
        Min = 1,
        Max = 10,
        Default = 5,
    },
    Callback = function(value)
        animationSpeed = value
        if rainbowBorderAnimation then
            rainbowBorderAnimation:Disconnect()
            rainbowBorderAnimation = nil
        end
        if borderEnabled then
            startBorderAnimation(Window, animationSpeed)
        end
        
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Slider({
    Title = "UI整体缩放",
    Desc = "调整UI大小比例",
    Value = { 
        Min = 0.5,
        Max = 1.5,
        Default = 1,
    },
    Step = 0.1,
    Callback = function(value)
        uiScale = value
        applyUIScale(value)
        playSound()
    end
})

Settings:Divider()

Settings:Slider({
    Title = "UI透明度",
    Desc = "调整整个UI的透明度",
    Value = { 
        Min = 0,
        Max = 1,
        Default = 0.2,
    },
    Step = 0.1,
    Callback = function(value)
        Window:ToggleTransparency(tonumber(value) > 0)
        WindUI.TransparencyValue = tonumber(value)
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI宽度",
    Desc = "调整窗口的宽度",
    Value = { 
        Min = 500,
        Max = 800,
        Default = 600,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(value, 400)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "调整UI高度",
    Desc = "调整窗口的高度",
    Value = { 
        Min = 300,
        Max = 600,
        Default = 400,
    },
    Callback = function(value)
        if Window.UIElements and Window.UIElements.Main then
            local currentWidth = Window.UIElements.Main.Size.X.Offset
            Window.UIElements.Main.Size = UDim2.fromOffset(currentWidth, value)
        end
        playSound()
    end
})

Settings:Slider({
    Title = "边框粗细",
    Desc = "调整边框的粗细",
    Value = { 
        Min = 1,
        Max = 5,
        Default = 1.5,
    },
    Step = 0.5,
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local rainbowStroke = mainFrame:FindFirstChild("RainbowStroke")
            if rainbowStroke then
                rainbowStroke.Thickness = value
            end
        end
        playSound()
    end
})

Settings:Slider({
    Title = "圆角大小",
    Desc = "调整UI圆角的大小",
    Value = { 
        Min = 0,
        Max = 20,
        Default = 16,
    },
    Callback = function(value)
        local mainFrame = Window.UIElements and Window.UIElements.Main
        if mainFrame then
            local corner = mainFrame:FindFirstChildOfClass("UICorner")
            if not corner then
                corner = Instance.new("UICorner")
                corner.Parent = mainFrame
            end
            corner.CornerRadius = UDim.new(0, value)
        end
        playSound()
    end
})

Settings:Button({
    Title = "恢复UI到原位",
    Icon = "rotate-ccw",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Position = UDim2.new(0.5, 0, 0.5, 0)
            playSound()
        end
    end
})

Settings:Button({
    Title = "重置UI大小",
    Icon = "maximize-2",
    Callback = function()
        if Window.UIElements and Window.UIElements.Main then
            Window.UIElements.Main.Size = UDim2.fromOffset(600, 400)
            playSound()
        end
    end
})

Settings:Button({
    Title = "随机字体",
    Icon = "shuffle",
    Callback = function()
        local randomFont = FONT_STYLES[math.random(1, #FONT_STYLES)]
        currentFontStyle = randomFont
        applyFontStyleToWindow(randomFont)
        playSound()
    end
})

Settings:Button({
    Title = "随机颜色",
    Icon = "palette",
    Callback = function()
        local randomColor = colorSchemeNames[math.random(1, #colorSchemeNames)]
        currentBorderColorScheme = randomColor
        initializeRainbowBorder(randomColor, animationSpeed)
        playSound()
    end
})

Settings:Divider()

Settings:Button({
    Title = "刷新字体颜色",
    Icon = "refresh-cw",
    Callback = function()
        applyFontColorsToWindow(currentFontColorScheme)
        playSound()
    end
})

Settings:Button({
    Title = "刷新字体样式",
    Icon = "refresh-cw",
    Callback = function()
        local successCount, totalCount = applyFontStyleToWindow(currentFontStyle)
        playSound()
    end
})

Settings:Button({
    Title = "测试所有字体",
    Icon = "check-circle",
    Callback = function()
        local workingFonts = {}
        local totalFonts = #FONT_STYLES
        
        for i, fontName in ipairs(FONT_STYLES) do
            local success = pcall(function()
                local test = Enum.Font[fontName]
            end)
            
            if success then
                table.insert(workingFonts, fontName)
            end
        end
        playSound()
    end
})

Settings:Button({
    Title = "导出设置",
    Icon = "download",
    Callback = function()
        local settings = {
            font = currentFontStyle,
            borderColor = currentBorderColorScheme,
            fontSize = currentFontColorScheme,
            speed = animationSpeed,
            scale = uiScale
        }
        setclipboard("YG/TNINE SCRIPT设置: " .. game:GetService("HttpService"):JSONEncode(settings))
        playSound()
    end
})

local animationIDs = {
    ["rbxassetid://10468665991"] = true,
    ["rbxassetid://10466974800"] = true,
    ["rbxassetid://10471336737"] = true,
    ["rbxassetid://12510170988"] = true,
    ["rbxassetid://12272894215"] = true,
    ["rbxassetid://12296882427"] = true,
    ["rbxassetid://12307656616"] = true,
    ["rbxassetid://12351854556"] = true,
    ["rbxassetid://12534735382"] = true,
    ["rbxassetid://12502664044"] = true,
    ["rbxassetid://12509505723"] = true,
    ["rbxassetid://12618292188"] = true,
    ["rbxassetid://12684185971"] = true,
    ["rbxassetid://13376869471"] = true,
    ["rbxassetid://13294790250"] = true,
    ["rbxassetid://13376962659"] = true,
    ["rbxassetid://13501296372"] = true,
    ["rbxassetid://14004235777"] = true,
    ["rbxassetid://14003607057"] = true,
    ["rbxassetid://14046756619"] = true,
    ["rbxassetid://14048349132"] = true,
    ["rbxassetid://14299135500"] = true,
    ["rbxassetid://14967219354"] = true,
    ["rbxassetid://14357997687"] = true,
    ["rbxassetid://14357943487"] = true,
    ["rbxassetid://15290930205"] = true,
    ["rbxassetid://15145462680"] = true,
    ["rbxassetid://15295895753"] = true,
    ["rbxassetid://15311685628"] = true,
    ["rbxassetid://16139108718"] = true,
    ["rbxassetid://16139402582"] = true,
    ["rbxassetid://16515850153"] = true,
    ["rbxassetid://16431491215"] = true,
    ["rbxassetid://16597322398"] = true,
    ["rbxassetid://10469493270"] = true,
    ["rbxassetid://10469630950"] = true,
    ["rbxassetid://10469639222"] = true,
    ["rbxassetid://10469643643"] = true,
    ["rbxassetid://13532562418"] = true,
    ["rbxassetid://13491635433"] = true,
    ["rbxassetid://13296577783"] = true,
    ["rbxassetid://13295919399"] = true,
    ["rbxassetid://13370310513"] = true,
    ["rbxassetid://13390230973"] = true,
    ["rbxassetid://13378751717"] = true,
    ["rbxassetid://13378708199"] = true,
    ["rbxassetid://14004222985"] = true,
    ["rbxassetid://13997092940"] = true,
    ["rbxassetid://14001963401"] = true,
    ["rbxassetid://14136436157"] = true,
    ["rbxassetid://15259161390"] = true,
    ["rbxassetid://15240216931"] = true,
    ["rbxassetid://15240176873"] = true,
    ["rbxassetid://15162694192"] = true,
    ["rbxassetid://16515503507"] = true,
    ["rbxassetid://16515520431"] = true,
    ["rbxassetid://16515448089"] = true,
    ["rbxassetid://16552234590"] = true,
    ["rbxassetid://17889458563"] = true,
    ["rbxassetid://17889461810"] = true,
    ["rbxassetid://17889471098"] = true,
    ["rbxassetid://17889290569"] = true,
    ["rbxassetid://10479335397"] = true,
    ["rbxassetid://13380255751"] = true,
    ["rbxassetid://13362587853"] = true,
    ["rbxassetid://11365563255"] = {range = 175, behind = 17},
    ["rbxassetid://12983333733"] = {range = 200, behind = 16},
    ["rbxassetid://13927612951"] = {range = 100, behind = 16},
    ["rbxassetid://13146710762"] = {range = 200, behind = 24},
    ["rbxassetid://15520132233"] = {range = 100, behind = 75},
    ["rbxassetid://16082123712"] = {range = 40, behind = 20}
}

local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

local detectionRange = 15
local detectionMode = "360"
local lastTeleportTime = 0

local function getNearbyPlayers(radius)
    local players = {}
    for _, otherPlayer in pairs(game.Players:GetPlayers()) do
        if otherPlayer ~= player then
            local otherCharacter = otherPlayer.Character
            if otherCharacter then
                local otherHumanoidRootPart = otherCharacter:FindFirstChild("HumanoidRootPart")
                if otherHumanoidRootPart and (otherHumanoidRootPart.Position - humanoidRootPart.Position).Magnitude <= radius then
                    table.insert(players, otherPlayer)
                end
            end
        end
    end
    return players
end

local function isInFront(character, target)
    local lookVector = character.CFrame.lookVector
    local directionToTarget = (target.Position - character.Position).unit
    return lookVector:Dot(directionToTarget) > 0.5
end

local function checkAnimations()
    local currentTime = tick()
    if currentTime - lastTeleportTime < 0.1 then
        return
    end
    
    local nearbyPlayers = getNearbyPlayers(detectionRange)
    for _, otherPlayer in pairs(nearbyPlayers) do
        local otherCharacter = otherPlayer.Character
        if otherCharacter then
            local otherHumanoidRootPart = otherCharacter:FindFirstChild("HumanoidRootPart")
            if otherHumanoidRootPart then
                if (detectionMode == "360" or isInFront(humanoidRootPart, otherHumanoidRootPart)) then
                    for _, animTrack in pairs(otherCharacter:FindFirstChildOfClass("Humanoid"):GetPlayingAnimationTracks()) do
                        local animId = animTrack.Animation.AnimationId
                        local data = animationIDs[animId]
                        if data then
                            local teleportDistance = (type(data) == "table" and data.behind) or 18
                            local newPosition = otherHumanoidRootPart.Position - otherHumanoidRootPart.CFrame.lookVector * teleportDistance + Vector3.new(math.random(-1, 1), 0, math.random(-1, 1))
                            humanoidRootPart.CFrame = CFrame.new(newPosition)
                            lastTeleportTime = currentTime
                            return
                        end
                    end
                end
            end
        end
    end
end

local ultraInstinctActive = false

local RunService = game:GetService("RunService")

local function ultraInstinctLoop()
    local connection
    connection = RunService.Heartbeat:Connect(function()
        if ultraInstinctActive then
            checkAnimations()
        else
            connection:Disconnect()
        end
    end)
end

local function onCharacterAdded(newCharacter)
    character = newCharacter
    humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    if ultraInstinctActive then
        ultraInstinctLoop()
    end
end

local animationsToAvoid = {
    ["rbxassetid://10468665991"] = true,
    ["rbxassetid://10466974800"] = true,
    ["rbxassetid://10471336737"] = true,
    ["rbxassetid://12510170988"] = true,
    ["rbxassetid://12272894215"] = true,
    ["rbxassetid://12296882427"] = true,
    ["rbxassetid://12307656616"] = true,
    ["rbxassetid://12351854556"] = true,
    ["rbxassetid://12534735382"] = true,
    ["rbxassetid://12502664044"] = true,
    ["rbxassetid://12509505723"] = true,
    ["rbxassetid://12618292188"] = true,
    ["rbxassetid://12684185971"] = true,
    ["rbxassetid://13376869471"] = true,
    ["rbxassetid://13294790250"] = true,
    ["rbxassetid://13376962659"] = true,
    ["rbxassetid://13501296372"] = true,
    ["rbxassetid://14004235777"] = true,
    ["rbxassetid://14003607057"] = true,
    ["rbxassetid://14046756619"] = true,
    ["rbxassetid://14048349132"] = true,
    ["rbxassetid://14299135500"] = true,
    ["rbxassetid://14967219354"] = true,
    ["rbxassetid://14357997687"] = true,
    ["rbxassetid://14357943487"] = true,
    ["rbxassetid://15290930205"] = true,
    ["rbxassetid://15145462680"] = true,
    ["rbxassetid://15295895753"] = true,
    ["rbxassetid://15311685628"] = true,
    ["rbxassetid://16139108718"] = true,
    ["rbxassetid://16139402582"] = true,
    ["rbxassetid://16515850153"] = true,
    ["rbxassetid://16431491215"] = true,
    ["rbxassetid://16597322398"] = true,
    ["rbxassetid://10469493270"] = "special"
}

local skills = {
    firstskill = {"Normal Punch", "Flowing Water", "Machine Gun Blows", "Flash Strike", "Homerun", "Quick Slice", "Bullet Barrage", "Crushing Pull"},
    secondskill = {"Atmos Cleave", "Windstorm Fury", "Ignition Burst", "Whirlwind Kick", "Beatdown", "Consecutive Punches", "Lethal Whirlwind Stream", "Vanishing Kick"},
    thirdskill = {"Shove", "Hunter's Grasp", "Blitz Shot", "Scatter", "Grand Slam", "Pinpoint Cut", "Stone Coffin", "Whirlwind Drop"},
    fourthskill = {"Split Second Counter", "Expulsive Push", "Jet Dive", "Explosive Shuriken", "Foul Ball", "Uppercut", "Head First", "Prey's Peril"}
}

local skillCooldowns = {
    ["Normal Punch"] = 21,
    ["Flowing Water"] = 19,
    ["Machine Gun Blows"] = 17,
    ["Flash Strike"] = 18.5,
    ["Homerun"] = 18.6,
    ["Quick Slice"] = 21.5,
    ["Bullet Barrage"] = 22,
    ["Crushing Pull"] = 23,
    ["Consecutive Punches"] = 19,
    ["Lethal Whirlwind Stream"] = 22,
    ["Ignition Burst"] = 18.3,
    ["Whirlwind Kick"] = 21.5,
    ["Beatdown"] = 24.3,
    ["Atmos Cleave"] = 23.2,
    ["Windstorm Fury"] = 21,
    ["Vanishing Kick"] = 21,
    ["Shove"] = 11,
    ["Hunter's Grasp"] = 17.8,
    ["Blitz Shot"] = 26,
    ["Scatter"] = 22.3,
    ["Grand Slam"] = 21.7,
    ["Pinpoint Cut"] = 18,
    ["Stone Coffin"] = 25.7,
    ["Whirlwind Drop"] = 15.7,
    ["Jet Dive"] = 19.5,
    ["Explosive Shuriken"] = 18.5,
    ["Foul Ball"] = 24.8,
    ["Split Second Counter"] = 18.7,
    ["Expulsive Push"] = 20.7,
    ["Prey's Peril"] = 18.5,
    ["Head First"] = 22,
    ["Uppercut"] = 21
}

local skillUsage = {
    firstskill = 0,
    secondskill = 0,
    thirdskill = 0,
    fourthskill = 0
}

local function isAnimationPlaying(character)
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        for _, track in pairs(humanoid:GetPlayingAnimationTracks()) do
            if animationsToAvoid[track.Animation.AnimationId] then
                return animationsToAvoid[track.Animation.AnimationId]
            end
        end
    end
    return false
end

local function teleportBehindTarget(player, targetPlayer, distance)
    local targetCharacter = targetPlayer.Character
    if targetCharacter then
        local targetHRP = targetCharacter:FindFirstChild("HumanoidRootPart")
        local playerHRP = player.Character:FindFirstChild("HumanoidRootPart")
        if targetHRP and playerHRP then
            local backOffset = targetHRP.CFrame.lookVector * -distance
            playerHRP.CFrame = CFrame.new(targetHRP.Position + backOffset, targetHRP.Position)
        end
    end
end

local function equipAndUseSkill(player, skillType)
    local character = player.Character
    if character then
        local backpack = player.Backpack
        local liveFolder = workspace:FindFirstChild("Live")
        if backpack and liveFolder then
            for _, skill in pairs(skills[skillType]) do
                local tool = backpack:FindFirstChild(skill) or character:FindFirstChild(skill)
                if tool then
                    character.Humanoid:EquipTool(tool)
                    
                    local args = {
                        [1] = {
                            ["Mobile"] = true,
                            ["Goal"] = "LeftClick"
                        }
                    }
                    game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))

                    wait(0.02)

                    local argsRelease = {
                        [1] = {
                            ["Goal"] = "LeftClickRelease",
                            ["Mobile"] = true
                        }
                    }
                    game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(argsRelease))

                    character.Humanoid:UnequipTools()

                    if skillCooldowns[skill] then
                        skillUsage[skillType] = tick()
                        wait(skillCooldowns[skill])
                    end
                end
            end
        end
    end
end

local autoFarmThread
local useFirstSkill = false
local useSecondSkill = false
local useThirdSkill = false
local useFourthSkill = false
local ignoreFriends = false
local specificPlayerUsername = ""
local specificPlayerTarget = nil

local function findClosestMatchingPlayer(inputName)
    local players = game:GetService("Players"):GetPlayers()
    local closestPlayer = nil
    local closestDistance = math.huge

    for _, player in pairs(players) do
        local distance = string.len(player.Name) + string.len(inputName) - 2 * string.len(player.Name:sub(1, string.len(inputName)))
        if distance < closestDistance then
            closestDistance = distance
            closestPlayer = player
        end
    end

    return closestPlayer
end

local function autoFarm()
    local player = game:GetService("Players").LocalPlayer
    local targetPlayer

    while true do
        wait(0.02)

        if specificPlayerTarget then
            targetPlayer = specificPlayerTarget
        else
            if not targetPlayer or not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") or targetPlayer.Character:FindFirstChildOfClass("Humanoid").Health <= 0 then
                local players = game:GetService("Players"):GetPlayers()
                repeat
                    targetPlayer = players[math.random(1, #players)]
                until targetPlayer ~= player and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") and (not ignoreFriends or not player:IsFriendsWith(targetPlayer.UserId))
            end
        end

        if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
            repeat wait() until player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        end

        local function handleAvoidAnimation()
            local endTime = tick() + 1
            while tick() < endTime do
                teleportBehindTarget(player, targetPlayer, 13)
                wait(0.02)
            end
        end

        if isAnimationPlaying(targetPlayer.Character) then
            handleAvoidAnimation()
        else
            teleportBehindTarget(player, targetPlayer, 3)

            local args = {
                [1] = {
                    ["Goal"] = "LeftClick",
                    ["Mobile"] = true
                }
            }
            game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))

            local argsRelease = {
                [1] = {
                    ["Goal"] = "LeftClickRelease",
                    ["Mobile"] = true
                }
            }
            game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(argsRelease))

            local currentTime = tick()

            if useFirstSkill and (currentTime - skillUsage["firstskill"] >= skillCooldowns[skills.firstskill[1]]) then
                coroutine.wrap(equipAndUseSkill)(player, "firstskill")
                skillUsage["firstskill"] = currentTime
            end
            if useSecondSkill and (currentTime - skillUsage["secondskill"] >= skillCooldowns[skills.secondskill[1]]) then
                coroutine.wrap(equipAndUseSkill)(player, "secondskill")
                skillUsage["secondskill"] = currentTime
            end
            if useThirdSkill and (currentTime - skillUsage["thirdskill"] >= skillCooldowns[skills.thirdskill[1]]) then
                coroutine.wrap(equipAndUseSkill)(player, "thirdskill")
                skillUsage["thirdskill"] = currentTime
            end
            if useFourthSkill and (currentTime - skillUsage["fourthskill"] >= skillCooldowns[skills.fourthskill[1]]) then
                coroutine.wrap(equipAndUseSkill)(player, "fourthskill")
                skillUsage["fourthskill"] = currentTime
            end
        end
    end
end

local OpenUI = Instance.new("ScreenGui") 
local ImageButton = Instance.new("ImageButton") 
local UICorner = Instance.new("UICorner") 
OpenUI.Name = "OpenUI" 
OpenUI.Parent = game:GetService("CoreGui") 
OpenUI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling 
ImageButton.Parent = OpenUI 
ImageButton.BackgroundColor3 = Color3.fromRGB(105, 105, 105) 
ImageButton.BackgroundTransparency = 0.8
ImageButton.Position = UDim2.new(0.9, 0, 0.1, 0) 
ImageButton.Size = UDim2.new(0, 50, 0, 50) 
ImageButton.Image = "" 
ImageButton.Draggable = true 
ImageButton.Transparency = 1
UICorner.CornerRadius = UDim.new(0, 200) 
UICorner.Parent = ImageButton 
ImageButton.MouseButton1Click:Connect(function()
	local vim = game:service("VirtualInputManager")
	vim:SendKeyEvent(true, "RightControl", false, game)
	local vim = game:service("VirtualInputManager")
	vim:SendKeyEvent(false, "RightControl", false, game)
end)

local punchAnimations = {
    ["10469493270"] = true,
    ["10469630950"] = true,
    ["10469639222"] = true,
    ["10469643643"] = true,
    ["13532562418"] = true,
    ["13491635433"] = true,
    ["13296577783"] = true,
    ["13295919399"] = true,
    ["13370310513"] = true,
    ["13390230973"] = true,
    ["13378751717"] = true,
    ["13378708199"] = true,
    ["14004222985"] = true,
    ["13997092940"] = true,
    ["14001963401"] = true,
    ["14136436157"] = true,
    ["15259161390"] = true,
    ["15240216931"] = true,
    ["15240176873"] = true,
    ["15162694192"] = true,
    ["16515503507"] = true,
    ["16515520431"] = true,
    ["16515448089"] = true,
    ["16552234590"] = true,
    ["17889458563"] = true,
    ["17889461810"] = true,
    ["17889471098"] = true,
    ["17889290569"] = true
}

local dashAnimations = {
    ["10479335397"] = true,
    ["13380255751"] = true
}

local skillAnimations = {
    ["10466974800"] = 1.8,
    ["12534735382"] = 1.9,
    ["14046756619"] = 0.5,
    ["13376962659"] = 1.0,
    ["12296882427"] = 0.4,
    ["12618292188"] = 0.6,
    ["12618271998"] = 0.6,
    ["13376869471"] = 0.5,
    ["17799224866"] = 0.9,
    ["18179181663"] = 0.6,
    ["16515850153"] = 0.8,
    ["16431491215"] = 0.7
}

local blockAnimations = {
    ["BlockingAnimationId"] = true
}

local function isPlayerInRange(player, range)
    local localPlayer = game:GetService("Players").LocalPlayer
    local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
    local rootPart = character:WaitForChild("HumanoidRootPart")

    local targetCharacter = player.Character
    if targetCharacter then
        local targetRootPart = targetCharacter:FindFirstChild("HumanoidRootPart")
        if targetRootPart then
            local distance = (rootPart.Position - targetRootPart.Position).Magnitude
            return distance <= range
        end
    end
    return false
end

local function isLocalPlayerPlayingAnimation()
    local localPlayer = game:GetService("Players").LocalPlayer
    local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
    for _, animTrack in pairs(character.Humanoid:GetPlayingAnimationTracks()) do
        local animId = animTrack.Animation.AnimationId:match("%d+$")
        if punchAnimations[animId] or dashAnimations[animId] or skillAnimations[animId] then
            return true
        end
    end
    return false
end

local function isLocalPlayerBlocking()
    local localPlayer = game:GetService("Players").LocalPlayer
    local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
    for _, animTrack in pairs(character.Humanoid:GetPlayingAnimationTracks()) do
        local animId = animTrack.Animation.AnimationId:match("%d+$")
        if blockAnimations[animId] then
            return true
        end
    end
    return false
end

local function detectAnimations()
    local players = game:GetService("Players")

    for _, player in pairs(players:GetPlayers()) do
        if player ~= players.LocalPlayer then
            local inRange = false
            if detectionMode == "360" then
                inRange = isPlayerInRange(player, 50)
            end

            if inRange then
                local character = player.Character
                if character then
                    for _, animTrack in pairs(character.Humanoid:GetPlayingAnimationTracks()) do
                        local animId = animTrack.Animation.AnimationId:match("%d+$")
                        if not isLocalPlayerPlayingAnimation() then
                            if punchAnimations[animId] then
                                local args = {
                                    [1] = {
                                        ["Goal"] = "KeyPress",
                                        ["Key"] = Enum.KeyCode.F
                                    }
                                }

                                game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))

                                wait(0.45)

                                local args = {
                                    [1] = {
                                        ["Goal"] = "KeyRelease",
                                        ["Key"] = Enum.KeyCode.F
                                    }
                                }

                                game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))
                            elseif dashAnimations[animId] then
                                local args = {
                                    [1] = {
                                        ["Goal"] = "KeyPress",
                                        ["Key"] = Enum.KeyCode.F
                                    }
                                }

                                game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))

                                wait(0.90)

                                local args = {
                                    [1] = {
                                        ["Goal"] = "KeyRelease",
                                        ["Key"] = Enum.KeyCode.F
                                    }
                                }

                                game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))
                            elseif skillAnimations[animId] then
                                local args = {
                                    [1] = {
                                        ["Goal"] = "KeyPress",
                                        ["Key"] = Enum.KeyCode.F
                                    }
                                }

                                game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))

                                wait(skillAnimations[animId])

                                local args = {
                                    [1] = {
                                        ["Goal"] = "KeyRelease",
                                        ["Key"] = Enum.KeyCode.F
                                    }
                                }

                                game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))
                            end
                        end
                    end
                end
            end
        end
    end
end

local function autoPunch()
    local players = game:GetService("Players")

    for _, player in pairs(players:GetPlayers()) do
        if player ~= players.LocalPlayer then
            local inRange = false
            if detectionMode == "360" then
                inRange = isPlayerInRange(player, 7)
            end

            if inRange and not isLocalPlayerBlocking() then
                local args = {
                    [1] = {
                        ["Goal"] = "LeftClick",
                        ["Mobile"] = true
                    }
                }
                game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(args))

                local argsRelease = {
                    [1] = {
                        ["Goal"] = "LeftClickRelease",
                        ["Mobile"] = true
                    }
                }
                game:GetService("Players").LocalPlayer.Character.Communicate:FireServer(unpack(argsRelease))
            end
        end
    end
end

local autoBlockEnabled = false
local autoPunchEnabled = false

game:GetService("RunService").Heartbeat:Connect(function()
    if autoBlockEnabled then
        detectAnimations()
    end
    if autoPunchEnabled then
        autoPunch()
    end
end)

local strongestBattleTab = Window:Tab({Title = "最强战场", Icon = "swords", Locked = false})

local combatSection = strongestBattleTab:Section({Title = "战斗功能", Icon = "sword", Opened = true})

combatSection:Toggle({
    Title = "防击打",
    Value = false,
    Callback = function(Value)
        ultraInstinctActive = Value
        if ultraInstinctActive then
            ultraInstinctLoop()
        end
    end
})

combatSection:Toggle({
    Title = "自动打人",
    Value = false,
    Callback = function(Value)
        if Value then
            autoFarmThread = coroutine.create(autoFarm)
            coroutine.resume(autoFarmThread)
        else
            if autoFarmThread then
                coroutine.close(autoFarmThread)
                autoFarmThread = nil
            end
        end
    end
})

combatSection:Input({
    Title = "输入玩家用户名",
    Placeholder = "输入玩家用户名",
    Callback = function(Value)
        specificPlayerUsername = Value
        specificPlayerTarget = findClosestMatchingPlayer(specificPlayerUsername)
    end
})

combatSection:Button({
    Title = "关闭自动打人",
    Callback = function()
        specificPlayerTarget = nil
    end
})

combatSection:Toggle({
    Title = "自动防御",
    Value = false,
    Callback = function(Value)
        autoBlockEnabled = Value
    end
})

combatSection:Toggle({
    Title = "自动挥拳",
    Value = false,
    Callback = function(Value)
        autoPunchEnabled = Value
    end
})

combatSection:Toggle({
    Title = "自瞄玩家",
    Value = false,
    Callback = function(Value)
        getgenv().AutoAimlocking = Value
        game:GetService("RunService").RenderStepped:Connect(function() 
            if not getgenv().AutoAimlocking == true then 
                return 
            end 
            local x,b 
            for _,v in ipairs(game:GetService("Players"):GetPlayers()) do 
                if v.Character and v ~= game:GetService("Players").LocalPlayer then 
                    if not x or (v.Character.Head.Position - game:GetService("Players").LocalPlayer.Character.Head.Position).Magnitude < b then 
                        x = v 
                        b = (v.Character.Head.Position - game:GetService("Players").LocalPlayer.Character.Head.Position).Magnitude 
                    end 
                end 
            end 
            if x and b <= 15 then 
                game:GetService("Workspace").CurrentCamera.CFrame = CFrame.new(game:GetService("Workspace").CurrentCamera.CFrame.p, x.Character.HumanoidRootPart.Position) 
            end 
        end)
    end
})

combatSection:Toggle({
    Title = "自动躲技能",
    Value = false,
    Callback = function(Value)
        getgenv().AutoDodging = Value

        local DashAnims = {NormalDash = {10479335397},WeaponDash = {13380255751}}
        local SaitamaAnims = {
            NormalPunch = {10468665991}
        }
        local GarouAnims = {
            FlowingWater = {12272894215}
        }
        local GenosAnims = {
            MachineGunBlows = {12534735382}
        }
        local SonicAnims = {
            FlashStrike = {13376869471}
        }
        local MetalBatAnims = {
            Homerun = {14004235777,14003607057}
        }
        local SamuraiAnims = {
            QuickSlice = {15290930205}
        }
        local EsperAnims = {
            CrushingPull = {16139108718,16139402582}
        }

        local Animations = {}
        for _,x in pairs({DashAnims,SaitamaAnims,GarouAnims,GenosAnims,SonicAnims,MetalBatAnims,SamuraiAnims,EsperAnims}) do
            for _,k in pairs(x) do
                for _,v in pairs(k) do
                    table.insert(Animations,v)
                end
            end
        end

        task.spawn(function()
            local connection
            connection = game:GetService("RunService").RenderStepped:Connect(function()
                if getgenv().AutoDodging == true then
                    pcall(function()
                        for _,k in ipairs(workspace.Live:GetChildren()) do
                            if k:IsA("Model") and k:FindFirstChild("Head") and k.Head:IsA("Part") and k.Head.Name == "Head" and k.Head ~= game.Players.LocalPlayer.Character.Head then
                                if (k.Head.Position - game.Players.LocalPlayer.Character.Head.Position).magnitude <= 25 then
                                    if k:FindFirstChildOfClass("Humanoid") and k:FindFirstChildOfClass("Humanoid").Health > 0 then 
                                        local IsUsingAttacks = false
                                        for _,x in pairs(k:FindFirstChildOfClass("Humanoid"):GetPlayingAnimationTracks()) do
                                            local animId = x.Animation.AnimationId:match("%d+")
                                            if animId and table.find(Animations, tonumber(animId)) then
                                                IsUsingAttacks = true
                                                break
                                            end
                                        end

                                        if k:FindFirstChild("M1ing") or IsUsingAttacks then    
                                            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(k.Head.Position + k.Head.CFrame.lookVector * -20 + Vector3.new(0,35,0),k.Head.Position)
                                        end
                                    end
                                end
                            end
                        end
                    end)
                else
                    if connection then
                        connection:Disconnect()
                    end
                end
            end)
        end)
    end
})

local autoSection = strongestBattleTab:Section({Title = "自动功能", Icon = "zap", Opened = true})

autoSection:Toggle({
    Title = "自动放技能1",
    Value = false,
    Callback = function(Value)
        useFirstSkill = Value
    end
})

autoSection:Toggle({
    Title = "自动放技能2",
    Value = false,
    Callback = function(Value)
        useSecondSkill = Value
    end
})

autoSection:Toggle({
    Title = "自动放技能3",
    Value = false,
    Callback = function(Value)
        useThirdSkill = Value
    end
})

autoSection:Toggle({
    Title = "自动放技能4",
    Value = false,
    Callback = function(Value)
        useFourthSkill = Value
    end
})

Window:OnClose(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    applyBlurEffect(false)
end)

Window:OnDestroy(function()
    windowOpen = false
    if rainbowBorderAnimation then
        rainbowBorderAnimation:Disconnect()
        rainbowBorderAnimation = nil
    end
    for _, animation in pairs(fontColorAnimations) do
        animation:Disconnect()
    end
    fontColorAnimations = {}
    applyBlurEffect(false)
end)

end
end